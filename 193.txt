2024-10-31 07:29:10.754 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 95.33333333333334
2024-10-31 07:29:10.755 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 95.33333333333334
2024-10-31 07:29:10.756 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 95.33333333333334
2024-10-31 07:29:10.757 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 95.33333333333334
2024-10-31 07:29:10.757 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 95.33333333333334
2024-10-31 07:29:10.758 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 95.33333333333334
2024-10-31 07:29:10.759 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 95.33333333333334
2024-10-31 07:29:10.760 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 95.33333333333334
2024-10-31 07:29:10.760 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 96.00000000000001
2024-10-31 07:29:10.761 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 96.00000000000001
2024-10-31 07:29:10.762 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 96.00000000000001
2024-10-31 07:29:10.763 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 96.00000000000001
2024-10-31 07:29:10.763 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 96.00000000000001
2024-10-31 07:29:10.764 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 96.00000000000001
2024-10-31 07:29:10.765 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 96.00000000000001
2024-10-31 07:29:10.766 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 96.00000000000001
2024-10-31 07:29:10.766 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 96.00000000000001
2024-10-31 07:29:10.767 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 96.00000000000001
2024-10-31 07:29:10.768 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 96.00000000000001
2024-10-31 07:29:10.769 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 96.00000000000001
2024-10-31 07:29:10.770 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 96.00000000000001
2024-10-31 07:29:10.771 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 96.00000000000001
2024-10-31 07:29:10.771 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 96.00000000000001
2024-10-31 07:29:10.772 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 96.00000000000001
2024-10-31 07:29:10.773 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 96.00000000000001
2024-10-31 07:29:10.774 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 96.00000000000001
2024-10-31 07:29:10.775 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 96.00000000000001
2024-10-31 07:29:10.775 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 96.00000000000001
2024-10-31 07:29:10.776 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 96.00000000000001
2024-10-31 07:29:10.777 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 96.00000000000001
2024-10-31 07:29:10.778 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 96.00000000000001
2024-10-31 07:29:10.779 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 96.00000000000001
2024-10-31 07:29:10.780 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 96.66666666666667
2024-10-31 07:29:10.781 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 100.0
2024-10-31 07:29:10.782 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 100.0
2024-10-31 07:29:10.782 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 100.0
2024-10-31 07:29:10.783 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 100.0
2024-10-31 07:29:10.784 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 100.0
2024-10-31 07:29:10.785 | INFO     | retrieval.model:validation_step:379 - MRR: 0.6131796540455262
2024-10-31 07:29:10.786 | INFO     | retrieval.model:validation_step:387 - End of validation_step
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14675/14675 [1:50:12<00:00,  2.22it/s, v_num=7]
[rank: 2] Monitored metric Recall@10_val did not improve in the last 15 records. Best score: 72.990. Signaling Trainer to stop.
[rank: 3] Monitored metric Recall@10_val did not improve in the last 15 records. Best score: 72.990. Signaling Trainer to stop.
[rank: 1] Monitored metric Recall@10_val did not improve in the last 15 records. Best score: 72.990. Signaling Trainer to stop.
[rank: 0] Monitored metric Recall@10_val did not improve in the last 15 records. Best score: 72.990. Signaling Trainer to stop.
Epoch 16, global step 76830: 'Recall@10_val' reached 62.83811 (best 72.99026), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch
=16-Recall@10_val=62.84.ckpt' as top 17
`Trainer.fit` stopped: `max_epochs=17` reached.
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14675/14675 [1:50:44<00:00,  2.21it/s, v_num=7]
2024-10-31 07:29:47.155 | INFO     | __main__:main:1696 - hit the barrier after training
2024-10-31 07:29:47.307 | INFO     | __main__:main:1696 - hit the barrier after training
2024-10-31 07:29:47.382 | INFO     | __main__:main:1696 - hit the barrier after training
2024-10-31 07:29:47.723 | INFO     | __main__:main:1696 - hit the barrier after training
2024-10-31 07:29:47.724 | INFO     | __main__:main:1702 - Finished progressive training at epoch 17
2024-10-31 07:29:47.724 | INFO     | __main__:main:1702 - Finished progressive training at epoch 17
2024-10-31 07:29:47.724 | INFO     | __main__:main:1702 - Finished progressive training at epoch 17
2024-10-31 07:29:47.724 | INFO     | __main__:main:1702 - Finished progressive training at epoch 17
2024-10-31 07:29:47.725 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:main:1709 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:main:1709 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:main:1709 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 07:29:47.725 | INFO     | __main__:main:1709 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 07:29:56.214 | INFO     | __main__:main:1719 - Testing...
2024-10-31 07:29:56.217 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
2024-10-31 07:29:56.258 | INFO     | __main__:main:1719 - Testing...
2024-10-31 07:29:56.258 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 07:29:56.262 | INFO     | __main__:main:1719 - Testing...
2024-10-31 07:29:56.263 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
2024-10-31 07:29:56.263 | INFO     | __main__:main:1719 - Testing...
2024-10-31 07:29:56.263 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-31 07:29:56.594 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-10-31 07:29:56.594 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-10-31 07:29:56.613 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-10-31 07:29:56.614 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-10-31 07:29:56.623 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-10-31 07:29:56.624 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-10-31 07:29:56.634 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-10-31 07:29:56.634 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 07:29:57.652 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-31 07:29:57.654 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-31 07:29:57.657 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_pred/cached_data.pkl
Testing dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 07:29:57.659 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:29:57.660 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:29:57.660 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:29:57.661 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:29:57.670 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/data.py:105: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.
2024-10-31 07:30:03.157 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:30:03.157 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 07:30:03.499 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-10-31 07:30:03.499 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-10-31 07:30:03.513 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-10-31 07:30:03.514 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-10-31 07:30:03.621 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 07:30:03.948 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-10-31 07:30:03.948 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-10-31 07:30:04.004 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:30:04.005 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.json
0it [00:00, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-10-31 07:30:04.010 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:30:04.011 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:30:04.343 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-10-31 07:30:04.343 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-31 07:30:26.909 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-10-31 07:30:31.107 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-10-31 07:30:31.143 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
2024-10-31 07:30:31.195 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-10-31 07:30:31.228 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
2024-10-31 07:30:31.230 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-10-31 07:30:31.271 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
2024-10-31 07:30:31.372 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-31 07:30:34.507 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:30:34.508 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2130 [00:00<?, ?it/s]
2024-10-31 07:30:34.548 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:30:34.549 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/2130 [00:00<02:48, 12.59it/s]
2024-10-31 07:30:34.744 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:30:34.745 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 07:30:35.230 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:30:35.231 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:15<00:00,  3.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:16<00:00,  3.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:18<00:00,  3.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:18<00:00,  3.14it/s]
Predicting DataLoader 0:   0%|                                                                                                                                                                                               | 0/21 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:53<00:00,  0.39it/s]
2024-10-31 07:42:46.958 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:42:46.958 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:42:46.958 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:42:46.958 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:42:47.173 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 07:42:47.173 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:42:47.177 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 07:42:47.177 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:42:47.202 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 07:42:47.202 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:42:47.206 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 07:42:47.207 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:42:47.207 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:53<00:00,  0.39it/s]
2024-10-31 07:42:48.370 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:42:48.619 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
2024-10-31 07:42:48.682 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
2024-10-31 07:42:48.841 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-10-31 07:42:48.841 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 07:42:49.007 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-10-31 07:42:49.007 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
2024-10-31 07:42:49.043 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-10-31 07:42:49.043 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
2024-10-31 07:42:49.571 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:42:49.666 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3364/3364 [00:00<00:00, 31229.07it/s]
2024-10-31 07:42:49.775 | INFO     | __main__:main:1746 - R@1 = 22.994627843904635 %, R@10 = 58.7784718990718 %, MRR = 0.4764686636053156
2024-10-31 07:42:49.777 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:42:50.132 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-10-31 07:42:50.133 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]

0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 07:42:50.922 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]2024-10-31 07:42:50.923 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318
a1b6621490c21/random/cache_train/cached_data.pkl
2024-10-31 07:42:50.923 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_train/cached_data.pkl
2024-10-31 07:42:50.923 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_train/cached_data.pkl

Training dataset size: 0
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-10-31 07:42:50.926 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:42:50.927 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_pred/cached_data.pkl
2024-10-31 07:42:50.927 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_pred/cached_data.pkl
2024-10-31 07:42:50.927 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:42:53.473 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 07:42:53.473 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 07:42:53.838 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-31 07:42:53.838 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-10-31 07:42:53.840 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-31 07:42:53.840 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-10-31 07:42:53.969 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 07:42:54.309 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-31 07:42:54.309 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-10-31 07:42:54.843 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:42:54.857 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/test.json
0it [00:00, ?it/s]
2024-10-31 07:42:54.858 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:42:54.859 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:42:55.203 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-31 07:42:55.203 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]


2024-10-31 07:42:55.968 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:42:55.969 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_train/cached_data.pkl
2024-10-31 07:42:55.969 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:42:55.969 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]

2024-10-31 07:42:55.974 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:42:55.975 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_pred/cached_data.pkl
2024-10-31 07:42:55.975 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
2024-10-31 07:42:55.975 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:42:58.672 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:42:58.673 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-31 07:42:59.022 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-10-31 07:42:59.022 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-10-31 07:42:59.029 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-10-31 07:42:59.029 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-10-31 07:42:59.163 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 07:42:59.480 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-10-31 07:42:59.480 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-10-31 07:42:59.956 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:42:59.957 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
0it [00:00, ?it/s]
2024-10-31 07:42:59.957 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:42:59.958 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:43:10.601 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-10-31 07:43:10.601 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-10-31 07:43:11.659 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:43:11.660 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_train/cached_data.pkl
2024-10-31 07:43:11.660 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_train/cached_data.pkl
2024-10-31 07:43:11.660 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]

0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 07:43:11.664 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:43:11.665 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_pred/cached_data.pkl
2024-10-31 07:43:11.665 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_pred/cached_data.pkl
2024-10-31 07:43:11.665 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-31 07:43:14.274 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:43:14.273 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-31 07:43:14.623 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-31 07:43:14.624 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-10-31 07:43:14.632 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-31 07:43:14.632 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-10-31 07:43:14.751 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 07:43:15.074 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-31 07:43:15.074 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-10-31 07:43:15.538 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:43:15.539 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/test.json
0it [00:00, ?it/s]
2024-10-31 07:43:15.540 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:43:15.541 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:43:15.880 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-31 07:43:15.880 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 07:43:16.659 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:43:16.659 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
2024-10-31 07:43:16.659 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
2024-10-31 07:43:16.659 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 07:43:16.663 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:43:16.664 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_pred/cached_data.pkl
2024-10-31 07:43:16.664 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
2024-10-31 07:43:16.664 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-31 07:43:18.983 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:43:18.986 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 07:43:19.347 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-31 07:43:19.347 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-31 07:43:19.349 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-31 07:43:19.350 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-31 07:43:19.495 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 07:43:19.829 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-31 07:43:19.829 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-31 07:43:20.353 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:43:20.354 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/test.json
0it [00:00, ?it/s]
2024-10-31 07:43:20.355 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:43:20.356 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:43:20.691 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-31 07:43:20.691 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-10-31 07:43:21.537 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:43:21.538 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_train/cached_data.pkl
2024-10-31 07:43:21.538 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
2024-10-31 07:43:21.538 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]


2024-10-31 07:43:21.541 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:43:21.542 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_pred/cached_data.pkl
2024-10-31 07:43:21.542 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
2024-10-31 07:43:21.542 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-31 07:43:24.023 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 07:43:24.024 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-31 07:43:24.369 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-31 07:43:24.370 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-10-31 07:43:24.380 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-31 07:43:24.380 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-10-31 07:43:24.520 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 07:43:24.821 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-31 07:43:24.821 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-10-31 07:43:25.338 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:43:25.339 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
0it [00:00, ?it/s]
2024-10-31 07:43:25.340 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:43:25.341 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:43:25.728 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-31 07:43:25.728 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 95967/95967 [00:15<00:00, 6292.73it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 95967/95967 [00:15<00:00, 6214.72it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     | 85729/95967 [00:15<00:02, 4741.21it/s]
2024-10-31 07:44:09.417 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_train/cached_data.pkl
Training dataset size: 199888
2024-10-31 07:44:09.442 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_train/cached_data.pkl
Training dataset size: 199888
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1999/1999 [00:00<00:00, 6211.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1999/1999 [00:00<00:00, 6260.78it/s]
2024-10-31 07:44:09.823 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_pred/cached_data.pkl
Testing dataset size: 3371
2024-10-31 07:44:09.838 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_pred/cached_data.pkl
Testing dataset size: 3371
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 95967/95967 [00:17<00:00, 5477.18it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 95967/95967 [00:18<00:00, 5212.09it/s]
2024-10-31 07:44:12.770 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_train/cached_data.pkl
Training dataset size: 199888
2024-10-31 07:44:12.793 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 3371
2024-10-31 07:44:13.480 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_train/cached_data.pkl
Training dataset size: 199888
2024-10-31 07:44:13.510 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 3371
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:44:16.958 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:44:16.987 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/1958 [00:00<?, ?it/s]
2024-10-31 07:44:16.997 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:44:16.997 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/1958 [00:00<02:31, 12.89it/s]
2024-10-31 07:44:17.214 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:44:17.215 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 07:44:17.656 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:44:17.657 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1958/1958 [10:27<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1958/1958 [10:29<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1958/1958 [10:30<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1958/1958 [10:30<00:00,  3.11it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:38<00:00,  0.36it/s]
2024-10-31 07:55:26.629 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:55:26.629 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:55:26.629 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:55:26.629 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:55:26.799 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 07:55:26.800 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:55:26.803 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 07:55:26.803 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:55:26.814 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 07:55:26.814 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:55:26.819 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 07:55:26.819 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:55:26.819 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:38<00:00,  0.36it/s]
2024-10-31 07:55:28.059 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:55:28.437 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 07:55:28.453 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 3] Seed set to 3407
2024-10-31 07:55:28.596 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-31 07:55:28.597 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 07:55:28.802 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-31 07:55:28.802 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-10-31 07:55:28.807 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-31 07:55:28.807 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-10-31 07:55:29.276 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:55:29.321 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1999/1999 [00:00<00:00, 30931.03it/s]
2024-10-31 07:55:29.386 | INFO     | __main__:main:1746 - R@1 = 23.624416821671158 %, R@10 = 61.00792134889805 %, MRR = 0.5209065681721322
2024-10-31 07:55:29.388 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 07:55:29.785 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-31 07:55:29.785 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 5003.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 4875.13it/s]
2024-10-31 07:55:35.531 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_train/cached_data.pkl
Training dataset size: 6693
  0%|                                                                                                                                                                                                                        | 0/51 [00:00<?, ?it/s]
2024-10-31 07:55:35.545 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_train/cached_data.pkl
Training dataset size: 6693
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 3264.65it/s]
2024-10-31 07:55:35.555 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 149
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 3038.44it/s]
2024-10-31 07:55:35.568 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 149
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 4018.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 4112.02it/s]
2024-10-31 07:55:35.678 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_train/cached_data.pkl
2024-10-31 07:55:35.678 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_train/cached_data.pkl
Training dataset size: 6693
Training dataset size: 6693
2024-10-31 07:55:35.680 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 149
2024-10-31 07:55:35.680 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 149
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:55:38.692 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:55:38.693 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  1%|█▏                                                                                                                                                                                                             | 2/355 [00:00<00:21, 16.19it/s]
2024-10-31 07:55:38.896 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:55:38.897 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                       | 0/355 [00:00<?, ?it/s]
2024-10-31 07:55:38.972 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:55:38.973 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 07:55:39.084 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:55:39.084 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 355/355 [02:20<00:00,  2.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 355/355 [02:21<00:00,  2.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 355/355 [02:20<00:00,  2.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 355/355 [02:21<00:00,  2.51it/s]
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.17it/s]
2024-10-31 07:58:01.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:58:01.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:58:01.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:58:01.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 07:58:01.145 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 07:58:01.145 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:58:01.146 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 07:58:01.146 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 07:58:01.146 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:58:01.146 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:58:01.146 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 07:58:01.146 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 07:58:01.147 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.16it/s]
2024-10-31 07:58:02.656 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:58:02.722 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
2024-10-31 07:58:02.793 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-31 07:58:03.023 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-31 07:58:03.023 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 2] Seed set to 3407
2024-10-31 07:58:03.088 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-31 07:58:03.088 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-31 07:58:03.105 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:58:03.118 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 32504.10it/s]
2024-10-31 07:58:03.121 | INFO     | __main__:main:1746 - R@1 = 30.960212777506378 %, R@10 = 76.30326222656463 %, MRR = 0.5930667755300013
2024-10-31 07:58:03.122 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
2024-10-31 07:58:03.144 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-31 07:58:03.145 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 0] Seed set to 3407
2024-10-31 07:58:03.422 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-31 07:58:03.422 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]


0it [00:00, ?it/s]
2024-10-31 07:58:04.116 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]2024-10-31 07:58:04.117 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa1
7e2147/random/cache_train/cached_data.pkl

2024-10-31 07:58:04.117 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_train/cached_data.pkl
Training dataset size: 0
2024-10-31 07:58:04.117 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]

2024-10-31 07:58:04.120 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:58:04.121 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 07:58:04.121 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_pred/cached_data.pkl
2024-10-31 07:58:04.121 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:58:06.937 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 07:58:06.938 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-31 07:58:07.291 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-31 07:58:07.291 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-31 07:58:07.295 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-31 07:58:07.295 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-31 07:58:07.432 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
2024-10-31 07:58:07.453 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 07:58:07.454 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
0it [00:00, ?it/s]
2024-10-31 07:58:07.454 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 07:58:07.455 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 1] Seed set to 3407
[rank: 0] Seed set to 3407
2024-10-31 07:58:07.742 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-31 07:58:07.742 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-31 07:58:07.774 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-31 07:58:07.774 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 96024/96024 [00:14<00:00, 6497.54it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 96024/96024 [00:15<00:00, 6271.59it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                          | 52174/96024 [00:11<00:09, 4604.13it/s]
2024-10-31 07:58:49.024 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_train/cached_data.pkl
Training dataset size: 200750
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2000/2000 [00:00<00:00, 6356.07it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                      | 54220/96024 [00:12<00:08, 4966.02it/s]
2024-10-31 07:58:49.428 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_pred/cached_data.pkl
Testing dataset size: 3371
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                     | 54718/96024 [00:12<00:08, 4743.04it/s]
2024-10-31 07:58:49.509 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_train/cached_data.pkl
Training dataset size: 200750
2024-10-31 07:58:49.529 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 3371
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 96024/96024 [00:18<00:00, 5151.81it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 81888/96024 [00:18<00:02, 5483.59it/s]
2024-10-31 07:58:55.391 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_train/cached_data.pkl
Training dataset size: 200750
2024-10-31 07:58:55.413 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 3371
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 96024/96024 [00:20<00:00, 4637.16it/s]
2024-10-31 07:58:59.140 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_train/cached_data.pkl
Training dataset size: 200750
2024-10-31 07:58:59.163 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 3371
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 07:59:02.624 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:59:02.624 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/1962 [00:00<02:01, 16.14it/s]
2024-10-31 07:59:02.865 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:59:02.865 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/1962 [00:00<?, ?it/s]
2024-10-31 07:59:02.909 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:59:02.911 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 07:59:03.347 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 07:59:03.348 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1962/1962 [10:29<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1962/1962 [10:31<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1962/1962 [10:32<00:00,  3.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1962/1962 [10:32<00:00,  3.10it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:41<00:00,  0.34it/s]
2024-10-31 08:10:16.638 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:10:16.638 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:10:16.638 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:10:16.638 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:10:16.794 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 08:10:16.795 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:10:16.799 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 08:10:16.799 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:10:16.811 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 08:10:16.811 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:10:16.816 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 08:10:16.817 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:10:16.817 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:41<00:00,  0.34it/s]
2024-10-31 08:10:18.421 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 08:10:18.452 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 08:10:18.463 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-31 08:10:19.019 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-31 08:10:19.022 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-31 08:10:19.197 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-31 08:10:19.200 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-31 08:10:19.501 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-31 08:10:19.506 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-31 08:10:28.308 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:10:28.362 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2000/2000 [00:00<00:00, 33314.83it/s]
2024-10-31 08:10:28.423 | INFO     | __main__:main:1746 - R@1 = 23.51559634236232 %, R@10 = 61.12162969100387 %, MRR = 0.5209261366261831
2024-10-31 08:10:28.425 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 08:10:28.802 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-31 08:10:28.802 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-10-31 08:10:29.748 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]2024-10-31 08:10:29.749 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee01
3a2687/random/cache_train/cached_data.pkl
2024-10-31 08:10:29.749 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-31 08:10:29.749 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-10-31 08:10:29.752 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 08:10:29.753 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 08:10:29.753 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 08:10:29.753 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:10:32.210 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 08:10:32.242 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-31 08:10:32.555 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-31 08:10:32.555 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-10-31 08:10:32.577 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-31 08:10:32.577 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-10-31 08:10:32.747 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 08:10:33.079 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-31 08:10:33.079 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-10-31 08:10:33.349 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:10:33.357 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
0it [00:00, ?it/s]
2024-10-31 08:10:33.358 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 08:10:33.359 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 08:10:33.688 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-31 08:10:33.688 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 76321/76321 [00:16<00:00, 4615.12it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                          | 41505/76321 [00:07<00:05, 6645.02it/s]
2024-10-31 08:11:08.537 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf2614
45d/random/cache_train/cached_data.pkl
Training dataset size: 172878
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1590/1590 [00:00<00:00, 6094.44it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                     | 43692/76321 [00:08<00:04, 6837.32it/s]
2024-10-31 08:11:08.862 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf2614
45d/random/cache_pred/cached_data.pkl
Testing dataset size: 2640
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 76321/76321 [00:12<00:00, 6267.63it/s]
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 73988/76321 [00:10<00:00, 5760.54it/s]
2024-10-31 08:11:11.797 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf2614
45d/random/cache_train/cached_data.pkl
Training dataset size: 172878
2024-10-31 08:11:11.820 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2640
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 76321/76321 [00:12<00:00, 5993.49it/s]
2024-10-31 08:11:14.484 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf2614
45d/random/cache_train/cached_data.pkl
Training dataset size: 172878
2024-10-31 08:11:14.503 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2640
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 76321/76321 [00:15<00:00, 4817.25it/s]
2024-10-31 08:11:17.911 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf2614
45d/random/cache_train/cached_data.pkl
Training dataset size: 172878
2024-10-31 08:11:17.930 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2640
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-31 08:11:20.953 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:11:20.954 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/1870 [00:00<?, ?it/s]
2024-10-31 08:11:21.059 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:11:21.059 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/1870 [00:00<?, ?it/s]
2024-10-31 08:11:21.065 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:11:21.096 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 08:11:21.622 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:11:21.623 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1870/1870 [09:59<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1870/1870 [10:00<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1870/1870 [10:01<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1870/1870 [10:02<00:00,  3.10it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:28<00:00,  0.39it/s]
2024-10-31 08:21:52.430 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:21:52.559 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 08:21:52.559 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:21:52.862 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:21:52.862 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:21:52.989 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 08:21:52.990 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:21:53.021 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 08:21:53.021 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:21:53.949 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:21:54.074 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 08:21:54.075 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:21:54.075 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:30<00:00,  0.37it/s]
2024-10-31 08:21:55.646 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
2024-10-31 08:21:55.764 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
2024-10-31 08:21:55.799 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-31 08:21:56.078 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-31 08:21:56.078 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
[rank: 3] Seed set to 3407
2024-10-31 08:21:56.154 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-31 08:21:56.154 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-31 08:21:56.191 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-31 08:21:56.191 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-31 08:22:06.176 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:22:06.227 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1590/1590 [00:00<00:00, 30329.65it/s]
2024-10-31 08:22:06.281 | INFO     | __main__:main:1746 - R@1 = 25.261743500017964 %, R@10 = 65.26118054563337 %, MRR = 0.558980099038321
2024-10-31 08:22:06.282 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 08:22:06.647 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-31 08:22:06.647 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 08:22:07.482 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]2024-10-31 08:22:07.483 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519e
bad9704be0/random/cache_train/cached_data.pkl
2024-10-31 08:22:07.483 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_train/cached_data.pkl
0it [00:00, ?it/s]2024-10-31 08:22:07.483 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519e
bad9704be0/random/cache_train/cached_data.pkl
Training dataset size: 0

Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]

2024-10-31 08:22:07.488 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 08:22:07.489 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
2024-10-31 08:22:07.489 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
2024-10-31 08:22:07.489 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-31 08:22:10.174 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 08:22:10.214 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 08:22:10.530 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-31 08:22:10.531 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-10-31 08:22:10.572 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-31 08:22:10.572 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-10-31 08:22:10.657 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 08:22:10.988 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-31 08:22:10.988 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-10-31 08:22:11.201 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:22:11.208 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/test.json
0it [00:00, ?it/s]
2024-10-31 08:22:11.209 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 08:22:11.211 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 08:22:11.568 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-31 08:22:11.568 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-31 08:22:30.518 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-10-31 08:22:30.568 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-10-31 08:22:32.527 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-10-31 08:22:32.557 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-10-31 08:22:37.920 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-10-31 08:22:37.950 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-10-31 08:22:39.223 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-10-31 08:22:39.248 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:22:42.339 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:22:42.340 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2318 [00:00<?, ?it/s]
2024-10-31 08:22:42.451 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:22:42.451 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2318 [00:00<?, ?it/s]
2024-10-31 08:22:42.434 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:22:42.495 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 08:22:42.820 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:22:42.821 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:09<00:00,  3.46it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:10<00:00,  3.46it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:11<00:00,  3.45it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:12<00:00,  3.45it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:51<00:00,  0.31it/s]
2024-10-31 08:34:46.560 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:34:46.560 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:34:46.560 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:34:46.560 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:34:46.743 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 08:34:46.743 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:34:46.749 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 08:34:46.749 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:34:46.752 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 08:34:46.752 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:34:46.759 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 08:34:46.759 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:34:46.759 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:51<00:00,  0.31it/s]
2024-10-31 08:34:48.416 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 08:34:48.508 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
2024-10-31 08:34:48.620 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-31 08:34:48.828 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-31 08:34:48.829 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-10-31 08:34:48.874 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-31 08:34:48.874 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
[rank: 2] Seed set to 3407
2024-10-31 08:34:48.964 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-31 08:34:48.964 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-10-31 08:35:00.503 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:35:00.574 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2462/2462 [00:00<00:00, 31388.02it/s]
2024-10-31 08:35:00.654 | INFO     | __main__:main:1746 - R@1 = 23.54040600554212 %, R@10 = 60.93331557929882 %, MRR = 0.4954247953197247
2024-10-31 08:35:00.655 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 08:35:01.040 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-31 08:35:01.040 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]


2024-10-31 08:35:01.851 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]2024-10-31 08:35:01.852 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc3
1e40b9db86bb8/random/cache_train/cached_data.pkl
2024-10-31 08:35:01.852 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_train/cached_data.pkl
2024-10-31 08:35:01.852 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-31 08:35:01.855 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 08:35:01.856 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_pred/cached_data.pkl
2024-10-31 08:35:01.856 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-31 08:35:01.856 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/rand
om/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:35:04.400 | INFO     | retrieval.main:run_cli:60 - PID: 4043868
2024-10-31 08:35:04.402 | INFO     | retrieval.main:run_cli:60 - PID: 4043867
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-31 08:35:04.762 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-10-31 08:35:04.762 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-10-31 08:35:04.765 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-10-31 08:35:04.765 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-10-31 08:35:04.855 | INFO     | retrieval.main:run_cli:60 - PID: 4043866
[rank: 1] Seed set to 3407
2024-10-31 08:35:05.165 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-10-31 08:35:05.165 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-10-31 08:35:05.542 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:35:05.551 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/test.json
0it [00:00, ?it/s]
2024-10-31 08:35:05.553 | INFO     | __main__:main:1746 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 08:35:05.554 | INFO     | retrieval.main:run_cli:60 - PID: 4036291
[rank: 0] Seed set to 3407
2024-10-31 08:35:05.933 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-10-31 08:35:05.933 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125459/125459 [00:27<00:00, 4503.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125459/125459 [00:23<00:00, 5350.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125459/125459 [00:24<00:00, 5161.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 125244/125459 [00:24<00:00, 4443.27it/s]
2024-10-31 08:36:05.696 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/ran
dom/cache_train/cached_data.pkl
Training dataset size: 246472
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125459/125459 [00:24<00:00, 5094.67it/s]
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                               | 2000/2613 [00:00<00:00, 4803.00it/s]
2024-10-31 08:36:06.204 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/ran
dom/cache_train/cached_data.pkl
Training dataset size: 246472
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2613/2613 [00:00<00:00, 4799.95it/s]
2024-10-31 08:36:06.353 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 4590
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2613/2613 [00:00<00:00, 5084.31it/s]
2024-10-31 08:36:06.821 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 4590
2024-10-31 08:36:06.890 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/ran
dom/cache_train/cached_data.pkl
Training dataset size: 246472
2024-10-31 08:36:06.920 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_pred/cached_data.pkl
Testing dataset size: 4590
2024-10-31 08:36:07.342 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/ran
dom/cache_train/cached_data.pkl
Training dataset size: 246472
2024-10-31 08:36:10.791 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_pred/cached_data.pkl
Testing dataset size: 4590
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:36:13.790 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:36:13.791 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2026 [00:00<?, ?it/s]
2024-10-31 08:36:13.858 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:36:13.859 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2026 [00:00<?, ?it/s]
2024-10-31 08:36:13.872 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:36:13.873 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-10-31 08:36:14.307 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-31 08:36:14.308 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2026/2026 [10:49<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2026/2026 [10:50<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2026/2026 [10:51<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2026/2026 [10:52<00:00,  3.11it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:50<00:00,  0.36it/s]
2024-10-31 08:47:56.587 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:47:56.792 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-31 08:47:56.793 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:47:58.045 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:47:58.045 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:47:58.045 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-31 08:47:58.226 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-31 08:47:58.226 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:47:58.231 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-31 08:47:58.231 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:47:58.252 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-31 08:47:58.252 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-31 08:47:58.253 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:51<00:00,  0.35it/s]
2024-10-31 08:47:59.888 | INFO     | __main__:main:1850 - Finished processing the repository
2024-10-31 08:47:59.889 | INFO     | __main__:main:1852 - current epoch: 17
2024-10-31 08:47:59.889 | INFO     | __main__:main:1502 - length of lean_git_repos: 8
2024-10-31 08:47:59.889 | INFO     | __main__:main:1503 - i: 2
2024-10-31 08:47:59.889 | INFO     | __main__:main:1561 - All GPUs
2024-10-31 08:47:59.892 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:47:59.892 | INFO     | __main__:main:1568 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 08:47:59.892 | INFO     | __main__:main:1574 - Inside train_test_fisher
2024-10-31 08:47:59.892 | INFO     | __main__:main:1575 - Starting training at epoch 17
[rank: 3] Seed set to 3407
2024-10-31 08:47:59.916 | INFO     | __main__:main:1850 - Finished processing the repository
2024-10-31 08:47:59.917 | INFO     | __main__:main:1852 - current epoch: 17
2024-10-31 08:47:59.917 | INFO     | __main__:main:1502 - length of lean_git_repos: 8
2024-10-31 08:47:59.917 | INFO     | __main__:main:1503 - i: 2
2024-10-31 08:47:59.918 | INFO     | __main__:main:1561 - All GPUs
2024-10-31 08:47:59.922 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:47:59.922 | INFO     | __main__:main:1568 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 08:47:59.922 | INFO     | __main__:main:1574 - Inside train_test_fisher
2024-10-31 08:47:59.922 | INFO     | __main__:main:1575 - Starting training at epoch 17
[rank: 2] Seed set to 3407
2024-10-31 08:47:59.929 | INFO     | __main__:main:1850 - Finished processing the repository
2024-10-31 08:47:59.929 | INFO     | __main__:main:1852 - current epoch: 17
2024-10-31 08:47:59.930 | INFO     | __main__:main:1502 - length of lean_git_repos: 8
2024-10-31 08:47:59.930 | INFO     | __main__:main:1503 - i: 2
2024-10-31 08:47:59.930 | INFO     | __main__:main:1561 - All GPUs
2024-10-31 08:47:59.932 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0
.1_epoch=16-Recall@10_val=62.84.ckpt
2024-10-31 08:47:59.932 | INFO     | __main__:main:1568 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10
_val=62.84.ckpt
2024-10-31 08:47:59.932 | INFO     | __main__:main:1574 - Inside train_test_fisher
2024-10-31 08:47:59.932 | INFO     | __main__:main:1575 - Starting training at epoch 17
[rank: 1] Seed set to 3407
2024-10-31 08:48:01.337 | INFO     | __main__:main:1741 - Loaded the predictions pickle files
2024-10-31 08:48:01.441 | INFO     | __main__:main:1744 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2613/2613 [00:00<00:00, 18821.81it/s]
2024-10-31 08:48:01.582 | INFO     | __main__:main:1746 - R@1 = 23.59861868167516 %, R@10 = 60.55124582915931 %, MRR = 0.4971193043388673
2024-10-31 08:48:01.584 | INFO     | __main__:main:1761 - Average R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-31 08:48:01.585 | INFO     | __main__:main:1797 - Starting the prover
2024-10-31 08:48:01.586 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-10-31 08:48:01.586 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-10-31 08:48:01.586 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-10-31 08:48:01.587 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf
37_lambda_0.1_epoch=16-Recall@10_val=62.84.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-10-31 08:48:02.558 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=
16-Recall@10_val=62.84.ckpt
2024-10-31 08:48:02.558 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=
16-Recall@10_val=62.84.ckpt
2024-10-31 08:48:06.362 | INFO     | __main__:main:1599 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall
@10_val=62.84.ckpt
2024-10-31 08:48:06.367 | INFO     | __main__:main:1599 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall
@10_val=62.84.ckpt
2024-10-31 08:48:06.369 | INFO     | __main__:main:1599 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall
@10_val=62.84.ckpt
2024-10-31 08:48:06.487 | INFO     | __main__:main:1657 - right before barrier for data module
2024-10-31 08:48:06.487 | INFO     | __main__:main:1657 - right before barrier for data module
2024-10-31 08:48:06.487 | INFO     | __main__:main:1657 - right before barrier for data module
2024-10-31 08:48:07.584 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-10-31 08:48:08.458 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-10-31 08:48:08.459 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-10-31 08:48:08.460 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-10-31 08:48:18.182 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-10-31 08:48:18.182 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4636/4636 [06:35<00:00, 11.73it/s]
2024-10-31 08:54:53.532 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-10-31 08:54:53.532 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
(autoscaler +8h37m39s) Tip: use `ray status` to view detailed cluster status. To disable these messages, set RAY_SCHEDULER_EVENTS=0.
(autoscaler +8h37m39s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h38m21s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h38m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h39m22s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h40m3s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +8h40m35s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h41m19s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h41m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h42m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h43m6s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +8h43m38s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h44m11s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h44m42s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h45m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h46m3s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +8h46m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h47m15s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h47m37s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h48m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h48m53s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h49m24s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h50m27s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h51m32s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h51m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h51m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h52m24s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h53m14s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h53m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h54m4s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +8h54m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h55m15s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h55m56s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h56m27s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h57m32s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h57m55s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h58m16s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h58m57s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +8h59m28s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h22s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to thi
s Ray cluster.
(autoscaler +9h55s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to thi
s Ray cluster.
(autoscaler +9h1m5s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +9h1m36s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h2m38s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h3m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +9h3m28s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h3m59s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h4m49s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h5m19s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h6m2s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +9h6m35s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h6m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h7m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h8m11s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h9m5s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +9h9m37s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h9m49s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h10m30s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h11m1s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h11m31s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h12m21s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h12m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h13m32s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h14m4s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h14m36s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h15m52s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h16m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h16m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h17m2s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h17m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h18m14s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h18m46s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h19m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h19m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h20m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h20m54s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h21m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h22m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h22m55s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h23m25s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h24m18s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h25m1s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h25m1s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h25m54s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h26m25s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h27m5s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h27m46s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h28m19s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h29m5s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h29m35s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h30m15s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h30m25s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h31m6s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h31m37s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h32m9s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h32m52s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h33m25s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h34m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h34m37s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h35m28s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h35m49s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h36m21s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h37m6s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h37m27s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h38m9s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h38m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h39m20s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h39m53s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h40m35s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h40m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h41m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h42m9s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +9h42m50s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h43m30s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h44m24s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h44m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h44m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h45m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h46m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h46m50s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h47m35s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +9h48m12s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
2024-10-31 10:06:18.961 | INFO     | __main__:prove_sorry_theorems:884 - Found 24 sorry theorems to prove
Processing theorems from fpvandoorn/carleson:   0%|                                                                                                                                                                     | 0/24 [00:00<?, ?theorem/s]
2024-10-31 10:06:18.962 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for card_le_of_le_dist
2024-10-31 10:06:18.963 | INFO     | __main__:prove_sorry_theorems:908 - Position: (116, 1)
2024-10-31 10:06:18.963 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for prop2_2
2024-10-31 10:06:26.912 | INFO     | __main__:prove_sorry_theorems:908 - Position: (36, 1)
Processing theorems from fpvandoorn/carleson:   8%|█████████████                                                                                                                                                | 2/24 [00:07<01:27,  3.97s/theorem]
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for partialFourierSum_eq_conv_dirichletKernel'
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:908 - Position: (198, 1)
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for dirichletKernel'_periodic
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:908 - Position: (22, 1)
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for dirichletKernel_periodic
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:908 - Position: (19, 1)
2024-10-31 10:06:26.913 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for theorem1_2C'
(pid=4050569) [2024-10-31 10:06:23,491] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-31 10:06:35.689 | INFO     | __main__:prove_sorry_theorems:908 - Position: (203, 1)
Processing theorems from fpvandoorn/carleson:  25%|███████████████████████████████████████▎                                                                                                                     | 6/24 [00:16<00:47,  2.66s/theorem]
2024-10-31 10:06:35.690 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for volume_ball_le_same
(pid=4050442) [2024-10-31 10:06:23,491] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-31 10:06:45.410 | INFO     | __main__:prove_sorry_theorems:908 - Position: (53, 1)
Processing theorems from fpvandoorn/carleson:  29%|█████████████████████████████████████████████▊                                                                                                               | 7/24 [00:26<01:10,  4.13s/theorem]
2024-10-31 10:06:45.411 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for fourier_uniformContinuous
(pid=4050566) [2024-10-31 10:06:23,491] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-31 10:06:45.411 | INFO     | __main__:prove_sorry_theorems:908 - Position: (99, 1)
2024-10-31 10:06:45.412 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for Hilbert_kernel_regularity
2024-10-31 10:06:45.412 | INFO     | __main__:prove_sorry_theorems:908 - Position: (277, 1)
2024-10-31 10:06:45.412 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for prop2_3
(ProverActor pid=4050566) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=4050566)   return torch.load(io.BytesIO(b))
2024-10-31 10:06:53.328 | INFO     | __main__:prove_sorry_theorems:908 - Position: (35, 1)
(ProverActor pid=4050569) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
Processing theorems from fpvandoorn/carleson:  42%|█████████████████████████████████████████████████████████████████                                                                                           | 10/24 [00:41<01:03,  4.55s/theorem]
(ProverActor pid=4050569)   return torch.load(io.BytesIO(b))
2024-10-31 10:07:07.549 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for partialFourierSum_uniformContinuous
(ProverActor pid=4050442) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=4050442)   return torch.load(io.BytesIO(b))
2024-10-31 10:07:14.693 | INFO     | __main__:prove_sorry_theorems:908 - Position: (105, 1)
Processing theorems from fpvandoorn/carleson:  46%|███████████████████████████████████████████████████████████████████████▌                                                                                    | 11/24 [01:20<02:21, 10.89s/theorem]
2024-10-31 10:07:55.915 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for theorem1_2C
2024-10-31 10:07:55.915 | INFO     | __main__:prove_sorry_theorems:908 - Position: (191, 1)
2024-10-31 10:08:03.178 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=4050569) 2024-10-31 10:08:41.551 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6cf37'), file_path=PosixPat
h('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="dirichletKernel'_periodic")
(ProverActor pid=4050442) 2024-10-31 10:08:41.551 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6cf37'), file_path=PosixPat
h('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="partialFourierSum_eq_conv_dirichletKernel'")
(ProverActor pid=4050566) 2024-10-31 10:08:41.551 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6cf37'), file_path=PosixPat
h('Carleson/Proposition2.lean'), full_name='prop2_2')
(pid=4050445) [2024-10-31 10:08:50,047] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=4050445) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=4050445)   return torch.load(io.BytesIO(b))
(ProverActor pid=4050445) 2024-10-31 10:09:05.865 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6cf37'), file_path=PosixPat
h('Carleson/HomogeneousType.lean'), full_name='card_le_of_le_dist')
(ProverActor pid=4050569) 2024-10-31 10:09:15.732 | INFO     | lean_dojo.utils:execute:88 -
(ProverActor pid=4050569) 2024-10-31 10:09:15.732 | ERROR    | lean_dojo.utils:execute:89 - error: ./.lake/packages/mathlib/lakefile.lean:79:2: error: unknown attribute [test_runner]
(ProverActor pid=4050569) error: ./.lake/packages/mathlib/lakefile.lean: package configuration has errors
(ProverActor pid=4050569)
(ProverActor pid=4050566)
(ProverActor pid=4050442)
Processing theorems from fpvandoorn/carleson:  46%|███████████████████████████████████████████████████████████████████████▌                                                                                    | 11/24 [03:01<03:34, 16.49s/theorem]
2024-10-31 10:09:20.352 | INFO     | __main__:main:1854 - An error occurred: ray::ProverActor.search() (pid=4050566, ip=10.0.5.234, actor_id=ba9667ac986d0ded54ae4ac301000000, repr=<prover.proof_search.ProverActor object at 0x7adabd959ed0>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 1828, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_proving)
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 921, in prove_sorry_theorems
    process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 806, in process_theorem_batch
    results = prover.search_unordered(LeanGitRepo(repo.url, repo.commit), lean_dojo_theorems, positions_batch)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 514, in search_unordered
    results = list(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 170, in get_generator
    yield self.get_next_unordered()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 370, in get_next_unordered
    return ray.get(future)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 2691, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 871, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(CalledProcessError): ray::ProverActor.search() (pid=4050566, ip=10.0.5.234, actor_id=ba9667ac986d0ded54ae4ac301000000, repr=<prover.proof_search.ProverActor object at 0x7adabd959ed0>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(ProverActor pid=4050566) 2024-10-31 10:09:20.357 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6cf37'), file_path=PosixPat
h('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name='dirichletKernel_periodic')
(ProverActor pid=4050442) 2024-10-31 10:09:15.967 | INFO     | lean_dojo.utils:execute:88 -  [repeated 2x across cluster]
(ProverActor pid=4050442) 2024-10-31 10:09:15.968 | ERROR    | lean_dojo.utils:execute:89 - error: ./.lake/packages/mathlib/lakefile.lean:79:2: error: unknown attribute [test_runner] [repeated 2x across cluster]
(ProverActor pid=4050442) error: ./.lake/packages/mathlib/lakefile.lean: package configuration has errors [repeated 2x across cluster]
2024-10-31 10:09:22,500 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=4050442, ip=10.0.5.234, actor_id=4ba0bb5ac62d0f45c20e712901000000, repr=<prover.proof_search.ProverAc
tor object at 0x7963e5361fc0>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
2024-10-31 10:09:22,501 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=4050569, ip=10.0.5.234, actor_id=843cfbb955cf4099217d584401000000, repr=<prover.proof_search.ProverAc
tor object at 0x7e9cf6f15fc0>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ slurmstepd: error: *** STEP 82611.0 ON compute-permanent-node-491 CANCELLED AT 2024-10-31T14:57:43 DUE TO TIME LIMIT ***
srun: error: compute-permanent-node-491: task 0: Killed
srun: Force Terminated StepId=82611.0
(base) yingzi_ma@cais-login-0:~/lean_project/ReProver$
