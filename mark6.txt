(ProverActor pid=136691) 2024-09-09 03:56:12.975 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_of_translate'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.8007191200740635, environment_time=0.7103672769153491, total_time=1
0.997132185962982, num_total_nodes=79, num_searched_nodes=2)
(ProverActor pid=136691) 2024-09-09 03:56:12.981 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_nonneg')
(ProverActor pid=137014) 2024-09-09 03:56:04.626 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 8x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log dedupli
cation, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ProverActor pid=137014) 2024-09-09 03:56:04.626 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions). [repeated 2x across cluster]
(ProverActor pid=137014) 2024-09-09 03:56:12.958 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_minus_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=11.00067835196387, num_total_nodes=
1, num_searched_nodes=0)
(ProverActor pid=137014) 2024-09-09 03:56:12.962 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_sum_le')
(ProverActor pid=136854) 2024-09-09 03:56:13.197 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='phi_min_exists'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.998759887064807, num_total_nodes=1
, num_searched_nodes=0)
(ProverActor pid=136854) 2024-09-09 03:56:13.202 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/RhoFunctional.lean'), full_name='I_one_le')
(ProverActor pid=137191) 2024-09-09 03:56:47.264 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=137191) 2024-09-09 03:56:47.265 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=136854) 2024-09-09 03:57:03.247 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=136854) 2024-09-09 03:57:03.246 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=137191) 2024-09-09 03:57:08.270 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='iter_multiDist_chainRule'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=11.168981444090605, num_tot
al_nodes=1, num_searched_nodes=0)
(ProverActor pid=137014) 2024-09-09 03:57:04.155 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=137014) 2024-09-09 03:57:04.154 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=137191) 2024-09-09 03:57:08.277 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/RhoFunctional.lean'), full_name='dist_add_dist_eq')
(ProverActor pid=136854) 2024-09-09 03:57:14.321 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='I_one_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.998696833034046, num_total_nodes=1, num_
searched_nodes=0)
(ProverActor pid=136854) 2024-09-09 03:57:14.327 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_of_translate')
(ProverActor pid=137014) 2024-09-09 03:57:15.495 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_sum_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.998706873971969, num_total_nodes=1
, num_searched_nodes=0)
(ProverActor pid=137014) 2024-09-09 03:57:15.500 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_continuous')
(ProverActor pid=136691) 2024-09-09 03:57:39.192 | INFO     | prover.proof_search:_best_first_search:149 - 1048566.609319598
(ProverActor pid=136691) 2024-09-09 03:57:39.192 | INFO     | prover.proof_search:_best_first_search:150 - 1048556.624435033
(ProverActor pid=136691) 2024-09-09 03:57:39.192 | INFO     | prover.proof_search:_best_first_search:151 - 9.985254561994225
(ProverActor pid=136691) 2024-09-09 03:57:39.192 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=136691) 2024-09-09 03:57:39.194 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=137191) 2024-09-09 03:57:58.946 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=137191) 2024-09-09 03:57:58.947 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=136854) 2024-09-09 03:58:03.370 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=137014) 2024-09-09 03:58:04.472 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 8x across cluster]
(ProverActor pid=136691) 2024-09-09 03:58:07.148 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_nonneg'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.984792848001234, environment_time=2.3664839323610067, total_time=10.987
067415029742, num_total_nodes=66, num_searched_nodes=2)
(ProverActor pid=136691) 2024-09-09 03:58:07.153 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_chainRule')
(ProverActor pid=137191) 2024-09-09 03:58:09.299 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='dist_add_dist_eq'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.999319434165955, num_total_nodes
=1, num_searched_nodes=0)
(ProverActor pid=137191) 2024-09-09 03:58:09.304 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), f
ile_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_eq_zero')
(ProverActor pid=137014) 2024-09-09 03:58:04.473 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=136854) 2024-09-09 03:58:12.019 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_of_translate'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.997704615117982, num_total_nodes
=1, num_searched_nodes=0)
(ProverActor pid=137014) 2024-09-09 03:58:12.769 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_continuous'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.99845637800172, num_total_nodes=1,
 num_searched_nodes=0)
(ProverActor pid=137191) 2024-09-09 03:59:21.217 | INFO     | prover.proof_search:_best_first_search:149 - 1048668.634725111
(ProverActor pid=137191) 2024-09-09 03:59:21.217 | INFO     | prover.proof_search:_best_first_search:150 - 1048658.650355742
(ProverActor pid=137191) 2024-09-09 03:59:21.217 | INFO     | prover.proof_search:_best_first_search:151 - 9.984703204827383
(ProverActor pid=137191) 2024-09-09 03:59:21.217 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=137191) 2024-09-09 03:59:21.218 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=137191) 2024-09-09 03:59:34.578 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_eq_zero'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=0.0, environment_time=0.0, total_time=10.985387937864289, num_total_node
s=1, num_searched_nodes=0)
(ProverActor pid=136691) 2024-09-09 03:59:22.898 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=136691) 2024-09-09 03:59:22.899 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-09-09 03:59:48.564 | INFO     | __main__:process_theorem_batch:764 - No proof found for condRho_minus_le
2024-09-09 03:59:48.564 | INFO     | __main__:process_theorem_batch:764 - No proof found for condRho_of_translate
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for phi_min_exists
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for iter_multiDist_chainRule
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for I_one_le
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for condRho_sum_le
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for multiDist_nonneg
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for dist_add_dist_eq
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for rho_of_translate
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for rho_continuous
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for multidist_eq_zero
2024-09-09 03:59:48.565 | INFO     | __main__:process_theorem_batch:764 - No proof found for multiDist_chainRule
(ProverActor pid=136691) 2024-09-09 03:59:48.562 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6ae
e013a2687'), file_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_chainRule'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.677855520043522, environment_time=1.5925434278324246, total_time=10.
984924440039322, num_total_nodes=90, num_searched_nodes=2)
Processing theorems from teorth/pfr:  30%|████████▎                   | 11/37 [04:54<11:36, 26.79s/theorem]
2024-09-09 03:59:56.540 | INFO     | __main__:save_progress:769 - Saving encountered theorems...
2024-09-09 03:59:56.541 | INFO     | __main__:prove_sorry_theorems:866 - Finished attempting to prove sorry theorems
2024-09-09 04:00:06.925 | INFO     | __main__:main:1670 - Finished searching for proofs of sorry theorems
2024-09-09 04:00:06.925 | INFO     | __main__:main:1689 - Finished processing the repository
2024-09-09 04:00:06.925 | INFO     | __main__:main:1691 - current epoch: 1
2024-09-09 04:00:06.925 | INFO     | __main__:main:1355 - length of lean_git_repos: 2
2024-09-09 04:00:06.925 | INFO     | __main__:main:1356 - i: 1
2024-09-09 04:00:06.925 | INFO     | __main__:main:1362 - Main process
2024-09-09 04:00:06.925 | INFO     | __main__:main:1363 - Using lambda = 0.1
2024-09-09 04:00:06.926 | INFO     | __main__:main:1364 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-09 04:00:06.926 | INFO     | __main__:add_repo_to_database:889 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:07.252 | INFO     | __main__:get_compatible_commit:322 - Latest commit: a9e8f49d818ffebad821d11100736088166009c3
2024-09-09 04:00:07.252 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-09 04:00:07.252 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:07.252 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:07.257 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-09 04:00:07.259 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:09.808 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:09.814 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:09.829 | INFO     | __main__:get_compatible_commit:365 - Found 533 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:09.830 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:09.830 | INFO     | __main__:add_repo_to_database:909 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-09 04:00:09.830 | INFO     | __main__:add_repo_to_database:910 - Lean version: v4.8.0-rc2
2024-09-09 04:00:09.830 | INFO     | __main__:add_repo_to_database:915 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5
2024-09-09 04:00:09.830 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c4
8c0a084411853a576389ecf5
2024-09-09 04:00:09.831 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-09-09 04:00:09.831 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-09-09 04:00:09.831 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:377 - Lean toolchain path 1 does not exist: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.832 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-09 04:00:09.926 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-09-09 04:00:09.926 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-09 04:00:09.926 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-09-09 04:00:09.935 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-09 04:00:09.935 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-09-09 04:00:09.935 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-09-09 04:00:09.938 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-09 04:00:09.938 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a0844118
53a576389ecf5/mathematics_in_lean_source
2024-09-09 04:00:13.360 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e
0fb051367c48c0a084411853a576389ecf5/mathematics_in_lean_source with 31 workers
100%|██████████████████████████████████████████████████████████████████| 3143/3143 [07:55<00:00,  6.61it/s]
2024-09-09 04:08:08.607 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48
c0a084411853a576389ecf5')
2024-09-09 04:08:10.036 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-09 04:08:27.336 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-09 04:08:43.456 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-09 04:08:44.568 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-09 04:08:47.772 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='8c811c94af285516e8c76
a63165c87027f18ccd0')
2024-09-09 04:08:48.917 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-09 04:09:19.964 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='529
7e0fb051367c48c0a084411853a576389ecf5'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='e9e858a4484905a0bfe97c4f05c3924ead02eed8'), 'batteries': LeanGitRepo(url='https://github.c
om/leanprover-community/batteries', commit='8feac540abb781cb1349688c816dc02fae66b49c'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='2c8ae451ce9ffc83554322b14437159c1a9703f9'), 'aeso
p': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='e291aa4de57079b3d2199b9eb7b4b00922b85a7c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit=
'eb08eee94098fe530ccd6d8751a86fe405473d4c'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), 'mathlib': LeanGitRepo(url='https://github.com/leanpro
ver-community/mathlib4', commit='8c811c94af285516e8c76a63165c87027f18ccd0'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='fb7841a6f4fb389ec0e47dd4677844d49906af3c')},
root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_in_lean_source'))
2024-09-09 04:09:32.091 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-09-09 04:09:38.757 | INFO     | generate_benchmark_lean4:split_data:133 - 78886 theorems in total
2024-09-09 04:09:38.758 | INFO     | generate_benchmark_lean4:split_data:138 - 78886 theorems in total, with 1577 for validation and 1577 for testing
2024-09-09 04:09:38.758 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-09-09 04:09:38.782 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-09-09 04:09:44.355 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-09-09 04:09:58.522 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 126284 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_s
ource_5297e0fb051367c48c0a084411853a576389ecf5/random/train.json
2024-09-09 04:09:58.971 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2875 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_sour
ce_5297e0fb051367c48c0a084411853a576389ecf5/random/val.json
2024-09-09 04:09:59.271 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2631 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_sour
ce_5297e0fb051367c48c0a084411853a576389ecf5/random/test.json
2024-09-09 04:10:12.660 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 123871 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_s
ource_5297e0fb051367c48c0a084411853a576389ecf5/novel_premises/train.json
2024-09-09 04:10:13.202 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 3950 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_sour
ce_5297e0fb051367c48c0a084411853a576389ecf5/novel_premises/val.json
2024-09-09 04:10:13.622 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 3969 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_sour
ce_5297e0fb051367c48c0a084411853a576389ecf5/novel_premises/test.json
2024-09-09 04:10:13.622 | INFO     | generate_benchmark_lean4:export_proofs:206 - 157772 theorems saved in total
2024-09-09 04:10:13.627 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-09-09 04:10:30.274 | INFO     | generate_benchmark_lean4:export_premises:229 - 117699 theorems/definitions from 3143 files saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathemati
cs_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:10:30.287 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-09-09 04:10:30.288 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-09-09 04:10:30.288 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-09-09 04:10:30.344 | INFO     | __main__:add_repo_to_database:923 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb05136
7c48c0a084411853a576389ecf5
100%|███████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 60751.84it/s]
100%|█████████████████████████████████████████████████████████████| 75732/75732 [00:01<00:00, 57435.15it/s]
100%|███████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 54044.66it/s]
2024-09-09 04:10:33.582 | INFO     | __main__:add_repo_to_database:948 - Before adding new repo:
2024-09-09 04:10:33.582 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-09 04:10:33.582 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-09 04:10:33.583 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-09 04:10:33.583 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-09 04:10:33.583 | INFO     | __main__:add_repo_to_database:951 - After adding new repo:
2024-09-09 04:10:33.583 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-09 04:10:33.583 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-09 04:10:33.583 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-09 04:10:48.036 | INFO     | __main__:main:1385 - Adding repo to repos_for_merged_dataset
2024-09-09 04:10:48.039 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-09 04:10:48.039 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-09 04:10:48.039 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-09 04:12:23.362 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5 already exists. Removing it now.
2024-09-09 04:12:39.088 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5
2024-09-09 04:12:39.588 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_l
ean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-09 04:12:39.597 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_s
ource_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-09 04:12:39.601 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-09 04:12:39.623 | INFO     | __main__:main:1397 - All GPUs
2024-09-09 04:12:39.625 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.ckpt
2024-09-09 04:12:39.625 | INFO     | __main__:main:1404 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=0.06.ckpt
2024-09-09 04:12:39.625 | INFO     | __main__:main:1410 - Inside train_test_fisher
2024-09-09 04:12:39.625 | INFO     | __main__:main:1411 - Starting training at epoch 1
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-09 04:12:40.944 | INFO     | __main__:main:1435 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=0.06.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-09 04:12:41.049 | INFO     | __main__:main:1494 - right before barrier for data module
2024-09-09 04:12:41.049 | INFO     | __main__:main:1509 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5763
89ecf5/random
2024-09-09 04:12:41.049 | INFO     | __main__:main:1509 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5763
89ecf5/random
2024-09-09 04:12:41.049 | INFO     | __main__:main:1509 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5763
89ecf5/random
2024-09-09 04:12:41.049 | INFO     | __main__:main:1509 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5763
89ecf5/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-09 04:12:41.141 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:12:41.148 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:12:41.149 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:12:41.151 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[100
%|██████████████████████████████████████████████████████████████| 94181/94181 [00:14<00:00, 6359.87it/s]
 16%|██████████                                                    | 15199/94181 [00:04<00:21, 3652.56it/s]2024-09-09 04:13:07.543 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /
data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
100%|████████████████████████████████████████████████████████████████| 1962/1962 [00:00<00:00, 7228.39it/s]
 28%|█████████████████▍                                            | 26509/94181 [00:05<00:11, 5665.42it/s]2024-09-09 04:13:07.886 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /
data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
100%|████████████████████████████████████████████████████████████████| 1962/1962 [00:00<00:00, 6712.63it/s]
 25%|███████████████▏                                              | 23110/94181 [00:05<00:10, 6864.99it/s]2024-09-09 04:13:08.250 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /
data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:13:08.250 | INFO     | __main__:main:1523 - Training dataset size after load: 220348
2024-09-09 04:13:08.250 | INFO     | __main__:main:1524 - Validation dataset size after load: 3274
2024-09-09 04:13:08.250 | INFO     | __main__:main:1525 - Testing dataset size after load: 3697
2024-09-09 04:13:08.250 | INFO     | __main__:main:1527 - Starting progressive training from epoch 1 to 2
2024-09-09 04:13:08.251 | INFO     | __main__:main:1530 - hit the barrier before training
100%|██████████████████████████████████████████████████████████████| 94181/94181 [00:14<00:00, 6324.83it/s]
 99%|█████████████████████████████████████████████████████████████ | 92779/94181 [00:15<00:00, 6516.32it/s]2024-09-09 04:13:18.022 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /
data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:13:18.041 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
2024-09-09 04:13:18.063 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:13:18.064 | INFO     | __main__:main:1523 - Training dataset size after load: 220348
2024-09-09 04:13:18.064 | INFO     | __main__:main:1524 - Validation dataset size after load: 3274
2024-09-09 04:13:18.064 | INFO     | __main__:main:1525 - Testing dataset size after load: 3697
2024-09-09 04:13:18.064 | INFO     | __main__:main:1527 - Starting progressive training from epoch 1 to 2
2024-09-09 04:13:18.064 | INFO     | __main__:main:1530 - hit the barrier before training
100%|██████████████████████████████████████████████████████████████| 94181/94181 [00:15<00:00, 6139.19it/s]
100%|██████████████████████████████████████████████████████████████| 94181/94181 [00:15<00:00, 6139.19it/s]
2024-09-09 04:13:19.219 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_s
ource_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:13:19.240 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
2024-09-09 04:13:19.260 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:13:19.260 | INFO     | __main__:main:1523 - Training dataset size after load: 220348
2024-09-09 04:13:19.260 | INFO     | __main__:main:1524 - Validation dataset size after load: 3274
2024-09-09 04:13:19.260 | INFO     | __main__:main:1525 - Testing dataset size after load: 3697
2024-09-09 04:13:19.260 | INFO     | __main__:main:1527 - Starting progressive training from epoch 1 to 2
2024-09-09 04:13:19.260 | INFO     | __main__:main:1530 - hit the barrier before training
2024-09-09 04:13:19.750 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_s
ource_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:13:19.771 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
2024-09-09 04:13:19.790 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:13:19.791 | INFO     | __main__:main:1523 - Training dataset size after load: 220348
2024-09-09 04:13:19.791 | INFO     | __main__:main:1524 - Validation dataset size after load: 3274
2024-09-09 04:13:19.791 | INFO     | __main__:main:1525 - Testing dataset size after load: 3697
2024-09-09 04:13:19.791 | INFO     | __main__:main:1527 - Starting progressive training from epoch 1 to 2
2024-09-09 04:13:19.791 | INFO     | __main__:main:1530 - hit the barrier before training
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-09 04:13:20.378 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:13:20.536 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
2024-09-09 04:13:20.566 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr
 exists and is not empty.
2024-09-09 04:13:23.536 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
2024-09-09 04:13:23.580 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:13:23.675 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
Training dataset size: 220348
2024-09-09 04:13:23.705 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:13:23.721 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
2024-09-09 04:13:23.732 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
2024-09-09 04:13:23.763 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
Training dataset size: 220348
2024-09-09 04:13:23.866 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 3274
2024-09-09 04:13:23.894 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06
.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-09 04:13:24.985 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-09 04:13:24.985 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-09 04:13:24.985 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-09 04:13:24.986 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.c
kpt
Epoch 1: 100%|██████████████████████████████████████████████████████| 2/2 [00:02<00:00,  0.77it/s, v_num=4]2024-09-09 04:13:29.428 | INFO     | retrieval.model:validation_step:325 - Inside validation_step
2024-09-09 04:13:29.488 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
2024-09-09 04:13:29.567 | INFO     | retrieval.model:validation_step:325 - Inside validation_step
2024-09-09 04:13:29.604 | INFO     | retrieval.model:validation_step:325 - Inside validation_step
2024-09-09 04:13:29.616 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
2024-09-09 04:13:29.640 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
                                                                                                          2024-09-09 04:13:30.038 | INFO     | retrieval.model:validation_step:325 - Inside validation_step0<?, ?it/s]
2024-09-09 04:13:30.079 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
2024-09-09 04:13:32.283 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-09 04:13:32.286 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-09 04:13:32.287 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-09 04:13:32.288 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-09 04:13:32.289 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-09 04:13:32.290 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-09 04:13:32.291 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-09 04:13:32.292 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-09 04:13:32.293 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-09 04:13:32.294 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-09 04:13:32.295 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-09 04:13:32.295 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-09 04:13:32.296 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-09 04:13:32.297 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-09 04:13:32.298 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-09 04:13:32.299 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-09 04:13:32.300 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-09 04:13:32.301 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-09 04:13:32.302 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-09 04:13:32.303 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-09 04:13:32.304 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-09 04:13:32.304 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-09 04:13:32.305 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 1.4285714285714286
2024-09-09 04:13:32.306 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 1.4285714285714286
2024-09-09 04:13:32.307 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 1.4285714285714286
2024-09-09 04:13:32.308 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 1.4285714285714286
2024-09-09 04:13:32.309 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 1.4285714285714286
2024-09-09 04:13:32.310 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 1.4285714285714286
2024-09-09 04:13:32.311 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 1.4285714285714286
2024-09-09 04:13:32.312 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 1.4285714285714286
2024-09-09 04:13:32.313 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 1.4285714285714286
2024-09-09 04:13:32.313 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 1.4285714285714286
2024-09-09 04:13:32.314 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 1.4285714285714286
2024-09-09 04:13:32.315 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 1.4285714285714286
2024-09-09 04:13:32.316 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 1.4285714285714286
2024-09-09 04:13:32.317 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 1.4285714285714286
2024-09-09 04:13:32.318 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 1.4285714285714286
2024-09-09 04:13:32.319 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 1.4285714285714286
2024-09-09 04:13:32.320 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 1.4285714285714286
2024-09-09 04:13:32.321 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 1.4285714285714286
2024-09-09 04:13:32.322 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 1.4285714285714286
2024-09-09 04:13:32.323 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 1.4285714285714286
2024-09-09 04:13:32.323 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 1.4285714285714286
2024-09-09 04:13:32.324 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 1.4285714285714286
2024-09-09 04:13:32.325 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 1.4285714285714286
2024-09-09 04:13:32.326 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 1.4285714285714286
2024-09-09 04:13:32.327 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 1.4285714285714286
2024-09-09 04:13:32.328 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 1.4285714285714286
2024-09-09 04:13:32.329 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 1.4285714285714286
2024-09-09 04:13:32.330 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 1.4285714285714286
2024-09-09 04:13:32.331 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 1.4285714285714286
2024-09-09 04:13:32.332 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 1.4285714285714286
2024-09-09 04:13:32.333 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 1.4285714285714286
2024-09-09 04:13:32.334 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 1.4285714285714286
2024-09-09 04:13:32.335 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 1.4285714285714286
2024-09-09 04:13:32.335 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 1.4285714285714286
2024-09-09 04:13:32.336 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 1.4285714285714286
2024-09-09 04:13:32.337 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 1.4285714285714286
2024-09-09 04:13:32.338 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 1.4285714285714286
2024-09-09 04:13:32.339 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 1.4285714285714286
2024-09-09 04:13:32.340 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 1.4285714285714286
2024-09-09 04:13:32.341 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 1.4285714285714286
2024-09-09 04:13:32.343 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 1.4285714285714286
2024-09-09 04:13:32.344 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 1.4285714285714286
2024-09-09 04:13:32.345 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 1.4285714285714286
2024-09-09 04:13:32.345 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 1.4285714285714286
2024-09-09 04:13:32.346 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 1.4285714285714286
2024-09-09 04:13:32.347 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 1.4285714285714286
2024-09-09 04:13:32.348 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 1.4285714285714286
2024-09-09 04:13:32.349 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 1.4285714285714286
2024-09-09 04:13:32.350 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 1.4285714285714286
2024-09-09 04:13:32.351 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 1.4285714285714286
2024-09-09 04:13:32.352 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 1.4285714285714286
2024-09-09 04:13:32.353 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 1.4285714285714286
2024-09-09 04:13:32.354 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 1.4285714285714286
2024-09-09 04:13:32.355 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 1.4285714285714286
2024-09-09 04:13:32.356 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 1.4285714285714286
2024-09-09 04:13:32.357 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 1.4285714285714286
2024-09-09 04:13:32.358 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 1.4285714285714286
2024-09-09 04:13:32.359 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 1.4285714285714286
2024-09-09 04:13:32.360 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 1.4285714285714286
2024-09-09 04:13:32.361 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 1.4285714285714286
2024-09-09 04:13:32.362 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 1.4285714285714286
2024-09-09 04:13:32.362 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 1.4285714285714286
2024-09-09 04:13:32.363 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 1.4285714285714286
2024-09-09 04:13:32.364 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 1.4285714285714286
2024-09-09 04:13:32.365 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 1.4285714285714286
2024-09-09 04:13:32.366 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 1.4285714285714286
2024-09-09 04:13:32.367 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 1.4285714285714286
2024-09-09 04:13:32.368 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 1.4285714285714286
2024-09-09 04:13:32.369 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 1.4285714285714286
2024-09-09 04:13:32.370 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 1.4285714285714286
2024-09-09 04:13:32.371 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 1.4285714285714286
2024-09-09 04:13:32.372 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 1.4285714285714286
2024-09-09 04:13:32.373 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 1.4285714285714286
2024-09-09 04:13:32.374 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 1.4285714285714286
2024-09-09 04:13:32.375 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 1.4285714285714286
2024-09-09 04:13:32.376 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 4.285714285714286
2024-09-09 04:13:32.377 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 4.285714285714286
2024-09-09 04:13:32.378 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 4.285714285714286
2024-09-09 04:13:32.379 | INFO     | retrieval.model:validation_step:388 - MRR: 0.0015337812143490935
2024-09-09 04:13:32.380 | INFO     | retrieval.model:validation_step:396 - End of validation_step
2024-09-09 04:13:32.436 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-09 04:13:32.439 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-09 04:13:32.440 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-09 04:13:32.441 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-09 04:13:32.442 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-09 04:13:32.442 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-09 04:13:32.443 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-09 04:13:32.444 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-09 04:13:32.444 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-09 04:13:32.445 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-09 04:13:32.446 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-09 04:13:32.446 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-09 04:13:32.447 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-09 04:13:32.447 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-09 04:13:32.448 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-09 04:13:32.448 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-09 04:13:32.449 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-09 04:13:32.449 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-09 04:13:32.450 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-09 04:13:32.450 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-09 04:13:32.451 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-09 04:13:32.451 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-09 04:13:32.452 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-09 04:13:32.452 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-09 04:13:32.453 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-09 04:13:32.453 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-09 04:13:32.453 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-09 04:13:32.454 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-09 04:13:32.454 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-09 04:13:32.455 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-09 04:13:32.455 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-09 04:13:32.455 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-09 04:13:32.456 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-09 04:13:32.456 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-09 04:13:32.457 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-09 04:13:32.457 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-09 04:13:32.458 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 1.1904761904761905
2024-09-09 04:13:32.458 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-09 04:13:32.459 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 1.1904761904761905
2024-09-09 04:13:32.459 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-09 04:13:32.460 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 1.1904761904761905
2024-09-09 04:13:32.460 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-09 04:13:32.461 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 1.6666666666666667
2024-09-09 04:13:32.461 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-09 04:13:32.462 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 1.6666666666666667
2024-09-09 04:13:32.462 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-09 04:13:32.463 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 1.6666666666666667
2024-09-09 04:13:32.463 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-09 04:13:32.463 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 1.6666666666666667
2024-09-09 04:13:32.464 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-09 04:13:32.464 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 1.6666666666666667
2024-09-09 04:13:32.464 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-09 04:13:32.465 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 1.6666666666666667
2024-09-09 04:13:32.465 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 0.0
2024-09-09 04:13:32.466 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 1.6666666666666667
2024-09-09 04:13:32.466 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 0.0
2024-09-09 04:13:32.467 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 1.6666666666666667
2024-09-09 04:13:32.467 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 0.0
2024-09-09 04:13:32.468 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 1.6666666666666667
2024-09-09 04:13:32.468 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 0.0
2024-09-09 04:13:32.469 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 1.6666666666666667
2024-09-09 04:13:32.469 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 0.0
2024-09-09 04:13:32.470 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 1.6666666666666667
2024-09-09 04:13:32.470 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 0.0
2024-09-09 04:13:32.471 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 1.6666666666666667
2024-09-09 04:13:32.471 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 0.0
2024-09-09 04:13:32.471 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 1.6666666666666667
2024-09-09 04:13:32.472 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 0.0
2024-09-09 04:13:32.472 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 1.6666666666666667
2024-09-09 04:13:32.472 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 0.0
2024-09-09 04:13:32.473 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 1.6666666666666667
2024-09-09 04:13:32.473 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 0.0
2024-09-09 04:13:32.474 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 1.6666666666666667
2024-09-09 04:13:32.474 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 0.0
2024-09-09 04:13:32.475 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 1.6666666666666667
2024-09-09 04:13:32.475 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 0.0
2024-09-09 04:13:32.476 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 1.6666666666666667
2024-09-09 04:13:32.476 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 0.0
2024-09-09 04:13:32.477 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 1.6666666666666667
2024-09-09 04:13:32.477 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 0.0
2024-09-09 04:13:32.478 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 1.6666666666666667
2024-09-09 04:13:32.478 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 0.0
2024-09-09 04:13:32.479 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 1.6666666666666667
2024-09-09 04:13:32.479 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 0.0
2024-09-09 04:13:32.480 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 1.6666666666666667
2024-09-09 04:13:32.480 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 0.0
2024-09-09 04:13:32.480 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 1.6666666666666667
2024-09-09 04:13:32.481 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 1.4583333333333333
2024-09-09 04:13:32.481 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 1.6666666666666667
2024-09-09 04:13:32.482 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 1.4583333333333333
2024-09-09 04:13:32.482 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 1.6666666666666667
2024-09-09 04:13:32.482 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 1.4583333333333333
2024-09-09 04:13:32.483 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 1.6666666666666667
2024-09-09 04:13:32.483 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 1.4583333333333333
2024-09-09 04:13:32.484 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 1.6666666666666667
2024-09-09 04:13:32.484 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 1.4583333333333333
2024-09-09 04:13:32.485 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 1.6666666666666667
2024-09-09 04:13:32.485 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 1.4583333333333333
2024-09-09 04:13:32.486 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 1.6666666666666667
2024-09-09 04:13:32.486 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 1.4583333333333333
2024-09-09 04:13:32.487 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 1.6666666666666667
2024-09-09 04:13:32.487 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 1.4583333333333333
2024-09-09 04:13:32.488 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 1.6666666666666667
2024-09-09 04:13:32.488 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 1.4583333333333333
2024-09-09 04:13:32.489 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 1.6666666666666667
2024-09-09 04:13:32.489 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 1.4583333333333333
2024-09-09 04:13:32.489 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 1.6666666666666667
2024-09-09 04:13:32.490 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 1.4583333333333333
2024-09-09 04:13:32.490 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 1.6666666666666667
2024-09-09 04:13:32.491 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 1.4583333333333333
2024-09-09 04:13:32.491 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 1.6666666666666667
2024-09-09 04:13:32.492 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 1.4583333333333333
2024-09-09 04:13:32.492 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 1.6666666666666667
2024-09-09 04:13:32.493 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 1.4583333333333333
2024-09-09 04:13:32.493 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 1.6666666666666667
2024-09-09 04:13:32.493 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 1.4583333333333333
2024-09-09 04:13:32.494 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 1.6666666666666667
2024-09-09 04:13:32.494 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 1.4583333333333333
2024-09-09 04:13:32.495 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 1.6666666666666667
2024-09-09 04:13:32.495 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 1.4583333333333333
2024-09-09 04:13:32.496 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 1.6666666666666667
2024-09-09 04:13:32.496 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 1.4583333333333333
2024-09-09 04:13:32.497 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 1.6666666666666667
2024-09-09 04:13:32.497 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 1.4583333333333333
2024-09-09 04:13:32.498 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 1.6666666666666667
2024-09-09 04:13:32.498 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 1.4583333333333333
2024-09-09 04:13:32.498 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 1.6666666666666667
2024-09-09 04:13:32.499 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 1.4583333333333333
2024-09-09 04:13:32.499 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 1.6666666666666667
2024-09-09 04:13:32.500 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 1.4583333333333333
2024-09-09 04:13:32.500 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 1.6666666666666667
2024-09-09 04:13:32.501 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 1.4583333333333333
2024-09-09 04:13:32.501 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 1.6666666666666667
2024-09-09 04:13:32.502 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 1.4583333333333333
2024-09-09 04:13:32.502 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 1.6666666666666667
2024-09-09 04:13:32.503 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 1.4583333333333333
2024-09-09 04:13:32.503 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 1.6666666666666667
2024-09-09 04:13:32.503 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 1.4583333333333333
2024-09-09 04:13:32.504 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 1.6666666666666667
2024-09-09 04:13:32.504 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 1.4583333333333333
2024-09-09 04:13:32.505 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 1.6666666666666667
2024-09-09 04:13:32.505 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 1.4583333333333333
2024-09-09 04:13:32.506 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 1.6666666666666667
2024-09-09 04:13:32.506 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 1.4583333333333333
2024-09-09 04:13:32.506 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 1.6666666666666667
2024-09-09 04:13:32.507 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 1.4583333333333333
2024-09-09 04:13:32.507 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 1.6666666666666667
2024-09-09 04:13:32.508 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 1.4583333333333333
2024-09-09 04:13:32.508 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 1.6666666666666667
2024-09-09 04:13:32.509 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 1.4583333333333333
2024-09-09 04:13:32.509 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 1.6666666666666667
2024-09-09 04:13:32.510 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 1.4583333333333333
2024-09-09 04:13:32.510 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 1.6666666666666667
2024-09-09 04:13:32.510 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 1.4583333333333333
2024-09-09 04:13:32.511 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 1.6666666666666667
2024-09-09 04:13:32.511 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 1.4583333333333333
2024-09-09 04:13:32.512 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 1.6666666666666667
2024-09-09 04:13:32.512 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 1.4583333333333333
2024-09-09 04:13:32.513 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 1.6666666666666667
2024-09-09 04:13:32.513 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 1.4583333333333333
2024-09-09 04:13:32.513 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 1.6666666666666667
2024-09-09 04:13:32.514 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 1.4583333333333333
2024-09-09 04:13:32.514 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 1.6666666666666667
2024-09-09 04:13:32.515 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 1.4583333333333333
2024-09-09 04:13:32.515 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 1.6666666666666667
2024-09-09 04:13:32.516 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 1.4583333333333333
2024-09-09 04:13:32.516 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 1.6666666666666667
2024-09-09 04:13:32.517 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 1.4583333333333333
2024-09-09 04:13:32.517 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 1.6666666666666667
2024-09-09 04:13:32.517 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 1.4583333333333333
2024-09-09 04:13:32.518 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 1.6666666666666667
2024-09-09 04:13:32.518 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 1.4583333333333333
2024-09-09 04:13:32.519 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 1.6666666666666667
2024-09-09 04:13:32.519 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 1.4583333333333333
2024-09-09 04:13:32.520 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 1.6666666666666667
2024-09-09 04:13:32.520 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 1.4583333333333333
2024-09-09 04:13:32.521 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 1.6666666666666667
2024-09-09 04:13:32.521 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 1.4583333333333333
2024-09-09 04:13:32.521 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 1.6666666666666667
2024-09-09 04:13:32.522 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 1.4583333333333333
2024-09-09 04:13:32.522 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 1.6666666666666667
2024-09-09 04:13:32.523 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 1.4583333333333333
2024-09-09 04:13:32.523 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 1.6666666666666667
2024-09-09 04:13:32.524 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 1.4583333333333333
2024-09-09 04:13:32.524 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 1.6666666666666667
2024-09-09 04:13:32.524 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 1.4583333333333333
2024-09-09 04:13:32.525 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 1.6666666666666667
2024-09-09 04:13:32.525 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 1.4583333333333333
2024-09-09 04:13:32.526 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 1.6666666666666667
2024-09-09 04:13:32.526 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 1.4583333333333333
2024-09-09 04:13:32.527 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 1.6666666666666667
2024-09-09 04:13:32.527 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 1.4583333333333333
2024-09-09 04:13:32.528 | INFO     | retrieval.model:validation_step:388 - MRR: 0.0019509476031215162
2024-09-09 04:13:32.528 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 1.4583333333333333
2024-09-09 04:13:32.529 | INFO     | retrieval.model:validation_step:396 - End of validation_step
2024-09-09 04:13:32.529 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 1.4583333333333333
2024-09-09 04:13:32.530 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 1.4583333333333333
2024-09-09 04:13:32.531 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 1.4583333333333333
2024-09-09 04:13:32.531 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 1.4583333333333333
2024-09-09 04:13:32.532 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 1.4583333333333333
2024-09-09 04:13:32.533 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 1.4583333333333333
2024-09-09 04:13:32.534 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 1.4583333333333333
2024-09-09 04:13:32.535 | INFO     | retrieval.model:validation_step:388 - MRR: 0.00125
2024-09-09 04:13:32.536 | INFO     | retrieval.model:validation_step:396 - End of validation_step
2024-09-09 04:13:32.719 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-09 04:13:32.722 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-09 04:13:32.724 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-09 04:13:32.725 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-09 04:13:32.726 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-09 04:13:32.727 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-09 04:13:32.728 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-09 04:13:32.729 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-09 04:13:32.730 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-09 04:13:32.731 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-09 04:13:32.732 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-09 04:13:32.733 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-09 04:13:32.734 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-09 04:13:32.735 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-09 04:13:32.736 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-09 04:13:32.737 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-09 04:13:32.738 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-09 04:13:32.739 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-09 04:13:32.741 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-09 04:13:32.742 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-09 04:13:32.743 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-09 04:13:32.744 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-09 04:13:32.745 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 2.4390243902439024
2024-09-09 04:13:32.747 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 2.4390243902439024
2024-09-09 04:13:32.748 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 2.4390243902439024
2024-09-09 04:13:32.749 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 3.2520325203252027
2024-09-09 04:13:32.750 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 5.284552845528455
2024-09-09 04:13:32.751 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 5.284552845528455
2024-09-09 04:13:32.752 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 5.284552845528455
2024-09-09 04:13:32.753 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 5.284552845528455
2024-09-09 04:13:32.754 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 5.284552845528455
2024-09-09 04:13:32.755 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 5.284552845528455
2024-09-09 04:13:32.756 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 5.284552845528455
2024-09-09 04:13:32.757 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 5.284552845528455
2024-09-09 04:13:32.758 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 5.284552845528455
2024-09-09 04:13:32.759 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 5.284552845528455
2024-09-09 04:13:32.760 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 5.284552845528455
2024-09-09 04:13:32.761 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 5.284552845528455
2024-09-09 04:13:32.762 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 5.284552845528455
2024-09-09 04:13:32.763 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 5.284552845528455
2024-09-09 04:13:32.764 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 5.284552845528455
2024-09-09 04:13:32.765 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 5.284552845528455
2024-09-09 04:13:32.766 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 5.284552845528455
2024-09-09 04:13:32.767 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 5.284552845528455
2024-09-09 04:13:32.768 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 5.284552845528455
2024-09-09 04:13:32.769 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 5.284552845528455
2024-09-09 04:13:32.770 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 5.284552845528455
2024-09-09 04:13:32.771 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 5.284552845528455
2024-09-09 04:13:32.772 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 5.284552845528455
2024-09-09 04:13:32.773 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 5.284552845528455
2024-09-09 04:13:32.774 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 5.284552845528455
2024-09-09 04:13:32.775 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 5.284552845528455
2024-09-09 04:13:32.776 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 5.284552845528455
2024-09-09 04:13:32.777 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 5.284552845528455
2024-09-09 04:13:32.778 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 5.284552845528455
2024-09-09 04:13:32.779 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 5.284552845528455
2024-09-09 04:13:32.780 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 5.284552845528455
2024-09-09 04:13:32.781 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 5.284552845528455
2024-09-09 04:13:32.782 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 5.284552845528455
2024-09-09 04:13:32.784 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 5.284552845528455
2024-09-09 04:13:32.785 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 5.284552845528455
2024-09-09 04:13:32.786 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 5.284552845528455
2024-09-09 04:13:32.787 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 5.284552845528455
2024-09-09 04:13:32.788 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 5.284552845528455
2024-09-09 04:13:32.789 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 5.284552845528455
2024-09-09 04:13:32.790 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 5.284552845528455
2024-09-09 04:13:32.791 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 5.284552845528455
2024-09-09 04:13:32.792 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 5.284552845528455
2024-09-09 04:13:32.793 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 5.284552845528455
2024-09-09 04:13:32.794 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 5.284552845528455
2024-09-09 04:13:32.795 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 5.284552845528455
2024-09-09 04:13:32.796 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 5.284552845528455
2024-09-09 04:13:32.797 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 5.284552845528455
2024-09-09 04:13:32.798 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 5.284552845528455
2024-09-09 04:13:32.799 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 5.284552845528455
2024-09-09 04:13:32.800 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 5.284552845528455
2024-09-09 04:13:32.801 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 5.284552845528455
2024-09-09 04:13:32.802 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 5.284552845528455
2024-09-09 04:13:32.804 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 5.284552845528455
2024-09-09 04:13:32.805 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 5.284552845528455
2024-09-09 04:13:32.806 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 5.284552845528455
2024-09-09 04:13:32.807 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 5.284552845528455
2024-09-09 04:13:32.808 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 5.284552845528455
2024-09-09 04:13:32.809 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 5.284552845528455
2024-09-09 04:13:32.810 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 5.284552845528455
2024-09-09 04:13:32.811 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 5.284552845528455
2024-09-09 04:13:32.812 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 5.284552845528455
2024-09-09 04:13:32.813 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 5.284552845528455
2024-09-09 04:13:32.815 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 5.284552845528455
2024-09-09 04:13:32.816 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 5.284552845528455
2024-09-09 04:13:32.817 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 5.284552845528455
2024-09-09 04:13:32.818 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 5.284552845528455
2024-09-09 04:13:32.819 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 5.284552845528455
2024-09-09 04:13:32.820 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 5.284552845528455
2024-09-09 04:13:32.821 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 5.284552845528455
2024-09-09 04:13:32.822 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 5.284552845528455
2024-09-09 04:13:32.823 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 5.284552845528455
2024-09-09 04:13:32.824 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 5.284552845528455
2024-09-09 04:13:32.825 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 5.284552845528455
2024-09-09 04:13:32.826 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 5.284552845528455
2024-09-09 04:13:32.827 | INFO     | retrieval.model:validation_step:388 - MRR: 0.00290187405775953
2024-09-09 04:13:32.828 | INFO     | retrieval.model:validation_step:396 - End of validation_step
Epoch 1: 100%|██████████████████████████████████████████████████████| 2/2 [00:06<00:00,  0.31it/s, v_num=4]Epoch 1, global step 2: 'Recall@10_val' was not in top 1
`Trainer.fit` stopped: `max_epochs=2` reached.
Epoch 1: 100%|██████████████████████████████████████████████████████| 2/2 [00:06<00:00,  0.31it/s, v_num=4]
2024-09-09 04:13:35.907 | INFO     | __main__:main:1533 - hit the barrier after training
2024-09-09 04:13:35.941 | INFO     | __main__:main:1533 - hit the barrier after training
2024-09-09 04:13:35.999 | INFO     | __main__:main:1533 - hit the barrier after training
2024-09-09 04:13:36.194 | INFO     | __main__:main:1533 - hit the barrier after training
2024-09-09 04:13:36.195 | INFO     | __main__:main:1539 - Finished progressive training at epoch 2
2024-09-09 04:13:36.195 | INFO     | __main__:main:1539 - Finished progressive training at epoch 2
2024-09-09 04:13:36.195 | INFO     | __main__:main:1539 - Finished progressive training at epoch 2
2024-09-09 04:13:36.195 | INFO     | __main__:main:1539 - Finished progressive training at epoch 2
2024-09-09 04:13:38.356 | INFO     | __main__:main:1558 - Testing...
2024-09-09 04:13:38.359 | INFO     | retrieval.main:run_cli:60 - PID: 104118
2024-09-09 04:13:38.366 | INFO     | __main__:main:1558 - Testing...
2024-09-09 04:13:38.367 | INFO     | retrieval.main:run_cli:60 - PID: 104457
2024-09-09 04:13:38.406 | INFO     | __main__:main:1558 - Testing...
2024-09-09 04:13:38.407 | INFO     | retrieval.main:run_cli:60 - PID: 104456
[rank: 3] Seed set to 3407
2024-09-09 04:13:38.564 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-09 04:13:38.564 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-09 04:13:38.565 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-09 04:13:38.565 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-09 04:13:38.606 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-09 04:13:38.606 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
2024-09-09 04:13:38.883 | INFO     | __main__:main:1558 - Testing...
2024-09-09 04:13:38.884 | INFO     | retrieval.main:run_cli:60 - PID: 104455
2024-09-09 04:13:39.076 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
[rank: 1] Seed set to 3407
2024-09-09 04:13:39.077 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-09 04:13:39.077 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
2024-09-09 04:13:39.117 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-09 04:13:39.119 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-09 04:13:39.611 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-09 04:13:50.435 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169436
2024-09-09 04:13:50.454 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2837
2024-09-09 04:13:52.616 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169436
2024-09-09 04:13:52.633 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2837
2024-09-09 04:13:53.532 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169436
2024-09-09 04:13:53.550 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2837
2024-09-09 04:13:55.978 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169436
2024-09-09 04:13:55.995 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2837
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06
.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.
ckpt
2024-09-09 04:13:58.552 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-09 04:13:58.639 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-09 04:13:58.674 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                        | 0/? [00:00<?, ?it/s]2024-09-09 04:13:59.158 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start
: True
Predicting DataLoader 0:   0%|                                                      | 0/12 [00:00<?, ?it/s]/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.
py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 12/12 [00:29<00:00,  0.41it/s]2024-09-09 04:14:28.493 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions
 map
2024-09-09 04:14:28.493 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-09 04:14:28.493 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-09 04:14:28.507 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-09 04:14:28.507 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-09 04:14:28.507 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:14:28.507 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:14:28.508 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-09 04:14:28.508 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:14:30.644 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-09 04:14:30.657 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-09 04:14:30.658 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:14:30.658 | INFO     | retrieval.model:on_predict_epoch_end:580 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 12/12 [00:31<00:00,  0.38it/s]
2024-09-09 04:14:31.557 | INFO     | retrieval.main:run_cli:60 - PID: 104456
2024-09-09 04:14:31.602 | INFO     | retrieval.main:run_cli:60 - PID: 104457
2024-09-09 04:14:31.637 | INFO     | retrieval.main:run_cli:60 - PID: 104455
[rank: 2] Seed set to 3407
2024-09-09 04:14:31.794 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/random
2024-09-09 04:14:31.794 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0
fb051367c48c0a084411853a576389ecf5/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-09 04:14:31.818 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/random
2024-09-09 04:14:31.818 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0
fb051367c48c0a084411853a576389ecf5/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-09 04:14:31.846 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/random
2024-09-09 04:14:31.846 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0
fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:14:31.867 | INFO     | __main__:main:1580 - Loaded the predictions pickle files
2024-09-09 04:14:31.907 | INFO     | __main__:main:1583 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
100%|███████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 23692.76it/s]
2024-09-09 04:14:31.971 | INFO     | __main__:main:1585 - R@1 = 0.0 %, R@10 = 0.22446689113355783 %, MRR = 0.003444090075449079
2024-09-09 04:14:31.972 | INFO     | retrieval.main:run_cli:60 - PID: 104118
[rank: 0] Seed set to 3407
2024-09-09 04:14:32.163 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/random
2024-09-09 04:14:32.163 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0
fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:14:32.314 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:14:32.353 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:14:32.392 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:14:32.676 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-09 04:14:46.806 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:14:46.830 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:14:49.806 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:14:49.828 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:14:50.080 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:14:50.099 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
2024-09-09 04:14:55.169 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 220348
2024-09-09 04:14:55.189 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_sourc
e_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 3697
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06
.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.
ckpt
2024-09-09 04:14:57.678 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-09 04:14:57.743 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-09 04:14:57.811 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                        | 0/? [00:00<?, ?it/s]2024-09-09 04:14:58.381 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start
: True
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 15/15 [00:36<00:00,  0.42it/s]2024-09-09 04:15:34.597 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions
 map
2024-09-09 04:15:34.621 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-09 04:15:34.621 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:15:36.088 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-09 04:15:36.107 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-09 04:15:36.107 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:15:37.320 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-09 04:15:37.336 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-09 04:15:37.336 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:15:39.271 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-09 04:15:39.287 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-09 04:15:39.287 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-09 04:15:39.287 | INFO     | retrieval.model:on_predict_epoch_end:580 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 15/15 [00:40<00:00,  0.37it/s]
2024-09-09 04:15:40.331 | INFO     | __main__:main:1689 - Finished processing the repository
2024-09-09 04:15:40.332 | INFO     | __main__:main:1691 - current epoch: 2
2024-09-09 04:15:40.332 | INFO     | __main__:main:1355 - length of lean_git_repos: 2
2024-09-09 04:15:40.332 | INFO     | __main__:main:1356 - i: 2
2024-09-09 04:15:40.332 | INFO     | __main__:main:1693 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1357, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-09 04:15:40.360 | INFO     | __main__:main:1689 - Finished processing the repository
2024-09-09 04:15:40.360 | INFO     | __main__:main:1691 - current epoch: 2
2024-09-09 04:15:40.360 | INFO     | __main__:main:1355 - length of lean_git_repos: 2
2024-09-09 04:15:40.360 | INFO     | __main__:main:1356 - i: 2
2024-09-09 04:15:40.360 | INFO     | __main__:main:1693 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1357, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-09 04:15:40.469 | INFO     | __main__:main:1689 - Finished processing the repository
2024-09-09 04:15:40.469 | INFO     | __main__:main:1691 - current epoch: 2
2024-09-09 04:15:40.469 | INFO     | __main__:main:1355 - length of lean_git_repos: 2
2024-09-09 04:15:40.469 | INFO     | __main__:main:1356 - i: 2
2024-09-09 04:15:40.469 | INFO     | __main__:main:1693 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1357, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-09 04:15:40.579 | INFO     | __main__:main:1580 - Loaded the predictions pickle files
2024-09-09 04:15:40.636 | INFO     | __main__:main:1583 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5
76389ecf5/random/test.json
100%|███████████████████████████████████████████████████████████████| 1962/1962 [00:00<00:00, 22166.68it/s]
2024-09-09 04:15:40.725 | INFO     | __main__:main:1585 - R@1 = 0.0 %, R@10 = 0.19030888596105988 %, MRR = 0.003176513496937078
2024-09-09 04:15:40.727 | INFO     | __main__:main:1600 - Average R@1 = 0.0 %, R@10 = 0.20738788854730886 %, MRR = 0.0033103017861930784
2024-09-09 04:15:40.728 | INFO     | __main__:main:1636 - Starting the prover
2024-09-09 04:15:40.728 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-09 04:15:40.728 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-09 04:15:40.728 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-09 04:15:40.729 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b
853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-09 04:15:41.163 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.ckpt
2024-09-09 04:15:41.163 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.06.ckpt
2024-09-09 04:15:43.629 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'r
etriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encode
r.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.
layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtte
ntion.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', '
retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'ret
riever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer
.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.
layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.we
ight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.Den
seReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q
.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.en
coder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.bl
ock.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0
.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseRelu
Dense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight',
'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.en
coder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.laye
r.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense
.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight
', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encod
er.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.
layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.Se
lfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDens
e.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.enc
oder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_
step', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-09 04:15:44.381 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-09-09 04:15:44.382 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-09 04:15:44.382 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_529
7e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:15:44.382 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0
a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:17:43.247 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-09 04:17:43.247 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297
e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-09 04:17:43.248 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
(autoscaler +28m41s) Tip: use `ray status` to view detailed cluster status. To disable these messages, set RAY_SCHEDULER_EVENTS=0.
(autoscaler +28m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +29m14s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
2024-09-09 04:18:50.130 | INFO     | __main__:prove_sorry_theorems:814 - Found 29 sorry theorems to prove
Processing theorems from avigad/mathematics_in_lean_source:   0%|                                                                                                                            | 0/29 [00:00<?, ?theorem/s]
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for MyRing.neg_neg
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:838 - Position: (305, 1)
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for Cantor
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:838 - Position: (673, 1)
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for MyGroup.mul_right_inv
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:838 - Position: (468, 1)
2024-09-09 04:18:50.138 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for C03S06.aux
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:838 - Position: (275, 1)
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for cauchySeq_of_le_geometric_two'
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:838 - Position: (423, 1)
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for C03S05.MyAbs.lt_abs
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:838 - Position: (193, 1)
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for MyRing.zero_mul
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:838 - Position: (279, 1)
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for C03S01.my_lemma3
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:838 - Position: (99, 1)
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for MyRing.two_mul
2024-09-09 04:18:50.139 | INFO     | __main__:prove_sorry_theorems:838 - Position: (407, 1)
2024-09-09 04:18:50.140 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for C03S05.MyAbs.abs_add
2024-09-09 04:18:50.140 | INFO     | __main__:prove_sorry_theorems:838 - Position: (163, 1)
2024-09-09 04:18:50.140 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for C03S04.aux
2024-09-09 04:18:50.140 | INFO     | __main__:prove_sorry_theorems:838 - Position: (246, 1)
2024-09-09 04:18:50.140 | INFO     | __main__:prove_sorry_theorems:837 - Searching for proof for C03S05.MyAbs.abs_lt
2024-09-09 04:18:50.140 | INFO     | __main__:prove_sorry_theorems:838 - Position: (196, 1)
2024-09-09 04:18:50.140 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(pid=142029) [2024-09-09 04:18:56,980] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=142029) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrust
ed-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be
 allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't ha
ve full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=142029)   return torch.load(io.BytesIO(b))
(ProverActor pid=142029) 2024-09-09 04:19:08.437 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a08
4411853a576389ecf5'), file_path=PosixPath('MIL/C02_Basics/S02_Proving_Identities_in_Algebraic_Structures.lean'), full_name='MyRing.neg_neg')
(ProverActor pid=142026) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrust
ed-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be
 allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't ha
ve full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature. [repeated 3x across cluster]
(ProverActor pid=142026)   return torch.load(io.BytesIO(b)) [repeated 3x across cluster]
(ProverActor pid=142027) 2024-09-09 04:19:09.415 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a08
4411853a576389ecf5'), file_path=PosixPath('MIL/C02_Basics/S02_Proving_Identities_in_Algebraic_Structures.lean'), full_name='MyGroup.mul_right_inv')
(ProverActor pid=142028) 2024-09-09 04:19:09.598 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a08
4411853a576389ecf5'), file_path=PosixPath('MIL/C04_Sets_and_Functions/S02_Functions.lean'), full_name='Cantor')
(ProverActor pid=142026) 2024-09-09 04:19:09.716 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a08
4411853a576389ecf5'), file_path=PosixPath('MIL/C03_Logic/S06_Sequences_and_Convergence.lean'), full_name='C03S06.aux')

