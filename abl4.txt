2024-09-22 22:41:34.820 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:41:34.821 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:22<00:00,  0.35it/s]
2024-09-22 22:41:35.859 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-22 22:41:36.082 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
2024-09-22 22:41:36.115 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
[rank: 2] Seed set to 3407
2024-09-22 22:41:36.180 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rando
m
2024-09-22 22:41:36.180 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/cor
pus.jsonl
[rank: 1] Seed set to 3407
2024-09-22 22:41:36.268 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rando
m
2024-09-22 22:41:36.268 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/cor
pus.jsonl
[rank: 3] Seed set to 3407
2024-09-22 22:41:36.346 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rando
m
2024-09-22 22:41:36.346 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/cor
pus.jsonl
2024-09-22 22:41:36.767 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 22:41:36.788 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
2024-09-22 22:41:36.801 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 1351/1351 [00:00<00:00, 53735.39it/s]
2024-09-22 22:41:36.828 | INFO     | __main__:main:1729 - R@1 = 29.731358806963648 %, R@10 = 71.78833263510683 %, MRR = 0.6045962068017519
2024-09-22 22:41:36.829 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
2024-09-22 22:41:36.855 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
2024-09-22 22:41:37.018 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-22 22:41:37.019 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rando
m
2024-09-22 22:41:37.019 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/cor
pus.jsonl
2024-09-22 22:41:37.534 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-22 22:41:43.079 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-22 22:41:43.084 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
2024-09-22 22:41:44.436 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-22 22:41:44.444 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
2024-09-22 22:41:45.356 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-22 22:41:45.361 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
2024-09-22 22:41:46.078 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-22 22:41:46.085 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b662149
0c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 22:41:53.993 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:41:53.994 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▏                                                                                 | 2/906 [00:00<00:54, 16.58it/s]2024-09-22 22:41:54.344 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:41:54.345 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▎                                                                                 | 4/906 [00:00<01:29, 10.03it/s]2024-09-22 22:41:54.374 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:41:54.375 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 22:41:54.928 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:41:54.929 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████| 906/906 [04:37<00:00,  3.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 906/906 [04:38<00:00,  3.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 906/906 [04:38<00:00,  3.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 906/906 [04:40<00:00,  3.24it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 3/3 [00:03<00:00,  0.77it/s]2024-09-22 22:46:37.213 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:46:37.213 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:46:37.244 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 22:46:37.244 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:46:37.247 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 22:46:37.247 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:46:37.920 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:46:37.920 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:46:37.950 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 22:46:37.950 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:46:37.953 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 22:46:37.953 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:46:37.953 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  0.64it/s]
2024-09-22 22:46:38.913 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
[rank: 1] Seed set to 3407
2024-09-22 22:46:39.141 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 22:46:39.141 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.
jsonl
2024-09-22 22:46:39.149 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-22 22:46:39.158 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
[rank: 2] Seed set to 3407
2024-09-22 22:46:39.372 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 22:46:39.372 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.
jsonl
[rank: 3] Seed set to 3407
2024-09-22 22:46:39.402 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 22:46:39.402 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.
jsonl
2024-09-22 22:46:39.651 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 22:46:39.665 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-22 22:46:39.666 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████| 500/500 [00:00<00:00, 51662.90it/s]
2024-09-22 22:46:39.677 | INFO     | __main__:main:1729 - R@1 = 27.486028641285365 %, R@10 = 67.13587146349983 %, MRR = 0.5701661588577744
2024-09-22 22:46:39.678 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
[rank: 0] Seed set to 3407
2024-09-22 22:46:39.944 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 22:46:39.944 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.
jsonl
2024-09-22 22:46:39.981 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-22 22:46:40.020 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-22 22:46:40.646 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
[rank: 3] Seed set to 3407
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
100%|██████████████████████████████████████████████████████████████████████████| 66088/66088 [00:08<00:00, 7660.47it/s]
 45%|█████████████████████████████████▋                                        | 30043/66088 [00:04<00:05, 6018.47it/s]2024-09-22 22:47:03.281 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/
lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
100%|████████████████████████████████████████████████████████████████████████████| 1376/1376 [00:00<00:00, 8874.84it/s]
2024-09-22 22:47:03.481 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5
b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
100%|██████████████████████████████████████████████████████████████████████████| 66088/66088 [00:09<00:00, 7207.69it/s]
 54%|████████████████████████████████████████▏                                 | 35938/66088 [00:05<00:04, 6625.23it/s]2024-09-22 22:47:04.309 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/
lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-22 22:47:04.321 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3
/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
100%|██████████████████████████████████████████████████████████████████████████| 66088/66088 [00:11<00:00, 5987.93it/s]
2024-09-22 22:47:10.336 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5
b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-22 22:47:10.353 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3
/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
100%|██████████████████████████████████████████████████████████████████████████| 66088/66088 [00:12<00:00, 5175.10it/s]
2024-09-22 22:47:25.639 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5
b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-22 22:47:25.658 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3
/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 22:47:28.823 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:47:28.824 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1620 [00:00<?, ?it/s]2024-09-22 22:47:28.918 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:47:28.919 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▏                                                                                | 4/1620 [00:00<02:24, 11.15it/s]2024-09-22 22:47:29.172 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:47:29.173 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 22:47:30.597 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:47:30.598 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:33<00:00,  3.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:34<00:00,  3.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:33<00:00,  3.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:36<00:00,  3.13it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:24<00:00,  0.33it/s]2024-09-22 22:56:28.740 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:56:28.740 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:56:28.740 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:56:28.740 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 22:56:28.816 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 22:56:28.816 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:56:28.817 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 22:56:28.817 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:56:28.819 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 22:56:28.819 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:56:28.876 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 22:56:28.876 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 22:56:28.876 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:24<00:00,  0.33it/s]
2024-09-22 22:56:29.953 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
2024-09-22 22:56:30.024 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-22 22:56:30.027 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
[rank: 1] Seed set to 3407
2024-09-22 22:56:30.214 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-09-22 22:56:30.214 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corp
us.jsonl
[rank: 2] Seed set to 3407
2024-09-22 22:56:30.275 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-09-22 22:56:30.275 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corp
us.jsonl
[rank: 3] Seed set to 3407
2024-09-22 22:56:30.303 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-09-22 22:56:30.303 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corp
us.jsonl
2024-09-22 22:56:30.739 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-09-22 22:56:30.866 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-09-22 22:56:30.987 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 22:56:31.032 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 1376/1376 [00:00<00:00, 36558.85it/s]
2024-09-22 22:56:31.071 | INFO     | __main__:main:1729 - R@1 = 29.098116969874145 %, R@10 = 70.38041398759476 %, MRR = 0.5839742862717707
2024-09-22 22:56:31.073 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
2024-09-22 22:56:31.106 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-22 22:56:31.414 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-09-22 22:56:31.414 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corp
us.jsonl
2024-09-22 22:56:32.226 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
[rank: 2] Seed set to 3407
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-22 22:57:07.984 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-22 22:57:08.040 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-22 22:57:14.853 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-22 22:57:14.878 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-22 22:57:19.731 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-22 22:57:19.781 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-22 22:57:20.970 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-22 22:57:21.010 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f
091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 22:57:24.149 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:57:24.150 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                 | 2/2783 [00:00<02:58, 15.57it/s]2024-09-22 22:57:24.512 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:57:24.513 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                 | 4/2783 [00:00<04:18, 10.73it/s]2024-09-22 22:57:24.622 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:57:24.623 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 22:57:26.110 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 22:57:26.110 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:23<00:00,  2.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:27<00:00,  2.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:27<00:00,  2.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:31<00:00,  2.81it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 20/20 [00:48<00:00,  0.41it/s]2024-09-22 23:14:42.272 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:14:42.272 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:14:42.272 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:14:42.272 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:14:42.417 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 23:14:42.417 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:14:42.420 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 23:14:42.421 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:14:42.423 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 23:14:42.424 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:14:42.434 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 23:14:42.434 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:14:42.435 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 20/20 [00:49<00:00,  0.41it/s]
2024-09-22 23:14:43.498 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
2024-09-22 23:14:43.507 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
2024-09-22 23:14:43.544 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
[rank: 3] Seed set to 3407
2024-09-22 23:14:43.694 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a
576389ecf5/random
2024-09-22 23:14:43.694 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-22 23:14:43.698 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a
576389ecf5/random
2024-09-22 23:14:43.698 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-22 23:14:43.740 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a
576389ecf5/random
2024-09-22 23:14:43.740 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/corpus.jsonl
2024-09-22 23:14:44.228 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-09-22 23:14:44.281 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-09-22 23:14:44.380 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-09-22 23:14:44.717 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 23:14:44.788 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 2427/2427 [00:00<00:00, 35399.83it/s]
2024-09-22 23:14:44.858 | INFO     | __main__:main:1729 - R@1 = 24.508268175841803 %, R@10 = 63.7719066642349 %, MRR = 0.5399142068279095
2024-09-22 23:14:44.860 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
[rank: 0] Seed set to 3407
2024-09-22 23:14:45.057 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a
576389ecf5/random
2024-09-22 23:14:45.057 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/corpus.jsonl
2024-09-22 23:14:45.612 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-22 23:14:57.470 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-22 23:14:57.492 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
2024-09-22 23:15:00.909 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-22 23:15:00.924 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
2024-09-22 23:15:01.204 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-22 23:15:01.219 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
2024-09-22 23:15:05.185 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-22 23:15:05.200 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a
084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:15:07.937 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:15:07.938 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1840 [00:00<?, ?it/s]2024-09-22 23:15:07.942 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:15:07.943 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1840 [00:00<?, ?it/s]2024-09-22 23:15:08.046 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:15:08.047 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 23:15:09.055 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:15:09.056 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:50<00:00,  3.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:52<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:52<00:00,  3.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:55<00:00,  3.09it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:22<00:00,  0.44it/s]2024-09-22 23:25:23.951 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:25:23.951 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:25:23.952 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:25:23.952 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:25:24.050 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 23:25:24.050 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:25:24.054 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 23:25:24.054 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:25:24.055 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 23:25:24.055 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:25:24.057 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 23:25:24.057 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:25:24.057 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:22<00:00,  0.44it/s]
2024-09-22 23:25:25.131 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
2024-09-22 23:25:25.167 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-22 23:25:25.181 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
[rank: 2] Seed set to 3407
2024-09-22 23:25:25.389 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf26144
5d/random
2024-09-22 23:25:25.390 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261
445d/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-22 23:25:25.408 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf26144
5d/random
2024-09-22 23:25:25.408 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261
445d/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-22 23:25:25.463 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf26144
5d/random
2024-09-22 23:25:25.463 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261
445d/corpus.jsonl
2024-09-22 23:25:25.975 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-09-22 23:25:26.002 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-09-22 23:25:26.031 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-09-22 23:25:26.264 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 23:25:26.327 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/test.
json
100%|███████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 34425.35it/s]
2024-09-22 23:25:26.375 | INFO     | __main__:main:1729 - R@1 = 27.562784264994722 %, R@10 = 67.5922496626108 %, MRR = 0.5754018914279281
2024-09-22 23:25:26.376 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
[rank: 0] Seed set to 3407
2024-09-22 23:25:26.666 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf26144
5d/random
2024-09-22 23:25:26.666 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261
445d/corpus.jsonl
2024-09-22 23:25:27.276 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-22 23:26:02.097 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-22 23:26:02.129 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
2024-09-22 23:26:03.720 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-22 23:26:03.736 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
2024-09-22 23:26:04.493 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-22 23:26:04.508 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
2024-09-22 23:26:05.371 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-22 23:26:05.394 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046
c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:26:08.497 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:26:08.498 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1805 [00:00<?, ?it/s]2024-09-22 23:26:08.527 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:26:08.528 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                 | 2/1805 [00:00<01:46, 16.98it/s]2024-09-22 23:26:08.844 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:26:08.845 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 23:26:10.281 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:26:10.282 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:42<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:44<00:00,  3.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:43<00:00,  3.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:46<00:00,  3.08it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:21<00:00,  0.47it/s]2024-09-22 23:36:15.706 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:36:15.707 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:36:15.801 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 23:36:15.802 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:36:15.815 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 23:36:15.815 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:36:17.173 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:36:17.174 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:36:17.269 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 23:36:17.269 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:36:17.272 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 23:36:17.272 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:36:17.273 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:23<00:00,  0.43it/s]
2024-09-22 23:36:18.399 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-22 23:36:18.439 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
2024-09-22 23:36:18.448 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
[rank: 3] Seed set to 3407
2024-09-22 23:36:18.635 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-09-22 23:36:18.635 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.
jsonl
[rank: 2] Seed set to 3407
2024-09-22 23:36:18.673 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-09-22 23:36:18.674 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.
jsonl
[rank: 1] Seed set to 3407
2024-09-22 23:36:18.713 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-09-22 23:36:18.713 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.
jsonl
2024-09-22 23:36:19.177 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-09-22 23:36:19.240 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-09-22 23:36:19.306 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 23:36:19.330 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-09-22 23:36:19.366 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 1538/1538 [00:00<00:00, 32718.97it/s]
2024-09-22 23:36:19.415 | INFO     | __main__:main:1729 - R@1 = 28.556304600123234 %, R@10 = 69.10543436122428 %, MRR = 0.5843152439330259
2024-09-22 23:36:19.416 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
[rank: 0] Seed set to 3407
2024-09-22 23:36:19.699 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-09-22 23:36:19.699 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.
jsonl
2024-09-22 23:36:20.299 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-22 23:36:26.274 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-22 23:36:26.477 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-22 23:36:26.485 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_pred/cached_data.pkl
Testing dataset size: 853
2024-09-22 23:36:26.970 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-22 23:36:26.975 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_pred/cached_data.pkl
Testing dataset size: 853
2024-09-22 23:36:27.287 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_pred/cached_data.pkl
Testing dataset size: 853
2024-09-22 23:36:30.088 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-22 23:36:30.097 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
/random/cache_pred/cached_data.pkl
Testing dataset size: 853
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:36:33.238 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:36:33.239 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1003 [00:00<?, ?it/s]2024-09-22 23:36:33.270 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:36:33.271 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▎                                                                                | 4/1003 [00:00<01:38, 10.14it/s]2024-09-22 23:36:33.637 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:36:33.637 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 23:36:34.481 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:36:34.482 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1003/1003 [04:54<00:00,  3.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1003/1003 [04:56<00:00,  3.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1003/1003 [04:55<00:00,  3.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1003/1003 [04:57<00:00,  3.38it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  0.61it/s]2024-09-22 23:41:37.013 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:41:37.014 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:41:37.014 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:41:37.014 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:41:37.049 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 23:41:37.050 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:41:37.051 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 23:41:37.051 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:41:37.064 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 23:41:37.065 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:41:37.066 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 23:41:37.066 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:41:37.066 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  0.61it/s]
2024-09-22 23:41:37.896 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
2024-09-22 23:41:38.167 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-22 23:41:38.216 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
[rank: 3] Seed set to 3407
2024-09-22 23:41:38.243 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-22 23:41:38.243 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jso
nl
[rank: 2] Seed set to 3407
2024-09-22 23:41:38.382 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-22 23:41:38.382 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jso
nl
[rank: 1] Seed set to 3407
2024-09-22 23:41:38.461 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-22 23:41:38.461 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jso
nl
2024-09-22 23:41:38.796 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 23:41:38.814 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████| 589/589 [00:00<00:00, 54823.24it/s]
2024-09-22 23:41:38.825 | INFO     | __main__:main:1729 - R@1 = 31.14360963997448 %, R@10 = 72.48338593183273 %, MRR = 0.6052101440778199
2024-09-22 23:41:38.826 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
2024-09-22 23:41:38.876 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-09-22 23:41:39.008 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-09-22 23:41:39.046 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-22 23:41:39.061 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-22 23:41:39.061 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jso
nl
2024-09-22 23:41:39.640 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-22 23:41:53.265 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-22 23:41:53.294 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-22 23:41:53.409 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-22 23:41:53.423 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-22 23:41:54.943 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-22 23:41:54.957 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-22 23:41:56.780 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-22 23:41:56.802 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/ra
ndom/cache_pred/cached_data.pkl
Testing dataset size: 2421
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:41:59.946 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:41:59.947 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1795 [00:00<?, ?it/s]2024-09-22 23:41:59.952 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:41:59.953 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▏                                                                                | 4/1795 [00:00<02:50, 10.51it/s]2024-09-22 23:42:00.322 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:42:00.323 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 23:42:01.681 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 23:42:01.682 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:40<00:00,  3.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:43<00:00,  3.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:42<00:00,  3.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:45<00:00,  3.07it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:28<00:00,  0.35it/s]2024-09-22 23:52:13.226 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:52:13.227 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:52:13.227 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:52:13.227 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 23:52:13.322 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 23:52:13.323 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:52:13.360 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 23:52:13.360 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:52:13.362 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 23:52:13.362 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:52:13.366 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 23:52:13.366 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 23:52:13.367 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  0.34it/s]
2024-09-22 23:52:14.259 | INFO     | __main__:main:1842 - Finished processing the repository
2024-09-22 23:52:14.260 | INFO     | __main__:main:1844 - current epoch: 10
2024-09-22 23:52:14.260 | INFO     | __main__:main:1517 - length of lean_git_repos: 11
2024-09-22 23:52:14.260 | INFO     | __main__:main:1518 - i: 8
2024-09-22 23:52:14.260 | INFO     | __main__:main:1545 - All GPUs
2024-09-22 23:52:14.263 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621
490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:14.263 | INFO     | __main__:main:1552 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epo
ch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:14.263 | INFO     | __main__:main:1558 - Inside train_test_fisher
2024-09-22 23:52:14.263 | INFO     | __main__:main:1559 - Starting training at epoch 10
[rank: 2] Seed set to 3407
2024-09-22 23:52:14.558 | INFO     | __main__:main:1842 - Finished processing the repository
2024-09-22 23:52:14.559 | INFO     | __main__:main:1844 - current epoch: 10
2024-09-22 23:52:14.559 | INFO     | __main__:main:1517 - length of lean_git_repos: 11
2024-09-22 23:52:14.559 | INFO     | __main__:main:1518 - i: 8
2024-09-22 23:52:14.559 | INFO     | __main__:main:1545 - All GPUs
2024-09-22 23:52:14.561 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621
490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:14.561 | INFO     | __main__:main:1552 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epo
ch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:14.561 | INFO     | __main__:main:1558 - Inside train_test_fisher
2024-09-22 23:52:14.562 | INFO     | __main__:main:1559 - Starting training at epoch 10
[rank: 1] Seed set to 3407
2024-09-22 23:52:14.670 | INFO     | __main__:main:1842 - Finished processing the repository
2024-09-22 23:52:14.671 | INFO     | __main__:main:1844 - current epoch: 10
2024-09-22 23:52:14.671 | INFO     | __main__:main:1517 - length of lean_git_repos: 11
2024-09-22 23:52:14.671 | INFO     | __main__:main:1518 - i: 8
2024-09-22 23:52:14.671 | INFO     | __main__:main:1545 - All GPUs
2024-09-22 23:52:14.673 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621
490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:14.673 | INFO     | __main__:main:1552 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epo
ch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:14.673 | INFO     | __main__:main:1558 - Inside train_test_fisher
2024-09-22 23:52:14.673 | INFO     | __main__:main:1559 - Starting training at epoch 10
[rank: 3] Seed set to 3407
2024-09-22 23:52:15.773 | INFO     | __main__:main:1724 - Loaded the predictions pickle files
2024-09-22 23:52:15.821 | INFO     | __main__:main:1727 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 1501/1501 [00:00<00:00, 37607.08it/s]
2024-09-22 23:52:15.862 | INFO     | __main__:main:1729 - R@1 = 26.977004920143376 %, R@10 = 68.1930154258372 %, MRR = 0.5752137568668212
2024-09-22 23:52:15.863 | INFO     | __main__:main:1744 - Average R@1 = 27.759469923937974 %, R@10 = 68.20802940345108 %, MRR = 0.5741760443613073
2024-09-22 23:52:15.864 | INFO     | __main__:main:1780 - Starting the prover
2024-09-22 23:52:15.864 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-22 23:52:15.864 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-22 23:52:15.864 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-22 23:52:15.865 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cd
c318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:16.597 | INFO     | __main__:main:1583 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_
epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:16.708 | INFO     | __main__:main:1641 - right before barrier for data module
2024-09-22 23:52:16.760 | INFO     | __main__:main:1583 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_
epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:16.785 | INFO     | __main__:main:1583 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_
epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:16.817 | INFO     | __main__:main:1641 - right before barrier for data module
2024-09-22 23:52:16.836 | INFO     | __main__:main:1641 - right before barrier for data module
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-22 23:52:17.016 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_la
mbda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:17.016 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_la
mbda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:52:20.717 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
2024-09-22 23:52:21.683 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-09-22 23:52:21.685 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-22 23:52:21.685 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/
corpus.jsonl
2024-09-22 23:52:21.685 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
2024-09-22 23:52:24.812 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-22 23:52:24.812 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/c
orpus.jsonl
2024-09-22 23:52:24.812 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1812/1812 [02:33<00:00, 11.82it/s]
2024-09-22 23:54:58.154 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-09-22 23:54:58.154 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-09-22 23:55:04,763 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=325924) [2024-09-22 23:55:43,996] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=325924) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=325924)   return torch.load(io.BytesIO(b))
2024-09-22 23:55:51.576 | INFO     | __main__:prove_sorry_theorems:1010 - Found 0 sorry theorems to prove
Processing theorems from FormalizedFormalLogic/Foundation: 0theorem [00:00, ?theorem/s]
2024-09-22 23:55:51.577 | INFO     | __main__:save_progress:965 - Saving encountered theorems...
2024-09-22 23:55:51.579 | INFO     | __main__:prove_sorry_theorems:1061 - Finished attempting to prove sorry theorems
(pid=326636) [2024-09-22 23:55:56,159] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect) [repeated 2x across cluster]
(ProverActor pid=326636) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature. [repeated 2x across cluster]
(ProverActor pid=326636)   return torch.load(io.BytesIO(b)) [repeated 2x across cluster]
(pid=326822) [2024-09-22 23:56:02,531] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-22 23:57:52.101 | INFO     | __main__:main:1819 - Finished searching for proofs of sorry theorems
2024-09-22 23:57:52.101 | INFO     | __main__:main:1822 - Shutting down Ray after proving
(ProverActor pid=326822) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=326822)   return torch.load(io.BytesIO(b))
2024-09-22 23:57:54.623 | INFO     | __main__:main:1842 - Finished processing the repository
2024-09-22 23:57:54.623 | INFO     | __main__:main:1844 - current epoch: 10
2024-09-22 23:57:54.624 | INFO     | __main__:main:1517 - length of lean_git_repos: 11
2024-09-22 23:57:54.624 | INFO     | __main__:main:1518 - i: 8
2024-09-22 23:57:54.624 | INFO     | __main__:main:1524 - Main process
2024-09-22 23:57:54.624 | INFO     | __main__:main:1525 - Using lambda = 0.1
2024-09-22 23:57:54.624 | INFO     | __main__:main:1526 - Processing https://github.com/siddhartha-gadgil/Saturn
2024-09-22 23:57:54.624 | INFO     | __main__:main:1533 - Adding repo to repos_for_merged_dataset
2024-09-22 23:57:54.625 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-22 23:57:54.625 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-22 23:57:55.402 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a already exists. Removin
g it now.
2024-09-22 23:57:56.622 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-09-22 23:57:56.765 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a
2024-09-22 23:57:56.771 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a
2024-09-22 23:57:56.772 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-09-22 23:57:56.774 | INFO     | __main__:main:1545 - All GPUs
2024-09-22 23:57:56.777 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621
490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:57:56.777 | INFO     | __main__:main:1552 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epo
ch=9-Recall@10_val=69.06.ckpt
2024-09-22 23:57:56.777 | INFO     | __main__:main:1558 - Inside train_test_fisher
2024-09-22 23:57:56.777 | INFO     | __main__:main:1559 - Starting training at epoch 10
[rank: 0] Seed set to 3407
2024-09-22 23:57:59.175 | INFO     | __main__:main:1583 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_
epoch=9-Recall@10_val=69.06.ckpt
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-22 23:57:59.282 | INFO     | __main__:main:1641 - right before barrier for data module
2024-09-22 23:57:59.283 | INFO     | __main__:main:1656 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-22 23:57:59.283 | INFO     | __main__:main:1656 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-22 23:57:59.283 | INFO     | __main__:main:1656 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-22 23:57:59.283 | INFO     | __main__:main:1656 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-22 23:57:59.382 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-09-22 23:57:59.382 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-09-22 23:57:59.391 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-09-22 23:57:59.454 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
100%|█████████████████████████████████████████████████████████████████████████| 10544/10544 [00:00<00:00, 12557.29it/s]
2024-09-22 23:58:01.587 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
100%|█████████████████████████████████████████████████████████████████████████████| 219/219 [00:00<00:00, 14471.55it/s]
2024-09-22 23:58:01.608 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
100%|█████████████████████████████████████████████████████████████████████████████| 219/219 [00:00<00:00, 12469.32it/s]
2024-09-22 23:58:01.632 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:01.633 | INFO     | __main__:main:1670 - Training dataset size after load: 15149
2024-09-22 23:58:01.633 | INFO     | __main__:main:1671 - Validation dataset size after load: 200
2024-09-22 23:58:01.633 | INFO     | __main__:main:1672 - Testing dataset size after load: 298
2024-09-22 23:58:01.633 | INFO     | __main__:main:1674 - Starting progressive training from epoch 10 to 11
2024-09-22 23:58:01.633 | INFO     | __main__:main:1677 - hit the barrier before training
100%|██████████████████████████████████████████████████████████████████████████| 10544/10544 [00:01<00:00, 6814.86it/s]
2024-09-22 23:58:03.603 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-22 23:58:03.605 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:03.608 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:03.608 | INFO     | __main__:main:1670 - Training dataset size after load: 15149
2024-09-22 23:58:03.609 | INFO     | __main__:main:1671 - Validation dataset size after load: 200
2024-09-22 23:58:03.609 | INFO     | __main__:main:1672 - Testing dataset size after load: 298
2024-09-22 23:58:03.609 | INFO     | __main__:main:1674 - Starting progressive training from epoch 10 to 11
2024-09-22 23:58:03.609 | INFO     | __main__:main:1677 - hit the barrier before training
 85%|███████████████████████████████████████████████████████████████▊           | 8976/10544 [00:00<00:00, 9137.95it/s]2024-09-22 23:58:04.815 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean
_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-22 23:58:04.817 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:04.819 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:04.819 | INFO     | __main__:main:1670 - Training dataset size after load: 15149
2024-09-22 23:58:04.820 | INFO     | __main__:main:1671 - Validation dataset size after load: 200
2024-09-22 23:58:04.820 | INFO     | __main__:main:1672 - Testing dataset size after load: 298
2024-09-22 23:58:04.820 | INFO     | __main__:main:1674 - Starting progressive training from epoch 10 to 11
2024-09-22 23:58:04.820 | INFO     | __main__:main:1677 - hit the barrier before training
100%|█████████████████████████████████████████████████████████████████████████| 10544/10544 [00:01<00:00, 10021.77it/s]
2024-09-22 23:58:05.119 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-22 23:58:05.121 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:05.124 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:05.124 | INFO     | __main__:main:1670 - Training dataset size after load: 15149
2024-09-22 23:58:05.124 | INFO     | __main__:main:1671 - Validation dataset size after load: 200
2024-09-22 23:58:05.124 | INFO     | __main__:main:1672 - Testing dataset size after load: 298
2024-09-22 23:58:05.124 | INFO     | __main__:main:1674 - Starting progressive training from epoch 10 to 11
2024-09-22 23:58:05.124 | INFO     | __main__:main:1677 - hit the barrier before training
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-22 23:58:05.202 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-22 23:58:05.215 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:05.217 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:05.695 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_train/cached_data.pkl
2024-09-22 23:58:05.697 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_train/cached_data.pkl
Training dataset size: 15149
Training dataset size: 15149
2024-09-22 23:58:05.708 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:05.709 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:05.711 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:05.711 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-22 23:58:08.196 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-22 23:58:08.205 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-22 23:58:08.207 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
/random/cache_pred/cached_data.pkl
Testing dataset size: 298
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-22 23:58:09.477 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-22 23:58:09.477 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-22 23:58:09.479 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-22 23:58:09.479 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=69.06.ckpt
Epoch 10: 100%|█████████████████████████████████████████████████████████████| 947/947 [05:45<00:00,  2.74it/s, v_num=4]2024-09-23 00:03:58.294 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 0/540 [00:00<?, ?it/s]2024-09-23 00:03:58.306 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▎                                                                                 | 2/540 [00:00<00:28, 18.77it/s]2024-09-23 00:03:58.532 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  1%|▉                                                                                 | 6/540 [00:00<01:23,  6.42it/s2024-09-23 00:03:59.237 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus0:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 540/540 [01:49<00:00,  4.94it/s]
2024-09-23 00:05:47.678 | INFO     | retrieval.model:validation_step:318 - Inside validation_step
2024-09-23 00:05:47.692 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: Falset/s]
100%|████████████████████████████████████████████████████████████████████████████████| 540/540 [01:49<00:00,  4.92it/s]
2024-09-23 00:05:47.977 | INFO     | retrieval.model:validation_step:318 - Inside validation_step
2024-09-23 00:05:47.992 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: Falset/s]
100%|███████████████████████████████████████████████████████████████████████████████▊| 539/540 [01:49<00:00,  4.50it/s2024-09-23 00:05:48.365 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 30.555555555555557
2024-09-23 00:05:48.367 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 47.222222222222220,  4.65it/s]
2024-09-23 00:05:48.368 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 58.333333333333336
2024-09-23 00:05:48.369 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 70.679012345679
2024-09-23 00:05:48.370 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 75.61728395061728
2024-09-23 00:05:48.371 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 80.55555555555556
2024-09-23 00:05:48.371 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 82.4074074074074
2024-09-23 00:05:48.372 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 83.64197530864197
2024-09-23 00:05:48.373 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 87.96296296296296
2024-09-23 00:05:48.374 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 87.96296296296296
2024-09-23 00:05:48.375 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 87.96296296296296
2024-09-23 00:05:48.375 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 89.81481481481481
2024-09-23 00:05:48.376 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 90.74074074074075
2024-09-23 00:05:48.377 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 90.74074074074075
2024-09-23 00:05:48.378 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 90.74074074074075
2024-09-23 00:05:48.379 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 90.74074074074075
2024-09-23 00:05:48.379 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 90.74074074074075
2024-09-23 00:05:48.380 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 90.74074074074075
2024-09-23 00:05:48.381 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 90.74074074074075
2024-09-23 00:05:48.382 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 90.74074074074075
2024-09-23 00:05:48.382 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 91.9753086419753
2024-09-23 00:05:48.383 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 92.90123456790123
2024-09-23 00:05:48.384 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 92.90123456790123
2024-09-23 00:05:48.385 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 94.1358024691358
2024-09-23 00:05:48.386 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 94.1358024691358
2024-09-23 00:05:48.386 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 94.1358024691358
2024-09-23 00:05:48.387 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 94.1358024691358
2024-09-23 00:05:48.388 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 94.1358024691358
2024-09-23 00:05:48.389 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 94.1358024691358
2024-09-23 00:05:48.390 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 94.1358024691358
2024-09-23 00:05:48.390 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 94.1358024691358
2024-09-23 00:05:48.391 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 94.1358024691358
2024-09-23 00:05:48.392 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 94.1358024691358
2024-09-23 00:05:48.393 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 94.1358024691358
2024-09-23 00:05:48.394 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 94.1358024691358
2024-09-23 00:05:48.394 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 94.1358024691358
2024-09-23 00:05:48.395 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 95.37037037037037
2024-09-23 00:05:48.396 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 95.37037037037037
2024-09-23 00:05:48.397 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 95.37037037037037
2024-09-23 00:05:48.398 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 95.37037037037037
2024-09-23 00:05:48.398 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 95.37037037037037
2024-09-23 00:05:48.399 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 95.37037037037037
2024-09-23 00:05:48.400 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 95.37037037037037
2024-09-23 00:05:48.401 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 96.29629629629629
2024-09-23 00:05:48.402 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 96.29629629629629
2024-09-23 00:05:48.402 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 96.29629629629629
2024-09-23 00:05:48.403 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 96.29629629629629
2024-09-23 00:05:48.404 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 96.29629629629629
2024-09-23 00:05:48.405 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 96.29629629629629
2024-09-23 00:05:48.405 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 96.29629629629629
2024-09-23 00:05:48.406 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 96.29629629629629
2024-09-23 00:05:48.407 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 96.29629629629629
2024-09-23 00:05:48.408 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 96.29629629629629
2024-09-23 00:05:48.409 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 96.29629629629629
2024-09-23 00:05:48.409 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 96.29629629629629
2024-09-23 00:05:48.410 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 96.29629629629629
2024-09-23 00:05:48.411 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 96.29629629629629
2024-09-23 00:05:48.412 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 96.29629629629629
2024-09-23 00:05:48.413 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 96.29629629629629
2024-09-23 00:05:48.413 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 96.29629629629629
2024-09-23 00:05:48.414 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 96.29629629629629
2024-09-23 00:05:48.415 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 96.29629629629629
2024-09-23 00:05:48.416 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 96.29629629629629
2024-09-23 00:05:48.417 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 96.29629629629629
2024-09-23 00:05:48.417 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 96.29629629629629
2024-09-23 00:05:48.418 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 96.29629629629629
2024-09-23 00:05:48.419 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 96.29629629629629
2024-09-23 00:05:48.420 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 96.29629629629629
2024-09-23 00:05:48.420 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 96.29629629629629
2024-09-23 00:05:48.421 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 96.29629629629629
2024-09-23 00:05:48.422 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 96.29629629629629
2024-09-23 00:05:48.423 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 96.29629629629629
2024-09-23 00:05:48.424 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 96.29629629629629
2024-09-23 00:05:48.424 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 96.29629629629629
2024-09-23 00:05:48.425 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 96.29629629629629
2024-09-23 00:05:48.426 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 96.29629629629629
2024-09-23 00:05:48.427 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 96.29629629629629
2024-09-23 00:05:48.428 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 96.29629629629629
2024-09-23 00:05:48.428 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 96.29629629629629
2024-09-23 00:05:48.429 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 96.29629629629629
2024-09-23 00:05:48.430 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 96.29629629629629
2024-09-23 00:05:48.431 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 96.29629629629629
2024-09-23 00:05:48.432 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 96.29629629629629
2024-09-23 00:05:48.432 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 96.29629629629629
2024-09-23 00:05:48.433 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 96.29629629629629
2024-09-23 00:05:48.434 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 96.29629629629629
2024-09-23 00:05:48.435 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 96.29629629629629
2024-09-23 00:05:48.436 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 96.29629629629629
2024-09-23 00:05:48.436 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 96.29629629629629
2024-09-23 00:05:48.437 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 96.29629629629629
2024-09-23 00:05:48.438 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 96.29629629629629
2024-09-23 00:05:48.439 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 96.29629629629629
2024-09-23 00:05:48.439 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 96.29629629629629
2024-09-23 00:05:48.440 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 96.29629629629629
2024-09-23 00:05:48.441 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 96.29629629629629
2024-09-23 00:05:48.442 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 96.29629629629629
2024-09-23 00:05:48.443 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 96.29629629629629
2024-09-23 00:05:48.443 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 96.29629629629629
2024-09-23 00:05:48.444 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 96.29629629629629
2024-09-23 00:05:48.445 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 96.29629629629629
2024-09-23 00:05:48.446 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6848765432098766
2024-09-23 00:05:48.447 | INFO     | retrieval.model:validation_step:389 - End of validation_step
100%|████████████████████████████████████████████████████████████████████████████████| 540/540 [01:49<00:00,  4.91it/s]
2024-09-23 00:05:48.527 | INFO     | retrieval.model:validation_step:318 - Inside validation_step
2024-09-23 00:05:48.544 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: False
                                                                                                                      2024-09-23 00:05:48.654 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 33.44086021505376
2024-09-23 00:05:48.656 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 43.091397849462370,  4.49it/s]
2024-09-23 00:05:48.657 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 52.23118279569893
2024-09-23 00:05:48.658 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 66.15591397849461
2024-09-23 00:05:48.659 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 66.96236559139783
2024-09-23 00:05:48.660 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 70.83333333333331
2024-09-23 00:05:48.660 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 72.44623655913976
2024-09-23 00:05:48.661 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 73.09139784946235
2024-09-23 00:05:48.662 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 74.7043010752688
2024-09-23 00:05:48.663 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 76.93548387096773
2024-09-23 00:05:48.664 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 79.48924731182797
2024-09-23 00:05:48.665 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 80.13440860215054
2024-09-23 00:05:48.665 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 80.77956989247312
2024-09-23 00:05:48.666 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 82.06989247311827
2024-09-23 00:05:48.667 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 82.06989247311827
2024-09-23 00:05:48.668 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 82.60752688172043
2024-09-23 00:05:48.669 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 84.2204301075269
2024-09-23 00:05:48.670 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 84.2204301075269
2024-09-23 00:05:48.670 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 84.2204301075269
2024-09-23 00:05:48.671 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 84.75806451612902
2024-09-23 00:05:48.672 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 84.75806451612902
2024-09-23 00:05:48.673 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 85.40322580645162
2024-09-23 00:05:48.674 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 86.20967741935485
2024-09-23 00:05:48.674 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 87.8225806451613
2024-09-23 00:05:48.675 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 87.8225806451613
2024-09-23 00:05:48.676 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 88.22580645161291
2024-09-23 00:05:48.677 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 88.22580645161291
2024-09-23 00:05:48.678 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 88.22580645161291
2024-09-23 00:05:48.679 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 88.22580645161291
2024-09-23 00:05:48.679 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 88.22580645161291
2024-09-23 00:05:48.680 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 88.22580645161291
2024-09-23 00:05:48.681 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 88.22580645161291
2024-09-23 00:05:48.682 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 88.22580645161291
2024-09-23 00:05:48.683 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 89.67741935483872
2024-09-23 00:05:48.683 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 89.67741935483872
2024-09-23 00:05:48.684 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 89.67741935483872
2024-09-23 00:05:48.685 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 92.90322580645162
2024-09-23 00:05:48.686 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 92.90322580645162
2024-09-23 00:05:48.687 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 92.90322580645162
2024-09-23 00:05:48.688 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 92.90322580645162
2024-09-23 00:05:48.688 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 94.51612903225806
2024-09-23 00:05:48.689 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 94.51612903225806
2024-09-23 00:05:48.690 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 94.51612903225806
2024-09-23 00:05:48.691 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 94.51612903225806
2024-09-23 00:05:48.692 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 94.51612903225806
2024-09-23 00:05:48.692 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 94.51612903225806
2024-09-23 00:05:48.693 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 94.91935483870968
2024-09-23 00:05:48.694 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 95.56451612903226
2024-09-23 00:05:48.695 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 95.56451612903226
2024-09-23 00:05:48.696 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 95.56451612903226
2024-09-23 00:05:48.697 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 95.56451612903226
2024-09-23 00:05:48.697 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 95.56451612903226
2024-09-23 00:05:48.698 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 95.56451612903226
2024-09-23 00:05:48.699 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 95.56451612903226
2024-09-23 00:05:48.700 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 95.56451612903226
2024-09-23 00:05:48.701 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 95.96774193548387
2024-09-23 00:05:48.701 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 95.96774193548387
2024-09-23 00:05:48.702 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 95.96774193548387
2024-09-23 00:05:48.703 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 95.96774193548387
2024-09-23 00:05:48.704 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 95.96774193548387
2024-09-23 00:05:48.705 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 95.96774193548387
2024-09-23 00:05:48.706 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 95.96774193548387
2024-09-23 00:05:48.706 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 95.96774193548387
2024-09-23 00:05:48.707 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 95.96774193548387
2024-09-23 00:05:48.708 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 95.96774193548387
2024-09-23 00:05:48.709 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 95.96774193548387
2024-09-23 00:05:48.710 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 95.96774193548387
2024-09-23 00:05:48.710 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 95.96774193548387
2024-09-23 00:05:48.711 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 95.96774193548387
2024-09-23 00:05:48.712 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 95.96774193548387
2024-09-23 00:05:48.713 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 95.96774193548387
2024-09-23 00:05:48.714 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 95.96774193548387
2024-09-23 00:05:48.714 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 95.96774193548387
2024-09-23 00:05:48.715 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 95.96774193548387
2024-09-23 00:05:48.716 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 95.96774193548387
2024-09-23 00:05:48.717 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 95.96774193548387
2024-09-23 00:05:48.718 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 95.96774193548387
2024-09-23 00:05:48.719 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 95.96774193548387
2024-09-23 00:05:48.719 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 95.96774193548387
2024-09-23 00:05:48.720 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 95.96774193548387
2024-09-23 00:05:48.721 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 95.96774193548387
2024-09-23 00:05:48.722 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 95.96774193548387
2024-09-23 00:05:48.723 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 95.96774193548387
2024-09-23 00:05:48.723 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 95.96774193548387
2024-09-23 00:05:48.724 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 95.96774193548387
2024-09-23 00:05:48.725 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 95.96774193548387
2024-09-23 00:05:48.726 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 95.96774193548387
2024-09-23 00:05:48.727 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 95.96774193548387
2024-09-23 00:05:48.728 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 95.96774193548387
2024-09-23 00:05:48.728 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 95.96774193548387
2024-09-23 00:05:48.729 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 95.96774193548387
2024-09-23 00:05:48.730 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 95.96774193548387
2024-09-23 00:05:48.731 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 95.96774193548387
2024-09-23 00:05:48.732 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 95.96774193548387
2024-09-23 00:05:48.732 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 95.96774193548387
2024-09-23 00:05:48.733 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 95.96774193548387
2024-09-23 00:05:48.734 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 95.96774193548387
2024-09-23 00:05:48.735 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 95.96774193548387
2024-09-23 00:05:48.736 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 95.96774193548387
2024-09-23 00:05:48.737 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 95.96774193548387
2024-09-23 00:05:48.738 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6345123925769087
2024-09-23 00:05:48.739 | INFO     | retrieval.model:validation_step:389 - End of validation_step
100%|████████████████████████████████████████████████████████████████████████████████| 540/540 [01:49<00:00,  4.93it/s]
                                                                                                                      2024-09-23 00:05:48.849 | INFO     | retrieval.model:validation_step:318 - Inside validation_step | 0/1 [00:00<?, ?it/s]
2024-09-23 00:05:48.871 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: False
2024-09-23 00:05:49.472 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 43.0672268907563
2024-09-23 00:05:49.475 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 53.18627450980392
2024-09-23 00:05:49.476 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 61.72969187675069
2024-09-23 00:05:49.477 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 64.70588235294117
2024-09-23 00:05:49.479 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 68.4873949579832
2024-09-23 00:05:49.480 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 69.67787114845937
2024-09-23 00:05:49.481 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 69.67787114845937
2024-09-23 00:05:49.482 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 69.67787114845937
2024-09-23 00:05:49.483 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 74.64985994397757
2024-09-23 00:05:49.484 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 78.22128851540614
2024-09-23 00:05:49.485 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 81.79271708683473
2024-09-23 00:05:49.486 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 82.00280112044818
2024-09-23 00:05:49.487 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 82.21288515406162
2024-09-23 00:05:49.489 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 85.7843137254902
2024-09-23 00:05:49.490 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 85.99439775910363
2024-09-23 00:05:49.491 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 86.20448179271708
2024-09-23 00:05:49.492 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 86.41456582633053
2024-09-23 00:05:49.493 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 86.62464985994397
2024-09-23 00:05:49.494 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 86.62464985994397
2024-09-23 00:05:49.495 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 90.19607843137256
2024-09-23 00:05:49.496 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 90.19607843137256
2024-09-23 00:05:49.497 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 90.19607843137256
2024-09-23 00:05:49.498 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 90.19607843137256
2024-09-23 00:05:49.500 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 91.98179271708683
2024-09-23 00:05:49.501 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 91.98179271708683
2024-09-23 00:05:49.502 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 92.19187675070027
2024-09-23 00:05:49.503 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 92.19187675070027
2024-09-23 00:05:49.504 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 93.97759103641457
2024-09-23 00:05:49.505 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 97.54901960784314
2024-09-23 00:05:49.506 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 97.54901960784314
2024-09-23 00:05:49.507 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 97.75910364145659
2024-09-23 00:05:49.509 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 97.75910364145659
2024-09-23 00:05:49.510 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 97.75910364145659
2024-09-23 00:05:49.511 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 97.75910364145659
2024-09-23 00:05:49.512 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 97.75910364145659
2024-09-23 00:05:49.513 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 97.75910364145659
2024-09-23 00:05:49.514 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 97.75910364145659
2024-09-23 00:05:49.515 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 97.75910364145659
2024-09-23 00:05:49.516 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 97.75910364145659
2024-09-23 00:05:49.517 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 97.75910364145659
2024-09-23 00:05:49.518 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 97.75910364145659
2024-09-23 00:05:49.520 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 97.96918767507002
2024-09-23 00:05:49.521 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 97.96918767507002
2024-09-23 00:05:49.522 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 97.96918767507002
2024-09-23 00:05:49.523 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 97.96918767507002
2024-09-23 00:05:49.524 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 97.96918767507002
2024-09-23 00:05:49.525 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 97.96918767507002
2024-09-23 00:05:49.527 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 97.96918767507002
2024-09-23 00:05:49.528 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 97.96918767507002
2024-09-23 00:05:49.529 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 97.96918767507002
2024-09-23 00:05:49.530 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 97.96918767507002
2024-09-23 00:05:49.531 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 97.96918767507002
2024-09-23 00:05:49.532 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 97.96918767507002
2024-09-23 00:05:49.533 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 97.96918767507002
2024-09-23 00:05:49.534 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 98.17927170868347
2024-09-23 00:05:49.535 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 98.17927170868347
2024-09-23 00:05:49.537 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 98.17927170868347
2024-09-23 00:05:49.538 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 98.17927170868347
2024-09-23 00:05:49.539 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 98.17927170868347
2024-09-23 00:05:49.540 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 98.17927170868347
2024-09-23 00:05:49.541 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 98.17927170868347
2024-09-23 00:05:49.542 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 98.17927170868347
2024-09-23 00:05:49.543 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 98.17927170868347
2024-09-23 00:05:49.544 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 98.17927170868347
2024-09-23 00:05:49.546 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 98.17927170868347
2024-09-23 00:05:49.547 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 98.17927170868347
2024-09-23 00:05:49.548 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 98.17927170868347
2024-09-23 00:05:49.549 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 98.17927170868347
2024-09-23 00:05:49.550 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 98.17927170868347
2024-09-23 00:05:49.551 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 98.17927170868347
2024-09-23 00:05:49.552 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 98.17927170868347
2024-09-23 00:05:49.553 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 98.17927170868347
2024-09-23 00:05:49.554 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 98.17927170868347
2024-09-23 00:05:49.555 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 98.17927170868347
2024-09-23 00:05:49.557 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 98.17927170868347
2024-09-23 00:05:49.558 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 98.17927170868347
2024-09-23 00:05:49.559 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 98.17927170868347
2024-09-23 00:05:49.560 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 98.17927170868347
2024-09-23 00:05:49.561 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 98.17927170868347
2024-09-23 00:05:49.562 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 98.17927170868347
2024-09-23 00:05:49.563 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 98.17927170868347
2024-09-23 00:05:49.564 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 98.17927170868347
2024-09-23 00:05:49.565 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 98.17927170868347
2024-09-23 00:05:49.566 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 98.17927170868347
2024-09-23 00:05:49.568 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 98.17927170868347
2024-09-23 00:05:49.569 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 98.17927170868347
2024-09-23 00:05:49.570 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 98.17927170868347
2024-09-23 00:05:49.571 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 98.17927170868347
2024-09-23 00:05:49.572 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 98.17927170868347
2024-09-23 00:05:49.573 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 98.17927170868347
2024-09-23 00:05:49.574 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 98.17927170868347
2024-09-23 00:05:49.575 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 98.17927170868347
2024-09-23 00:05:49.576 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 98.17927170868347
2024-09-23 00:05:49.578 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 98.17927170868347
2024-09-23 00:05:49.579 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 98.17927170868347
2024-09-23 00:05:49.580 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 98.17927170868347
2024-09-23 00:05:49.581 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 98.17927170868347
2024-09-23 00:05:49.582 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 98.17927170868347
2024-09-23 00:05:49.583 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 98.17927170868347
2024-09-23 00:05:49.585 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 98.17927170868347
2024-09-23 00:05:49.586 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6901642213834333
2024-09-23 00:05:49.587 | INFO     | retrieval.model:validation_step:389 - End of validation_step
2024-09-23 00:05:49.783 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 41.034188034188034
2024-09-23 00:05:49.786 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 51.31196581196581
2024-09-23 00:05:49.787 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 58.64529914529915
2024-09-23 00:05:49.788 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 60.01282051282052
2024-09-23 00:05:49.789 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 68.84615384615384
2024-09-23 00:05:49.791 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 68.84615384615384
2024-09-23 00:05:49.792 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 71.34615384615385
2024-09-23 00:05:49.793 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 72.45726495726495
2024-09-23 00:05:49.794 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 72.45726495726495
2024-09-23 00:05:49.795 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 73.82478632478633
2024-09-23 00:05:49.796 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 74.91452991452991
2024-09-23 00:05:49.797 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 74.91452991452991
2024-09-23 00:05:49.798 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 76.0042735042735
2024-09-23 00:05:49.799 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 76.0042735042735
2024-09-23 00:05:49.801 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 79.61538461538463
2024-09-23 00:05:49.802 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 79.61538461538463
2024-09-23 00:05:49.803 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 79.61538461538463
2024-09-23 00:05:49.804 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 79.61538461538463
2024-09-23 00:05:49.805 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 79.87179487179486
2024-09-23 00:05:49.806 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 80.70512820512819
2024-09-23 00:05:49.807 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 82.37179487179486
2024-09-23 00:05:49.808 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 82.37179487179486
2024-09-23 00:05:49.809 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 82.62820512820514
2024-09-23 00:05:49.810 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 82.88461538461537
2024-09-23 00:05:49.812 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 83.71794871794872
2024-09-23 00:05:49.813 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 87.05128205128204
2024-09-23 00:05:49.814 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 87.05128205128204
2024-09-23 00:05:49.815 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 87.05128205128204
2024-09-23 00:05:49.816 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 87.05128205128204
2024-09-23 00:05:49.817 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 87.05128205128204
2024-09-23 00:05:49.818 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 87.88461538461537
2024-09-23 00:05:49.819 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 87.88461538461537
2024-09-23 00:05:49.820 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 87.88461538461537
2024-09-23 00:05:49.822 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 87.88461538461537
2024-09-23 00:05:49.823 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 87.88461538461537
2024-09-23 00:05:49.824 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 88.8076923076923
2024-09-23 00:05:49.825 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 89.47435897435896
2024-09-23 00:05:49.826 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 89.47435897435896
2024-09-23 00:05:49.827 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 89.47435897435896
2024-09-23 00:05:49.828 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 89.47435897435896
2024-09-23 00:05:49.829 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 89.47435897435896
2024-09-23 00:05:49.830 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 89.47435897435896
2024-09-23 00:05:49.831 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 89.47435897435896
2024-09-23 00:05:49.833 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 89.47435897435896
2024-09-23 00:05:49.834 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 89.47435897435896
2024-09-23 00:05:49.835 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 89.73076923076924
2024-09-23 00:05:49.836 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 89.73076923076924
2024-09-23 00:05:49.837 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 89.73076923076924
2024-09-23 00:05:49.838 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 89.98717948717947
2024-09-23 00:05:49.839 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 89.98717948717947
2024-09-23 00:05:49.840 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 89.98717948717947
2024-09-23 00:05:49.841 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 89.98717948717947
2024-09-23 00:05:49.842 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 89.98717948717947
2024-09-23 00:05:49.843 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 89.98717948717947
2024-09-23 00:05:49.844 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 89.98717948717947
2024-09-23 00:05:49.846 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 89.98717948717947
2024-09-23 00:05:49.847 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 89.98717948717947
2024-09-23 00:05:49.848 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 89.98717948717947
2024-09-23 00:05:49.849 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 89.98717948717947
2024-09-23 00:05:49.850 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 89.98717948717947
2024-09-23 00:05:49.851 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 91.65384615384615
2024-09-23 00:05:49.852 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 91.65384615384615
2024-09-23 00:05:49.853 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 91.65384615384615
2024-09-23 00:05:49.854 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 91.65384615384615
2024-09-23 00:05:49.855 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 91.65384615384615
2024-09-23 00:05:49.857 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 91.65384615384615
2024-09-23 00:05:49.858 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 91.65384615384615
2024-09-23 00:05:49.859 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 91.65384615384615
2024-09-23 00:05:49.860 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 91.65384615384615
2024-09-23 00:05:49.861 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 91.65384615384615
2024-09-23 00:05:49.862 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 91.65384615384615
2024-09-23 00:05:49.863 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 91.65384615384615
2024-09-23 00:05:49.864 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 91.65384615384615
2024-09-23 00:05:49.865 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 91.65384615384615
2024-09-23 00:05:49.866 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 91.65384615384615
2024-09-23 00:05:49.868 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 91.65384615384615
2024-09-23 00:05:49.869 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 91.65384615384615
2024-09-23 00:05:49.870 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 91.65384615384615
2024-09-23 00:05:49.871 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 91.65384615384615
2024-09-23 00:05:49.872 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 91.65384615384615
2024-09-23 00:05:49.873 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 91.65384615384615
2024-09-23 00:05:49.874 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 91.65384615384615
2024-09-23 00:05:49.875 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 91.65384615384615
2024-09-23 00:05:49.876 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 91.65384615384615
2024-09-23 00:05:49.877 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 91.65384615384615
2024-09-23 00:05:49.879 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 91.65384615384615
2024-09-23 00:05:49.880 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 91.65384615384615
2024-09-23 00:05:49.881 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 93.32051282051282
2024-09-23 00:05:49.882 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 96.65384615384615
2024-09-23 00:05:49.883 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 96.65384615384615
2024-09-23 00:05:49.884 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 96.65384615384615
2024-09-23 00:05:49.885 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 96.65384615384615
2024-09-23 00:05:49.886 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 96.65384615384615
2024-09-23 00:05:49.887 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 96.65384615384615
2024-09-23 00:05:49.888 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 96.65384615384615
2024-09-23 00:05:49.890 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 96.65384615384615
2024-09-23 00:05:49.891 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 96.65384615384615
2024-09-23 00:05:49.892 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 96.65384615384615
2024-09-23 00:05:49.893 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 96.65384615384615
2024-09-23 00:05:49.894 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 96.65384615384615
2024-09-23 00:05:49.896 | INFO     | retrieval.model:validation_step:381 - MRR: 0.7174555564572141
2024-09-23 00:05:49.897 | INFO     | retrieval.model:validation_step:389 - End of validation_step
Epoch 10: 100%|█████████████████████████████████████████████████████████████| 947/947 [07:37<00:00,  2.07it/s, v_num=4][rank: 3] Metric Recall@10_val improved by 8.293 >= min_delta = 0.0. New best score: 79.008
[rank: 1] Metric Recall@10_val improved by 8.293 >= min_delta = 0.0. New best score: 79.008
[rank: 2] Metric Recall@10_val improved by 8.293 >= min_delta = 0.0. New best score: 79.008
[rank: 0] Metric Recall@10_val improved by 8.293 >= min_delta = 0.0. New best score: 79.008
Epoch 10, global step 25093: 'Recall@10_val' reached 79.00810 (best 79.00810), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambd
a_0.1_epoch=10-Recall@10_val=79.01.ckpt' as top 11
`Trainer.fit` stopped: `max_epochs=11` reached.
Epoch 10: 100%|█████████████████████████████████████████████████████████████| 947/947 [07:43<00:00,  2.04it/s, v_num=4]
2024-09-23 00:05:59.237 | INFO     | __main__:main:1680 - hit the barrier after training
2024-09-23 00:05:59.560 | INFO     | __main__:main:1680 - hit the barrier after training
2024-09-23 00:05:59.843 | INFO     | __main__:main:1680 - hit the barrier after training
2024-09-23 00:06:00.109 | INFO     | __main__:main:1680 - hit the barrier after training
2024-09-23 00:06:00.110 | INFO     | __main__:main:1686 - Finished progressive training at epoch 11
2024-09-23 00:06:00.110 | INFO     | __main__:main:1686 - Finished progressive training at epoch 11
2024-09-23 00:06:00.110 | INFO     | __main__:main:1686 - Finished progressive training at epoch 11
2024-09-23 00:06:00.110 | INFO     | __main__:main:1686 - Finished progressive training at epoch 11
2024-09-23 00:06:00.111 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a4
2a_lambda_0.1_epoch=10-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:main:1693 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=1
0-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a4
2a_lambda_0.1_epoch=10-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a4
2a_lambda_0.1_epoch=10-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a4
2a_lambda_0.1_epoch=10-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:main:1693 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=1
0-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:main:1693 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=1
0-Recall@10_val=79.01.ckpt
2024-09-23 00:06:00.111 | INFO     | __main__:main:1693 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=1
0-Recall@10_val=79.01.ckpt
2024-09-23 00:06:02.059 | INFO     | __main__:main:1702 - Testing...
2024-09-23 00:06:02.060 | INFO     | retrieval.main:run_cli:60 - PID: 3544251
2024-09-23 00:06:02.302 | INFO     | __main__:main:1702 - Testing...
2024-09-23 00:06:02.303 | INFO     | retrieval.main:run_cli:60 - PID: 3544249
[rank: 3] Seed set to 3407
2024-09-23 00:06:02.345 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2425
3d566/random
2024-09-23 00:06:02.345 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/corpus.jsonl
2024-09-23 00:06:02.512 | INFO     | __main__:main:1702 - Testing...
2024-09-23 00:06:02.513 | INFO     | retrieval.main:run_cli:60 - PID: 3544250
2024-09-23 00:06:02.613 | INFO     | __main__:main:1702 - Testing...
2024-09-23 00:06:02.615 | INFO     | retrieval.main:run_cli:60 - PID: 3533897
[rank: 2] Seed set to 3407
2024-09-23 00:06:02.698 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2425
3d566/random
2024-09-23 00:06:02.698 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-23 00:06:02.805 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2425
3d566/random
2024-09-23 00:06:02.805 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 00:06:02.996 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2425
3d566/random
2024-09-23 00:06:02.996 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/corpus.jsonl
2024-09-23 00:06:03.022 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-09-23 00:06:03.271 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-09-23 00:06:03.357 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-09-23 00:06:03.570 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-23 00:06:17.981 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 00:06:18.006 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
2024-09-23 00:06:20.232 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 00:06:20.250 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
2024-09-23 00:06:22.243 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 00:06:22.275 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
2024-09-23 00:06:23.047 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 00:06:23.072 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f
9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=79.01.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl4/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=79.01.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-23 00:06:26.181 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-23 00:06:26.182 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                 | 2/1809 [00:00<01:59, 15.18it/s]2024-09-23 00:06:26.494 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-23 00:06:26.500 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
2024-09-23 00:06:26.488 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-23 00:06:26.501 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-23 00:06:27.286 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-23 00:06:27.287 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
 95%|█████████████████████████████████████████████████████████████████████████▋    | 1710/1809 [08:59<00:36,  2.74it/s]^Z4%|█████████████████████████████████████████████████████████████████████████▌    | 1705/1809 [08:58<00:43,  2.37it/s]
[4]+  Stopped                 bash run_code3_abl4.sh
(base) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ clear
(base) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ conda activate RePRover

EnvironmentNameNotFound: Could not find conda environment: RePRover
You can list all discoverable environments with `conda info --envs`.


(base) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ conda activate ReProver
(ReProver) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ export ROOT_DIR="/data/yingzi_ma/lean_project"
export PYTHONPATH="${PYTHONPATH}:${ROOT_DIR}/ReProver"
export GITHUB_ACCESS_TOKEN="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"
export CACHE_DIR="${ROOT_DIR}/.cache/lean_dojo"
(ReProver) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ python leanagent.py
[2024-09-23 00:16:16,491] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)

MiniF2F Demo
Initializing LeanAgent...
Loading the model...
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoint_tacgen.ckpt`
2024-09-23 00:16:21.444 | INFO     | generator.model_demo:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_demo/leanagent_checkpoint.ckpt
2024-09-23 00:16:21.444 | INFO     | generator.model_demo:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_demo/leanagent_checkpoint.ckpt
2024-09-23 00:16:24.851 | INFO     | generator.model_demo:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
Model loaded!
2024-09-23 00:16:25.715 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_demo/corpus.jsonl
2024-09-23 00:16:31.667 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
Computing and caching corpus embeddings...
2024-09-23 00:16:31.668 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
 28%|████████████████████████████████████████████████████████▎                                                                                                                                                  | 1103/3976 [01:35<03:30, 13.64it/s]
 28%|████████████████████████████████████████████████████████▍                                                                                                                                                  | 1106/3976 [01:35<03:03, 15.66it/s]
 28%|████████████████████████████████████████████████████████▌                                                                                                                                                  | 1108/3976 [01:35<03:31, 13.59it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3976/3976 [05:27<00:00, 12.13it/s]
LeanAgent is ready!
2024-09-23 00:22:17.222 | INFO     | prover.proof_search_demo:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('MiniF2F/Test.le
an'), full_name='induction_12dvd4expnp1p20')
2024-09-23 00:22:58.993 | INFO     | prover.proof_search_demo:_best_first_search:149 - 3894660.416005263
2024-09-23 00:22:58.993 | INFO     | prover.proof_search_demo:_best_first_search:150 - 3894658.42867446
2024-09-23 00:22:58.993 | INFO     | prover.proof_search_demo:_best_first_search:151 - 1.9877166929654777
2024-09-23 00:22:58.993 | INFO     | prover.proof_search_demo:_best_first_search:152 - 2
2024-09-23 00:22:58.993 | INFO     | prover.proof_search_demo:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-09-23 00:23:04.087 | INFO     | prover.proof_search_demo:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('M
iniF2F/Test.lean'), full_name='induction_12dvd4expnp1p20'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=1.5810222192667425, environment_time=0.3150885081849992, total_time=2.9878907981328666, num_total_nodes=15, num_searched_nodes=0)
Proof found: False
(ReProver) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ python leanagent.py
[2024-09-23 00:23:28,189] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)

MiniF2F Demo
Initializing LeanAgent...
Loading the model...
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoint_tacgen.ckpt`
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
Model loaded!
2024-09-23 00:23:37.084 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_demo/corpus.jsonl
2024-09-23 00:23:43.157 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
Loading cached corpus embeddings...
/data/yingzi_ma/lean_project/ReProver/leanagent.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickl
e data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. Th
is limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend
 you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.model.retriever.corpus_embeddings = torch.load(CORPUS_EMBEDDINGS_CACHE)
LeanAgent is ready!
Proving Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='induction_12dvd4expnp1p20')
2024-09-23 00:24:28.003 | INFO     | prover.proof_search_demo:_best_first_search:157 - Hit the resource limit (timeout or max_expansions).
Proof found: False
(ReProver) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$ python leanagent.py
[2024-09-23 00:25:11,988] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)

MiniF2F Demo
Initializing LeanAgent...
Loading the model...
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoint_tacgen.ckpt`
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
Model loaded!
2024-09-23 00:25:25.125 | INFO     | retrieval.model:load_corpus:158 - Embeddings staled load corpus jsonl: True
Loading cached corpus embeddings...
/data/yingzi_ma/lean_project/ReProver/leanagent.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickl
e data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. Th
is limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend
 you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.model.retriever.corpus_embeddings = torch.load(CORPUS_EMBEDDINGS_CACHE)
LeanAgent is ready!
Proving Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='induction_12dvd4expnp1p20')
Hit the resource limit (timeout or max_expansions).
Proof found: False
(ReProver) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$
