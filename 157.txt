 96%|██████████████████████████████████████████████████▊  | 3194/3328 [16:54<00:59,  2.26it/s]
 96%|██████████████████████████████████████████████████▋  | 3184/3328 [16:54<01: 96%|██████████████████████████████████████████████████▉  | 3195/3328 [16:55<00: 96%|██████████████████████████████████████████████████▊  | 3189/3328 [16:55<00:53,
 2.61it/s]
 96%|██████████████████████████████████████████████████▋  | 3185/3328 [16:55<00: 96%|██████████████████████████████████████████████████▉  | 3196/3328 [16:55<00: 96%|██████████████████████████████████████████████████▊  | 3190/3328 [16:55<00: 96%
|██████████████████████████████████████████████████▊  | 3191/3328 [16:55<00:47,  2.85it/s]
 96%|██████████████████████████████████████████████████▋  | 3186/3328 [16:55<01: 96%|██████████████████████████████████████████████████▊  | 3192/3328 [16:56<00: 96%|██████████████████████████████████████████████████▉  | 3197/3328 [16:56<01: 96%
|██████████████████████████████████████████████████▊  | 3187/3328 [16:55<00:56,  2.48it/s]
 96%|██████████████████████████████████████████████████▊  | 3188/3328 [16:56<00: 96%|██████████████████████████████████████████████████▊  | 3193/3328 [16:56<00: 96%|██████████████████████████████████████████████████▉  | 3198/3328 [16:56<01: 96%
|██████████████████████████████████████████████████▊  | 3189/3328 [16:56<00: 96%|██████████████████████████████████████████████████▉  | 3199/3328 [16:57<00:53,  2.40it/s]
 96%|██████████████████████████████████████████████████▉  | 3200/3328 [16:57<00: 96%|██████████████████████████████████████████████████▊  | 3194/3328 [16:57<00:59,  2.25it/s]
 96%|██████████████████████████████████████████████████▊  | 3190/3328 [16:57<00: 96%|██████████████████████████████████████████████████▉  | 3195/3328 [16:57<00: 96%|██████████████████████████████████████████████████▊  | 3191/3328 [16:57<00: 96%
|██████████████████████████████████████████████████▉  | 3201/3328 [16:57<00:51,  2.47it/s]
 96%|██████████████████████████████████████████████████▊  | 3192/3328 [16:57<00: 96%|██████████████████████████████████████████████████▉  | 3196/3328 [16:58<00: 96%|██████████████████████████████████████████████████▉  | 3202/3328 [16:58<00:57,
 2.19it/s]
 96%|██████████████████████████████████████████████████▊  | 3193/3328 [16:58<00: 96%|██████████████████████████████████████████████████▉  | 3197/3328 [16:58<01:02,  2.10it/s]
 96%|███████████████████████████████████████████████████  | 3204/3328 [16:58<00: 96%|██████████████████████████████████████████████████▊  | 3194/3328 [16:58<00: 96%|██████████████████████████████████████████████████▉  | 3198/3328 [16:59<01: 96%
|██████████████████████████████████████████████████▉  | 3195/3328 [16:59<00:54,  2.46it/s]
 96%|██████████████████████████████████████████████████▉  | 3199/3328 [16:59<00: 96%|███████████████████████████████████████████████████  | 3205/3328 [16:59<00: 96%|██████████████████████████████████████████████████▉  | 3200/3328 [16:59<00:44,
 2.89it/s]
 96%|███████████████████████████████████████████████████  | 3206/3328 [16:59<00:49,  2.44it/s]
 96%|██████████████████████████████████████████████████▉  | 3196/3328 [16:59<00: 96%|██████████████████████████████████████████████████▉  | 3201/3328 [17:00<00: 96%|███████████████████████████████████████████████████  | 3207/3328 [17:00<00:54,
 2.24it/s]
 96%|██████████████████████████████████████████████████▉  | 3197/3328 [17:00<01:02,  2.09it/s]
 95%|██████████████████████████████████████████████████▌  | 3176/3328 [16:59<00: 96%|██████████████████████████████████████████████████▉  | 3202/3328 [17:00<00: 96%|███████████████████████████████████████████████████  | 3208/3328 [17:00<00:54,
 2.20it/s]
 96%|██████████████████████████████████████████████████▉  | 3198/3328 [17:00<01: 96%|██████████████████████████████████████████████████▉  | 3199/3328 [17:00<00: 96%|███████████████████████████████████████████████████  | 3204/3328 [17:01<00: 96%
|███████████████████████████████████████████████████  | 3209/3328 [17:01<00: 96%|██████████████████████████████████████████████████▉  | 3200/3328 [17:01<00:44,  2.88it/s]
 96%|███████████████████████████████████████████████████  | 3210/3328 [17:01<00: 96%|███████████████████████████████████████████████████  | 3205/3328 [17:01<00: 96%|██████████████████████████████████████████████████▉  | 3201/3328 [17:01<00:51,
 2.46it/s]
 96%|███████████████████████████████████████████████████  | 3206/3328 [17:02<00:50,  2.43it/s]
 96%|███████████████████████████████████████████████████▏ | 3211/3328 [17:02<00:58,  1.99it/s]
 96%|██████████████████████████████████████████████████▉  | 3202/3328 [17:02<00: 97%|███████████████████████████████████████████████████▏ | 3212/3328 [17:02<00: 96%|███████████████████████████████████████████████████  | 3207/3328 [17:02<00:54,
 2.23it/s]
 96%|███████████████████████████████████████████████████  | 3204/3328 [17:02<00: 97%|███████████████████████████████████████████████████▏ | 3213/3328 [17:03<00: 96%|███████████████████████████████████████████████████  | 3208/3328 [17:03<00:54,
 2.20it/s]
 96%|███████████████████████████████████████████████████  | 3205/3328 [17:03<00: 97%|███████████████████████████████████████████████████▏ | 3214/3328 [17:03<00: 96%|███████████████████████████████████████████████████  | 3209/3328 [17:03<00:57,
 2.08it/s]
 96%|███████████████████████████████████████████████████  | 3206/3328 [17:03<00: 96%|███████████████████████████████████████████████████  | 3210/3328 [17:04<00: 97%|███████████████████████████████████████████████████▏ | 3215/3328 [17:04<00:57,
 1.96it/s]
 96%|███████████████████████████████████████████████████  | 3207/3328 [17:04<00:54,  2.23it/s]
 96%|███████████████████████████████████████████████████▏ | 3211/3328 [17:04<00: 97%|███████████████████████████████████████████████████▏ | 3216/3328 [17:04<00: 96%|███████████████████████████████████████████████████  | 3208/3328 [17:04<00:54,
 2.20it/s]
 97%|███████████████████████████████████████████████████▏ | 3212/3328 [17:05<00: 97%|███████████████████████████████████████████████████▏ | 3217/3328 [17:05<00:53,  2.07it/s]
 96%|███████████████████████████████████████████████████  | 3209/3328 [17:05<00: 97%|███████████████████████████████████████████████████▏ | 3213/3328 [17:05<00: 97%|███████████████████████████████████████████████████▏ | 3218/3328 [17:05<00:55,
 2.00it/s]
 96%|███████████████████████████████████████████████████  | 3210/3328 [17:05<00:57,  2.05it/s]
 97%|███████████████████████████████████████████████████▏ | 3214/3328 [17:06<00: 97%|███████████████████████████████████████████████████▎ | 3219/3328 [17:06<00:55,  1.95it/s]
 96%|███████████████████████████████████████████████████▏ | 3211/3328 [17:06<00: 97%|███████████████████████████████████████████████████▏ | 3215/3328 [17:06<00: 97%|███████████████████████████████████████████████████▎ | 3220/3328 [17:06<00: 97%
|███████████████████████████████████████████████████▏ | 3212/3328 [17:06<00:52,  2.22it/s]
 97%|███████████████████████████████████████████████████▎ | 3221/3328 [17:07<00: 97%|███████████████████████████████████████████████████▏ | 3216/3328 [17:07<00: 97%|███████████████████████████████████████████████████▏ | 3213/3328 [17:07<00: 97%
|███████████████████████████████████████████████████▎ | 3222/3328 [17:07<00:44,  2.39it/s]
 97%|███████████████████████████████████████████████████▏ | 3217/3328 [17:07<00:53,  2.07it/s]
 97%|███████████████████████████████████████████████████▏ | 3214/3328 [17:07<00: 97%|███████████████████████████████████████████████████▎ | 3223/3328 [17:08<00: 97%|███████████████████████████████████████████████████▏ | 3218/3328 [17:08<00: 97%
|███████████████████████████████████████████████████▎ | 3224/3328 [17:08<00:41,  2.50it/s]
 97%|███████████████████████████████████████████████████▏ | 3215/3328 [17:08<00: 97%|███████████████████████████████████████████████████▎ | 3219/3328 [17:08<00: 97%|███████████████████████████████████████████████████▎ | 3225/3328 [17:09<00:45,
 2.26it/s]
 97%|███████████████████████████████████████████████████▏ | 3216/3328 [17:08<00: 97%|███████████████████████████████████████████████████▎ | 3220/3328 [17:09<00: 97%|███████████████████████████████████████████████████▍ | 3226/3328 [17:09<00: 97%
|███████████████████████████████████████████████████▏ | 3217/3328 [17:09<00:53,  2.06it/s]
 97%|███████████████████████████████████████████████████▎ | 3221/3328 [17:09<00: 97%|███████████████████████████████████████████████████▍ | 3227/3328 [17:09<00:44,  2.26it/s]
 96%|██████████████████████████████████████████████████▉  | 3199/3328 [17:08<00: 97%|███████████████████████████████████████████████████▎ | 3222/3328 [17:10<00: 97%|███████████████████████████████████████████████████▏ | 3218/3328 [17:09<00: 97%
|███████████████████████████████████████████████████▍ | 3228/3328 [17:10<00:47,  2.11it/s]
 97%|███████████████████████████████████████████████████▎ | 3223/3328 [17:10<00: 97%|███████████████████████████████████████████████████▎ | 3219/3328 [17:10<00: 97%|███████████████████████████████████████████████████▎ | 3224/3328 [17:10<00: 97%
|███████████████████████████████████████████████████▍ | 3229/3328 [17:10<00:48,  2.02it/s]
 97%|███████████████████████████████████████████████████▎ | 3220/3328 [17:10<00: 97%|███████████████████████████████████████████████████▎ | 3225/3328 [17:11<00: 97%|███████████████████████████████████████████████████▍ | 3230/3328 [17:11<00: 97%
|███████████████████████████████████████████████████▎ | 3221/3328 [17:11<00:52,  2.02it/s]
 97%|███████████████████████████████████████████████████▍ | 3226/3328 [17:11<00: 97%|███████████████████████████████████████████████████▎ | 3222/3328 [17:11<00: 97%|███████████████████████████████████████████████████▍ | 3231/3328 [17:12<00: 97%
|███████████████████████████████████████████████████▍ | 3227/3328 [17:12<00:44,  2.25it/s]
 97%|███████████████████████████████████████████████████▎ | 3223/3328 [17:12<00: 97%|███████████████████████████████████████████████████▍ | 3232/3328 [17:12<00: 97%|███████████████████████████████████████████████████▎ | 3224/3328 [17:12<00:41,
 2.49it/s]
 97%|███████████████████████████████████████████████████▍ | 3228/3328 [17:12<00: 97%|███████████████████████████████████████████████████▍ | 3233/3328 [17:13<00: 97%|███████████████████████████████████████████████████▎ | 3225/3328 [17:12<00:45,
 2.25it/s]
 97%|███████████████████████████████████████████████████▍ | 3229/3328 [17:13<00: 97%|███████████████████████████████████████████████████▌ | 3234/3328 [17:13<00: 97%|███████████████████████████████████████████████████▍ | 3226/3328 [17:13<00:46,
 2.21it/s]
 97%|███████████████████████████████████████████████████▍ | 3230/3328 [17:13<00: 97%|███████████████████████████████████████████████████▌ | 3235/3328 [17:14<00: 97%|███████████████████████████████████████████████████▍ | 3227/3328 [17:13<00:44,
 2.25it/s]
 97%|███████████████████████████████████████████████████▍ | 3231/3328 [17:14<00: 97%|███████████████████████████████████████████████████▌ | 3236/3328 [17:14<00: 97%|███████████████████████████████████████████████████▍ | 3228/3328 [17:14<00:47,
 2.10it/s]
 97%|███████████████████████████████████████████████████▍ | 3232/3328 [17:15<00: 97%|███████████████████████████████████████████████████▌ | 3237/3328 [17:15<00: 97%|███████████████████████████████████████████████████▍ | 3229/3328 [17:14<00:49,
 2.01it/s]
 97%|███████████████████████████████████████████████████▍ | 3233/3328 [17:15<00:48,  1.96it/s]
 97%|███████████████████████████████████████████████████▌ | 3238/3328 [17:15<00: 97%|███████████████████████████████████████████████████▍ | 3230/3328 [17:15<00: 97%|███████████████████████████████████████████████████▌ | 3234/3328 [17:16<00:49,
 1.92it/s]
 97%|███████████████████████████████████████████████████▌ | 3239/3328 [17:16<00: 97%|███████████████████████████████████████████████████▍ | 3231/3328 [17:16<00: 97%|███████████████████████████████████████████████████▌ | 3235/3328 [17:16<00:49,
 1.89it/s]
 97%|███████████████████████████████████████████████████▌ | 3240/3328 [17:16<00: 97%|███████████████████████████████████████████████████▍ | 3232/3328 [17:16<00: 97%|███████████████████████████████████████████████████▌ | 3236/3328 [17:17<00:49,
 1.87it/s]
 97%|███████████████████████████████████████████████████▍ | 3233/3328 [17:17<00: 97%|███████████████████████████████████████████████████▌ | 3241/3328 [17:17<00: 97%|███████████████████████████████████████████████████▌ | 3237/3328 [17:17<00: 97%
|███████████████████████████████████████████████████▋ | 3242/3328 [17:17<00:40,  2.13it/s]
 97%|███████████████████████████████████████████████████▌ | 3234/3328 [17:17<00: 97%|███████████████████████████████████████████████████▋ | 3243/3328 [17:17<00: 97%|███████████████████████████████████████████████████▌ | 3238/3328 [17:18<00:48,
 1.85it/s]
 97%|███████████████████████████████████████████████████▋ | 3244/3328 [17:18<00: 97%|███████████████████████████████████████████████████▌ | 3235/3328 [17:18<00: 97%|███████████████████████████████████████████████████▌ | 3239/3328 [17:18<00:48,
 1.85it/s]
 98%|███████████████████████████████████████████████████▋ | 3245/3328 [17:18<00: 97%|███████████████████████████████████████████████████▌ | 3236/3328 [17:18<00: 97%|███████████████████████████████████████████████████▌ | 3240/3328 [17:19<00:47,
 1.84it/s]
 98%|███████████████████████████████████████████████████▋ | 3246/3328 [17:19<00: 97%|███████████████████████████████████████████████████▌ | 3237/3328 [17:19<00: 97%|███████████████████████████████████████████████████▌ | 3241/3328 [17:19<00:47,
 1.84it/s]
 98%|███████████████████████████████████████████████████▋ | 3247/3328 [17:20<00: 97%|███████████████████████████████████████████████████▌ | 3238/3328 [17:19<00: 97%|███████████████████████████████████████████████████▋ | 3242/3328 [17:20<00:40,
 2.12it/s]
 97%|███████████████████████████████████████████████████▋ | 3243/3328 [17:20<00: 98%|███████████████████████████████████████████████████▋ | 3248/3328 [17:20<00:40,  1.98it/s]
 97%|███████████████████████████████████████████████████▌ | 3239/3328 [17:20<00: 97%|███████████████████████████████████████████████████▋ | 3244/3328 [17:20<00: 98%|███████████████████████████████████████████████████▋ | 3249/3328 [17:21<00:40,
 1.94it/s]
 97%|███████████████████████████████████████████████████▌ | 3240/3328 [17:20<00: 98%|███████████████████████████████████████████████████▊ | 3250/3328 [17:21<00: 98%|███████████████████████████████████████████████████▋ | 3245/3328 [17:21<00:35,
 2.32it/s]
 97%|███████████████████████████████████████████████████▌ | 3241/3328 [17:21<00: 98%|███████████████████████████████████████████████████▊ | 3251/3328 [17:21<00: 98%|███████████████████████████████████████████████████▋ | 3246/3328 [17:21<00:38,
 2.15it/s]
 97%|███████████████████████████████████████████████████▋ | 3242/3328 [17:21<00: 97%|███████████████████████████████████████████████████▋ | 3243/3328 [17:21<00: 98%|███████████████████████████████████████████████████▊ | 3252/3328 [17:22<00:37,
 2.02it/s]
 98%|███████████████████████████████████████████████████▋ | 3247/3328 [17:22<00: 97%|███████████████████████████████████████████████████▋ | 3244/3328 [17:22<00:36,  2.30it/s]
 98%|███████████████████████████████████████████████████▊ | 3253/3328 [17:22<00: 98%|███████████████████████████████████████████████████▋ | 3248/3328 [17:22<00: 98%|███████████████████████████████████████████████████▋ | 3245/3328 [17:22<00:35,
 2.32it/s]
 98%|███████████████████████████████████████████████████▊ | 3254/3328 [17:23<00: 98%|███████████████████████████████████████████████████▋ | 3249/3328 [17:23<00: 98%|███████████████████████████████████████████████████▋ | 3246/3328 [17:23<00: 98%
|███████████████████████████████████████████████████▊ | 3255/3328 [17:23<00: 98%|███████████████████████████████████████████████████▊ | 3250/3328 [17:23<00: 98%|███████████████████████████████████████████████████▊ | 3256/3328 [17:23<00:26,  2.7
4it/s]
 98%|███████████████████████████████████████████████████▋ | 3247/3328 [17:24<00: 98%|███████████████████████████████████████████████████▊ | 3251/3328 [17:24<00: 98%|███████████████████████████████████████████████████▊ | 3257/3328 [17:24<00:29,
 2.38it/s]
 98%|███████████████████████████████████████████████████▉ | 3258/3328 [17:24<00: 98%|███████████████████████████████████████████████████▋ | 3248/3328 [17:24<00: 98%|███████████████████████████████████████████████████▊ | 3252/3328 [17:24<00:37,
 2.02it/s]
 98%|███████████████████████████████████████████████████▉ | 3259/3328 [17:25<00: 98%|███████████████████████████████████████████████████▋ | 3249/3328 [17:25<00: 98%|███████████████████████████████████████████████████▊ | 3253/3328 [17:25<00:38,
 1.96it/s]
 98%|███████████████████████████████████████████████████▊ | 3250/3328 [17:25<00: 98%|███████████████████████████████████████████████████▉ | 3260/3328 [17:25<00: 98%|███████████████████████████████████████████████████▊ | 3254/3328 [17:25<00:38,
 1.92it/s]
 98%|███████████████████████████████████████████████████▊ | 3251/3328 [17:25<00: 98%|███████████████████████████████████████████████████▉ | 3261/3328 [17:26<00: 98%|███████████████████████████████████████████████████▊ | 3255/3328 [17:26<00: 98%
|███████████████████████████████████████████████████▊ | 3256/3328 [17:26<00: 98%|███████████████████████████████████████████████████▉ | 3262/3328 [17:26<00:28,  2.29it/s]
 98%|███████████████████████████████████████████████████▊ | 3252/3328 [17:26<00: 98%|███████████████████████████████████████████████████▉ | 3263/3328 [17:26<00: 98%|███████████████████████████████████████████████████▊ | 3257/3328 [17:26<00: 98%
|███████████████████████████████████████████████████▉ | 3264/3328 [17:27<00: 98%|███████████████████████████████████████████████████▉ | 3258/3328 [17:27<00:24,  2.85it/s]
 98%|███████████████████████████████████████████████████▉ | 3265/3328 [17:27<00: 98%|███████████████████████████████████████████████████▊ | 3253/3328 [17:27<00: 98%|███████████████████████████████████████████████████▉ | 3259/3328 [17:27<00:28,
 2.44it/s]
 98%|████████████████████████████████████████████████████ | 3266/3328 [17:27<00: 98%|███████████████████████████████████████████████████▊ | 3254/3328 [17:27<00: 98%|███████████████████████████████████████████████████▊ | 3255/3328 [17:27<00: 98%
|███████████████████████████████████████████████████▉ | 3260/3328 [17:28<00:28,  2.38it/s]
 98%|███████████████████████████████████████████████████▊ | 3256/3328 [17:28<00: 98%|████████████████████████████████████████████████████ | 3267/3328 [17:28<00: 98%|███████████████████████████████████████████████████▉ | 3261/3328 [17:28<00: 98%
|███████████████████████████████████████████████████▊ | 3257/3328 [17:28<00:29,  2.38it/s]
 98%|████████████████████████████████████████████████████ | 3268/3328 [17:28<00: 98%|███████████████████████████████████████████████████▉ | 3258/3328 [17:28<00: 98%|███████████████████████████████████████████████████▉ | 3262/3328 [17:29<00: 98%
|████████████████████████████████████████████████████ | 3269/3328 [17:29<00: 98%|███████████████████████████████████████████████████▉ | 3263/3328 [17:29<00:24,  2.67it/s]
 98%|███████████████████████████████████████████████████▉ | 3264/3328 [17:29<00: 98%|████████████████████████████████████████████████████ | 3270/3328 [17:29<00: 98%|███████████████████████████████████████████████████▉ | 3259/3328 [17:29<00: 98%
|███████████████████████████████████████████████████▉ | 3265/3328 [17:29<00: 98%|████████████████████████████████████████████████████ | 3271/3328 [17:29<00:20,  2.77it/s]
 98%|███████████████████████████████████████████████████▉ | 3260/3328 [17:29<00: 98%|████████████████████████████████████████████████████ | 3266/3328 [17:30<00: 98%|████████████████████████████████████████████████████ | 3272/3328 [17:30<00:23,
 2.40it/s]
 98%|███████████████████████████████████████████████████▉ | 3261/3328 [17:30<00: 98%|████████████████████████████████████████████████████ | 3273/3328 [17:30<00:23,  2.38it/s]
 98%|████████████████████████████████████████████████████ | 3267/3328 [17:30<00: 98%|███████████████████████████████████████████████████▉ | 3262/3328 [17:30<00:28,  2.28it/s]
 98%|████████████████████████████████████████████████████▏| 3274/3328 [17:31<00: 98%|███████████████████████████████████████████████████▉ | 3263/3328 [17:30<00: 98%|███████████████████████████████████████████████████▉ | 3264/3328 [17:31<00: 98%
|████████████████████████████████████████████████████ | 3268/3328 [17:31<00:27,  2.15it/s]
 98%|███████████████████████████████████████████████████▉ | 3265/3328 [17:31<00: 98%|████████████████████████████████████████████████████▏| 3275/3328 [17:31<00: 98%|████████████████████████████████████████████████████ | 3269/3328 [17:31<00:25,
 2.31it/s]
 98%|████████████████████████████████████████████████████ | 3270/3328 [17:32<00: 98%|████████████████████████████████████████████████████ | 3266/3328 [17:31<00: 98%|████████████████████████████████████████████████████▏| 3276/3328 [17:32<00: 98%
|████████████████████████████████████████████████████ | 3271/3328 [17:32<00:20,  2.76it/s]
 98%|████████████████████████████████████████████████████▏| 3277/3328 [17:32<00: 98%|████████████████████████████████████████████████████ | 3267/3328 [17:32<00: 98%|████████████████████████████████████████████████████ | 3272/3328 [17:32<00:23,
 2.40it/s]
 98%|████████████████████████████████████████████████████▏| 3278/3328 [17:33<00: 98%|████████████████████████████████████████████████████ | 3268/3328 [17:32<00: 98%|████████████████████████████████████████████████████ | 3273/3328 [17:33<00: 98%
|████████████████████████████████████████████████████ | 3269/3328 [17:33<00:25,  2.31it/s]
 99%|████████████████████████████████████████████████████▏| 3279/3328 [17:33<00: 98%|████████████████████████████████████████████████████▏| 3274/3328 [17:33<00: 99%|████████████████████████████████████████████████████▏| 3280/3328 [17:33<00: 98%
|████████████████████████████████████████████████████ | 3270/3328 [17:33<00: 98%|████████████████████████████████████████████████████▏| 3275/3328 [17:34<00:21,  2.42it/s]
 98%|████████████████████████████████████████████████████ | 3271/3328 [17:33<00: 99%|████████████████████████████████████████████████████▎| 3281/3328 [17:34<00:20,  2.26it/s]
 98%|████████████████████████████████████████████████████▏| 3276/3328 [17:34<00: 98%|████████████████████████████████████████████████████ | 3272/3328 [17:34<00: 99%|████████████████████████████████████████████████████▎| 3282/3328 [17:34<00:21,
 2.11it/s]
 98%|████████████████████████████████████████████████████▏| 3277/3328 [17:35<00: 98%|████████████████████████████████████████████████████ | 3273/3328 [17:34<00: 99%|████████████████████████████████████████████████████▎| 3283/3328 [17:35<00:22,
 2.02it/s]
 98%|████████████████████████████████████████████████████▏| 3274/3328 [17:35<00: 98%|████████████████████████████████████████████████████▏| 3278/3328 [17:35<00: 98%|████████████████████████████████████████████████████▏| 3275/3328 [17:35<00: 99%
|████████████████████████████████████████████████████▎| 3284/3328 [17:36<00:22,  1.96it/s]
 99%|████████████████████████████████████████████████████▏| 3279/3328 [17:36<00: 99%|████████████████████████████████████████████████████▏| 3280/3328 [17:36<00: 99%|████████████████████████████████████████████████████▎| 3285/3328 [17:36<00: 98%
|████████████████████████████████████████████████████▏| 3276/3328 [17:36<00:23,  2.20it/s]
 99%|████████████████████████████████████████████████████▎| 3281/3328 [17:36<00:20,  2.26it/s]
 99%|████████████████████████████████████████████████████▎| 3286/3328 [17:37<00: 98%|████████████████████████████████████████████████████▏| 3277/3328 [17:36<00: 99%|████████████████████████████████████████████████████▎| 3287/3328 [17:37<00:15,
 2.56it/s]
 99%|████████████████████████████████████████████████████▎| 3282/3328 [17:37<00: 98%|████████████████████████████████████████████████████▏| 3278/3328 [17:37<00: 99%|████████████████████████████████████████████████████▎| 3288/3328 [17:37<00:16,
 2.38it/s]
 99%|████████████████████████████████████████████████████▍| 3289/3328 [17:37<00:14,  2.73it/s]
 99%|████████████████████████████████████████████████████▎| 3283/3328 [17:37<00: 99%|████████████████████████████████████████████████████▏| 3279/3328 [17:37<00: 99%|████████████████████████████████████████████████████▏| 3280/3328 [17:37<00: 99%
|████████████████████████████████████████████████████▍| 3290/3328 [17:38<00:15,  2.38it/s]
 99%|████████████████████████████████████████████████████▎| 3284/3328 [17:38<00: 99%|████████████████████████████████████████████████████▍| 3291/3328 [17:38<00: 99%|████████████████████████████████████████████████████▎| 3281/3328 [17:38<00:20,
 2.25it/s]
 99%|████████████████████████████████████████████████████▎| 3285/3328 [17:38<00: 99%|████████████████████████████████████████████████████▍| 3292/3328 [17:39<00: 99%|████████████████████████████████████████████████████▎| 3282/3328 [17:39<00:21,
 2.11it/s]
 99%|████████████████████████████████████████████████████▎| 3286/3328 [17:39<00: 99%|████████████████████████████████████████████████████▍| 3293/3328 [17:39<00: 99%|████████████████████████████████████████████████████▎| 3287/3328 [17:39<00:16,
 2.56it/s]
 99%|████████████████████████████████████████████████████▎| 3283/3328 [17:39<00: 99%|████████████████████████████████████████████████████▍| 3295/3328 [17:39<00:09,  3.46it/s]
 99%|████████████████████████████████████████████████████▎| 3288/3328 [17:40<00:16,  2.37it/s]
 99%|████████████████████████████████████████████████████▍| 3289/3328 [17:40<00: 99%|████████████████████████████████████████████████████▎| 3284/3328 [17:40<00:22,  1.96it/s]
 99%|████████████████████████████████████████████████████▍| 3296/3328 [17:40<00: 99%|████████████████████████████████████████████████████▎| 3285/3328 [17:40<00: 99%|████████████████████████████████████████████████████▌| 3297/3328 [17:40<00: 99%
|████████████████████████████████████████████████████▍| 3290/3328 [17:40<00:16,  2.37it/s]
 99%|████████████████████████████████████████████████████▍| 3291/3328 [17:41<00: 99%|████████████████████████████████████████████████████▎| 3286/3328 [17:41<00: 99%|████████████████████████████████████████████████████▌| 3298/3328 [17:41<00: 99%
|████████████████████████████████████████████████████▎| 3287/3328 [17:41<00:16,  2.55it/s]
 99%|████████████████████████████████████████████████████▌| 3299/3328 [17:41<00: 99%|████████████████████████████████████████████████████▍| 3292/3328 [17:41<00: 99%|████████████████████████████████████████████████████▌| 3300/3328 [17:42<00: 99%
|████████████████████████████████████████████████████▎| 3288/3328 [17:41<00: 99%|████████████████████████████████████████████████████▍| 3293/3328 [17:42<00:13,  2.60it/s]
 99%|████████████████████████████████████████████████████▍| 3289/3328 [17:41<00: 99%|████████████████████████████████████████████████████▍| 3295/3328 [17:42<00:09,  3.45it/s]
 99%|████████████████████████████████████████████████████▌| 3301/3328 [17:42<00:10,  2.49it/s]
 99%|████████████████████████████████████████████████████▍| 3290/3328 [17:42<00: 99%|████████████████████████████████████████████████████▍| 3296/3328 [17:42<00: 99%|████████████████████████████████████████████████████▌| 3302/3328 [17:43<00:11,
 2.26it/s]
 99%|████████████████████████████████████████████████████▍| 3291/3328 [17:42<00: 99%|████████████████████████████████████████████████████▌| 3303/3328 [17:43<00: 99%|████████████████████████████████████████████████████▌| 3297/3328 [17:43<00:11,
 2.72it/s]
 99%|████████████████████████████████████████████████████▍| 3292/3328 [17:43<00: 99%|████████████████████████████████████████████████████▌| 3304/3328 [17:43<00: 99%|████████████████████████████████████████████████████▌| 3298/3328 [17:43<00: 99%
|████████████████████████████████████████████████████▍| 3293/3328 [17:43<00:13,  2.60it/s]
 99%|████████████████████████████████████████████████████▍| 3295/3328 [17:44<00: 99%|████████████████████████████████████████████████████▌| 3299/3328 [17:44<00: 99%|████████████████████████████████████████████████████▋| 3305/3328 [17:44<00:10,
 2.17it/s]
 99%|████████████████████████████████████████████████████▌| 3300/3328 [17:44<00: 99%|████████████████████████████████████████████████████▍| 3296/3328 [17:44<00:11,  2.83it/s]
 99%|████████████████████████████████████████████████████▋| 3306/3328 [17:44<00: 99%|████████████████████████████████████████████████████▌| 3301/3328 [17:45<00: 99%|████████████████████████████████████████████████████▋| 3307/3328 [17:45<00: 99%
|████████████████████████████████████████████████████▌| 3297/3328 [17:44<00:11,  2.71it/s]
 99%|████████████████████████████████████████████████████▌| 3302/3328 [17:45<00: 99%|████████████████████████████████████████████████████▋| 3308/3328 [17:45<00: 99%|████████████████████████████████████████████████████▌| 3303/3328 [17:45<00: 99%
|████████████████████████████████████████████████████▌| 3298/3328 [17:45<00:12,  2.40it/s]
 99%|████████████████████████████████████████████████████▋| 3309/3328 [17:46<00: 99%|████████████████████████████████████████████████████▌| 3299/3328 [17:45<00: 99%|████████████████████████████████████████████████████▌| 3304/3328 [17:46<00: 99%
|████████████████████████████████████████████████████▌| 3300/3328 [17:46<00:09,  2.88it/s]
 99%|████████████████████████████████████████████████████▋| 3310/3328 [17:46<00: 99%|████████████████████████████████████████████████████▋| 3305/3328 [17:46<00: 99%|████████████████████████████████████████████████████▌| 3301/3328 [17:46<00:10,
 2.48it/s]
 99%|████████████████████████████████████████████████████▋| 3311/3328 [17:47<00:07,  2.29it/s]
 99%|████████████████████████████████████████████████████▋| 3306/3328 [17:47<00: 99%|████████████████████████████████████████████████████▌| 3302/3328 [17:47<00:100%|████████████████████████████████████████████████████▋| 3312/3328 [17:47<00: 99%
|████████████████████████████████████████████████████▋| 3307/3328 [17:47<00:08,  2.50it/s]
 99%|████████████████████████████████████████████████████▌| 3303/3328 [17:47<00:100%|████████████████████████████████████████████████████▊| 3313/3328 [17:48<00: 99%|████████████████████████████████████████████████████▋| 3308/3328 [17:48<00:08,
 2.26it/s]
 99%|████████████████████████████████████████████████████▌| 3304/3328 [17:47<00:100%|████████████████████████████████████████████████████▊| 3314/3328 [17:48<00: 99%|████████████████████████████████████████████████████▋| 3309/3328 [17:48<00:09,
 2.11it/s]
 99%|████████████████████████████████████████████████████▋| 3305/3328 [17:48<00:100%|████████████████████████████████████████████████████▊| 3315/3328 [17:48<00: 99%|████████████████████████████████████████████████████▋| 3310/3328 [17:49<00:100%
|████████████████████████████████████████████████████▊| 3316/3328 [17:49<00:05,  2.40it/s]
 99%|████████████████████████████████████████████████████▋| 3306/3328 [17:49<00: 99%|████████████████████████████████████████████████████▋| 3307/3328 [17:49<00: 99%|████████████████████████████████████████████████████▋| 3311/3328 [17:49<00:07,
 2.29it/s]
100%|████████████████████████████████████████████████████▊| 3317/3328 [17:49<00:100%|████████████████████████████████████████████████████▊| 3318/3328 [17:50<00: 99%|████████████████████████████████████████████████████▋| 3308/3328 [17:49<00:100%
|████████████████████████████████████████████████████▋| 3312/3328 [17:50<00:100%|████████████████████████████████████████████████████▊| 3319/3328 [17:50<00:02,  3.20it/s]
 99%|████████████████████████████████████████████████████▎| 3286/3328 [17:48<00: 99%|████████████████████████████████████████████████████▋| 3309/3328 [17:50<00:100%|████████████████████████████████████████████████████▊| 3313/3328 [17:50<00:100%
|████████████████████████████████████████████████████▊| 3320/3328 [17:50<00:03,  2.62it/s]
 99%|████████████████████████████████████████████████████▎| 3288/3328 [17:49<00: 99%|████████████████████████████████████████████████████▋| 3310/3328 [17:50<00:100%|████████████████████████████████████████████████████▊| 3314/3328 [17:51<00:100%
|████████████████████████████████████████████████████▉| 3321/3328 [17:51<00:100%|████████████████████████████████████████████████████▊| 3315/3328 [17:51<00: 99%|████████████████████████████████████████████████████▋| 3311/3328 [17:51<00:07,  2.2
8it/s]
100%|████████████████████████████████████████████████████▉| 3322/3328 [17:51<00:100%|████████████████████████████████████████████████████▊| 3316/3328 [17:51<00:100%|████████████████████████████████████████████████████▋| 3312/3328 [17:51<00:07,
 2.13it/s]
100%|████████████████████████████████████████████████████▉| 3323/3328 [17:52<00:100%|████████████████████████████████████████████████████▊| 3317/3328 [17:52<00:100%|████████████████████████████████████████████████████▊| 3318/3328 [17:52<00:100%
|████████████████████████████████████████████████████▊| 3313/3328 [17:52<00:07,  2.03it/s]
100%|████████████████████████████████████████████████████▊| 3319/3328 [17:52<00:02,  3.20it/s]
100%|████████████████████████████████████████████████████▉| 3325/3328 [17:53<00:100%|████████████████████████████████████████████████████▊| 3314/3328 [17:52<00:07,  1.96it/s]
100%|████████████████████████████████████████████████████▊| 3320/3328 [17:53<00:100%|████████████████████████████████████████████████████▊| 3315/3328 [17:53<00:100%|████████████████████████████████████████████████████▉| 3326/3328 [17:53<00:100%
|████████████████████████████████████████████████████▊| 3316/3328 [17:53<00:05,  2.39it/s]
100%|████████████████████████████████████████████████████▉| 3321/3328 [17:53<00:100%|████████████████████████████████████████████████████▉| 3327/3328 [17:54<00:00,  2.13it/s]
100%|████████████████████████████████████████████████████▊| 3317/3328 [17:54<00:100%|████████████████████████████████████████████████████▉| 3322/3328 [17:54<00:100%|████████████████████████████████████████████████████▊| 3318/3328 [17:54<00:100%
|█████████████████████████████████████████████████████| 3328/3328 [17:54<00:100%|█████████████████████████████████████████████████████| 3328/3328 [17:54<00:00,  3.10it/s]
100%|████████████████████████████████████████████████████▊| 3319/3328 [17:54<00:02,  3.19it/s]
100%|████████████████████████████████████████████████████▉| 3323/3328 [17:54<00:02,  2.04it/s]
100%|████████████████████████████████████████████████████▊| 3320/3328 [17:54<00:03,  2.61it/s]
100%|████████████████████████████████████████████████████▉| 3325/3328 [17:55<00:100%|████████████████████████████████████████████████████▉| 3321/3328 [17:55<00:03,  2.31it/s]
100%|████████████████████████████████████████████████████▉| 3326/3328 [17:56<00:100%|████████████████████████████████████████████████████▉| 3322/3328 [17:56<00:02,  2.14it/s]
100%|████████████████████████████████████████████████████▉| 3327/3328 [17:56<00:00,  2.13it/s]
100%|████████████████████████████████████████████████████▉| 3323/3328 [17:56<00:100%|█████████████████████████████████████████████████████| 3328/3328 [17:57<00:100%|█████████████████████████████████████████████████████| 3328/3328 [17:57<00:00,
 3.09it/s]

100%|████████████████████████████████████████████████████▉| 3325/3328 [17:57<00:01,  2.43it/s]
100%|████████████████████████████████████████████████████▉| 3326/3328 [17:57<00:00,  2.25it/s]
 99%|████████████████████████████████████████████████████▋| 3306/3328 [17:57<00:100%|████████████████████████████████████████████████████▉| 3327/3328 [17:58<00:00,  2.12it/s]
100%|█████████████████████████████████████████████████████| 3328/3328 [17:58<00:100%|█████████████████████████████████████████████████████| 3328/3328 [17:58<00:00,  3.08it/s]

 99%|████████████████████████████████████████████████████▋| 3309/3328 [17:58<00: 99%|████████████████████████████████████████████████████▋| 3310/3328 [17:58<00: 99%|████████████████████████████████████████████████████▋| 3311/3328 [17:59<00:100%
|████████████████████████████████████████████████████▋| 3312/3328 [17:59<00:100%|████████████████████████████████████████████████████▊| 3313/3328 [18:00<00:100%|████████████████████████████████████████████████████▊| 3314/3328 [18:00<00:100%|███
█████████████████████████████████████████████████▊| 3315/3328 [18:01<00:100%|████████████████████████████████████████████████████▊| 3316/3328 [18:01<00:100%|████████████████████████████████████████████████████▊| 3317/3328 [18:02<00:100%|███████
█████████████████████████████████████████████▊| 3318/3328 [18:02<00:100%|████████████████████████████████████████████████████▊| 3319/3328 [18:02<00:100%|████████████████████████████████████████████████████▊| 3320/3328 [18:02<00:100%|███████████
█████████████████████████████████████████▉| 3321/3328 [18:03<00:100%|████████████████████████████████████████████████████▉| 3322/3328 [18:04<00:100%|████████████████████████████████████████████████████▉| 3323/3328 [18:04<00:100%|███████████████
█████████████████████████████████████▉| 3325/3328 [18:05<00:100%|████████████████████████████████████████████████████▉| 3326/3328 [18:05<00:100%|████████████████████████████████████████████████████▉| 3327/3328 [18:06<00:100%|███████████████████
██████████████████████████████████| 3328/3328 [18:06<00:00,  3.06it/s]
Predicting:   0%|                                        | 0/29 [00:00<?, ?it/s]Predicting DataLoader 0: 100%|██████████████████| 29/29 [01:50<00:00,  0.26it/s]2024-10-23 02:36:16.426 | INFO     | retrieval.model:on_predict_epoch_end:501 - Abou
t to construct predictions map
2024-10-23 02:36:16.426 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:36:16.426 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:36:16.426 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:36:16.641 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-23 02:36:16.641 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:36:16.642 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-23 02:36:16.642 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:36:16.734 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-23 02:36:16.734 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:36:16.743 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-23 02:36:16.744 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:36:16.744 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 29/29 [01:51<00:00,  0.26it/s]
2024-10-23 02:36:17.962 | INFO     | retrieval.main:run_cli:60 - PID: 813006
2024-10-23 02:36:18.179 | INFO     | retrieval.main:run_cli:60 - PID: 813008
2024-10-23 02:36:18.194 | INFO     | retrieval.main:run_cli:60 - PID: 813007
[rank: 1] Seed set to 3407
2024-10-23 02:36:18.366 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-23 02:36:18.366 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-23 02:36:18.524 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-23 02:36:18.524 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-23 02:36:18.535 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-23 02:36:18.536 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-23 02:36:42.379 | INFO     | __main__:main:1708 - Loaded the predictions pickle files
2024-10-23 02:36:42.528 | INFO     | __main__:main:1711 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
100%|████████████████████████████████████| 3919/3919 [00:00<00:00, 27582.53it/s]
2024-10-23 02:36:42.671 | INFO     | __main__:main:1713 - R@1 = 19.118163319191858 %, R@10 = 52.735114732890864 %, MRR = 0.41606209525757415
2024-10-23 02:36:42.674 | INFO     | retrieval.main:run_cli:60 - PID: 804165
[rank: 0] Seed set to 3407
2024-10-23 02:36:43.080 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-23 02:36:43.081 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-23 02:36:57.976 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 213383
2024-10-23 02:36:58.005 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3735
2024-10-23 02:37:08.692 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 213383
2024-10-23 02:37:08.714 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3735
2024-10-23 02:37:13.665 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 213383
2024-10-23 02:37:13.697 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3735
2024-10-23 02:37:13.766 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 213383
2024-10-23 02:37:13.796 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3735
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-23 02:37:17.301 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:37:17.302 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/2384 [00:00<03:05, 12.84it/s]2024-10-23 02:37:17.624 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:37:17.624 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/2384 [00:00<?, ?it/s]2024-10-23 02:37:17.649 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:37:17.650 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-23 02:37:18.042 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:37:18.042 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 2384/2384 [11:26<00:00,  3.47it/s]
100%|███████████████████████████████████████| 2384/2384 [11:28<00:00,  3.46it/s]
100%|███████████████████████████████████████| 2384/2384 [11:28<00:00,  3.46it/s]
100%|███████████████████████████████████████| 2384/2384 [11:33<00:00,  3.44it/s]
Predicting DataLoader 0: 100%|██████████████████| 15/15 [00:43<00:00,  0.34it/s]2024-10-23 02:49:35.742 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:49:35.743 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:49:35.743 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:49:35.743 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 02:49:35.874 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-23 02:49:35.874 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:49:35.875 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-23 02:49:35.875 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:49:35.917 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-23 02:49:35.918 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:49:35.929 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-23 02:49:35.929 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 02:49:35.930 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 15/15 [00:44<00:00,  0.34it/s]
2024-10-23 02:49:37.301 | INFO     | retrieval.main:run_cli:60 - PID: 813006
2024-10-23 02:49:37.397 | INFO     | retrieval.main:run_cli:60 - PID: 813008
2024-10-23 02:49:37.416 | INFO     | retrieval.main:run_cli:60 - PID: 813007
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-23 02:49:37.666 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-23 02:49:37.666 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
2024-10-23 02:49:37.743 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-23 02:49:37.743 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-23 02:49:37.798 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-23 02:49:37.798 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-23 02:49:38.252 | INFO     | __main__:main:1708 - Loaded the predictions pickle files
2024-10-23 02:49:38.330 | INFO     | __main__:main:1711 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
100%|████████████████████████████████████| 2339/2339 [00:00<00:00, 43714.81it/s]
2024-10-23 02:49:38.385 | INFO     | __main__:main:1713 - R@1 = 21.854580891085313 %, R@10 = 60.532514682957164 %, MRR = 0.4849337331149597
2024-10-23 02:49:38.387 | INFO     | retrieval.main:run_cli:60 - PID: 804165
[rank: 0] Seed set to 3407
2024-10-23 02:49:38.818 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-23 02:49:38.818 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-23 02:50:01.984 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 257488
2024-10-23 02:50:06.469 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 257488
2024-10-23 02:50:06.498 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4393
2024-10-23 02:50:10.692 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 257488
2024-10-23 02:50:10.738 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4393
2024-10-23 02:50:14.758 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 257488
2024-10-23 02:50:14.795 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4393
2024-10-23 02:50:21.717 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4393
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-23 02:50:25.252 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:50:25.253 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/2452 [00:00<02:39, 15.34it/s]2024-10-23 02:50:25.542 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:50:25.544 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/2452 [00:00<?, ?it/s]2024-10-23 02:50:25.597 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:50:25.597 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-23 02:50:25.925 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-23 02:50:25.926 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 2452/2452 [11:54<00:00,  3.43it/s]
100%|███████████████████████████████████████| 2452/2452 [11:56<00:00,  3.42it/s]
100%|███████████████████████████████████████| 2452/2452 [11:57<00:00,  3.42it/s]
100%|███████████████████████████████████████| 2452/2452 [12:02<00:00,  3.39it/s]
Predicting DataLoader 0: 100%|██████████████████| 18/18 [00:45<00:00,  0.40it/s]2024-10-23 03:03:13.984 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 03:03:14.198 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-23 03:03:14.198 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 03:03:25.908 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 03:03:25.908 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 03:03:25.908 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-23 03:03:26.115 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-23 03:03:26.116 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 03:03:26.150 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-23 03:03:26.150 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 03:03:26.159 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-23 03:03:26.159 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-23 03:03:26.160 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 18/18 [00:57<00:00,  0.31it/s]
2024-10-23 03:03:27.352 | INFO     | __main__:main:1817 - Finished processing the repository
2024-10-23 03:03:27.353 | INFO     | __main__:main:1819 - current epoch: 6
2024-10-23 03:03:27.353 | INFO     | __main__:main:1485 - length of lean_git_repos: 18
2024-10-23 03:03:27.354 | INFO     | __main__:main:1486 - i: 1
2024-10-23 03:03:27.354 | INFO     | __main__:main:1529 - All GPUs
2024-10-23 03:03:27.356 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1
_epoch=5-Recall@10_val=52.88.ckpt
2024-10-23 03:03:27.357 | INFO     | __main__:main:1536 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_va
l=52.88.ckpt
2024-10-23 03:03:27.357 | INFO     | __main__:main:1542 - Inside train_test_fisher
2024-10-23 03:03:27.357 | INFO     | __main__:main:1543 - Starting training at epoch 6
[rank: 3] Seed set to 3407
2024-10-23 03:03:27.636 | INFO     | __main__:main:1817 - Finished processing the repository
2024-10-23 03:03:27.637 | INFO     | __main__:main:1819 - current epoch: 6
2024-10-23 03:03:27.637 | INFO     | __main__:main:1485 - length of lean_git_repos: 18
2024-10-23 03:03:27.637 | INFO     | __main__:main:1486 - i: 1
2024-10-23 03:03:27.637 | INFO     | __main__:main:1529 - All GPUs
2024-10-23 03:03:27.640 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1
_epoch=5-Recall@10_val=52.88.ckpt
2024-10-23 03:03:27.640 | INFO     | __main__:main:1536 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_va
l=52.88.ckpt
2024-10-23 03:03:27.640 | INFO     | __main__:main:1542 - Inside train_test_fisher
2024-10-23 03:03:27.640 | INFO     | __main__:main:1543 - Starting training at epoch 6
[rank: 1] Seed set to 3407
2024-10-23 03:03:27.659 | INFO     | __main__:main:1817 - Finished processing the repository
2024-10-23 03:03:27.660 | INFO     | __main__:main:1819 - current epoch: 6
2024-10-23 03:03:27.660 | INFO     | __main__:main:1485 - length of lean_git_repos: 18
2024-10-23 03:03:27.660 | INFO     | __main__:main:1486 - i: 1
2024-10-23 03:03:27.660 | INFO     | __main__:main:1529 - All GPUs
2024-10-23 03:03:27.664 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1
_epoch=5-Recall@10_val=52.88.ckpt
2024-10-23 03:03:27.664 | INFO     | __main__:main:1536 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_va
l=52.88.ckpt
2024-10-23 03:03:27.664 | INFO     | __main__:main:1542 - Inside train_test_fisher
2024-10-23 03:03:27.664 | INFO     | __main__:main:1543 - Starting training at epoch 6
[rank: 2] Seed set to 3407
2024-10-23 03:03:28.656 | INFO     | __main__:main:1708 - Loaded the predictions pickle files
2024-10-23 03:03:28.741 | INFO     | __main__:main:1711 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|████████████████████████████████████| 2618/2618 [00:00<00:00, 28516.45it/s]
2024-10-23 03:03:28.835 | INFO     | __main__:main:1713 - R@1 = 20.731696913566708 %, R@10 = 58.63474653028021 %, MRR = 0.46732190061385775
2024-10-23 03:03:28.837 | INFO     | __main__:main:1728 - Average R@1 = 20.868961352253837 %, R@10 = 57.937630466644954 %, MRR = 0.4641480767066645
2024-10-23 03:03:28.838 | INFO     | __main__:main:1764 - Starting the prover
2024-10-23 03:03:28.838 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-10-23 03:03:28.838 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-10-23 03:03:28.839 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-10-23 03:03:28.840 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0
_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-10-23 03:03:29.738 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-
Recall@10_val=52.88.ckpt
2024-10-23 03:03:29.738 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-
Recall@10_val=52.88.ckpt
2024-10-23 03:03:32.896 | INFO     | __main__:main:1567 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10
_val=52.88.ckpt
2024-10-23 03:03:32.917 | INFO     | __main__:main:1567 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10
_val=52.88.ckpt
2024-10-23 03:03:32.917 | INFO     | __main__:main:1567 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10
_val=52.88.ckpt
2024-10-23 03:03:33.104 | INFO     | __main__:main:1625 - right before barrier for data module
2024-10-23 03:03:33.104 | INFO     | __main__:main:1625 - right before barrier for data module
2024-10-23 03:03:33.104 | INFO     | __main__:main:1625 - right before barrier for data module
2024-10-23 03:03:34.103 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-10-23 03:03:34.889 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-10-23 03:03:34.890 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-10-23 03:03:34.890 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-23 03:03:57.098 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-23 03:03:57.099 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 6667/6667 [10:12<00:00, 10.89it/s]
2024-10-23 03:14:09.156 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-10-23 03:14:09.156 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-10-23 03:14:16,384 INFO worker.py:1777 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=875127) [2024-10-23 03:15:19,063] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=875127) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=875127)   return torch.load(io.BytesIO(b))
(pid=875265) [2024-10-23 03:15:49,577] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=875265) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=875265)   return torch.load(io.BytesIO(b))
(pid=875273) [2024-10-23 03:16:19,474] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=875273) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=875273)   return torch.load(io.BytesIO(b))
2024-10-23 03:16:38.227 | INFO     | __main__:prove_sorry_theorems:884 - Found 0 sorry theorems to prove
Processing theorems from google-deepmind/debate: 0theorem [00:00, ?theorem/s]
2024-10-23 03:16:38.228 | INFO     | __main__:save_progress:839 - Saving encountered theorems...
2024-10-23 03:16:38.231 | INFO     | __main__:prove_sorry_theorems:935 - Finished attempting to prove sorry theorems
(pid=875239) [2024-10-23 03:16:50,344] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=875239) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=875239)   return torch.load(io.BytesIO(b))
2024-10-23 03:18:02.904 | INFO     | __main__:main:1798 - Finished searching for proofs of sorry theorems
2024-10-23 03:18:02.905 | INFO     | __main__:main:1817 - Finished processing the repository
2024-10-23 03:18:02.905 | INFO     | __main__:main:1819 - current epoch: 6
2024-10-23 03:18:02.905 | INFO     | __main__:main:1485 - length of lean_git_repos: 18
2024-10-23 03:18:02.905 | INFO     | __main__:main:1486 - i: 1
2024-10-23 03:18:02.905 | INFO     | __main__:main:1492 - Main process
2024-10-23 03:18:02.905 | INFO     | __main__:main:1493 - Using lambda = 0.1
2024-10-23 03:18:02.905 | INFO     | __main__:main:1494 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-10-23 03:18:02.905 | INFO     | __main__:add_repo_to_database:958 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-10-23 03:18:02.905 | INFO     | __main__:add_repo_to_database:1038 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-10-23 03:18:02.905 | INFO     | __main__:add_repo_to_database:1039 - Lean version: v4.8.0-rc2
2024-10-23 03:18:02.905 | INFO     | __main__:add_repo_to_database:1044 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-23 03:18:02.906 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-23 03:18:02.908 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-23 03:18:02.908 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-23 03:18:02.908 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-23 03:18:03.003 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc2, x86_64-unknown-linux-gnu, commit 873ef2d894af, Release)

2024-10-23 03:18:03.004 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-10-23 03:18:03.004 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-10-23 03:18:03.013 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-23 03:18:03.013 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-10-23 03:18:03.013 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-10-23 03:18:03.018 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-10-23 03:18:03.019 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_i
n_lean_source
2024-10-23 03:18:05.820 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1125 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a57
6389ecf5/mathematics_in_lean_source with 31 workers
100%|███████████████████████████████████████| 3143/3143 [11:07<00:00,  4.71it/s]
2024-10-23 03:29:12.944 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-10-23 03:29:13.536 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-23 03:29:14.651 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-23 03:29:17.458 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='1deca17a1b609ab594f02d2200998c396a52d1e7')
2024-10-23 03:29:38.047 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1010 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a
576389ecf5'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='01d414ac36dc28f3e424dabd36d818873fea655c'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='dc72dcdb8e
97b3c56bd70f06f043ed2dee3258e6'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='1357f4f49450abb9dfd4783e38219f4ce84f9785'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='9ac1
2945862fa39eab7795c2f79bb9aa0c8e332c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='baa65c6339a56bd22b7292aa4511c54b3cc7a6af'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli
', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='1deca17a1b609ab594f02d2200998c396a52d1e7'), 'importGraph': LeanGitRepo(url='https://github.com/leanpro
ver-community/import-graph', commit='9b4088ccf0f44ddd7b1132bb1348aef8cf481e12'), 'LeanSearchClient': LeanGitRepo(url='https://github.com/leanprover-community/LeanSearchClient', commit='7bedaed1ef024add1e171cc17706b012a9a37802')}, root_dir=Posix
Path('/data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_in_lean_source'))
2024-10-23 03:29:56.584 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-10-23 03:30:06.586 | INFO     | generate_benchmark_lean4:split_data:133 - 78886 theorems in total
2024-10-23 03:30:06.587 | INFO     | generate_benchmark_lean4:split_data:138 - 78886 theorems in total, with 1577 for validation and 1577 for testing
2024-10-23 03:30:06.587 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-10-23 03:30:06.630 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-10-23 03:30:14.230 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-10-23 03:30:34.038 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 126284 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/train.json
2024-10-23 03:30:34.690 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2875 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a57
6389ecf5/random/val.json
2024-10-23 03:30:35.118 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2631 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a57
6389ecf5/random/test.json
2024-10-23 03:30:54.790 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 123871 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/novel_premises/train.json
2024-10-23 03:30:55.536 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 3637 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a57
6389ecf5/novel_premises/val.json
2024-10-23 03:30:56.159 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 4282 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a57
6389ecf5/novel_premises/test.json
2024-10-23 03:30:56.160 | INFO     | generate_benchmark_lean4:export_proofs:206 - 157772 theorems saved in total
2024-10-23 03:30:56.166 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-10-23 03:31:21.544 | INFO     | generate_benchmark_lean4:export_premises:229 - 117699 theorems/definitions from 3143 files saved to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48
c0a084411853a576389ecf5/corpus.jsonl
2024-10-23 03:31:21.561 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-10-23 03:31:21.563 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-10-23 03:31:21.563 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-10-23 03:31:21.652 | INFO     | __main__:add_repo_to_database:1052 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
100%|██████████████████████████████████| 75732/75732 [00:01<00:00, 42313.58it/s]
100%|████████████████████████████████████| 1577/1577 [00:00<00:00, 44639.23it/s]
100%|████████████████████████████████████| 1577/1577 [00:00<00:00, 40536.72it/s]
2024-10-23 03:31:26.271 | INFO     | __main__:add_repo_to_database:1077 - Before adding new repo:
2024-10-23 03:31:26.271 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-23 03:31:26.271 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-10-23 03:31:26.271 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-10-23 03:31:26.271 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-10-23 03:31:26.271 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-10-23 03:31:26.271 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-10-23 03:31:26.272 | INFO     | __main__:add_repo_to_database:1080 - After adding new repo:
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-10-23 03:31:26.272 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-10-23 03:31:26.273 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-10-23 03:32:35.534 | INFO     | __main__:main:1516 - Adding repo to repos_for_merged_dataset
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 89bf7b5e3a226525e8580bae21ef543604f99b21)
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-10-23 03:32:35.537 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-10-23 03:41:08.545 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already exists.
Removing it now.
2024-10-23 03:42:03.220 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a57638
9ecf5
2024-10-23 03:42:04.719 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5
2024-10-23 03:42:04.740 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5
2024-10-23 03:42:04.749 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5
2024-10-23 03:42:04.808 | INFO     | __main__:main:1529 - All GPUs
2024-10-23 03:42:04.810 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1
_epoch=5-Recall@10_val=52.88.ckpt
2024-10-23 03:42:04.810 | INFO     | __main__:main:1536 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_va
l=52.88.ckpt
2024-10-23 03:42:04.810 | INFO     | __main__:main:1542 - Inside train_test_fisher
2024-10-23 03:42:04.810 | INFO     | __main__:main:1543 - Starting training at epoch 6
[rank: 0] Seed set to 3407
2024-10-23 03:42:06.783 | INFO     | __main__:main:1567 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10
_val=52.88.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-23 03:42:07.010 | INFO     | __main__:main:1625 - right before barrier for data module
2024-10-23 03:42:07.012 | INFO     | __main__:main:1640 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
2024-10-23 03:42:07.012 | INFO     | __main__:main:1640 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
2024-10-23 03:42:07.012 | INFO     | __main__:main:1640 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
2024-10-23 03:42:07.012 | INFO     | __main__:main:1640 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
100%|█████████████████████████████████| 191287/191287 [00:59<00:00, 3188.91it/s]
2024-10-23 03:44:25.583 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
100%|█████████████████████████████████████| 3985/3985 [00:01<00:00, 3590.88it/s]
 96%|███████████████████████████████▊ | 184161/191287 [01:00<00:06, 1071.85it/s]2024-10-23 03:44:26.877 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_e
wc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
100%|█████████████████████████████████████| 3985/3985 [00:01<00:00, 3651.71it/s]
 98%|████████████████████████████████▎| 187166/191287 [01:01<00:01, 2363.22it/s]2024-10-23 03:44:28.152 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_e
wc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
2024-10-23 03:44:28.152 | INFO     | __main__:main:1654 - Training dataset size after load: 447220
2024-10-23 03:44:28.152 | INFO     | __main__:main:1655 - Validation dataset size after load: 8209
2024-10-23 03:44:28.153 | INFO     | __main__:main:1656 - Testing dataset size after load: 7491
2024-10-23 03:44:28.153 | INFO     | __main__:main:1658 - Starting progressive training from epoch 6 to 7
2024-10-23 03:44:28.153 | INFO     | __main__:main:1661 - hit the barrier before training
100%|█████████████████████████████████| 191287/191287 [01:03<00:00, 3006.31it/s]
100%|█████████████████████████████████| 191287/191287 [01:03<00:00, 3009.88it/s]
2024-10-23 03:44:32.732 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:44:32.782 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:44:32.838 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
2024-10-23 03:44:32.838 | INFO     | __main__:main:1654 - Training dataset size after load: 447220
2024-10-23 03:44:32.839 | INFO     | __main__:main:1655 - Validation dataset size after load: 8209
2024-10-23 03:44:32.839 | INFO     | __main__:main:1656 - Testing dataset size after load: 7491
2024-10-23 03:44:32.839 | INFO     | __main__:main:1658 - Starting progressive training from epoch 6 to 7
2024-10-23 03:44:32.839 | INFO     | __main__:main:1661 - hit the barrier before training
2024-10-23 03:44:33.203 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:44:33.262 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:44:33.318 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
2024-10-23 03:44:33.318 | INFO     | __main__:main:1654 - Training dataset size after load: 447220
2024-10-23 03:44:33.318 | INFO     | __main__:main:1655 - Validation dataset size after load: 8209
2024-10-23 03:44:33.319 | INFO     | __main__:main:1656 - Testing dataset size after load: 7491
2024-10-23 03:44:33.319 | INFO     | __main__:main:1658 - Starting progressive training from epoch 6 to 7
2024-10-23 03:44:33.319 | INFO     | __main__:main:1661 - hit the barrier before training
2024-10-23 03:44:54.204 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:44:54.271 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:44:54.334 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
2024-10-23 03:44:54.334 | INFO     | __main__:main:1654 - Training dataset size after load: 447220
2024-10-23 03:44:54.334 | INFO     | __main__:main:1655 - Validation dataset size after load: 8209
2024-10-23 03:44:54.335 | INFO     | __main__:main:1656 - Testing dataset size after load: 7491
2024-10-23 03:44:54.335 | INFO     | __main__:main:1658 - Starting progressive training from epoch 6 to 7
2024-10-23 03:44:54.335 | INFO     | __main__:main:1661 - hit the barrier before training
2024-10-23 03:44:56.043 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:44:56.478 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:44:56.564 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full exists and is not empty.
2024-10-23 03:45:02.844 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:45:03.197 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:45:03.260 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
2024-10-23 03:45:06.374 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:45:06.754 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:45:06.832 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
2024-10-23 03:45:06.946 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 447220
2024-10-23 03:45:07.337 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 8209
2024-10-23 03:45:07.410 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 7491
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-23 03:45:08.990 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-23 03:45:08.993 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-23 03:45:08.993 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-23 03:45:08.993 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params | Mode
---------------------------------------------------
0 | encoder | T5EncoderModel | 217 M  | train
---------------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
235       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_val=52.88.ckpt
Epoch 6:   0%|                   | 1/27951 [00:04<35:41:54,  0.22it/s, v_num=25]An error occurred during training: Caught AttributeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 132, in __getitem__
    if ex["pos_premise"].path == ex["context"].path:
AttributeError: 'list' object has no attribute 'path'

Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 1663, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1025, in _run_stage
    self.fit_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 212, in advance
    batch, _, __ = next(data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 78, in __next__
    out[i] = next(self.iterators[i])
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1324, in _next_data
    return self._process_data(data)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 132, in __getitem__
    if ex["pos_premise"].path == ex["context"].path:
AttributeError: 'list' object has no attribute 'path'


2024-10-23 03:45:18.792 | INFO     | __main__:main:1670 - Finished progressive training at epoch 6
2024-10-23 03:45:18.794 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1
_epoch=5-Recall@10_val=52.88.ckpt
2024-10-23 03:45:18.794 | INFO     | __main__:main:1677 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_va
l=52.88.ckpt
An error occurred during training: Caught AttributeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 132, in __getitem__
    if ex["pos_premise"].path == ex["context"].path:
AttributeError: 'str' object has no attribute 'path'

Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 1663, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1025, in _run_stage
    self.fit_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 212, in advance
    batch, _, __ = next(data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 78, in __next__
    out[i] = next(self.iterators[i])
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1324, in _next_data
    return self._process_data(data)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 132, in __getitem__
    if ex["pos_premise"].path == ex["context"].path:
AttributeError: 'str' object has no attribute 'path'


2024-10-23 03:45:18.978 | INFO     | __main__:main:1670 - Finished progressive training at epoch 6
2024-10-23 03:45:18.979 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1
_epoch=5-Recall@10_val=52.88.ckpt
2024-10-23 03:45:18.979 | INFO     | __main__:main:1677 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0_lambda_0.1_epoch=5-Recall@10_va
l=52.88.ckpt
2024-10-23 03:45:22.735 | INFO     | __main__:main:1686 - Testing...
2024-10-23 03:45:22.737 | INFO     | retrieval.main:run_cli:60 - PID: 813007
2024-10-23 03:45:22.780 | INFO     | __main__:main:1686 - Testing...
2024-10-23 03:45:22.781 | INFO     | retrieval.main:run_cli:60 - PID: 813006
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-23 03:45:23.223 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random
2024-10-23 03:45:23.224 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/corpu
s.jsonl
2024-10-23 03:45:23.228 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random
2024-10-23 03:45:23.228 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/corpu
s.jsonl

