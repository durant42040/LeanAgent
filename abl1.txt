 0.6058871618483841
2024-09-22 10:30:04.386 | INFO     | retrieval.main:run_cli:60 - PID: 2882462
2024-09-22 10:30:04.584 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
[rank: 0] Seed set to 3407
2024-09-22 10:30:04.658 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f5
64669f/random
2024-09-22 10:30:04.658 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882
f564669f/corpus.jsonl
2024-09-22 10:30:04.697 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
2024-09-22 10:30:04.774 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
2024-09-22 10:30:05.247 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-22 10:30:16.418 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-22 10:30:16.445 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-22 10:30:18.481 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-22 10:30:18.491 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-22 10:30:18.494 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-22 10:30:18.503 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-22 10:30:19.897 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-22 10:30:19.914 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024
b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:30:22.879 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:30:22.882 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                 | 2/1599 [00:00<01:35, 16.75it/s]2024-09-22 10:30:23.103 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:30:23.104 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1599 [00:00<?, ?it/s]2024-09-22 10:30:23.124 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:30:23.124 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 10:30:23.760 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:30:23.760 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1599/1599 [08:30<00:00,  3.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1599/1599 [08:30<00:00,  3.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1599/1599 [08:33<00:00,  3.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1599/1599 [08:34<00:00,  3.11it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:19<00:00,  0.42it/s]2024-09-22 10:39:16.981 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:39:16.981 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:39:16.981 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:39:16.981 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:39:17.057 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 10:39:17.057 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:39:17.067 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 10:39:17.067 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:39:17.091 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 10:39:17.092 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:39:17.095 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 10:39:17.095 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:39:17.095 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:19<00:00,  0.42it/s]
2024-09-22 10:39:18.151 | INFO     | retrieval.main:run_cli:60 - PID: 2884979
2024-09-22 10:39:18.212 | INFO     | retrieval.main:run_cli:60 - PID: 2884978
2024-09-22 10:39:18.235 | INFO     | retrieval.main:run_cli:60 - PID: 2884980
[rank: 2] Seed set to 3407
2024-09-22 10:39:18.426 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/ran
dom
2024-09-22 10:39:18.426 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/c
orpus.jsonl
[rank: 1] Seed set to 3407
2024-09-22 10:39:18.543 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/ran
dom
2024-09-22 10:39:18.543 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/c
orpus.jsonl
[rank: 3] Seed set to 3407
2024-09-22 10:39:18.565 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/ran
dom
2024-09-22 10:39:18.565 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/c
orpus.jsonl
2024-09-22 10:39:18.830 | INFO     | __main__:main:1715 - Loaded the predictions pickle files
2024-09-22 10:39:18.874 | INFO     | __main__:main:1718 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 1351/1351 [00:00<00:00, 39943.50it/s]
2024-09-22 10:39:18.909 | INFO     | __main__:main:1720 - R@1 = 29.925646150444535 %, R@10 = 70.05576793278406 %, MRR = 0.60410984545555
2024-09-22 10:39:18.910 | INFO     | retrieval.main:run_cli:60 - PID: 2882462
2024-09-22 10:39:19.007 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-09-22 10:39:19.061 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-09-22 10:39:19.168 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-22 10:39:19.222 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/ran
dom
2024-09-22 10:39:19.223 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/c
orpus.jsonl
2024-09-22 10:39:19.905 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-22 10:39:24.006 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_train/cached_data.pkl
Training dataset size: 17735
2024-09-22 10:39:24.009 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_pred/cached_data.pkl
Testing dataset size: 313
2024-09-22 10:39:24.098 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_train/cached_data.pkl
Training dataset size: 17735
2024-09-22 10:39:24.101 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_pred/cached_data.pkl
Testing dataset size: 313
2024-09-22 10:39:24.109 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_train/cached_data.pkl
Training dataset size: 17735
2024-09-22 10:39:24.111 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_pred/cached_data.pkl
Testing dataset size: 313
2024-09-22 10:39:25.985 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_train/cached_data.pkl
Training dataset size: 17735
2024-09-22 10:39:25.988 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9d
b86bb8/random/cache_pred/cached_data.pkl
Testing dataset size: 313
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:39:29.033 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:39:29.034 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 0/634 [00:00<?, ?it/s]2024-09-22 10:39:29.046 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:39:29.047 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▎                                                                                 | 2/634 [00:00<00:38, 16.59it/s]2024-09-22 10:39:29.321 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:39:29.322 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 10:39:30.731 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:39:30.732 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████| 634/634 [03:43<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 634/634 [03:44<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 634/634 [03:45<00:00,  2.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 634/634 [03:45<00:00,  2.81it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.06it/s]2024-09-22 10:43:18.344 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:43:18.344 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:43:18.344 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:43:18.344 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 10:43:18.363 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 10:43:18.364 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 10:43:18.364 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:43:18.364 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:43:18.369 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 10:43:18.369 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:43:18.370 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 10:43:18.370 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 10:43:18.370 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.04it/s]
2024-09-22 10:43:19.524 | INFO     | __main__:main:1833 - Finished processing the repository
2024-09-22 10:43:19.525 | INFO     | __main__:main:1835 - current epoch: 8
2024-09-22 10:43:19.525 | INFO     | __main__:main:1506 - length of lean_git_repos: 8
2024-09-22 10:43:19.525 | INFO     | __main__:main:1507 - i: 7
2024-09-22 10:43:19.526 | INFO     | __main__:main:1535 - All GPUs
2024-09-22 10:43:19.529 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b
9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:19.529 | INFO     | __main__:main:1542 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_e
poch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:19.529 | INFO     | __main__:main:1548 - Inside train_test_fisher
2024-09-22 10:43:19.529 | INFO     | __main__:main:1549 - Starting training at epoch 8
[rank: 1] Seed set to 3407
2024-09-22 10:43:19.563 | INFO     | __main__:main:1833 - Finished processing the repository
2024-09-22 10:43:19.564 | INFO     | __main__:main:1835 - current epoch: 8
2024-09-22 10:43:19.565 | INFO     | __main__:main:1506 - length of lean_git_repos: 8
2024-09-22 10:43:19.565 | INFO     | __main__:main:1507 - i: 7
2024-09-22 10:43:19.565 | INFO     | __main__:main:1535 - All GPUs
2024-09-22 10:43:19.567 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b
9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:19.567 | INFO     | __main__:main:1542 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_e
poch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:19.567 | INFO     | __main__:main:1548 - Inside train_test_fisher
2024-09-22 10:43:19.567 | INFO     | __main__:main:1549 - Starting training at epoch 8
[rank: 2] Seed set to 3407
2024-09-22 10:43:19.587 | INFO     | __main__:main:1833 - Finished processing the repository
2024-09-22 10:43:19.589 | INFO     | __main__:main:1835 - current epoch: 8
2024-09-22 10:43:19.589 | INFO     | __main__:main:1506 - length of lean_git_repos: 8
2024-09-22 10:43:19.589 | INFO     | __main__:main:1507 - i: 7
2024-09-22 10:43:19.589 | INFO     | __main__:main:1535 - All GPUs
2024-09-22 10:43:19.592 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b
9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:19.592 | INFO     | __main__:main:1542 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_e
poch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:19.592 | INFO     | __main__:main:1548 - Inside train_test_fisher
2024-09-22 10:43:19.592 | INFO     | __main__:main:1549 - Starting training at epoch 8
[rank: 3] Seed set to 3407
2024-09-22 10:43:20.271 | INFO     | __main__:main:1715 - Loaded the predictions pickle files
2024-09-22 10:43:20.287 | INFO     | __main__:main:1718 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████| 308/308 [00:00<00:00, 42597.21it/s]
2024-09-22 10:43:20.296 | INFO     | __main__:main:1720 - R@1 = 28.92423115079365 %, R@10 = 72.3765167124542 %, MRR = 0.6060088539119249
2024-09-22 10:43:20.297 | INFO     | __main__:main:1735 - Average R@1 = 28.471960766958084 %, R@10 = 70.18358170946667 %, MRR = 0.5846983483140433
2024-09-22 10:43:20.298 | INFO     | __main__:main:1771 - Starting the prover
2024-09-22 10:43:20.298 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-22 10:43:20.298 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-22 10:43:20.298 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-22 10:43:20.299 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb828205757
58efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-22 10:43:21.431 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_
lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:21.431 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_
lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:21.606 | INFO     | __main__:main:1573 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.
1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:21.633 | INFO     | __main__:main:1573 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.
1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:21.640 | INFO     | __main__:main:1573 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.
1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:43:21.713 | INFO     | __main__:main:1631 - right before barrier for data module
2024-09-22 10:43:21.713 | INFO     | __main__:main:1631 - right before barrier for data module
2024-09-22 10:43:21.713 | INFO     | __main__:main:1631 - right before barrier for data module
2024-09-22 10:43:24.140 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
2024-09-22 10:43:24.959 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-09-22 10:43:24.960 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-22 10:43:24.960 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb
8/corpus.jsonl
2024-09-22 10:43:24.960 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-09-22 10:43:26.466 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-22 10:43:26.466 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
/corpus.jsonl
2024-09-22 10:43:26.466 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1268/1268 [01:59<00:00, 10.57it/s]
2024-09-22 10:45:26.465 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-09-22 10:45:26.465 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-09-22 10:45:31,940 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=3678396) [2024-09-22 10:46:10,990] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-22 10:46:14.150 | INFO     | __main__:prove_sorry_theorems:1009 - Found 0 sorry theorems to prove
Processing theorems from loganrjmurphy/LeanEuclid: 0theorem [00:00, ?theorem/s]
2024-09-22 10:46:14.151 | INFO     | __main__:save_progress:964 - Saving encountered theorems...
2024-09-22 10:46:14.153 | INFO     | __main__:prove_sorry_theorems:1060 - Finished attempting to prove sorry theorems
(ProverActor pid=3678396) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pick
le module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release,
 the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted
 by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
(ProverActor pid=3678396)   return torch.load(io.BytesIO(b))
(pid=3678635) [2024-09-22 10:46:19,976] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect) [repeated 2x across cluster]
2024-09-22 10:48:10.373 | INFO     | __main__:main:1810 - Finished searching for proofs of sorry theorems
2024-09-22 10:48:10.373 | INFO     | __main__:main:1813 - Shutting down Ray after proving
(pid=3678864) [2024-09-22 10:46:26,886] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=3678864) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pick
le module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release,
 the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted
 by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature. [repeated 3x across cluster]
(ProverActor pid=3678864)   return torch.load(io.BytesIO(b)) [repeated 3x across cluster]
2024-09-22 10:48:13.416 | INFO     | __main__:main:1833 - Finished processing the repository
2024-09-22 10:48:13.416 | INFO     | __main__:main:1835 - current epoch: 8
2024-09-22 10:48:13.416 | INFO     | __main__:main:1506 - length of lean_git_repos: 8
2024-09-22 10:48:13.417 | INFO     | __main__:main:1507 - i: 7
2024-09-22 10:48:13.417 | INFO     | __main__:main:1513 - Main process
2024-09-22 10:48:13.417 | INFO     | __main__:main:1514 - Using lambda = 0.1
2024-09-22 10:48:13.417 | INFO     | __main__:main:1515 - Processing https://github.com/digama0/lean4lean
2024-09-22 10:48:13.417 | INFO     | __main__:main:1522 - Adding repo to repos_for_merged_dataset
2024-09-22 10:48:13.419 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-22 10:48:13.419 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-22 10:48:13.473 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f already exists. Re
moving it now.
2024-09-22 10:48:13.997 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276
e0f
2024-09-22 10:48:14.098 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6
a56fef21276e0f
2024-09-22 10:48:14.103 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f
2024-09-22 10:48:14.104 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f
2024-09-22 10:48:14.105 | INFO     | __main__:main:1535 - All GPUs
2024-09-22 10:48:14.107 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b
9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:48:14.107 | INFO     | __main__:main:1542 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_e
poch=7-Recall@10_val=75.71.ckpt
2024-09-22 10:48:14.107 | INFO     | __main__:main:1548 - Inside train_test_fisher
2024-09-22 10:48:14.107 | INFO     | __main__:main:1549 - Starting training at epoch 8
[rank: 0] Seed set to 3407
2024-09-22 10:48:15.726 | INFO     | __main__:main:1573 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.
1_epoch=7-Recall@10_val=75.71.ckpt
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-22 10:48:15.834 | INFO     | __main__:main:1631 - right before barrier for data module
2024-09-22 10:48:15.834 | INFO     | __main__:main:1646 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-09-22 10:48:15.834 | INFO     | __main__:main:1646 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-09-22 10:48:15.834 | INFO     | __main__:main:1646 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-09-22 10:48:15.834 | INFO     | __main__:main:1646 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-09-22 10:48:15.931 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-09-22 10:48:15.931 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-09-22 10:48:15.931 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-09-22 10:48:15.933 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 5991.51it/s]
2024-09-22 10:48:17.124 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_train/cached_data.pkl
Training dataset size: 6840
100%|████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 6588.11it/s]
2024-09-22 10:48:17.137 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
100%|████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 6962.29it/s]
2024-09-22 10:48:17.149 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
2024-09-22 10:48:17.149 | INFO     | __main__:main:1660 - Training dataset size after load: 6840
2024-09-22 10:48:17.149 | INFO     | __main__:main:1661 - Validation dataset size after load: 95
2024-09-22 10:48:17.150 | INFO     | __main__:main:1662 - Testing dataset size after load: 157
2024-09-22 10:48:17.150 | INFO     | __main__:main:1664 - Starting progressive training from epoch 8 to 9
2024-09-22 10:48:17.150 | INFO     | __main__:main:1667 - hit the barrier before training
100%|████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 6034.44it/s]
2024-09-22 10:48:17.193 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_train/cached_data.pkl
Training dataset size: 6840
2024-09-22 10:48:17.194 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
2024-09-22 10:48:17.195 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
2024-09-22 10:48:17.195 | INFO     | __main__:main:1660 - Training dataset size after load: 6840
2024-09-22 10:48:17.195 | INFO     | __main__:main:1661 - Validation dataset size after load: 95
2024-09-22 10:48:17.196 | INFO     | __main__:main:1662 - Testing dataset size after load: 157
2024-09-22 10:48:17.196 | INFO     | __main__:main:1664 - Starting progressive training from epoch 8 to 9
2024-09-22 10:48:17.196 | INFO     | __main__:main:1667 - hit the barrier before training
2024-09-22 10:48:17.717 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_train/cached_data.pkl
Training dataset size: 6840
2024-09-22 10:48:17.719 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
2024-09-22 10:48:17.720 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
2024-09-22 10:48:17.720 | INFO     | __main__:main:1660 - Training dataset size after load: 6840
2024-09-22 10:48:17.720 | INFO     | __main__:main:1661 - Validation dataset size after load: 95
2024-09-22 10:48:17.720 | INFO     | __main__:main:1662 - Testing dataset size after load: 157
2024-09-22 10:48:17.720 | INFO     | __main__:main:1664 - Starting progressive training from epoch 8 to 9
2024-09-22 10:48:17.720 | INFO     | __main__:main:1667 - hit the barrier before training
2024-09-22 10:48:17.726 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_train/cached_data.pkl
Training dataset size: 6840
2024-09-22 10:48:17.727 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
2024-09-22 10:48:17.728 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
2024-09-22 10:48:17.728 | INFO     | __main__:main:1660 - Training dataset size after load: 6840
2024-09-22 10:48:17.728 | INFO     | __main__:main:1661 - Validation dataset size after load: 95
2024-09-22 10:48:17.728 | INFO     | __main__:main:1662 - Testing dataset size after load: 157
2024-09-22 10:48:17.728 | INFO     | __main__:main:1664 - Starting progressive training from epoch 8 to 9
2024-09-22 10:48:17.728 | INFO     | __main__:main:1667 - hit the barrier before training
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 0] Seed set to 3407
2024-09-22 10:48:17.757 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_train/cached_data.pkl
2024-09-22 10:48:17.759 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_train/cached_data.pkl
2024-09-22 10:48:17.759 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_train/cached_data.pkl
2024-09-22 10:48:17.760 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_train/cached_data.pkl
Training dataset size: 6840
Training dataset size: 6840
2024-09-22 10:48:17.762 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
Training dataset size: 6840
2024-09-22 10:48:17.763 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
2024-09-22 10:48:17.763 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
2024-09-22 10:48:17.763 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
Testing dataset size: 157
Validation dataset size: 95
Validation dataset size: 95
2024-09-22 10:48:17.764 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
2024-09-22 10:48:17.764 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
Testing dataset size: 157
Training dataset size: 6840
2024-09-22 10:48:17.766 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
2024-09-22 10:48:17.766 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-22 10:48:18.913 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-22 10:48:18.914 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-22 10:48:18.914 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-22 10:48:18.914 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8_lambda_0.1_epoch=7-Recall@10_val=75.71.ckpt
Epoch 8: 100%|██████████████████████████████████████████████████████████████| 427/427 [02:41<00:00,  2.65it/s, v_num=4]2024-09-22 10:51:02.686 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
2024-09-22 10:51:02.687 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 0/355 [00:00<?, ?it/s]2024-09-22 10:51:02.691 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  2%|█▍                                                                                | 6/355 [00:00<00:55,  6.33it/s2024-09-22 10:51:03.618 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus0:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 355/355 [01:14<00:00,  4.78it/s]
2024-09-22 10:52:16.928 | INFO     | retrieval.model:validation_step:318 - Inside validation_step
 97%|█████████████████████████████████████████████████████████████████████████████▉  | 346/355 [01:13<00:02,  4.13it/s2024-09-22 10:52:16.946 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: False
100%|████████████████████████████████████████████████████████████████████████████████| 355/355 [01:14<00:00,  4.78it/s]
2024-09-22 10:52:16.978 | INFO     | retrieval.model:validation_step:318 - Inside validation_step
2024-09-22 10:52:16.997 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: False
100%|████████████████████████████████████████████████████████████████████████████████| 355/355 [01:14<00:00,  4.76it/s]
2024-09-22 10:52:17.209 | INFO     | retrieval.model:validation_step:318 - Inside validation_step
2024-09-22 10:52:17.229 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: Falset/s]
                                                                                                                      2024-09-22 10:52:17.419 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 26.02040816326531
2024-09-22 10:52:17.421 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 45.717377860235004,  5.96it/s]
2024-09-22 10:52:17.422 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 54.05071119356833
2024-09-22 10:52:17.423 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 54.05071119356833
2024-09-22 10:52:17.424 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 54.05071119356833
2024-09-22 10:52:17.425 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 56.43166357452072
2024-09-22 10:52:17.425 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 63.57452071737786
2024-09-22 10:52:17.426 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 65.95547309833024
2024-09-22 10:52:17.427 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 73.09833024118738
2024-09-22 10:52:17.428 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 73.09833024118738
2024-09-22 10:52:17.429 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 73.09833024118738
2024-09-22 10:52:17.430 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 73.09833024118738
2024-09-22 10:52:17.430 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 73.09833024118738
2024-09-22 10:52:17.431 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 73.09833024118738
2024-09-22 10:52:17.432 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 73.09833024118738
2024-09-22 10:52:17.433 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 73.09833024118738
2024-09-22 10:52:17.434 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 75.47928262213978
2024-09-22 10:52:17.435 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 75.47928262213978
2024-09-22 10:52:17.435 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 75.47928262213978
2024-09-22 10:52:17.436 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 75.47928262213978
2024-09-22 10:52:17.437 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 75.47928262213978
2024-09-22 10:52:17.438 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 75.47928262213978
2024-09-22 10:52:17.439 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 75.47928262213978
2024-09-22 10:52:17.439 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 75.47928262213978
2024-09-22 10:52:17.440 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 75.47928262213978
2024-09-22 10:52:17.441 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 75.47928262213978
2024-09-22 10:52:17.442 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 75.47928262213978
2024-09-22 10:52:17.443 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 75.47928262213978
2024-09-22 10:52:17.444 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 75.47928262213978
2024-09-22 10:52:17.444 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 77.86023500309214
2024-09-22 10:52:17.445 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 77.86023500309214
2024-09-22 10:52:17.446 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 77.86023500309214
2024-09-22 10:52:17.447 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 77.86023500309214
2024-09-22 10:52:17.448 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 77.86023500309214
2024-09-22 10:52:17.449 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 77.86023500309214
2024-09-22 10:52:17.449 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 77.86023500309214
2024-09-22 10:52:17.450 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 77.86023500309214
2024-09-22 10:52:17.451 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 77.86023500309214
2024-09-22 10:52:17.452 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 77.86023500309214
2024-09-22 10:52:17.453 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 77.86023500309214
2024-09-22 10:52:17.453 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 77.86023500309214
2024-09-22 10:52:17.454 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 77.86023500309214
2024-09-22 10:52:17.455 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 77.86023500309214
2024-09-22 10:52:17.456 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 77.86023500309214
2024-09-22 10:52:17.457 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 77.86023500309214
2024-09-22 10:52:17.458 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 77.86023500309214
2024-09-22 10:52:17.458 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 77.86023500309214
2024-09-22 10:52:17.459 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 77.86023500309214
2024-09-22 10:52:17.460 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 77.86023500309214
2024-09-22 10:52:17.461 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 77.86023500309214
2024-09-22 10:52:17.462 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 77.86023500309214
2024-09-22 10:52:17.462 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 77.86023500309214
2024-09-22 10:52:17.463 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 77.86023500309214
2024-09-22 10:52:17.464 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 80.24118738404454
2024-09-22 10:52:17.465 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 80.24118738404454
2024-09-22 10:52:17.466 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 80.24118738404454
2024-09-22 10:52:17.467 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 80.24118738404454
2024-09-22 10:52:17.467 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 80.24118738404454
2024-09-22 10:52:17.468 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 80.24118738404454
2024-09-22 10:52:17.469 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 80.24118738404454
2024-09-22 10:52:17.470 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 80.24118738404454
2024-09-22 10:52:17.471 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 80.24118738404454
2024-09-22 10:52:17.471 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 81.26159554730982
2024-09-22 10:52:17.472 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 43.28231292517007
2024-09-22 10:52:17.472 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 81.26159554730982
2024-09-22 10:52:17.473 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 81.26159554730982
2024-09-22 10:52:17.474 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 46.85374149659864
2024-09-22 10:52:17.474 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 81.26159554730982
2024-09-22 10:52:17.475 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 81.26159554730982
2024-09-22 10:52:17.475 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 46.85374149659864
2024-09-22 10:52:17.475 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 81.26159554730982
2024-09-22 10:52:17.476 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 47.87414965986394
2024-09-22 10:52:17.476 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 81.26159554730982
2024-09-22 10:52:17.476 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 47.87414965986394
2024-09-22 10:52:17.477 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 81.26159554730982
2024-09-22 10:52:17.477 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 50.255102040816325
2024-09-22 10:52:17.478 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 81.26159554730982
2024-09-22 10:52:17.478 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 52.0408163265306
2024-09-22 10:52:17.479 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 81.26159554730982
2024-09-22 10:52:17.479 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 57.397959183673464
2024-09-22 10:52:17.480 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 81.26159554730982
2024-09-22 10:52:17.480 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 58.41836734693876
2024-09-22 10:52:17.480 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 81.26159554730982
2024-09-22 10:52:17.481 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 58.41836734693876
2024-09-22 10:52:17.481 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 81.26159554730982
2024-09-22 10:52:17.481 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 58.41836734693876
2024-09-22 10:52:17.482 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 81.26159554730982
2024-09-22 10:52:17.482 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 58.41836734693876
2024-09-22 10:52:17.483 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 81.91094619666049
2024-09-22 10:52:17.483 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 58.41836734693876
2024-09-22 10:52:17.484 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 81.91094619666049
2024-09-22 10:52:17.484 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 60.20408163265305
2024-09-22 10:52:17.485 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 81.91094619666049
2024-09-22 10:52:17.485 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 60.20408163265305
2024-09-22 10:52:17.485 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 81.91094619666049
2024-09-22 10:52:17.486 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 60.20408163265305
2024-09-22 10:52:17.486 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 81.91094619666049
2024-09-22 10:52:17.486 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 64.79591836734693
2024-09-22 10:52:17.487 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 81.91094619666049
2024-09-22 10:52:17.487 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 64.79591836734693
2024-09-22 10:52:17.488 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 81.91094619666049
2024-09-22 10:52:17.488 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 64.79591836734693
2024-09-22 10:52:17.489 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 81.91094619666049
2024-09-22 10:52:17.489 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 64.79591836734693
2024-09-22 10:52:17.489 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 81.91094619666049
2024-09-22 10:52:17.490 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 66.5816326530612
2024-09-22 10:52:17.490 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 81.91094619666049
2024-09-22 10:52:17.491 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 68.3673469387755
2024-09-22 10:52:17.491 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 81.91094619666049
2024-09-22 10:52:17.491 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 68.3673469387755
2024-09-22 10:52:17.492 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 81.91094619666049
2024-09-22 10:52:17.492 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 68.3673469387755
2024-09-22 10:52:17.493 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 81.91094619666049
2024-09-22 10:52:17.493 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 68.3673469387755
2024-09-22 10:52:17.493 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 81.91094619666049
2024-09-22 10:52:17.494 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 68.3673469387755
2024-09-22 10:52:17.494 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 81.91094619666049
2024-09-22 10:52:17.495 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 70.15306122448978
2024-09-22 10:52:17.495 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 81.91094619666049
2024-09-22 10:52:17.496 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 70.15306122448978
2024-09-22 10:52:17.496 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 81.91094619666049
2024-09-22 10:52:17.497 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 70.15306122448978
2024-09-22 10:52:17.497 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 81.91094619666049
2024-09-22 10:52:17.498 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 81.91094619666049
2024-09-22 10:52:17.498 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 70.15306122448978
2024-09-22 10:52:17.498 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 70.15306122448978
2024-09-22 10:52:17.498 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 81.91094619666049
2024-09-22 10:52:17.499 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 70.15306122448978
2024-09-22 10:52:17.499 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 81.91094619666049
2024-09-22 10:52:17.500 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 81.91094619666049
2024-09-22 10:52:17.500 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 70.15306122448978
2024-09-22 10:52:17.501 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 81.91094619666049
2024-09-22 10:52:17.501 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 70.15306122448978
2024-09-22 10:52:17.502 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 81.91094619666049
2024-09-22 10:52:17.502 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 70.15306122448978
2024-09-22 10:52:17.503 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 70.15306122448978
2024-09-22 10:52:17.503 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6609977324263038
2024-09-22 10:52:17.503 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 70.15306122448978
2024-09-22 10:52:17.503 | INFO     | retrieval.model:validation_step:389 - End of validation_step
2024-09-22 10:52:17.504 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 70.15306122448978
2024-09-22 10:52:17.505 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 70.15306122448978
2024-09-22 10:52:17.506 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 70.15306122448978
2024-09-22 10:52:17.507 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 70.15306122448978
2024-09-22 10:52:17.508 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 70.15306122448978
2024-09-22 10:52:17.508 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 70.15306122448978
2024-09-22 10:52:17.509 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 71.17346938775509
2024-09-22 10:52:17.510 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 71.17346938775509
2024-09-22 10:52:17.511 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 72.95918367346938
2024-09-22 10:52:17.512 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 72.95918367346938
2024-09-22 10:52:17.512 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 72.95918367346938
2024-09-22 10:52:17.513 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 72.95918367346938
2024-09-22 10:52:17.514 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 80.10204081632652
2024-09-22 10:52:17.515 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 80.10204081632652
2024-09-22 10:52:17.516 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 81.12244897959184
2024-09-22 10:52:17.517 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 81.12244897959184
2024-09-22 10:52:17.517 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 81.12244897959184
2024-09-22 10:52:17.518 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 81.12244897959184
2024-09-22 10:52:17.519 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 81.12244897959184
2024-09-22 10:52:17.520 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 81.12244897959184
2024-09-22 10:52:17.521 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 81.12244897959184
2024-09-22 10:52:17.521 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 81.12244897959184
2024-09-22 10:52:17.522 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 81.12244897959184
2024-09-22 10:52:17.523 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 82.90816326530613
2024-09-22 10:52:17.524 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 82.90816326530613
2024-09-22 10:52:17.525 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 82.90816326530613
2024-09-22 10:52:17.525 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 85.2891156462585
2024-09-22 10:52:17.526 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 85.2891156462585
2024-09-22 10:52:17.527 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 85.2891156462585
2024-09-22 10:52:17.528 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 85.2891156462585
2024-09-22 10:52:17.529 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 85.2891156462585
2024-09-22 10:52:17.530 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 85.2891156462585
2024-09-22 10:52:17.530 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 85.2891156462585
2024-09-22 10:52:17.531 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 85.2891156462585
2024-09-22 10:52:17.532 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 85.2891156462585
2024-09-22 10:52:17.533 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 85.2891156462585
2024-09-22 10:52:17.534 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 85.2891156462585
2024-09-22 10:52:17.534 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 85.2891156462585
2024-09-22 10:52:17.535 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 85.2891156462585
2024-09-22 10:52:17.536 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 85.2891156462585
2024-09-22 10:52:17.537 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 85.2891156462585
2024-09-22 10:52:17.538 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 85.2891156462585
2024-09-22 10:52:17.538 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 85.2891156462585
2024-09-22 10:52:17.539 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 85.2891156462585
2024-09-22 10:52:17.540 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 85.2891156462585
2024-09-22 10:52:17.541 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 85.2891156462585
2024-09-22 10:52:17.542 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 85.2891156462585
2024-09-22 10:52:17.543 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 85.2891156462585
2024-09-22 10:52:17.543 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 85.2891156462585
2024-09-22 10:52:17.544 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 85.2891156462585
2024-09-22 10:52:17.545 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 85.2891156462585
2024-09-22 10:52:17.546 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 85.2891156462585
2024-09-22 10:52:17.547 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 85.2891156462585
2024-09-22 10:52:17.547 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 85.2891156462585
2024-09-22 10:52:17.548 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 85.2891156462585
2024-09-22 10:52:17.549 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 85.2891156462585
2024-09-22 10:52:17.550 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 85.2891156462585
2024-09-22 10:52:17.551 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 85.2891156462585
2024-09-22 10:52:17.551 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 85.2891156462585
2024-09-22 10:52:17.552 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 85.2891156462585
2024-09-22 10:52:17.553 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 85.2891156462585
2024-09-22 10:52:17.554 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 85.2891156462585
2024-09-22 10:52:17.555 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 85.2891156462585
2024-09-22 10:52:17.556 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6940306122448979
2024-09-22 10:52:17.556 | INFO     | retrieval.model:validation_step:389 - End of validation_step
                                                                                                                      2024-09-22 10:52:17.707 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 30.76923076923077
2024-09-22 10:52:17.709 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 48.717948717948715,  5.41it/s]
2024-09-22 10:52:17.710 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 64.1025641025641
2024-09-22 10:52:17.710 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 70.51282051282051
2024-09-22 10:52:17.711 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 70.51282051282051
2024-09-22 10:52:17.712 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 74.35897435897438
2024-09-22 10:52:17.713 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 76.92307692307693
2024-09-22 10:52:17.714 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 80.76923076923077
2024-09-22 10:52:17.715 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 80.76923076923077
2024-09-22 10:52:17.716 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 80.76923076923077
2024-09-22 10:52:17.717 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 84.61538461538461
2024-09-22 10:52:17.717 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 84.61538461538461
2024-09-22 10:52:17.718 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 84.61538461538461
2024-09-22 10:52:17.719 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 84.61538461538461
2024-09-22 10:52:17.720 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 84.61538461538461
2024-09-22 10:52:17.721 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 84.61538461538461
2024-09-22 10:52:17.722 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 84.61538461538461
2024-09-22 10:52:17.723 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 84.61538461538461
2024-09-22 10:52:17.723 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 84.61538461538461
2024-09-22 10:52:17.724 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 84.61538461538461
2024-09-22 10:52:17.725 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 84.61538461538461
2024-09-22 10:52:17.726 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 84.61538461538461
2024-09-22 10:52:17.727 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 84.61538461538461
2024-09-22 10:52:17.728 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 84.61538461538461
2024-09-22 10:52:17.728 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 84.61538461538461
2024-09-22 10:52:17.729 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 88.46153846153845
2024-09-22 10:52:17.730 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 88.46153846153845
2024-09-22 10:52:17.731 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 88.46153846153845
2024-09-22 10:52:17.732 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 88.46153846153845
2024-09-22 10:52:17.733 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 88.46153846153845
2024-09-22 10:52:17.733 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 88.46153846153845
2024-09-22 10:52:17.734 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 88.46153846153845
2024-09-22 10:52:17.735 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 88.46153846153845
2024-09-22 10:52:17.736 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 88.46153846153845
2024-09-22 10:52:17.737 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 88.46153846153845
2024-09-22 10:52:17.737 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 88.46153846153845
2024-09-22 10:52:17.738 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 88.46153846153845
2024-09-22 10:52:17.739 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 88.46153846153845
2024-09-22 10:52:17.740 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 88.46153846153845
2024-09-22 10:52:17.741 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 88.46153846153845
2024-09-22 10:52:17.742 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 88.46153846153845
2024-09-22 10:52:17.742 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 88.46153846153845
2024-09-22 10:52:17.743 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 88.46153846153845
2024-09-22 10:52:17.744 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 88.46153846153845
2024-09-22 10:52:17.745 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 88.46153846153845
2024-09-22 10:52:17.746 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 88.46153846153845
2024-09-22 10:52:17.747 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 88.46153846153845
2024-09-22 10:52:17.747 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 88.46153846153845
2024-09-22 10:52:17.748 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 88.46153846153845
2024-09-22 10:52:17.749 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 88.46153846153845
2024-09-22 10:52:17.750 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 88.46153846153845
2024-09-22 10:52:17.751 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 88.46153846153845
2024-09-22 10:52:17.752 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 88.46153846153845
2024-09-22 10:52:17.752 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 88.46153846153845
2024-09-22 10:52:17.753 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 88.46153846153845
2024-09-22 10:52:17.754 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 88.46153846153845
2024-09-22 10:52:17.755 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 88.46153846153845
2024-09-22 10:52:17.756 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 88.46153846153845
2024-09-22 10:52:17.757 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 88.46153846153845
2024-09-22 10:52:17.757 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 88.46153846153845
2024-09-22 10:52:17.758 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 88.46153846153845
2024-09-22 10:52:17.759 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 88.46153846153845
2024-09-22 10:52:17.760 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 88.46153846153845
2024-09-22 10:52:17.761 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 88.46153846153845
2024-09-22 10:52:17.761 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 88.46153846153845
2024-09-22 10:52:17.762 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 96.15384615384616
2024-09-22 10:52:17.763 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 96.15384615384616
2024-09-22 10:52:17.764 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 96.15384615384616
2024-09-22 10:52:17.765 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 96.15384615384616
2024-09-22 10:52:17.765 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 96.15384615384616
2024-09-22 10:52:17.766 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 96.15384615384616
2024-09-22 10:52:17.767 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 96.15384615384616
2024-09-22 10:52:17.768 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 96.15384615384616
2024-09-22 10:52:17.769 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 96.15384615384616
2024-09-22 10:52:17.770 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 96.15384615384616
2024-09-22 10:52:17.770 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 96.15384615384616
2024-09-22 10:52:17.771 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 96.15384615384616
2024-09-22 10:52:17.772 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 96.15384615384616
2024-09-22 10:52:17.773 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 96.15384615384616
2024-09-22 10:52:17.774 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 96.15384615384616
2024-09-22 10:52:17.774 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 96.15384615384616
2024-09-22 10:52:17.775 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 96.15384615384616
2024-09-22 10:52:17.776 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 96.15384615384616
2024-09-22 10:52:17.777 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 96.15384615384616
2024-09-22 10:52:17.778 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 96.15384615384616
2024-09-22 10:52:17.779 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 96.15384615384616
2024-09-22 10:52:17.779 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 96.15384615384616
2024-09-22 10:52:17.780 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 96.15384615384616
2024-09-22 10:52:17.781 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 96.15384615384616
2024-09-22 10:52:17.782 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 96.15384615384616
2024-09-22 10:52:17.783 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 96.15384615384616
2024-09-22 10:52:17.783 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 96.15384615384616
2024-09-22 10:52:17.784 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 96.15384615384616
2024-09-22 10:52:17.785 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 96.15384615384616
2024-09-22 10:52:17.786 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 96.15384615384616
2024-09-22 10:52:17.787 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 96.15384615384616
2024-09-22 10:52:17.787 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 96.15384615384616
2024-09-22 10:52:17.788 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 96.15384615384616
2024-09-22 10:52:17.789 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 96.15384615384616
2024-09-22 10:52:17.790 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 96.15384615384616
2024-09-22 10:52:17.791 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6486013986013984
2024-09-22 10:52:17.792 | INFO     | retrieval.model:validation_step:389 - End of validation_step
100%|████████████████████████████████████████████████████████████████████████████████| 355/355 [01:14<00:00,  4.74it/s]
                                                                                                                      2024-09-22 10:52:18.595 | INFO     | retrieval.model:validation_step:318 - Inside validation_step | 0/1 [00:00<?, ?it/s]
2024-09-22 10:52:18.614 | INFO     | retrieval.model:validation_step:322 - Embeddings staled validation step: False
2024-09-22 10:52:19.081 | INFO     | retrieval.model:validation_step:372 - Recall@1_val: 34.375
2024-09-22 10:52:19.085 | INFO     | retrieval.model:validation_step:372 - Recall@2_val: 45.83333333333333
2024-09-22 10:52:19.086 | INFO     | retrieval.model:validation_step:372 - Recall@3_val: 52.86458333333333
2024-09-22 10:52:19.087 | INFO     | retrieval.model:validation_step:372 - Recall@4_val: 59.11458333333333
2024-09-22 10:52:19.088 | INFO     | retrieval.model:validation_step:372 - Recall@5_val: 63.28125
2024-09-22 10:52:19.088 | INFO     | retrieval.model:validation_step:372 - Recall@6_val: 66.40625
2024-09-22 10:52:19.089 | INFO     | retrieval.model:validation_step:372 - Recall@7_val: 66.40625
2024-09-22 10:52:19.090 | INFO     | retrieval.model:validation_step:372 - Recall@8_val: 70.57291666666666
2024-09-22 10:52:19.091 | INFO     | retrieval.model:validation_step:372 - Recall@9_val: 73.69791666666666
2024-09-22 10:52:19.092 | INFO     | retrieval.model:validation_step:372 - Recall@10_val: 76.82291666666666
2024-09-22 10:52:19.093 | INFO     | retrieval.model:validation_step:372 - Recall@11_val: 79.94791666666666
2024-09-22 10:52:19.094 | INFO     | retrieval.model:validation_step:372 - Recall@12_val: 83.07291666666666
2024-09-22 10:52:19.094 | INFO     | retrieval.model:validation_step:372 - Recall@13_val: 83.07291666666666
2024-09-22 10:52:19.095 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 83.07291666666666
2024-09-22 10:52:19.096 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 83.07291666666666
2024-09-22 10:52:19.097 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 83.07291666666666
2024-09-22 10:52:19.098 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 83.07291666666666
2024-09-22 10:52:19.099 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 83.07291666666666
2024-09-22 10:52:19.100 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 83.07291666666666
2024-09-22 10:52:19.100 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 83.07291666666666
2024-09-22 10:52:19.101 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 83.07291666666666
2024-09-22 10:52:19.102 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 85.15625
2024-09-22 10:52:19.103 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 85.15625
2024-09-22 10:52:19.104 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 85.15625
2024-09-22 10:52:19.105 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 85.15625
2024-09-22 10:52:19.105 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 88.28125
2024-09-22 10:52:19.106 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 88.28125
2024-09-22 10:52:19.107 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 88.28125
2024-09-22 10:52:19.108 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 90.36458333333333
2024-09-22 10:52:19.109 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 90.36458333333333
2024-09-22 10:52:19.110 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 90.36458333333333
2024-09-22 10:52:19.111 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 90.36458333333333
2024-09-22 10:52:19.111 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 90.36458333333333
2024-09-22 10:52:19.112 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 90.36458333333333
2024-09-22 10:52:19.113 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 90.36458333333333
2024-09-22 10:52:19.114 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 90.36458333333333
2024-09-22 10:52:19.115 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 90.36458333333333
2024-09-22 10:52:19.116 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 90.36458333333333
2024-09-22 10:52:19.116 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 90.36458333333333
2024-09-22 10:52:19.117 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 90.36458333333333
2024-09-22 10:52:19.118 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 90.36458333333333
2024-09-22 10:52:19.119 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 90.36458333333333
2024-09-22 10:52:19.120 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 90.36458333333333
2024-09-22 10:52:19.121 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 90.36458333333333
2024-09-22 10:52:19.122 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 90.36458333333333
2024-09-22 10:52:19.123 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 90.36458333333333
2024-09-22 10:52:19.124 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 90.36458333333333
2024-09-22 10:52:19.124 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 90.36458333333333
2024-09-22 10:52:19.125 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 90.36458333333333
2024-09-22 10:52:19.126 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 90.36458333333333
2024-09-22 10:52:19.127 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 90.36458333333333
2024-09-22 10:52:19.128 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 90.36458333333333
2024-09-22 10:52:19.129 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 90.36458333333333
2024-09-22 10:52:19.129 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 90.36458333333333
2024-09-22 10:52:19.130 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 90.36458333333333
2024-09-22 10:52:19.131 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 90.36458333333333
2024-09-22 10:52:19.132 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 90.36458333333333
2024-09-22 10:52:19.133 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 90.36458333333333
2024-09-22 10:52:19.134 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 90.36458333333333
2024-09-22 10:52:19.135 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 90.36458333333333
2024-09-22 10:52:19.135 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 90.36458333333333
2024-09-22 10:52:19.136 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 90.36458333333333
2024-09-22 10:52:19.137 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 90.36458333333333
2024-09-22 10:52:19.138 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 90.36458333333333
2024-09-22 10:52:19.139 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 90.36458333333333
2024-09-22 10:52:19.140 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 90.36458333333333
2024-09-22 10:52:19.140 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 90.36458333333333
2024-09-22 10:52:19.141 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 90.36458333333333
2024-09-22 10:52:19.142 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 90.36458333333333
2024-09-22 10:52:19.143 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 90.36458333333333
2024-09-22 10:52:19.144 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 90.36458333333333
2024-09-22 10:52:19.145 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 90.36458333333333
2024-09-22 10:52:19.145 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 90.36458333333333
2024-09-22 10:52:19.146 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 91.14583333333333
2024-09-22 10:52:19.147 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 91.14583333333333
2024-09-22 10:52:19.148 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 91.14583333333333
2024-09-22 10:52:19.149 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 91.14583333333333
2024-09-22 10:52:19.150 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 91.14583333333333
2024-09-22 10:52:19.151 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 91.14583333333333
2024-09-22 10:52:19.151 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 91.14583333333333
2024-09-22 10:52:19.152 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 91.14583333333333
2024-09-22 10:52:19.153 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 91.14583333333333
2024-09-22 10:52:19.154 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 91.14583333333333
2024-09-22 10:52:19.155 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 91.14583333333333
2024-09-22 10:52:19.156 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 91.14583333333333
2024-09-22 10:52:19.156 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 91.14583333333333
2024-09-22 10:52:19.157 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 91.14583333333333
2024-09-22 10:52:19.158 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 91.14583333333333
2024-09-22 10:52:19.159 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 91.14583333333333
2024-09-22 10:52:19.160 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 91.14583333333333
2024-09-22 10:52:19.161 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 91.14583333333333
2024-09-22 10:52:19.162 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 91.14583333333333
2024-09-22 10:52:19.162 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 91.14583333333333
2024-09-22 10:52:19.163 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 91.14583333333333
2024-09-22 10:52:19.164 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 91.14583333333333
2024-09-22 10:52:19.165 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 91.14583333333333
2024-09-22 10:52:19.166 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 91.14583333333333
2024-09-22 10:52:19.167 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 91.14583333333333
2024-09-22 10:52:19.168 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 91.14583333333333
2024-09-22 10:52:19.168 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 91.14583333333333
2024-09-22 10:52:19.169 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6145359848484848
2024-09-22 10:52:19.170 | INFO     | retrieval.model:validation_step:389 - End of validation_step
Epoch 8: 100%|██████████████████████████████████████████████████████████████| 427/427 [03:58<00:00,  1.79it/s, v_num=4]Epoch 8, global step 11266: 'Recall@10_val' reached 73.57858 (best 76.48103), saving model to '/data/yingzi_ma/lean_project
/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt' as top 9
`Trainer.fit` stopped: `max_epochs=9` reached.
Epoch 8: 100%|██████████████████████████████████████████████████████████████| 427/427 [04:01<00:00,  1.77it/s, v_num=4]
2024-09-22 10:52:25.105 | INFO     | __main__:main:1670 - hit the barrier after training
2024-09-22 10:52:25.961 | INFO     | __main__:main:1670 - hit the barrier after training
2024-09-22 10:52:26.128 | INFO     | __main__:main:1670 - hit the barrier after training
2024-09-22 10:52:26.862 | INFO     | __main__:main:1670 - hit the barrier after training
2024-09-22 10:52:26.862 | INFO     | __main__:main:1676 - Finished progressive training at epoch 9
2024-09-22 10:52:26.863 | INFO     | __main__:main:1676 - Finished progressive training at epoch 9
2024-09-22 10:52:26.863 | INFO     | __main__:main:1676 - Finished progressive training at epoch 9
2024-09-22 10:52:26.863 | INFO     | __main__:main:1676 - Finished progressive training at epoch 9
2024-09-22 10:52:26.863 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef2
1276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.863 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef2
1276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.863 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef2
1276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.864 | INFO     | __main__:find_latest_checkpoint:704 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef2
1276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.864 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_ep
och=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.864 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_ep
och=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.864 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_ep
och=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:26.864 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_ep
och=8-Recall@10_val=73.58.ckpt
2024-09-22 10:52:28.657 | INFO     | __main__:main:1693 - Testing...
2024-09-22 10:52:28.658 | INFO     | retrieval.main:run_cli:60 - PID: 2884978
2024-09-22 10:52:28.891 | INFO     | __main__:main:1693 - Testing...
2024-09-22 10:52:28.891 | INFO     | retrieval.main:run_cli:60 - PID: 2884980
[rank: 1] Seed set to 3407
2024-09-22 10:52:28.919 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-22 10:52:28.919 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
[rank: 3] Seed set to 3407
2024-09-22 10:52:29.154 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-22 10:52:29.154 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
2024-09-22 10:52:29.262 | INFO     | __main__:main:1693 - Testing...
2024-09-22 10:52:29.263 | INFO     | retrieval.main:run_cli:60 - PID: 2884979
2024-09-22 10:52:29.412 | INFO     | __main__:main:1693 - Testing...
2024-09-22 10:52:29.414 | INFO     | retrieval.main:run_cli:60 - PID: 2882462
2024-09-22 10:52:29.434 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-22 10:52:29.521 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-22 10:52:29.522 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
[rank: 0] Seed set to 3407
2024-09-22 10:52:29.664 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-22 10:52:29.665 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
2024-09-22 10:52:29.793 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-22 10:52:30.033 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-22 10:52:30.171 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
[rank: 3] Seed set to 3407
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 2] Seed set to 3407
[rank: 0] Seed set to 3407
2024-09-22 10:52:41.604 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_train/cached_data.pkl
Training dataset size: 169493
2024-09-22 10:52:41.622 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2597
2024-09-22 10:52:41.651 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_train/cached_data.pkl
Training dataset size: 169493
2024-09-22 10:52:41.667 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2597
2024-09-22 10:52:42.273 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_train/cached_data.pkl
Training dataset size: 169493
2024-09-22 10:52:42.286 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2597
2024-09-22 10:52:47.835 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_train/cached_data.pkl
Training dataset size: 169493
2024-09-22 10:52:47.855 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2597
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-22 10:52:50.679 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:52:50.695 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
2024-09-22 10:52:50.699 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:52:50.699 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/1717 [00:00<?, ?it/s]2024-09-22 10:52:50.738 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:52:50.738 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 10:52:51.751 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 10:52:51.752 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:10<00:00,  3.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:10<00:00,  3.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:14<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:14<00:00,  3.10it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 11/11 [00:22<00:00,  0.49it/s]2024-09-22 11:02:28.724 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:02:28.874 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 11:02:28.874 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:02:31.000 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:02:31.000 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:02:31.000 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:02:31.141 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 11:02:31.141 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:02:31.142 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 11:02:31.142 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:02:31.148 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 11:02:31.148 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:02:31.149 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 11/11 [00:25<00:00,  0.44it/s]
2024-09-22 11:02:32.430 | INFO     | retrieval.main:run_cli:60 - PID: 2884980
2024-09-22 11:02:32.485 | INFO     | retrieval.main:run_cli:60 - PID: 2884978
2024-09-22 11:02:32.527 | INFO     | retrieval.main:run_cli:60 - PID: 2884979
[rank: 3] Seed set to 3407
2024-09-22 11:02:32.729 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-09-22 11:02:32.729 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corp
us.jsonl
[rank: 1] Seed set to 3407
2024-09-22 11:02:32.735 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-09-22 11:02:32.735 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corp
us.jsonl
[rank: 2] Seed set to 3407
2024-09-22 11:02:32.821 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-09-22 11:02:32.822 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corp
us.jsonl
2024-09-22 11:02:33.164 | INFO     | __main__:main:1715 - Loaded the predictions pickle files
2024-09-22 11:02:33.215 | INFO     | __main__:main:1718 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|███████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 43301.53it/s]
2024-09-22 11:02:33.251 | INFO     | __main__:main:1720 - R@1 = 27.50255747613808 %, R@10 = 66.65623317441897 %, MRR = 0.5471020518324533
2024-09-22 11:02:33.252 | INFO     | retrieval.main:run_cli:60 - PID: 2882462
2024-09-22 11:02:33.253 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-09-22 11:02:33.302 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-09-22 11:02:33.365 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-22 11:02:33.592 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-09-22 11:02:33.592 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corp
us.jsonl
2024-09-22 11:02:34.208 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 3] Seed set to 3407
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-22 11:02:45.726 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-22 11:02:45.745 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
2024-09-22 11:02:47.309 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-22 11:02:47.859 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-22 11:02:47.877 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
2024-09-22 11:02:48.345 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-22 11:02:48.362 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
2024-09-22 11:02:48.839 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655
744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
2024-09-22 11:02:51.528 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 11:02:51.528 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/2027 [00:00<?, ?it/s]2024-09-22 11:02:51.583 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 11:02:51.583 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/2027 [00:00<?, ?it/s]2024-09-22 11:02:51.604 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 11:02:51.604 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]2024-09-22 11:02:52.653 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-22 11:02:52.653 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:21<00:00,  3.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:22<00:00,  3.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:25<00:00,  3.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:25<00:00,  3.58it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:23<00:00,  0.42it/s]2024-09-22 11:12:42.474 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:12:42.637 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-22 11:12:42.637 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:12:47.279 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:12:47.279 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:12:47.279 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-22 11:12:47.413 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-22 11:12:47.413 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:12:47.415 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-22 11:12:47.415 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:12:47.458 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-22 11:12:47.458 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-22 11:12:47.458 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████| 10/10 [00:28<00:00,  0.35it/s]
2024-09-22 11:12:48.515 | INFO     | retrieval.main:run_cli:60 - PID: 2884979
2024-09-22 11:12:48.637 | INFO     | retrieval.main:run_cli:60 - PID: 2884978
2024-09-22 11:12:48.706 | INFO     | retrieval.main:run_cli:60 - PID: 2884980
[rank: 2] Seed set to 3407
2024-09-22 11:12:48.840 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 11:12:48.841 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpu
s.jsonl
[rank: 1] Seed set to 3407
2024-09-22 11:12:48.898 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 11:12:48.898 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpu
s.jsonl
[rank: 3] Seed set to 3407
2024-09-22 11:12:49.025 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random
2024-09-22 11:12:49.025 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpu
s.jsonl
2024-09-22 11:12:49.343 | INFO     | __main__:main:2215 - An error occurred: pickle data was truncated
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_abl1.py", line 1712, in main
    num_gpus = 4 # TODO: change for GPU
_pickle.UnpicklingError: pickle data was truncated
2024-09-22 11:12:49.382 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-22 11:12:49.493 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-22 11:12:49.571 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank0]:[W922 11:12:58.142815806 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that a
ny pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only
 been added since PyTorch 2.4 (function operator())
[rank: 1] Seed set to 3407
run_code3_abl1.sh: line 21: unexpected EOF while looking for matching `"'
run_code3_abl1.sh: line 23: syntax error: unexpected end of file
(base) yingzi_ma@compute-permanent-node-519:~/lean_project/ReProver$ bash run_code3_abl1.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758905.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758901.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758890.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_GCS.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2759530.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758904.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_RAYLET.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758900.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758065.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758906.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_AUTOSCALER.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758902.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758903.log': Permission denied
rm: cannot remove '/data/yingzi_ma/lean_project/tmp/ray': Directory not empty
mkdir: cannot create directory ‘/data/yingzi_ma/lean_project/tmp’: File exists
Stopping ray
Did not find any active Ray processes.
kill: (6968): Operation not permitted
kill: (7274): Operation not permitted
kill: (931994): Operation not permitted
kill: (932012): Operation not permitted
kill: (932013): Operation not permitted
kill: (932014): Operation not permitted
kill: (932021): Operation not permitted
kill: (932932): Operation not permitted
kill: (932959): Operation not permitted
kill: (932960): Operation not permitted
kill: (932961): Operation not permitted
kill: (932968): Operation not permitted
kill: (933682): Operation not permitted
kill: (933700): Operation not permitted
kill: (933701): Operation not permitted
kill: (933702): Operation not permitted
kill: (933709): Operation not permitted
kill: (3200197): Operation not permitted
kill: (3314176): Operation not permitted
kill: (3342826): Operation not permitted
kill: (3409036): Operation not permitted
kill: (3769542): No such process
Sun Sep 22 13:28:15 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   51C    P0             93W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:8C:00.0 Off |                    0 |
| N/A   39C    P0             84W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:91:00.0 Off |                    0 |
| N/A   38C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:DA:00.0 Off |                    0 |
| N/A   50C    P0             88W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running main3_abl1.py
[2024-09-22 13:28:23,281] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-22 13:28:28.159 | INFO     | __main__:main:1400 - Running progressive training
2024-09-22 13:28:28.160 | INFO     | __main__:main:1406 - Configuring LeanDojo...
2024-09-22 13:28:28.162 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-22 13:28:28.162 | INFO     | __main__:main:1408 - LeanDojo configured
2024-09-22 13:28:28.163 | INFO     | __main__:main:1413 - Starting the main process
2024-09-22 13:28:28.163 | INFO     | __main__:main:1421 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_abl1.json
2024-09-22 13:29:20.139 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-22 13:29:20.139 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-22 13:29:26.243 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-22 13:29:26.243 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-22 13:29:33.215 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-22 13:29:33.215 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-22 13:29:41.027 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 89bf7b5e3a226525e8580bae21ef543604f99b21)
2024-09-22 13:29:41.027 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 89bf7b5e3a226525e8580bae21ef543604f99b21)
2024-09-22 13:29:51.178 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-22 13:29:51.179 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-22 13:30:00.438 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-22 13:30:00.438 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-22 13:30:02.455 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-22 13:30:02.455 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-22 13:30:03.079 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-22 13:30:03.079 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-22 13:30:03.221 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-22 13:30:03.221 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-22 13:30:13.732 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-22 13:30:13.733 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-22 13:30:15.668 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-22 13:30:15.668 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-22 13:30:16.031 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-22 13:30:16.031 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-22 13:30:16.758 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-22 13:30:16.758 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-22 13:30:17.053 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-22 13:30:17.053 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-22 13:30:18.160 | INFO     | __main__:main:1423 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_abl1.json
2024-09-22 13:30:18.161 | INFO     | __main__:main:1430 - Found 9 repositories
2024-09-22 13:30:18.161 | INFO     | __main__:main:1433 - Starting curriculum learning
2024-09-22 13:30:18.524 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-22 13:30:35.143 | INFO     | __main__:main:1510 - length of lean_git_repos: 1
2024-09-22 13:30:35.143 | INFO     | __main__:main:1511 - i: 0
2024-09-22 13:30:35.143 | INFO     | __main__:main:1517 - Main process
2024-09-22 13:30:35.143 | INFO     | __main__:main:1518 - Using lambda = 0.1
2024-09-22 13:30:35.143 | INFO     | __main__:main:1519 - Processing https://github.com/digama0/lean4lean
2024-09-22 13:30:35.143 | INFO     | __main__:main:1526 - Adding repo to repos_for_merged_dataset
2024-09-22 13:30:35.145 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-22 13:30:35.145 | INFO     | __main__:main:2223 - An error occurred: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_abl1.py", line 1533, in main
    db.generate_merged_dataset(dst_dir_debate, repos_for_merged_dataset_debate)
  File "/data/yingzi_ma/lean_project/ReProver/dynamic_database.py", line 416, in generate_merged_dataset
    for url, commit in repos_to_include:
ValueError: too many values to unpack (expected 2)
(base) yingzi_ma@compute-permanent-node-519:~/lean_project/ReProver$ bash run_code3_abl1.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758905.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758901.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758890.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_GCS.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2759530.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758904.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_RAYLET.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758900.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758065.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758906.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_AUTOSCALER.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758902.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-22_03-10-46_831852_2758123/logs/events/event_CORE_WORKER_2758903.log': Permission denied
Stopping ray
Did not find any active Ray processes.
kill: (6968): Operation not permitted
kill: (7274): Operation not permitted
kill: (931994): Operation not permitted
kill: (932012): Operation not permitted
kill: (932013): Operation not permitted
kill: (932014): Operation not permitted
kill: (932021): Operation not permitted
kill: (932932): Operation not permitted
kill: (932959): Operation not permitted
kill: (932960): Operation not permitted
kill: (932961): Operation not permitted
kill: (932968): Operation not permitted
kill: (933682): Operation not permitted
kill: (933700): Operation not permitted
kill: (933701): Operation not permitted
kill: (933702): Operation not permitted
kill: (933709): Operation not permitted
kill: (3200197): Operation not permitted
kill: (3903621): Operation not permitted
kill: (3903668): Operation not permitted
kill: (3915857): Operation not permitted
kill: (3915891): Operation not permitted
kill: (3923460): Operation not permitted
kill: (3923494): Operation not permitted
kill: (3932753): Operation not permitted
kill: (3932787): Operation not permitted
kill: (3939775): No such process
Sun Sep 22 18:05:26 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   49C    P0             91W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:8C:00.0 Off |                    0 |
| N/A   39C    P0             84W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:91:00.0 Off |                    0 |
| N/A   37C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:DA:00.0 Off |                    0 |
| N/A   47C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running main3_abl1.py
[2024-09-22 18:05:35,234] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-22 18:05:40.487 | INFO     | __main__:main:1400 - Running progressive training
2024-09-22 18:05:40.487 | INFO     | __main__:main:1406 - Configuring LeanDojo...
2024-09-22 18:05:40.490 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-22 18:05:40.490 | INFO     | __main__:main:1408 - LeanDojo configured
2024-09-22 18:05:40.490 | INFO     | __main__:main:1413 - Starting the main process
2024-09-22 18:05:40.490 | INFO     | __main__:main:1421 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_abl1.json
2024-09-22 18:06:31.057 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-22 18:06:31.057 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-22 18:06:37.210 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-22 18:06:37.210 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-22 18:06:44.186 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-22 18:06:44.186 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-22 18:06:52.073 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 89bf7b5e3a226525e8580bae21ef543604f99b21)
2024-09-22 18:06:52.074 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 89bf7b5e3a226525e8580bae21ef543604f99b21)
2024-09-22 18:07:02.213 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-22 18:07:02.213 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-22 18:07:11.600 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-22 18:07:11.600 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-22 18:07:13.535 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-22 18:07:13.535 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-22 18:07:14.137 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-22 18:07:14.137 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-22 18:07:14.275 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-22 18:07:14.275 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-22 18:07:24.913 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-22 18:07:24.914 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-22 18:07:26.759 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-22 18:07:26.760 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-22 18:07:27.116 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-22 18:07:27.116 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-22 18:07:27.827 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-22 18:07:27.827 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-22 18:07:28.118 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-22 18:07:28.119 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-22 18:07:29.232 | INFO     | __main__:main:1423 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_abl1.json
2024-09-22 18:07:29.233 | INFO     | __main__:main:1430 - Found 9 repositories
2024-09-22 18:07:29.233 | INFO     | __main__:main:1433 - Starting curriculum learning
2024-09-22 18:07:29.626 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-22 18:07:46.474 | INFO     | __main__:main:1510 - length of lean_git_repos: 1
2024-09-22 18:07:46.474 | INFO     | __main__:main:1511 - i: 0
2024-09-22 18:07:46.474 | INFO     | __main__:main:1517 - Main process
2024-09-22 18:07:46.474 | INFO     | __main__:main:1518 - Using lambda = 0.1
2024-09-22 18:07:46.474 | INFO     | __main__:main:1519 - Processing https://github.com/digama0/lean4lean
2024-09-22 18:07:46.474 | INFO     | __main__:main:1526 - Adding repo to repos_for_merged_dataset
2024-09-22 18:07:46.475 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-22 18:07:46.475 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-22 18:08:31.574 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3 already exists. Remov
ing it now.
2024-09-22 18:08:40.766 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3
2024-09-22 18:08:41.104 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177f
abd29a5b5a3
2024-09-22 18:08:41.114 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3
2024-09-22 18:08:41.116 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5
a3
2024-09-22 18:08:41.126 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-22 18:08:41.127 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-22 18:08:41.181 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f already exists. Re
moving it now.
2024-09-22 18:08:41.673 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276
e0f
2024-09-22 18:08:41.754 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6
a56fef21276e0f
2024-09-22 18:08:41.759 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f
2024-09-22 18:08:41.760 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef212
76e0f
2024-09-22 18:08:41.760 | INFO     | __main__:main:1543 - All GPUs
2024-09-22 18:08:41.761 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef2
1276e0f_lambda_0.1_epoch=8-Recall@10_val=73.58.ckpt
2024-09-22 18:08:41.761 | INFO     | __main__:main:1550 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_ep
och=8-Recall@10_val=73.58.ckpt
2024-09-22 18:08:41.761 | INFO     | __main__:main:1556 - Inside train_test_fisher
2024-09-22 18:08:41.761 | INFO     | __main__:main:1557 - Starting training at epoch 8
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly
. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value f
or `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `to
rch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-22 18:08:45.419 | INFO     | __main__:main:1581 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1
_epoch=8-Recall@10_val=73.58.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, pr
epend your python command with `srun` like so: srun python main3_abl1.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-22 18:08:45.534 | INFO     | __main__:main:1639 - right before barrier for data module
2024-09-22 18:08:45.534 | INFO     | __main__:main:1654 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracte
d in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-22 18:08:45.638 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████| 2457/2457 [00:00<00:00, 6440.25it/s]
2024-09-22 18:08:46.688 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_train/cached_data.pkl
Training dataset size: 6840
100%|████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 7323.41it/s]
2024-09-22 18:08:46.699 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_val/cached_data.pkl
Validation dataset size: 95
100%|████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 7550.90it/s]
2024-09-22 18:08:46.711 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl1/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fe
f21276e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 157
2024-09-22 18:08:46.711 | INFO     | __main__:main:1668 - Training dataset size after load: 6840
2024-09-22 18:08:46.711 | INFO     | __main__:main:1669 - Validation dataset size after load: 95
2024-09-22 18:08:46.711 | INFO     | __main__:main:1670 - Testing dataset size after load: 157
2024-09-22 18:08:46.711 | INFO     | __main__:main:1672 - Starting progressive training from epoch 8 to 9
2024-09-22 18:08:46.711 | INFO     | __main__:main:1675 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-22 18:08:52,780] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-22 18:08:52,781] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-22 18:08:52,781] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-22 18:08:56.651 | INFO     | __main__:main:1400 - Running progressive training
2024-09-22 18:08:56.652 | INFO     | __main__:main:1406 - Configuring LeanDojo...
2024-09-22 18:08:56.655 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-22 18:08:56.655 | INFO     | __main__:main:1408 - LeanDojo configured
2024-09-22 18:08:56.655 | INFO     | __main__:main:1430 - Found 9 repositories
2024-09-22 18:08:56.655 | INFO     | __main__:main:1400 - Running progressive training
2024-09-22 18:08:56.655 | INFO     | __main__:main:1400 - Running progressive training
2024-09-22 18:08:56.655 | INFO     | __main__:main:1433 - Starting curriculum learning
2024-09-22 18:08:56.655 | INFO     | __main__:main:1406 - Configuring LeanDojo...
2024-09-22 18:08:56.655 | INFO     | __main__:main:1406 - Configuring LeanDojo...
2024-09-22 18:08:56.659 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-22 18:08:56.659 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-22 18:08:56.659 | INFO     | __main__:main:1408 - LeanDojo configured
2024-09-22 18:08:56.659 | INFO     | __main__:main:1408 - LeanDojo configured
2024-09-22 18:08:56.660 | INFO     | __main__:main:1430 - Found 9 repositories
2024-09-22 18:08:56.660 | INFO     | __main__:main:1430 - Found 9 repositories
2024-09-22 18:08:56.660 | INFO     | __main__:main:1433 - Starting curriculum learning
2024-09-22 18:08:56.660 | INFO     | __main__:main:1433 - Starting curriculum learning
2024-09-22 18:08:56.851 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-22 18:08:56.857 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-22 18:08:56.858 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1

