(base) yingzi_ma@cais-login-0:~/lean_project/ReProver$ srun --partition=compute --gpus=4 --nodes=1 --time=2-00:00:00 -
-pty /bin/bash
srun: job 87335 queued and waiting for resources
srun: job 87335 has been allocated resources
(base) yingzi_ma@compute-permanent-node-824:~/lean_project/ReProver$ ps aux | grep "python"
root        6950  0.0  0.0  33188 14280 ?        Ss   Aug08   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run
-startup-triggers
root        7265  0.1  0.0 262952 20400 ?        Ssl  Aug08 134:24 /usr/bin/python3 -Es /usr/sbin/tuned -l -P
root     2186363  0.0  0.0  60648 16320 ?        Ss   Sep13  35:05 /usr/bin/python2 /usr/local/bin/supervisord -n -c /
etc/supervisord.conf
root     2186381  0.0  0.0  25664  6120 ?        S    Sep13   0:00 /usr/bin/python2 /weka/scripts/logger.py
root     2186382  0.0  0.0 126832 12240 ?        Sl   Sep13   0:00 /usr/bin/python2 /weka/scripts/events.py --rpcbind_
register
root     2186383  0.0  0.0 1380000 4080 ?        S    Sep13   6:27 python2 /weka/scripts/shelld.py -p /var/run/shelld.
sock -s
root     2186390  4.4  0.0  74824 24816 ?        S    Sep13 3586:30 python3-weka /weka/scripts/rotate_files.py
root     2187167  0.0  0.0  60512 10200 ?        Ss   Sep13  31:52 /usr/bin/python2 /usr/local/bin/supervisord -n -c /
etc/supervisord.conf
root     2187198  0.0  0.0  25664  6120 ?        S    Sep13   0:00 /usr/bin/python2 /weka/scripts/logger.py
root     2187199  0.0  0.0 126832 12240 ?        Sl   Sep13   0:00 /usr/bin/python2 /weka/scripts/events.py --rpcbind_
register
root     2187200  0.0  0.0 724384  4080 ?        S    Sep13   6:06 python2 /weka/scripts/shelld.py -p /var/run/shelld.
sock -s
root     2187207  1.4  0.0  70596 24480 ?        S    Sep13 1182:31 python3-weka /weka/scripts/rotate_files.py
root     2187894  0.0  0.0  60612 10200 ?        Ss   Sep13  37:53 /usr/bin/python2 /usr/local/bin/supervisord -n -c /
etc/supervisord.conf
root     2187914  0.0  0.0  25664  6120 ?        S    Sep13   0:00 /usr/bin/python2 /weka/scripts/logger.py
root     2187915  0.0  0.0 126832 12240 ?        Sl   Sep13   0:00 /usr/bin/python2 /weka/scripts/events.py --rpcbind_
register
root     2187916  0.0  0.0 1379744 2040 ?        S    Sep13  10:01 python2 /weka/scripts/shelld.py -p /var/run/shelld.
sock -s
root     2187923  1.4  0.0  70596 20400 ?        S    Sep13 1158:32 python3-weka /weka/scripts/rotate_files.py
will_cai 2501787  0.2  0.0 765572 347564 pts/1   Sl+  Nov07   3:18 /data/will_cai/wicai24/ENTER/envs/rahf_env/bin/pyth
on /data/will_cai/wicai24/ENTER/envs/rahf_env/bin/jupyter-notebook --no-browser --port=8286
will_cai 2604042 17.1  1.8 102774384 39087496 ?  Ssl  00:33 161:32 /data/will_cai/wicai24/ENTER/envs/rahf_env/bin/pyth
on -m ipykernel_launcher -f /data/will_cai/.local/share/jupyter/runtime/kernel-d6faa9e1-c189-47f1-9021-3f316fa0d81d.js
on
tianyu_+ 2855142  0.0  0.0 377864 57120 ?        Sl   07:49   0:00 python -m FastChat.fastchat.serve.controller
tianyu_+ 2855143  0.0  0.0 377864 59160 ?        Sl   07:49   0:00 python -m FastChat.fastchat.serve.controller
tianyu_+ 2855144  0.0  0.0 304428 61200 ?        Sl   07:49   0:19 python -m FastChat.fastchat.serve.controller
tianyu_+ 2855147  178  0.0 29352284 1883852 ?    Sl   07:49 908:25 python -m FastChat.fastchat.serve.model_worker --mo
del-path mistralai/Mistral-7B-Instruct-v0.2
tianyu_+ 2855148  0.2  0.0 8645568 590944 ?      Sl   07:49   1:23 python src/gen_data/workflow_gen_from_failedkeys.py
 --data_path data/math/train.jsonl --env math --log_dir log/math/ --max_turns 2 --num_of_samples 1 16 --models Mistral
-7B-Instruct-v0.2 Mistral-7B-Instruct-v0.2 --start_idx 3750 --process_lth 50
tianyu_+ 2855149  0.1  0.0 8648636 591024 ?      Sl   07:49   0:46 python src/gen_data/workflow_gen_from_failedkeys.py
 --data_path data/math/train.jsonl --env math --log_dir log/math/ --max_turns 2 --num_of_samples 1 16 --models Mistral
-7B-Instruct-v0.2 Mistral-7B-Instruct-v0.2 --start_idx 3800 --process_lth 50
tianyu_+ 2855150  0.1  0.0 8644720 586812 ?      Sl   07:49   0:51 python src/gen_data/workflow_gen_from_failedkeys.py
 --data_path data/math/train.jsonl --env math --log_dir log/math/ --max_turns 2 --num_of_samples 1 16 --models Mistral
-7B-Instruct-v0.2 Mistral-7B-Instruct-v0.2 --start_idx 3850 --process_lth 50
yingzi_+ 3153520  0.0  0.0   7012  2040 pts/0    S+   16:17   0:00 grep --color=auto python
(base) yingzi_ma@compute-permanent-node-824:~/lean_project/ReProver$ bash run_code3full.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
rm: cannot remove '/tmp/ray/session_2024-08-18_01-24-47_655228_704985/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-24-47_655228_704985/metrics/grafana/provisioning/dashboards': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-24-47_655228_704985/metrics/grafana/provisioning/datasources': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-24-47_655228_704985/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-04-52_379825_3040113/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-04-52_379825_3040113/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-04-52_379825_3040113/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-04-52_379825_3040113/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-12-19_093562_3264862/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-12-19_093562_3264862/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-12-19_093562_3264862/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-12-19_093562_3264862/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-47-36_571336_1161904/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-47-36_571336_1161904/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-47-36_571336_1161904/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-47-36_571336_1161904/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-02-03_364178_2992725/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-02-03_364178_2992725/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-02-03_364178_2992725/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-02-03_364178_2992725/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-46-08_097084_2838361/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-46-08_097084_2838361/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-46-08_097084_2838361/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-46-08_097084_2838361/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-07-27_081570_3150613/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-07-27_081570_3150613/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-07-27_081570_3150613/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_07-07-27_081570_3150613/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-30-15_447866_854977/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-30-15_447866_854977/metrics/grafana/provisioning/dashboards': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-30-15_447866_854977/metrics/grafana/provisioning/datasources': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-30-15_447866_854977/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-14-22_477543_1824346/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-14-22_477543_1824346/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-14-22_477543_1824346/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-14-22_477543_1824346/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-22-32_731425_625213/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-22-32_731425_625213/metrics/grafana/provisioning/dashboards': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-22-32_731425_625213/metrics/grafana/provisioning/datasources': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-22-32_731425_625213/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-55-23_635687_1416119/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-55-23_635687_1416119/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-55-23_635687_1416119/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-55-23_635687_1416119/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-20-57_009433_2190974/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-20-57_009433_2190974/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-20-57_009433_2190974/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-20-57_009433_2190974/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-52-47_043731_1306443/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-52-47_043731_1306443/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-52-47_043731_1306443/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-52-47_043731_1306443/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-15-09_793674_496095/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-15-09_793674_496095/metrics/grafana/provisioning/dashboards': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-15-09_793674_496095/metrics/grafana/provisioning/datasources': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-15-09_793674_496095/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-16-53_796422_537170/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-16-53_796422_537170/metrics/grafana/provisioning/dashboards': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-16-53_796422_537170/metrics/grafana/provisioning/datasources': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-16-53_796422_537170/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-49-29_076125_2889517/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-49-29_076125_2889517/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-49-29_076125_2889517/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-49-29_076125_2889517/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-39-41_592697_1031525/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-39-41_592697_1031525/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-39-41_592697_1031525/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-39-41_592697_1031525/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-53-37_785990_2939355/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-53-37_785990_2939355/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-53-37_785990_2939355/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_06-53-37_785990_2939355/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-01-42_963555_1525485/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-01-42_963555_1525485/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-01-42_963555_1525485/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-01-42_963555_1525485/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-06-19_023770_1673900/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-06-19_023770_1673900/metrics/grafana/provisioning/dashboards': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-06-19_023770_1673900/metrics/grafana/provisioning/datasources': Perm
ission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_02-06-19_023770_1673900/metrics/grafana/dashboards': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/metrics/prometheus': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/metrics/grafana/provisioning/dashboards': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/metrics/grafana/provisioning/datasources': Permi
ssion denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/metrics/grafana/dashboards': Permission denied
Stopping ray
Did not find any active Ray processes.
kill: (6950): Operation not permitted
kill: (7265): Operation not permitted
kill: (2186363): Operation not permitted
kill: (2186381): Operation not permitted
kill: (2186382): Operation not permitted
kill: (2186383): Operation not permitted
kill: (2186390): Operation not permitted
kill: (2187167): Operation not permitted
kill: (2187198): Operation not permitted
kill: (2187199): Operation not permitted
kill: (2187200): Operation not permitted
kill: (2187207): Operation not permitted
kill: (2187894): Operation not permitted
kill: (2187914): Operation not permitted
kill: (2187915): Operation not permitted
kill: (2187916): Operation not permitted
kill: (2187923): Operation not permitted
kill: (2501787): Operation not permitted
kill: (2604042): Operation not permitted
kill: (2855142): Operation not permitted
kill: (2855143): Operation not permitted
kill: (2855144): Operation not permitted
kill: (2855147): Operation not permitted
kill: (2855148): Operation not permitted
kill: (2855149): Operation not permitted
kill: (2855150): Operation not permitted
kill: (3153555): No such process
Fri Nov  8 16:18:03 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   41C    P0             89W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   38C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:D6:00.0 Off |                    0 |
| N/A   38C    P0             85W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:DA:00.0 Off |                    0 |
| N/A   41C    P0             88W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running main3full.py
[2024-11-08 16:18:13,581] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect
)
2024-11-08 16:18:18.252 | INFO     | __main__:main:1457 - Running progressive training
2024-11-08 16:18:18.252 | INFO     | __main__:main:1463 - Configuring LeanDojo...
2024-11-08 16:18:18.255 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /dat
a/yingzi_ma/lean_project/ReProver
2024-11-08 16:18:18.255 | INFO     | __main__:main:1465 - LeanDojo configured
2024-11-08 16:18:18.255 | INFO     | __main__:main:1470 - Starting the main process
2024-11-08 16:18:18.256 | INFO     | __main__:main:1478 - Loading database from /data/yingzi_ma/lean_project/dynamic_d
atabase_PT_single_repo_no_ewc_curriculum_full2.json
2024-11-08 16:19:55.502 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-11-08 16:19:55.502 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dw
rensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-11-08 16:20:07.423 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-11-08 16:20:07.423 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ah
hwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-11-08 16:20:19.559 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-11-08 16:20:19.559 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/av
igad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-11-08 16:20:21.581 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-11-08 16:20:21.581 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Al
exKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-11-08 16:20:34.881 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-11-08 16:20:34.882 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yu
ma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-11-08 16:20:36.657 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-11-08 16:20:36.657 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Im
perialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-11-08 16:20:38.415 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-11-08 16:20:38.415 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/mo
271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-11-08 16:20:53.271 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f515a0e52878)
2024-11-08 16:20:53.271 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Lo
uis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f515a0e52878)
2024-11-08 16:20:55.116 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-11-08 16:20:55.116 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/te
orth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-11-08 16:20:56.935 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-11-08 16:20:56.935 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/fp
vandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-11-08 16:20:58.603 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-11-08 16:20:58.604 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Ya
elDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-11-08 16:21:15.413 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/corent1234/hairy-ball-theorem-lean (commit: fa500d7d2e58580bac7c050f0f6c408041b70205)
2024-11-08 16:21:15.413 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/co
rent1234/hairy-ball-theorem-lean (commit: fa500d7d2e58580bac7c050f0f6c408041b70205)
2024-11-08 16:21:17.164 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-11-08 16:21:17.164 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/le
copivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-11-08 16:21:18.916 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-11-08 16:21:18.916 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/NU
S-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-11-08 16:21:20.643 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-11-08 16:21:20.643 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ya
ngky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-11-08 16:21:22.244 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-11-08 16:21:22.244 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/go
ogle-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-11-08 16:21:41.305 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-11-08 16:21:41.305 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/er
ic-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-11-08 16:21:42.022 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-11-08 16:21:42.022 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/le
anprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-11-08 16:21:42.636 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-11-08 16:21:42.636 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Fo
rmalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-11-08 16:21:43.118 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-11-08 16:21:43.118 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/m4
lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-11-08 16:21:43.476 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-11-08 16:21:43.476 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lo
ganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-11-08 16:21:43.766 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-11-08 16:21:43.766 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/si
ddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-11-08 16:21:43.907 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-11-08 16:21:43.907 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/di
gama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-11-08 16:21:47.313 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://githu
b.com/Adarsh321123/PutnamBench (commit: 14ea70715649764b046183d4417d50bd9cf6cd0b)
2024-11-08 16:21:47.313 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Ad
arsh321123/PutnamBench (commit: 14ea70715649764b046183d4417d50bd9cf6cd0b)
2024-11-08 16:21:49.545 | INFO     | __main__:main:1480 - Loaded database from /data/yingzi_ma/lean_project/dynamic_da
tabase_PT_single_repo_no_ewc_curriculum_full2.json
2024-11-08 16:21:49.547 | INFO     | __main__:main:1487 - Found 23 repositories
2024-11-08 16:21:49.547 | INFO     | __main__:main:1490 - Starting curriculum learning
2024-11-08 16:21:50.035 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for
lean4 v4.8.0
2024-11-08 16:22:10.673 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 16:22:10.674 | INFO     | __main__:main:1612 - i: 0
2024-11-08 16:22:10.674 | INFO     | __main__:main:1618 - Main process
2024-11-08 16:22:10.674 | INFO     | __main__:main:1619 - Using lambda = 0.1
2024-11-08 16:22:10.674 | INFO     | __main__:main:1620 - Processing https://github.com/siddhartha-gadgil/Saturn
2024-11-08 16:22:10.674 | INFO     | __main__:main:1627 - Adding repo to repos_for_merged_dataset
2024-11-08 16:22:10.675 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in t
he database:
2024-11-08 16:22:10.675 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/math
ematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-11-08 16:23:12.216 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets
_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a57638
9ecf5 already exists. Removing it now.
2024-11-08 16:23:24.272 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma
/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_mathematics_in_lean_source_5297e0fb05136
7c48c0a084411853a576389ecf5
2024-11-08 16:23:24.674 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /dat
a/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_mathematics_in_lean_source_52
97e0fb051367c48c0a084411853a576389ecf5
2024-11-08 16:23:24.687 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_mathematics_in_lean_source_5297e0f
b051367c48c0a084411853a576389ecf5
2024-11-08 16:23:24.689 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_mathematics_in_lean_source_5297e0fb051
367c48c0a084411853a576389ecf5
2024-11-08 16:23:24.702 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in t
he database:
2024-11-08 16:23:24.702 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/siddhartha-
gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-11-08 16:23:25.455 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets
_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a already exists
. Removing it now.
2024-11-08 16:23:26.693 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma
/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2
ec4a42a
2024-11-08 16:23:26.818 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /dat
a/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1
896720c28d2ec4a42a
2024-11-08 16:23:26.824 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c189672
0c28d2ec4a42a
2024-11-08 16:23:26.826 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a
2024-11-08 16:23:26.828 | INFO     | __main__:main:1640 - All GPUs
2024-11-08 16:23:26.828 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:23:26.828 | INFO     | __main__:main:1648 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.
1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:23:26.828 | INFO     | __main__:main:1654 - Inside train_test_fisher
2024-11-08 16:23:26.828 | INFO     | __main__:main:1655 - Starting training at epoch 21
[rank: 0] Seed set to 3407
2024-11-08 16:23:30.086 | INFO     | __main__:main:1679 - Loaded premise retriever at /data/yingzi_ma/lean_project/che
ckpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda
_0.1_epoch=21-Recall@10_val=76.85.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:2
04: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLU
RM, prepend your python command with `srun` like so: srun python main3full.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-08 16:23:30.193 | INFO     | __main__:main:1737 - right before barrier for data module
2024-11-08 16:23:30.194 | INFO     | __main__:main:1752 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_r
epo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
100%|████████████████████████████████████████████████████████████████████████| 10544/10544 [00:00<00:00, 13081.56it/s]
2024-11-08 16:23:32.486 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c189672
0c28d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
100%|████████████████████████████████████████████████████████████████████████████| 219/219 [00:00<00:00, 10283.03it/s]
2024-11-08 16:23:32.515 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c189672
0c28d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
100%|█████████████████████████████████████████████████████████████████████████████| 219/219 [00:00<00:00, 8204.22it/s]
2024-11-08 16:23:32.550 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c189672
0c28d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
2024-11-08 16:23:32.550 | INFO     | __main__:main:1766 - Training dataset size after load: 14904
2024-11-08 16:23:32.550 | INFO     | __main__:main:1767 - Validation dataset size after load: 251
2024-11-08 16:23:32.550 | INFO     | __main__:main:1768 - Testing dataset size after load: 374
2024-11-08 16:23:32.550 | INFO     | __main__:main:1770 - Starting progressive training from epoch 21 to 22
2024-11-08 16:23:32.550 | INFO     | __main__:main:1773 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-11-08 16:23:39,266] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect
)
[2024-11-08 16:23:39,270] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect
)
[2024-11-08 16:23:39,270] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect
)
2024-11-08 16:23:42.457 | INFO     | __main__:main:1457 - Running progressive training
2024-11-08 16:23:42.457 | INFO     | __main__:main:1463 - Configuring LeanDojo...
2024-11-08 16:23:42.460 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /dat
a/yingzi_ma/lean_project/ReProver
2024-11-08 16:23:42.460 | INFO     | __main__:main:1465 - LeanDojo configured
2024-11-08 16:23:42.461 | INFO     | __main__:main:1487 - Found 23 repositories
2024-11-08 16:23:42.461 | INFO     | __main__:main:1490 - Starting curriculum learning
2024-11-08 16:23:42.546 | INFO     | __main__:main:1457 - Running progressive training
2024-11-08 16:23:42.546 | INFO     | __main__:main:1463 - Configuring LeanDojo...
2024-11-08 16:23:42.551 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /dat
a/yingzi_ma/lean_project/ReProver
2024-11-08 16:23:42.551 | INFO     | __main__:main:1465 - LeanDojo configured
2024-11-08 16:23:42.551 | INFO     | __main__:main:1487 - Found 23 repositories
2024-11-08 16:23:42.551 | INFO     | __main__:main:1490 - Starting curriculum learning
2024-11-08 16:23:42.556 | INFO     | __main__:main:1457 - Running progressive training
2024-11-08 16:23:42.556 | INFO     | __main__:main:1463 - Configuring LeanDojo...
2024-11-08 16:23:42.559 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /dat
a/yingzi_ma/lean_project/ReProver
2024-11-08 16:23:42.559 | INFO     | __main__:main:1465 - LeanDojo configured
2024-11-08 16:23:42.559 | INFO     | __main__:main:1487 - Found 23 repositories
2024-11-08 16:23:42.560 | INFO     | __main__:main:1490 - Starting curriculum learning
2024-11-08 16:23:42.680 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for
lean4 v4.8.0
2024-11-08 16:23:42.753 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for
lean4 v4.8.0
2024-11-08 16:23:42.791 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for
lean4 v4.8.0
2024-11-08 16:24:03.148 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 16:24:03.148 | INFO     | __main__:main:1612 - i: 0
2024-11-08 16:24:03.148 | INFO     | __main__:main:1640 - All GPUs
2024-11-08 16:24:03.149 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:03.149 | INFO     | __main__:main:1648 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.
1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:24:03.149 | INFO     | __main__:main:1654 - Inside train_test_fisher
2024-11-08 16:24:03.149 | INFO     | __main__:main:1655 - Starting training at epoch 21
[rank: 1] Seed set to 3407
2024-11-08 16:24:03.162 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 16:24:03.162 | INFO     | __main__:main:1612 - i: 0
2024-11-08 16:24:03.162 | INFO     | __main__:main:1640 - All GPUs
2024-11-08 16:24:03.163 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:03.163 | INFO     | __main__:main:1648 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.
1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:24:03.163 | INFO     | __main__:main:1654 - Inside train_test_fisher
2024-11-08 16:24:03.163 | INFO     | __main__:main:1655 - Starting training at epoch 21
[rank: 2] Seed set to 3407
2024-11-08 16:24:04.492 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 16:24:04.492 | INFO     | __main__:main:1612 - i: 0
2024-11-08 16:24:04.492 | INFO     | __main__:main:1640 - All GPUs
2024-11-08 16:24:04.493 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:04.493 | INFO     | __main__:main:1648 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.
1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:24:04.493 | INFO     | __main__:main:1654 - Inside train_test_fisher
2024-11-08 16:24:04.493 | INFO     | __main__:main:1655 - Starting training at epoch 21
[rank: 3] Seed set to 3407
2024-11-08 16:24:05.791 | INFO     | __main__:main:1679 - Loaded premise retriever at /data/yingzi_ma/lean_project/che
ckpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda
_0.1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:24:05.893 | INFO     | __main__:main:1737 - right before barrier for data module
2024-11-08 16:24:05.893 | INFO     | __main__:main:1752 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_r
epo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-08 16:24:05.971 | INFO     | __main__:main:1679 - Loaded premise retriever at /data/yingzi_ma/lean_project/che
ckpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda
_0.1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:24:06.017 | INFO     | __main__:main:1737 - right before barrier for data module
2024-11-08 16:24:06.018 | INFO     | __main__:main:1752 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_r
epo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-08 16:24:07.250 | INFO     | __main__:main:1679 - Loaded premise retriever at /data/yingzi_ma/lean_project/che
ckpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda
_0.1_epoch=21-Recall@10_val=76.85.ckpt
2024-11-08 16:24:07.360 | INFO     | __main__:main:1737 - right before barrier for data module
2024-11-08 16:24:07.360 | INFO     | __main__:main:1752 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_r
epo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-08 16:24:07.606 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
2024-11-08 16:24:07.608 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:07.611 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
2024-11-08 16:24:07.612 | INFO     | __main__:main:1766 - Training dataset size after load: 14904
2024-11-08 16:24:07.612 | INFO     | __main__:main:1767 - Validation dataset size after load: 251
2024-11-08 16:24:07.612 | INFO     | __main__:main:1768 - Testing dataset size after load: 374
2024-11-08 16:24:07.612 | INFO     | __main__:main:1770 - Starting progressive training from epoch 21 to 22
2024-11-08 16:24:07.612 | INFO     | __main__:main:1773 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-11-08 16:24:07.853 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
2024-11-08 16:24:07.855 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:07.857 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
2024-11-08 16:24:07.857 | INFO     | __main__:main:1766 - Training dataset size after load: 14904
2024-11-08 16:24:07.857 | INFO     | __main__:main:1767 - Validation dataset size after load: 251
2024-11-08 16:24:07.857 | INFO     | __main__:main:1768 - Testing dataset size after load: 374
2024-11-08 16:24:07.857 | INFO     | __main__:main:1770 - Starting progressive training from epoch 21 to 22
2024-11-08 16:24:07.857 | INFO     | __main__:main:1773 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-11-08 16:24:09.005 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
2024-11-08 16:24:09.006 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:09.008 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
2024-11-08 16:24:09.009 | INFO     | __main__:main:1766 - Training dataset size after load: 14904
2024-11-08 16:24:09.009 | INFO     | __main__:main:1767 - Validation dataset size after load: 251
2024-11-08 16:24:09.009 | INFO     | __main__:main:1768 - Testing dataset size after load: 374
2024-11-08 16:24:09.009 | INFO     | __main__:main:1770 - Starting progressive training from epoch 21 to 22
2024-11-08 16:24:09.009 | INFO     | __main__:main:1773 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-11-08 16:24:10.614 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
2024-11-08 16:24:10.630 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:10.633 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:
654: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2 exists and i
s not empty.
2024-11-08 16:24:11.082 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
2024-11-08 16:24:11.093 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:11.095 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
2024-11-08 16:24:11.115 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
2024-11-08 16:24:11.123 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 14904
2024-11-08 16:24:11.126 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:11.129 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
Training dataset size: 14904
2024-11-08 16:24:11.134 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 251
2024-11-08 16:24:11.137 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28
d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 374
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=21-Recall@10_val=76.85.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-08 16:24:12.215 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-11-08 16:24:12.215 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-11-08 16:24:12.215 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-11-08 16:24:12.215 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params | Mode
---------------------------------------------------
0 | encoder | T5EncoderModel | 217 M  | train
---------------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
235       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_f
ull2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=21-Recall@10_val=76.85.ckpt
`Trainer.fit` stopped: `max_epochs=22` reached.
2024-11-08 16:24:15.956 | INFO     | __main__:main:1776 - hit the barrier after training
2024-11-08 16:24:15.974 | INFO     | __main__:main:1776 - hit the barrier after training
2024-11-08 16:24:15.974 | INFO     | __main__:main:1776 - hit the barrier after training
2024-11-08 16:24:16.442 | INFO     | __main__:main:1776 - hit the barrier after training
2024-11-08 16:24:16.443 | INFO     | __main__:main:1782 - Finished progressive training at epoch 22
2024-11-08 16:24:16.443 | INFO     | __main__:main:1782 - Finished progressive training at epoch 22
2024-11-08 16:24:16.443 | INFO     | __main__:main:1782 - Finished progressive training at epoch 22
2024-11-08 16:24:16.443 | INFO     | __main__:main:1782 - Finished progressive training at epoch 22
2024-11-08 16:24:16.444 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:main:1790 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lamb
da_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_m
a/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4
417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:main:1790 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lamb
da_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:main:1790 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lamb
da_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:16.444 | INFO     | __main__:main:1790 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkp
oints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lamb
da_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 16:24:20.417 | INFO     | __main__:main:1799 - Testing...
2024-11-08 16:24:20.420 | INFO     | retrieval.main:run_cli:60 - PID: 3153576
2024-11-08 16:24:20.453 | INFO     | __main__:main:1799 - Testing...
2024-11-08 16:24:20.454 | INFO     | retrieval.main:run_cli:60 - PID: 3157215
2024-11-08 16:24:20.473 | INFO     | __main__:main:1799 - Testing...
2024-11-08 16:24:20.474 | INFO     | retrieval.main:run_cli:60 - PID: 3157217
2024-11-08 16:24:20.474 | INFO     | __main__:main:1799 - Testing...
2024-11-08 16:24:20.474 | INFO     | retrieval.main:run_cli:60 - PID: 3157216
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-08 16:24:20.701 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/random
2024-11-08 16:24:20.701 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-08 16:24:20.741 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/random
2024-11-08 16:24:20.741 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-08 16:24:20.841 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/random
2024-11-08 16:24:20.841 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d/corpus.jsonl
2024-11-08 16:24:20.864 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/random
2024-11-08 16:24:20.864 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:2
04: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLU
RM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r
...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-08 16:24:36.276 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 167182
2024-11-08 16:24:36.296 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2326
2024-11-08 16:24:36.577 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 167182
2024-11-08 16:24:36.595 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2326
2024-11-08 16:24:36.614 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 167182
2024-11-08 16:24:36.632 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2326
2024-11-08 16:24:50.320 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 167182
2024-11-08 16:24:50.343 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103
2798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2326
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ck
pt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckp
t
2024-11-08 16:25:01.248 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:25:01.249 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1805 [00:00<?, ?it/s]
2024-11-08 16:25:01.308 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:25:01.309 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
2024-11-08 16:25:01.335 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:25:01.335 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                   | 0/? [00:00<?, ?it/s]
2024-11-08 16:25:02.672 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:25:02.673 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:38<00:00,  3.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:39<00:00,  3.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:42<00:00,  3.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:42<00:00,  3.10it/s]
Predicting DataLoader 0:   0%|                                                                 | 0/10 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255:
predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████| 10/10 [00:21<00:00,  0.46it/s]
2024-11-08 16:35:07.180 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:35:07.180 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:35:07.271 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_1.pkl
2024-11-08 16:35:07.271 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:35:07.281 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_0.pkl
2024-11-08 16:35:07.281 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:35:07.321 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:35:07.445 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_2.pkl
2024-11-08 16:35:07.445 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:35:09.653 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:35:09.775 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_3.pkl
2024-11-08 16:35:09.776 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:35:09.776 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predicti
ons and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████| 10/10 [00:24<00:00,  0.41it/s]
2024-11-08 16:35:10.497 | INFO     | retrieval.main:run_cli:60 - PID: 3157215
2024-11-08 16:35:10.668 | INFO     | retrieval.main:run_cli:60 - PID: 3157217
2024-11-08 16:35:10.712 | INFO     | retrieval.main:run_cli:60 - PID: 3157216
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-08 16:35:10.910 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388a
d3a3/random
2024-11-08 16:35:10.911 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b9038
8ad3a3/corpus.jsonl
2024-11-08 16:35:10.955 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388a
d3a3/random
2024-11-08 16:35:10.955 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b9038
8ad3a3/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-08 16:35:11.045 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388a
d3a3/random
2024-11-08 16:35:11.045 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b9038
8ad3a3/corpus.jsonl
2024-11-08 16:35:11.373 | INFO     | __main__:main:1855 - Loaded the predictions pickle files
2024-11-08 16:35:11.404 | INFO     | __main__:main:1858 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_singl
e_repo_no_ewc_curriculum_full2/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/test
.json
100%|██████████████████████████████████████████████████████████████████████████| 1538/1538 [00:00<00:00, 47257.86it/s]
2024-11-08 16:35:11.437 | INFO     | __main__:main:1860 - R@1 = 28.346599034823832 %, R@10 = 69.68306230393651 %, MRR
= 0.5995713696622068
2024-11-08 16:35:11.439 | INFO     | retrieval.main:run_cli:60 - PID: 3153576
[rank: 0] Seed set to 3407
2024-11-08 16:35:11.802 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388a
d3a3/random
2024-11-08 16:35:11.802 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b9038
8ad3a3/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-08 16:35:26.402 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_train/cached_data.pkl
Training dataset size: 153333
2024-11-08 16:35:26.431 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2233
2024-11-08 16:35:27.140 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_train/cached_data.pkl
Training dataset size: 153333
2024-11-08 16:35:27.161 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2233
2024-11-08 16:35:29.249 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_train/cached_data.pkl
Training dataset size: 153333
2024-11-08 16:35:29.272 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2233
2024-11-08 16:35:29.929 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_train/cached_data.pkl
Training dataset size: 153333
2024-11-08 16:35:29.947 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750
a71b90388ad3a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2233
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ck
pt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckp
t
2024-11-08 16:35:33.225 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:35:33.226 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1758 [00:00<?, ?it/s]
2024-11-08 16:35:33.309 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:35:33.320 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1758 [00:00<?, ?it/s]
2024-11-08 16:35:33.339 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:35:33.340 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                   | 0/? [00:00<?, ?it/s]
2024-11-08 16:35:34.306 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:35:34.306 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:16<00:00,  3.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:17<00:00,  3.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:19<00:00,  3.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:20<00:00,  3.14it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:18<00:00,  0.50it/s]
2024-11-08 16:45:12.815 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:45:12.815 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:45:12.815 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:45:12.816 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:45:12.897 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_1.pkl
2024-11-08 16:45:12.897 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:45:12.901 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_3.pkl
2024-11-08 16:45:12.901 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:45:12.907 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_2.pkl
2024-11-08 16:45:12.907 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:45:12.914 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_0.pkl
2024-11-08 16:45:12.914 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:45:12.915 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predicti
ons and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:18<00:00,  0.50it/s]
2024-11-08 16:45:13.698 | INFO     | retrieval.main:run_cli:60 - PID: 3157217
2024-11-08 16:45:13.781 | INFO     | retrieval.main:run_cli:60 - PID: 3157215
2024-11-08 16:45:13.804 | INFO     | retrieval.main:run_cli:60 - PID: 3157216
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-08 16:45:14.083 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97
/random
2024-11-08 16:45:14.083 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a
97/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-08 16:45:14.161 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97
/random
2024-11-08 16:45:14.162 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a
97/corpus.jsonl
2024-11-08 16:45:14.193 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97
/random
2024-11-08 16:45:14.193 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a
97/corpus.jsonl
2024-11-08 16:45:14.699 | INFO     | __main__:main:1855 - Loaded the predictions pickle files
2024-11-08 16:45:14.745 | INFO     | __main__:main:1858 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_singl
e_repo_no_ewc_curriculum_full2/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/test.json
100%|██████████████████████████████████████████████████████████████████████████| 1493/1493 [00:00<00:00, 37140.63it/s]
2024-11-08 16:45:14.787 | INFO     | __main__:main:1860 - R@1 = 28.628097575420842 %, R@10 = 70.50846650108832 %, MRR
= 0.601055371628291
2024-11-08 16:45:14.788 | INFO     | retrieval.main:run_cli:60 - PID: 3153576
[rank: 0] Seed set to 3407
2024-11-08 16:45:15.194 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97
/random
2024-11-08 16:45:15.194 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a
97/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-08 16:45:26.277 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_train/cached_data.pkl
Training dataset size: 151012
2024-11-08 16:45:26.306 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_pred/cached_data.pkl
Testing dataset size: 2139
2024-11-08 16:45:27.172 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_train/cached_data.pkl
Training dataset size: 151012
2024-11-08 16:45:27.194 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_pred/cached_data.pkl
Testing dataset size: 2139
2024-11-08 16:45:29.034 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_train/cached_data.pkl
Training dataset size: 151012
2024-11-08 16:45:29.055 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_pred/cached_data.pkl
Testing dataset size: 2139
2024-11-08 16:45:29.750 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_train/cached_data.pkl
Training dataset size: 151012
2024-11-08 16:45:29.766 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a5
59ea389a97/random/cache_pred/cached_data.pkl
Testing dataset size: 2139
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ck
pt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckp
t
2024-11-08 16:45:33.081 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:45:33.081 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1994 [00:00<?, ?it/s]
2024-11-08 16:45:33.170 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:45:33.170 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1994 [00:00<?, ?it/s]
2024-11-08 16:45:33.189 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:45:33.189 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                   | 0/? [00:00<?, ?it/s]
2024-11-08 16:45:34.371 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:45:34.372 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:20<00:00,  3.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:21<00:00,  3.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:23<00:00,  3.54it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:25<00:00,  3.53it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:19<00:00,  0.47it/s]
2024-11-08 16:55:18.916 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:55:18.916 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:55:18.916 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:55:18.916 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 16:55:19.030 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_3.pkl
2024-11-08 16:55:19.030 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:55:19.033 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_2.pkl
2024-11-08 16:55:19.033 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:55:19.035 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_1.pkl
2024-11-08 16:55:19.035 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:55:19.044 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_0.pkl
2024-11-08 16:55:19.044 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 16:55:19.044 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predicti
ons and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:19<00:00,  0.46it/s]
2024-11-08 16:55:20.041 | INFO     | retrieval.main:run_cli:60 - PID: 3157216
2024-11-08 16:55:20.116 | INFO     | retrieval.main:run_cli:60 - PID: 3157217
2024-11-08 16:55:20.119 | INFO     | retrieval.main:run_cli:60 - PID: 3157215
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-08 16:55:20.421 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c050f
0f6c408041b70205/random
2024-11-08 16:55:20.421 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c05
0f0f6c408041b70205/corpus.jsonl
2024-11-08 16:55:20.431 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c050f
0f6c408041b70205/random
2024-11-08 16:55:20.432 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c05
0f0f6c408041b70205/corpus.jsonl
2024-11-08 16:55:20.490 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c050f
0f6c408041b70205/random
2024-11-08 16:55:20.490 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c05
0f0f6c408041b70205/corpus.jsonl
2024-11-08 16:55:20.893 | INFO     | __main__:main:1855 - Loaded the predictions pickle files
2024-11-08 16:55:20.928 | INFO     | __main__:main:1858 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_singl
e_repo_no_ewc_curriculum_full2/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/test.json
100%|██████████████████████████████████████████████████████████████████████████| 1425/1425 [00:00<00:00, 54340.24it/s]
2024-11-08 16:55:20.955 | INFO     | __main__:main:1860 - R@1 = 27.974266644592422 %, R@10 = 71.49533481155294 %, MRR
= 0.5991071682989773
2024-11-08 16:55:20.956 | INFO     | retrieval.main:run_cli:60 - PID: 3153576
[rank: 0] Seed set to 3407
2024-11-08 16:55:21.225 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c050f
0f6c408041b70205/random
2024-11-08 16:55:21.225 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c05
0f0f6c408041b70205/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-08 16:55:31.149 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_train/cached_data.pkl
Training dataset size: 156422
2024-11-08 16:55:31.175 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_pred/cached_data.pkl
Testing dataset size: 2247
2024-11-08 16:55:35.212 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_train/cached_data.pkl
Training dataset size: 156422
2024-11-08 16:55:35.232 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_pred/cached_data.pkl
Testing dataset size: 2247
2024-11-08 16:55:35.417 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_train/cached_data.pkl
Training dataset size: 156422
2024-11-08 16:55:35.432 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_train/cached_data.pkl
Training dataset size: 156422
2024-11-08 16:55:35.435 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_pred/cached_data.pkl
Testing dataset size: 2247
2024-11-08 16:55:35.451 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e5858
0bac7c050f0f6c408041b70205/random/cache_pred/cached_data.pkl
Testing dataset size: 2247
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ck
pt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckp
t
2024-11-08 16:55:38.856 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:55:38.857 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/2051 [00:00<?, ?it/s]
2024-11-08 16:55:38.908 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:55:38.911 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/2051 [00:00<?, ?it/s]
2024-11-08 16:55:38.962 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:55:38.963 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                   | 0/? [00:00<?, ?it/s]
2024-11-08 16:55:40.745 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 16:55:40.746 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████| 2051/2051 [09:29<00:00,  3.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 2051/2051 [09:30<00:00,  3.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 2051/2051 [09:33<00:00,  3.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 2051/2051 [09:34<00:00,  3.57it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:22<00:00,  0.40it/s]
2024-11-08 17:05:37.324 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:05:37.324 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:05:37.324 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:05:37.324 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:05:37.440 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_2.pkl
2024-11-08 17:05:37.440 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:05:37.446 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_1.pkl
2024-11-08 17:05:37.447 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:05:37.454 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_3.pkl
2024-11-08 17:05:37.454 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:05:37.463 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_0.pkl
2024-11-08 17:05:37.464 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:05:37.464 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predicti
ons and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:22<00:00,  0.40it/s]
2024-11-08 17:05:38.316 | INFO     | retrieval.main:run_cli:60 - PID: 3157217
2024-11-08 17:05:38.431 | INFO     | retrieval.main:run_cli:60 - PID: 3157216
2024-11-08 17:05:38.513 | INFO     | retrieval.main:run_cli:60 - PID: 3157215
[rank: 3] Seed set to 3407
2024-11-08 17:05:38.662 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7/random
2024-11-08 17:05:38.662 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6c
f37/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-08 17:05:38.773 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7/random
2024-11-08 17:05:38.773 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6c
f37/corpus.jsonl
2024-11-08 17:05:38.857 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7/random
2024-11-08 17:05:38.857 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6c
f37/corpus.jsonl
2024-11-08 17:05:39.347 | INFO     | __main__:main:1855 - Loaded the predictions pickle files
2024-11-08 17:05:39.385 | INFO     | __main__:main:1858 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_singl
e_repo_no_ewc_curriculum_full2/merged_with_new_hairy-ball-theorem-lean_fa500d7d2e58580bac7c050f0f6c408041b70205/random
/test.json
100%|██████████████████████████████████████████████████████████████████████████| 1460/1460 [00:00<00:00, 48343.98it/s]
2024-11-08 17:05:39.417 | INFO     | __main__:main:1860 - R@1 = 30.82334894075785 %, R@10 = 72.20150117164286 %, MRR =
 0.62622134911958
2024-11-08 17:05:39.418 | INFO     | retrieval.main:run_cli:60 - PID: 3153576
[rank: 0] Seed set to 3407
2024-11-08 17:05:39.710 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7/random
2024-11-08 17:05:39.710 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_
project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6c
f37/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|█████████████████████████████████████████████████████████████████████████| 70897/70897 [00:15<00:00, 4690.66it/s]
 50%|████████████████████████████████████▍                                    | 35422/70897 [00:09<00:07, 4727.28it/s]
2024-11-08 17:06:07.315 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54c
e749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 165382
100%|███████████████████████████████████████████████████████████████████████████| 1477/1477 [00:00<00:00, 5279.70it/s]
 71%|███████████████████████████████████████████████████▌                     | 50121/70897 [00:10<00:04, 4790.48it/s]
2024-11-08 17:06:07.664 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54c
e749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2276
100%|█████████████████████████████████████████████████████████████████████████| 70897/70897 [00:14<00:00, 4785.16it/s]
100%|█████████████████████████████████████████████████████████████████████████| 70897/70897 [00:14<00:00, 4744.37it/s]
 86%|██████████████████████████████████████████████████████████████▉          | 61125/70897 [00:14<00:01, 4962.26it/s]
2024-11-08 17:06:12.415 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54c
e749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 165382
2024-11-08 17:06:12.434 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749
af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2276
 91%|██████████████████████████████████████████████████████████████████▎      | 64409/70897 [00:15<00:01, 5056.55it/s]
2024-11-08 17:06:13.093 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54c
e749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 165382
2024-11-08 17:06:13.113 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749
af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2276
100%|█████████████████████████████████████████████████████████████████████████| 70897/70897 [00:16<00:00, 4244.17it/s]
2024-11-08 17:06:15.283 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yin
gzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54c
e749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 165382
2024-11-08 17:06:15.304 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749
af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2276
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ck
pt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckp
t
2024-11-08 17:06:18.759 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 17:06:18.760 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1709 [00:00<?, ?it/s]
2024-11-08 17:06:18.804 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 17:06:18.805 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                        | 0/1709 [00:00<?, ?it/s]
2024-11-08 17:06:18.860 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 17:06:18.861 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                   | 0/? [00:00<?, ?it/s]
2024-11-08 17:06:20.137 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-08 17:06:20.137 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:03<00:00,  3.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:04<00:00,  3.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:07<00:00,  3.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:07<00:00,  3.12it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:18<00:00,  0.49it/s]
2024-11-08 17:15:46.224 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:15:46.224 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:15:46.224 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:15:46.350 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_1.pkl
2024-11-08 17:15:46.350 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:15:46.351 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_2.pkl
2024-11-08 17:15:46.351 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:15:46.374 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_0.pkl
2024-11-08 17:15:46.374 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:15:48.158 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-08 17:15:48.304 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pi
ckle_3.pkl
2024-11-08 17:15:48.304 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-08 17:15:48.305 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predicti
ons and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 9/9 [00:20<00:00,  0.44it/s]
2024-11-08 17:15:49.136 | INFO     | __main__:main:1990 - Finished processing the repository
2024-11-08 17:15:49.138 | INFO     | __main__:main:1992 - current epoch: 22
2024-11-08 17:15:49.138 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 17:15:49.138 | INFO     | __main__:main:1612 - i: 1
2024-11-08 17:15:49.138 | INFO     | __main__:main:2374 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3full.py", line 1613, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-11-08 17:15:49.346 | INFO     | __main__:main:1990 - Finished processing the repository
2024-11-08 17:15:49.347 | INFO     | __main__:main:1992 - current epoch: 22
2024-11-08 17:15:49.347 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 17:15:49.348 | INFO     | __main__:main:1612 - i: 1
2024-11-08 17:15:49.348 | INFO     | __main__:main:2374 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3full.py", line 1613, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-11-08 17:15:49.363 | INFO     | __main__:main:1990 - Finished processing the repository
2024-11-08 17:15:49.364 | INFO     | __main__:main:1992 - current epoch: 22
2024-11-08 17:15:49.364 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 17:15:49.364 | INFO     | __main__:main:1612 - i: 1
2024-11-08 17:15:49.364 | INFO     | __main__:main:2374 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3full.py", line 1613, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-11-08 17:15:50.479 | INFO     | __main__:main:1855 - Loaded the predictions pickle files
2024-11-08 17:15:50.543 | INFO     | __main__:main:1858 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_singl
e_repo_no_ewc_curriculum_full2/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/test.json
100%|██████████████████████████████████████████████████████████████████████████| 1477/1477 [00:00<00:00, 29212.82it/s]
2024-11-08 17:15:50.596 | INFO     | __main__:main:1860 - R@1 = 30.34440330823452 %, R@10 = 72.01140804613874 %, MRR =
 0.616974786427756
2024-11-08 17:15:50.597 | INFO     | __main__:main:1892 - Average R@1 = 29.223343100765895 %, R@10 = 70.79787576165666
 %, MRR = 0.6085860090273623
2024-11-08 17:15:50.598 | INFO     | __main__:main:1928 - Starting the prover
2024-11-08 17:15:50.599 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-11-08 17:15:50.599 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-11-08 17:15:50.599 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-11-08 17:15:50.600 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /da
ta/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea707156497
64b046183d4417d50bd9cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files perm
anently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-11-08 17:15:51.599 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_pr
oject/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9
cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 17:15:51.599 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_pr
oject/checkpoints_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_PutnamBench_14ea70715649764b046183d4417d50bd9
cf6cd0b_lambda_0.1_epoch=23-Recall@10_val=63.58.ckpt
2024-11-08 17:15:54.824 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys
 that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.en
coder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.enc
oder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'ret
riever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttenti
on.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.
encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.we
ight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.
1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.b
lock.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight
', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.
DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.
encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retri
ever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention
.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.lay
er.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.en
coder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight
', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAtten
tion.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encod
er.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight',
 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.De
nseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.blo
ck.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.e
ncoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.wei
ght', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.enco
der.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriev
er.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer
.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', '
retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_
norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.l
ayer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retr
iever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseRel
uDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.
block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.enc
oder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weigh
t', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.lay
er_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bl
ock.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retr
iever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.w
eight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0
.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encod
er.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluD
ense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.lay
er.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.e
ncoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'r
etriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense
.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encod
er.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weigh
t', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.blo
ck.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'r
etriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer
_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1
1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.enc
oder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight',
 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.
DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder
.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys
 that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'st
ate_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-11-08 17:15:55.766 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project
/model_lightning.ckpt
2024-11-08 17:15:55.768 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-11-08 17:15:55.768 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/le
an_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a/corpus.jsonl
2024-11-08 17:15:57.875 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lea
n_project/datasets_PT_single_repo_no_ewc_curriculum_full2/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a
42a/corpus.jsonl
2024-11-08 17:15:57.876 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████| 1079/1079 [01:43<00:00, 10.44it/s]
2024-11-08 17:17:41.276 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-11-08 17:17:41.276 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-11-08 17:17:48,043 INFO worker.py:1777 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=3190968) [2024-11-08 17:18:21,274] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cud
a (auto detect)
(ProverActor pid=3190968) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414:
FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during
 unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a fut
ure release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be e
xecuted during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are expl
icitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_onl
y=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any
issues related to this experimental feature.
(ProverActor pid=3190968)   return torch.load(io.BytesIO(b))
2024-11-08 17:18:29.021 | INFO     | __main__:prove_sorry_theorems:1010 - Found 0 sorry theorems to prove
Processing theorems from siddhartha-gadgil/Saturn: 0theorem [00:00, ?theorem/s]
2024-11-08 17:18:29.021 | INFO     | __main__:save_progress:965 - Saving encountered theorems...
2024-11-08 17:18:29.024 | INFO     | __main__:prove_sorry_theorems:1061 - Finished attempting to prove sorry theorems
(pid=3191030) [2024-11-08 17:18:31,344] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cud
a (auto detect) [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log de
duplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplicati
on for more options.)
(ProverActor pid=3191030) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414:
FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during
 unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a fut
ure release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be e
xecuted during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are expl
icitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_onl
y=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any
issues related to this experimental feature. [repeated 2x across cluster]
(ProverActor pid=3191030)   return torch.load(io.BytesIO(b)) [repeated 2x across cluster]
(pid=3190779) [2024-11-08 17:18:36,443] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cud
a (auto detect)
(ProverActor pid=3190779) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414:
FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during
 unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a fut
ure release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be e
xecuted during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are expl
icitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_onl
y=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any
issues related to this experimental feature.
(ProverActor pid=3190779)   return torch.load(io.BytesIO(b))
2024-11-08 17:21:53.167 | INFO     | __main__:main:1967 - Finished searching for proofs of sorry theorems
2024-11-08 17:21:53.169 | INFO     | __main__:main:1970 - Shutting down Ray after proving
2024-11-08 17:21:56.672 | INFO     | __main__:main:1990 - Finished processing the repository
2024-11-08 17:21:56.673 | INFO     | __main__:main:1992 - current epoch: 22
2024-11-08 17:21:56.673 | INFO     | __main__:main:1611 - length of lean_git_repos: 1
2024-11-08 17:21:56.673 | INFO     | __main__:main:1612 - i: 1
2024-11-08 17:21:56.673 | INFO     | __main__:main:2374 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3full.py", line 1613, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
(base) yingzi_ma@compute-permanent-node-824:~/lean_project/ReProver$ slurmstepd: error: *** STEP 87335.0 ON compute-pe
rmanent-node-824 CANCELLED AT 2024-11-08T17:51:09 DUE TO TIME LIMIT ***
srun: error: compute-permanent-node-824: task 0: Killed
srun: Force Terminated StepId=87335.0
(base) yingzi_ma@cais-login-0:~/lean_project/ReProver$
