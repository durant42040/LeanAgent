2024-09-18 23:28:53.643 | INFO     | __main__:prove_sorry_theorems:876 - Position: (712, 1)
2024-09-18 23:28:53.643 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=187006) 2024-09-18 23:28:53.653 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_299')
(ProverActor pid=187440) 2024-09-18 23:29:01.064 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_541') [repeated 2x across cluster] (Ray deduplicates logs
 by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/
user-guides/configure-logging.html#log-deduplication for more options.)
(pid=188182) [2024-09-18 23:29:01,088] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda
(auto detect)
(ProverActor pid=188182) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: Fu
tureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default p
ickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unp
ickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future r
elease, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be execute
d during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly
allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True`
for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues re
lated to this experimental feature.
(ProverActor pid=188182)   return torch.load(io.BytesIO(b))
(ProverActor pid=188182) 2024-09-18 23:29:14.164 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='mathd_algebra_398')
(ProverActor pid=187006) 2024-09-18 23:29:28.193 | INFO     | prover.proof_search:_best_first_search:171 - Found a proo
f!
(ProverActor pid=187006) 2024-09-18 23:29:34.775 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_299'), status=<Status.PROVED: 'Proved'>, pr
oof=['norm_num'], actor_time=3.410391518846154, environment_time=0.014607597142457962, total_time=4.425312612671405, nu
m_total_nodes=2, num_searched_nodes=1)
(ProverActor pid=187006) 2024-09-18 23:29:34.781 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Valid.lean'), full_name='mathd_numbertheory_156')
(ProverActor pid=188182) 2024-09-18 23:29:51.045 | INFO     | prover.proof_search:_best_first_search:171 - Found a proo
f!
(ProverActor pid=188182) 2024-09-18 23:30:00.292 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='mathd_algebra_398'), status=<Status.PROVED: 'Proved'>, proof=[
'linarith'], actor_time=1.7000907259061933, environment_time=0.3043671906925738, total_time=3.0048334463499486, num_tot
al_nodes=4, num_searched_nodes=1)
(ProverActor pid=188182) 2024-09-18 23:30:00.298 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_342')
(ProverActor pid=188182) 2024-09-18 23:30:44.716 | INFO     | prover.proof_search:_best_first_search:171 - Found a proo
f!
(ProverActor pid=188182) 2024-09-18 23:30:53.478 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_342'), status=<Status.PROVED: 'Proved'>, pr
oof=['norm_num'], actor_time=2.1773695000447333, environment_time=0.011772376950830221, total_time=3.189395252149552, n
um_total_nodes=2, num_searched_nodes=1)
(ProverActor pid=188182) 2024-09-18 23:30:53.483 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_343')
(ProverActor pid=188182) 2024-09-18 23:31:35.922 | INFO     | prover.proof_search:_best_first_search:171 - Found a proo
f!
(ProverActor pid=188182) 2024-09-18 23:31:43.908 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_343'), status=<Status.PROVED: 'Proved'>, pr
oof=['norm_num'], actor_time=4.760808777064085, environment_time=0.02927131811156869, total_time=5.790405361913145, num
_total_nodes=2, num_searched_nodes=1)
(ProverActor pid=188182) 2024-09-18 23:31:43.913 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='algebra_apbmpcneq0_aeq0anbeq0anceq0')
(ProverActor pid=187184) 2024-09-18 23:39:39.273 | INFO     | prover.proof_search:_best_first_search:149 - 3364748.4400
92073
(ProverActor pid=187184) 2024-09-18 23:39:39.274 | INFO     | prover.proof_search:_best_first_search:150 - 3364148.4555
95484
(ProverActor pid=187184) 2024-09-18 23:39:39.274 | INFO     | prover.proof_search:_best_first_search:151 - 599.98496427
89923
(ProverActor pid=187184) 2024-09-18 23:39:39.274 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=187184) 2024-09-18 23:39:39.274 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
(ProverActor pid=187440) 2024-09-18 23:39:45.790 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='mathd_numbertheory_541'), status=<Status.OPEN: 'Open'>, proof=
None, actor_time=165.4731104010716, environment_time=434.18724394543096, total_time=600.9867739658803, num_total_nodes=
2794, num_searched_nodes=96)
(ProverActor pid=187440) 2024-09-18 23:39:45.796 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='imo_1997_p5')
(ProverActor pid=187440) 2024-09-18 23:39:39.470 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeate
d 4x across cluster]
(ProverActor pid=187440) 2024-09-18 23:39:39.470 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
(ProverActor pid=187006) 2024-09-18 23:40:26.884 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
(ProverActor pid=187184) 2024-09-18 23:39:45.872 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Valid.lean'), full_name='amc12b_2002_p3'), status=<Status.OPEN: 'Open'>, proof=None, a
ctor_time=320.34742924012244, environment_time=279.38259295979515, total_time=600.9852464362048, num_total_nodes=5186,
num_searched_nodes=170)
(ProverActor pid=187184) 2024-09-18 23:39:45.878 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Valid.lean'), full_name='mathd_numbertheory_110')
(ProverActor pid=187006) 2024-09-18 23:40:26.884 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeate
d 4x across cluster]
(ProverActor pid=187006) 2024-09-18 23:40:34.497 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Valid.lean'), full_name='mathd_numbertheory_156'), status=<Status.OPEN: 'Open'>, proof
=None, actor_time=2.866334429010749, environment_time=0.1000924059189856, total_time=600.9821330746636, num_total_nodes
=8, num_searched_nodes=0)
(ProverActor pid=187006) 2024-09-18 23:40:34.501 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Valid.lean'), full_name='imo_1984_p2')
(ProverActor pid=187184) 2024-09-18 23:40:39.688 | INFO     | prover.proof_search:_best_first_search:171 - Found a proo
f!
(ProverActor pid=187184) 2024-09-18 23:41:10.751 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Valid.lean'), full_name='mathd_numbertheory_110'), status=<Status.PROVED: 'Proved'>, p
roof=['omega'], actor_time=2.9142690668813884, environment_time=0.7502835248596966, total_time=4.664909110404551, num_t
otal_nodes=2, num_searched_nodes=1)
(ProverActor pid=187184) 2024-09-18 23:41:10.755 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='algebra_absapbon1pabsapbleqsumabsaon1pabsa')
(ProverActor pid=188182) 2024-09-18 23:42:22.054 | INFO     | prover.proof_search:_best_first_search:149 - 3364911.2204
14149
(ProverActor pid=188182) 2024-09-18 23:42:22.054 | INFO     | prover.proof_search:_best_first_search:150 - 3364311.2337
83302
(ProverActor pid=188182) 2024-09-18 23:42:22.054 | INFO     | prover.proof_search:_best_first_search:151 - 599.98721155
98992
(ProverActor pid=188182) 2024-09-18 23:42:22.055 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=188182) 2024-09-18 23:42:22.055 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
(ProverActor pid=188182) 2024-09-18 23:42:32.686 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='algebra_apbmpcneq0_aeq0anbeq0anceq0'), status=<Status.OPEN: 'O
pen'>, proof=None, actor_time=303.96602410217747, environment_time=205.46095176786184, total_time=600.9876934201457, nu
m_total_nodes=4258, num_searched_nodes=131)
(ProverActor pid=187440) 2024-09-18 23:50:23.031 | INFO     | prover.proof_search:_best_first_search:149 - 3365392.1974
19945
(ProverActor pid=187440) 2024-09-18 23:50:23.031 | INFO     | prover.proof_search:_best_first_search:150 - 3364792.2090
49828
(ProverActor pid=187440) 2024-09-18 23:50:23.031 | INFO     | prover.proof_search:_best_first_search:151 - 599.98878912
6277
(ProverActor pid=187440) 2024-09-18 23:50:23.031 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=187440) 2024-09-18 23:50:23.031 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
(ProverActor pid=187440) 2024-09-18 23:50:28.152 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='imo_1997_p5'), status=<Status.OPEN: 'Open'>, proof=None, actor
_time=247.6608263500966, environment_time=351.9732994046062, total_time=600.9889826499857, num_total_nodes=3732, num_se
arched_nodes=122)
(ProverActor pid=187006) 2024-09-18 23:51:09.347 | INFO     | prover.proof_search:_best_first_search:149 - 3365438.5135
21956
(ProverActor pid=187006) 2024-09-18 23:51:09.348 | INFO     | prover.proof_search:_best_first_search:150 - 3364838.5303
4412
(ProverActor pid=187006) 2024-09-18 23:51:09.348 | INFO     | prover.proof_search:_best_first_search:151 - 599.98458890
66346
(ProverActor pid=187006) 2024-09-18 23:51:09.348 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=187006) 2024-09-18 23:51:09.348 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
(ProverActor pid=187006) 2024-09-18 23:51:15.436 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Valid.lean'), full_name='imo_1984_p2'), status=<Status.OPEN: 'Open'>, proof=None, acto
r_time=168.74843922583386, environment_time=268.0791529561393, total_time=600.9848648929037, num_total_nodes=3330, num_
searched_nodes=81)
(ProverActor pid=187184) 2024-09-18 23:51:44.508 | INFO     | prover.proof_search:_best_first_search:149 - 3365473.6746
94988
(ProverActor pid=187184) 2024-09-18 23:51:44.508 | INFO     | prover.proof_search:_best_first_search:150 - 3364873.6907
09559
(ProverActor pid=187184) 2024-09-18 23:51:44.508 | INFO     | prover.proof_search:_best_first_search:151 - 599.98435457
70273
(ProverActor pid=187184) 2024-09-18 23:51:44.508 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=187184) 2024-09-18 23:51:44.509 | INFO     | prover.proof_search:_best_first_search:163 - Hit the reso
urce limit (timeout or max_expansions).
2024-09-18 23:51:49.429 | INFO     | __main__:process_theorem_batch:784 - Proof found for mathd_numbertheory_299
Processing theorems from yangky11/miniF2F-lean4:  30%|██████████████████████████████████████████▉
                                                                            | 109/358 [22:55<52:22, 12.62s/theorem]
2024-09-18 23:51:49.432 | INFO     | __main__:main:2066 - An error occurred: [Errno 28] No space left on device
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1658, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_merged_dataset)
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 889, in prove_sorry_theorems
    process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 794, in process_theorem_batch
    repo.change_sorry_to_proven(theorem, PROOF_LOG_FILE_NAME)
  File "/data/yingzi_ma/lean_project/ReProver/dynamic_database.py", line 369, in change_sorry_to_proven
    with open(log_file, 'a') as f:
OSError: [Errno 28] No space left on device
(ProverActor pid=187184) 2024-09-18 23:51:49.426 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=The
orem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00
'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='algebra_absapbon1pabsapbleqsumabsaon1pabsa'), status=<Status.O
PEN: 'Open'>, proof=None, actor_time=68.58220724062994, environment_time=152.19589131418616, total_time=600.98452185001
22, num_total_nodes=1122, num_searched_nodes=30)
[rank0]:[W918 23:52:00.271100482 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed befo
re we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure th
at any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and
 block the progress of another member of the process group. This constraint has always been present,  but this warning
has only been added since PyTorch 2.4 (function operator())
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ bash run_code_minif2f.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
Running main3_minif2f.py
[2024-09-19 00:10:03,876] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-19 00:10:11.956 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:10:11.956 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:10:11.959 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:10:11.959 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:10:11.960 | INFO     | __main__:main:1252 - Starting the main process
2024-09-19 00:10:11.960 | INFO     | __main__:main:1260 - Loading database from /data/yingzi_ma/lean_project/dynamic_da
tabase_PT_single_repo_no_ewc_curriculum_full.json
2024-09-19 00:11:17.646 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-19 00:11:17.646 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lec
opivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-19 00:11:25.039 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-19 00:11:25.039 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Imp
erialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-19 00:11:33.414 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-19 00:11:33.414 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teo
rth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-19 00:11:42.838 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-19 00:11:42.838 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Ale
xKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-19 00:11:54.643 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-19 00:11:54.643 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dwr
ensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-19 00:11:56.232 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-19 00:11:56.232 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/goo
gle-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-19 00:11:58.159 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-19 00:11:58.159 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avi
gad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-19 00:11:58.298 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-19 00:11:58.299 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dig
ama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-19 00:12:09.548 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-19 00:12:09.548 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/eri
c-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-19 00:12:11.407 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-19 00:12:11.407 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yum
a-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-19 00:12:11.765 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-19 00:12:11.765 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/log
anrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-19 00:12:12.370 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-19 00:12:12.370 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/For
malizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-19 00:12:12.512 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-19 00:12:12.512 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-19 00:12:12.599 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-19 00:12:12.599 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/nom
eata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-19 00:12:13.319 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-19 00:12:13.319 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-19 00:12:13.608 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-19 00:12:13.608 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/sid
dhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-19 00:12:28.314 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/flt-regular (commit: 359ab563c7ba5d775c1878ac7b3d0c4095b37ec4)
2024-09-19 00:12:28.314 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/flt-regular (commit: 359ab563c7ba5d775c1878ac7b3d0c4095b37ec4)
2024-09-19 00:12:30.035 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/rami3l/plfl (commit: 1a25fc310d8fb0c6e21ab9e385cc7dac0c31f77a)
2024-09-19 00:12:30.035 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ram
i3l/plfl (commit: 1a25fc310d8fb0c6e21ab9e385cc7dac0c31f77a)
2024-09-19 00:12:31.746 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-19 00:12:31.746 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yan
gky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-19 00:12:33.254 | INFO     | __main__:main:1262 - Loaded database from /data/yingzi_ma/lean_project/dynamic_dat
abase_PT_single_repo_no_ewc_curriculum_full.json
2024-09-19 00:12:33.255 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:12:33.255 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:12:33.650 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:12:49.832 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:12:49.832 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:12:49.833 | INFO     | __main__:main:1364 - Main process
2024-09-19 00:12:49.833 | INFO     | __main__:main:1365 - Using lambda = 0.1
2024-09-19 00:12:49.833 | INFO     | __main__:main:1366 - Processing https://github.com/yangky11/miniF2F-lean4
2024-09-19 00:12:49.833 | INFO     | __main__:main:1373 - Adding repo to repos_for_merged_dataset
2024-09-19 00:12:49.833 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:12:49.836 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:12:49.836 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:12:49.836 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:12:49.836 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:12:52.460 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:20
4: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM
, prepend your python command with `srun` like so: srun python main3_minif2f.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-19 00:12:52.834 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:12:52.835 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-19 00:12:52.954 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:13:07.813 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:13:07.825 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:13:07.837 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:13:07.837 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:13:07.837 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:13:07.837 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:13:07.837 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:13:07.837 | INFO     | __main__:main:1518 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-19 00:13:18,781] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-19 00:13:18,781] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-19 00:13:18,781] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-19 00:13:26.165 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:13:26.165 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:13:26.165 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:13:26.165 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:13:26.165 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:13:26.165 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:13:26.168 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:13:26.168 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:13:26.168 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:13:26.168 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:13:26.168 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:13:26.168 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:13:26.168 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:13:26.168 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:13:26.168 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:13:26.168 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:13:26.168 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:13:26.168 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:13:26.348 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:13:26.370 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:13:26.375 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:13:42.599 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:13:42.599 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:13:42.599 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:13:42.603 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:42.603 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:42.603 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:13:42.603 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 2] Seed set to 3407
2024-09-19 00:13:42.719 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:13:42.719 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:13:42.719 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:13:42.720 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:42.720 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:42.720 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:13:42.720 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 1] Seed set to 3407
2024-09-19 00:13:42.775 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:13:42.775 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:13:42.775 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:13:42.776 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:42.776 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:42.776 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:13:42.776 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:13:45.989 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:46.121 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:46.135 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:13:46.304 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:13:46.304 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:13:46.305 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:13:46.305 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-09-19 00:13:46.305 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-09-19 00:13:46.305 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-19 00:13:46.421 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:13:46.422 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:13:46.422 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:13:56.303 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:13:56.320 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:13:56.332 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:13:56.332 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:13:56.332 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:13:56.332 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:13:56.332 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:13:56.332 | INFO     | __main__:main:1518 - hit the barrier before training
2024-09-19 00:13:56.387 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:13:56.398 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:13:56.403 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:13:56.419 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:13:56.419 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:13:56.419 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:13:56.419 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:13:56.419 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:13:56.419 | INFO     | __main__:main:1518 - hit the barrier before training
2024-09-19 00:13:56.429 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:13:56.470 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:13:56.470 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:13:56.470 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:13:56.470 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:13:56.470 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:13:56.471 | INFO     | __main__:main:1518 - hit the barrier before training
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-19 00:13:59.225 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:13:59.382 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:13:59.414 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:6
53: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum exists and is not em
pty.
2024-09-19 00:14:00.401 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
2024-09-19 00:14:00.445 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:14:00.481 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
Training dataset size: 146704
2024-09-19 00:14:00.519 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:14:00.793 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:14:00.906 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:14:01.842 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:14:01.902 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:14:02.541 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/
merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-19 00:14:04.089 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-19 00:14:04.089 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-19 00:14:04.090 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-19 00:14:04.090 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/me
rged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
`Trainer.fit` stopped: `max_epochs=17` reached.
2024-09-19 00:14:07.132 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:14:07.331 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:14:07.394 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:14:07.785 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:14:07.785 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:14:07.785 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:14:07.785 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:14:07.785 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:14:07.787 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.787 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.787 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.787 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.788 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.788 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.788 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:07.788 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:09.853 | INFO     | __main__:main:1684 - Finished processing the repository
2024-09-19 00:14:09.853 | INFO     | __main__:main:1686 - current epoch: 17
2024-09-19 00:14:09.853 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:14:09.854 | INFO     | __main__:main:1358 - i: 1
2024-09-19 00:14:09.854 | INFO     | __main__:main:2066 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1359, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-19 00:14:10.329 | INFO     | __main__:main:1684 - Finished processing the repository
2024-09-19 00:14:10.329 | INFO     | __main__:main:1686 - current epoch: 17
2024-09-19 00:14:10.329 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:14:10.329 | INFO     | __main__:main:1358 - i: 1
2024-09-19 00:14:10.329 | INFO     | __main__:main:2066 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1359, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-19 00:14:10.544 | INFO     | __main__:main:1684 - Finished processing the repository
2024-09-19 00:14:10.544 | INFO     | __main__:main:1686 - current epoch: 17
2024-09-19 00:14:10.544 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:14:10.544 | INFO     | __main__:main:1358 - i: 1
2024-09-19 00:14:10.544 | INFO     | __main__:main:2066 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1359, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-19 00:14:10.550 | INFO     | __main__:main:1622 - Starting the prover
2024-09-19 00:14:10.551 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-19 00:14:10.551 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-19 00:14:10.551 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-19 00:14:10.552 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b8
8b44a98436d50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files perma
nently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-19 00:14:10.917 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd0
0_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:10.917 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd0
0_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:14:13.412 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys
that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.enco
der.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encode
r.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriev
er.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.re
lative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encode
r.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight',
'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_
norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.la
yer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriev
er.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block
.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.e
ncoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 're
triever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.
weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.lay
er.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 're
triever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttenti
on.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.la
yer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.en
coder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight'
, 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttenti
on.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.la
yer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.e
ncoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'ret
riever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseRel
uDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.la
yer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.e
ncoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.w
i_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5
.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.e
ncoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 're
triever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1
.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encode
r.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 're
triever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.la
yer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encode
r.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight',
'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_
norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.la
yer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriev
er.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block
.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.e
ncoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 're
triever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.
weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.lay
er.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'r
etriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAtte
ntion.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.
10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.enco
der.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo
.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.S
elfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder
.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_
0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11
.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys
that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'stat
e_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-19 00:14:14.113 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/
model_lightning.ckpt
2024-09-19 00:14:14.114 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-19 00:14:14.114 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lea
n_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7ab
d00/corpus.jsonl
2024-09-19 00:14:14.114 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:14:19.592 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-19 00:14:19.592 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean
_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd
00/corpus.jsonl
2024-09-19 00:14:19.592 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  7%|█████▏                                                                     | 272/3976 [00:25<06:53,  8.97it/s]  7%
|█████▏                                                                     | 274/3976 [00:25<07:12,  8.55it/s]  7%|███
██▏                                                                     | 275/3976 [00:26<07:19,  8.42it/s]  7%|█████▏
                                                                    | 276/3976 [00:26<07:24,  8.32it/s]  7%|█████▏
                                                                | 277/3976 [00:26<07:28,  8.25it/s]  7%|█████▏
                                                            | 278/3976 [00:26<07:31,  8.20it/s]  7%|█████▎
                                                        | 279/3976 [00:26<07:33,  8.15it/s] 59%|███████████████████████
████████████████████▌                              | 2340/3976 [03:13<02:19, 11.71it/s]^Z
[1]+  Stopped                 bash run_code_minif2f.sh
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ rm -rf encountered_theorems_PT_single_repo_no_ewc_
curriculum_full_minif2f.pkl
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ vim encountered_theorems_PT_single_repo_no_ewc_cur
riculum_full_minif2f.pkl
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ bash run_code_minif2f.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
Running main3_minif2f.py
[2024-09-19 00:18:33,366] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-19 00:18:37.270 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:18:37.270 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:18:37.273 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:18:37.273 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:18:37.273 | INFO     | __main__:main:1252 - Starting the main process
2024-09-19 00:18:37.274 | INFO     | __main__:main:1260 - Loading database from /data/yingzi_ma/lean_project/dynamic_da
tabase_PT_single_repo_no_ewc_curriculum_full.json
2024-09-19 00:19:43.937 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-19 00:19:43.937 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lec
opivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-19 00:19:51.343 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-19 00:19:51.344 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Imp
erialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-19 00:19:59.786 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-19 00:19:59.786 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teo
rth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-19 00:20:09.228 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-19 00:20:09.228 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Ale
xKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-19 00:20:21.134 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-19 00:20:21.134 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dwr
ensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-19 00:20:22.766 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-19 00:20:22.766 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/goo
gle-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-19 00:20:24.748 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-19 00:20:24.748 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avi
gad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-19 00:20:24.892 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-19 00:20:24.892 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dig
ama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-19 00:20:36.168 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-19 00:20:36.169 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/eri
c-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-19 00:20:38.064 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-19 00:20:38.064 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yum
a-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-19 00:20:38.430 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-19 00:20:38.430 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/log
anrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-19 00:20:39.051 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-19 00:20:39.051 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/For
malizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-19 00:20:39.197 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-19 00:20:39.198 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-19 00:20:39.287 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-19 00:20:39.287 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/nom
eata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-19 00:20:40.015 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-19 00:20:40.015 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-19 00:20:40.312 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-19 00:20:40.312 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/sid
dhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-19 00:20:55.100 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/flt-regular (commit: 359ab563c7ba5d775c1878ac7b3d0c4095b37ec4)
2024-09-19 00:20:55.100 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/flt-regular (commit: 359ab563c7ba5d775c1878ac7b3d0c4095b37ec4)
2024-09-19 00:20:56.881 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/rami3l/plfl (commit: 1a25fc310d8fb0c6e21ab9e385cc7dac0c31f77a)
2024-09-19 00:20:56.881 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ram
i3l/plfl (commit: 1a25fc310d8fb0c6e21ab9e385cc7dac0c31f77a)
2024-09-19 00:20:58.647 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-19 00:20:58.647 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yan
gky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-19 00:21:00.153 | INFO     | __main__:main:1262 - Loaded database from /data/yingzi_ma/lean_project/dynamic_dat
abase_PT_single_repo_no_ewc_curriculum_full.json
2024-09-19 00:21:00.154 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:21:00.155 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:21:00.537 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:21:17.246 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:21:17.246 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:21:17.246 | INFO     | __main__:main:1364 - Main process
2024-09-19 00:21:17.246 | INFO     | __main__:main:1365 - Using lambda = 0.1
2024-09-19 00:21:17.246 | INFO     | __main__:main:1366 - Processing https://github.com/yangky11/miniF2F-lean4
2024-09-19 00:21:17.246 | INFO     | __main__:main:1373 - Adding repo to repos_for_merged_dataset
2024-09-19 00:21:17.246 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:21:17.247 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:21:17.247 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:21:17.247 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:21:17.247 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:21:19.337 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:20
4: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM
, prepend your python command with `srun` like so: srun python main3_minif2f.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-19 00:21:19.440 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:21:19.440 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-19 00:21:19.541 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:21:34.383 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:21:34.393 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:21:34.405 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:21:34.405 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:21:34.405 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:21:34.405 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:21:34.405 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:21:34.405 | INFO     | __main__:main:1518 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-19 00:21:40,202] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-19 00:21:40,205] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-19 00:21:40,205] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-19 00:21:44.055 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:21:44.055 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:21:44.055 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:21:44.055 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:21:44.055 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:21:44.055 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:21:44.058 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:21:44.058 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:21:44.058 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:21:44.058 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:21:44.058 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:21:44.058 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:21:44.058 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:21:44.058 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:21:44.058 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:21:44.058 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:21:44.058 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:21:44.058 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:21:44.236 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:21:44.271 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:21:44.277 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
^Z
[2]+  Stopped                 bash run_code_minif2f.sh
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ nvidia-smi
Thu Sep 19 00:21:58 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   45C    P0             87W /  400W |   13957MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:91:00.0 Off |                    0 |
| N/A   37C    P0             87W /  400W |     292MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:D6:00.0 Off |                    0 |
| N/A   38C    P0             84W /  400W |       4MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:DA:00.0 Off |                    0 |
| N/A   39C    P0             85W /  400W |     148MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    212959      C   python                                       9922MiB |
|    0   N/A  N/A    217828      C   python                                       4024MiB |
+-----------------------------------------------------------------------------------------+
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ ps aux | grep "python" | awk '{print $2}' | xargs
-r kill -9
kill: (6951): Operation not permitted
kill: (7260): Operation not permitted
kill: (12567): Operation not permitted
kill: (220584): No such process
kill: (667449): Operation not permitted
kill: (667466): Operation not permitted
kill: (667467): Operation not permitted
kill: (667468): Operation not permitted
kill: (667475): Operation not permitted
kill: (668342): Operation not permitted
kill: (668360): Operation not permitted
kill: (668361): Operation not permitted
kill: (668362): Operation not permitted
kill: (668369): Operation not permitted
kill: (669121): Operation not permitted
kill: (669214): Operation not permitted
kill: (669215): Operation not permitted
kill: (669216): Operation not permitted
kill: (669223): Operation not permitted
kill: (2509131): Operation not permitted
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ nvidia-smi
Thu Sep 19 00:22:03 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   45C    P0             87W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:91:00.0 Off |                    0 |
| N/A   37C    P0             87W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:D6:00.0 Off |                    0 |
| N/A   38C    P0             84W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:DA:00.0 Off |                    0 |
| N/A   39C    P0             85W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ bash run_code_minif2f.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
Running main3_minif2f.py
[2024-09-19 00:22:14,091] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-19 00:22:17.760 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:22:17.760 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:22:17.763 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:22:17.763 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:22:17.763 | INFO     | __main__:main:1252 - Starting the main process
2024-09-19 00:22:17.763 | INFO     | __main__:main:1260 - Loading database from /data/yingzi_ma/lean_project/dynamic_da
tabase_PT_single_repo_no_ewc_curriculum_full.json
2024-09-19 00:23:24.186 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-19 00:23:24.186 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lec
opivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-19 00:23:31.575 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-19 00:23:31.576 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Imp
erialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-19 00:23:39.981 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-19 00:23:39.981 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teo
rth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-19 00:23:49.353 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-19 00:23:49.353 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Ale
xKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-19 00:24:01.225 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-19 00:24:01.226 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dwr
ensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-19 00:24:02.860 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-19 00:24:02.860 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/goo
gle-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-19 00:24:04.864 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-19 00:24:04.865 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avi
gad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-19 00:24:05.009 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-19 00:24:05.009 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dig
ama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-19 00:24:16.303 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-19 00:24:16.303 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/eri
c-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-19 00:24:18.200 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-19 00:24:18.201 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yum
a-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-19 00:24:18.563 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-19 00:24:18.563 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/log
anrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-19 00:24:19.182 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-19 00:24:19.182 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/For
malizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-19 00:24:19.328 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-19 00:24:19.328 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-19 00:24:19.417 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-19 00:24:19.417 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/nom
eata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-19 00:24:20.143 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-19 00:24:20.143 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-19 00:24:20.437 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-19 00:24:20.438 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/sid
dhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-19 00:24:35.250 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/leanprover-community/flt-regular (commit: 359ab563c7ba5d775c1878ac7b3d0c4095b37ec4)
2024-09-19 00:24:35.251 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lea
nprover-community/flt-regular (commit: 359ab563c7ba5d775c1878ac7b3d0c4095b37ec4)
2024-09-19 00:24:37.021 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/rami3l/plfl (commit: 1a25fc310d8fb0c6e21ab9e385cc7dac0c31f77a)
2024-09-19 00:24:37.022 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ram
i3l/plfl (commit: 1a25fc310d8fb0c6e21ab9e385cc7dac0c31f77a)
2024-09-19 00:24:38.781 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github
.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-19 00:24:38.781 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yan
gky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-19 00:24:40.282 | INFO     | __main__:main:1262 - Loaded database from /data/yingzi_ma/lean_project/dynamic_dat
abase_PT_single_repo_no_ewc_curriculum_full.json
2024-09-19 00:24:40.284 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:24:40.284 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:24:40.511 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:24:56.889 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:24:56.890 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:24:56.890 | INFO     | __main__:main:1364 - Main process
2024-09-19 00:24:56.890 | INFO     | __main__:main:1365 - Using lambda = 0.1
2024-09-19 00:24:56.890 | INFO     | __main__:main:1366 - Processing https://github.com/yangky11/miniF2F-lean4
2024-09-19 00:24:56.890 | INFO     | __main__:main:1373 - Adding repo to repos_for_merged_dataset
2024-09-19 00:24:56.890 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:24:56.891 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:24:56.891 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:24:56.891 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:24:56.891 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:24:58.990 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:20
4: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM
, prepend your python command with `srun` like so: srun python main3_minif2f.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-19 00:24:59.096 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:24:59.096 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-19 00:24:59.199 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:25:14.133 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:25:14.144 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:14.156 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:25:14.156 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:25:14.156 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:25:14.156 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:25:14.156 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:25:14.156 | INFO     | __main__:main:1518 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-19 00:25:20,034] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-19 00:25:20,036] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-19 00:25:20,037] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-19 00:25:25.516 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:25:25.516 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:25:25.516 | INFO     | __main__:main:1239 - Running progressive training
2024-09-19 00:25:25.516 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:25:25.516 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:25:25.516 | INFO     | __main__:main:1245 - Configuring LeanDojo...
2024-09-19 00:25:25.519 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:25:25.519 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:25:25.519 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:25:25.519 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data
/yingzi_ma/lean_project/ReProver
2024-09-19 00:25:25.519 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:25:25.519 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:25:25.519 | INFO     | __main__:main:1247 - LeanDojo configured
2024-09-19 00:25:25.519 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:25:25.519 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:25:25.519 | INFO     | __main__:main:1269 - Found 15 repositories
2024-09-19 00:25:25.519 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:25:25.519 | INFO     | __main__:main:1272 - Starting curriculum learning
2024-09-19 00:25:25.707 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:25:25.725 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:25:25.804 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for l
ean4 v4.7.0-rc2
2024-09-19 00:25:42.131 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:25:42.131 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:25:42.131 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:25:42.132 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:42.132 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:42.132 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:25:42.132 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:25:42.433 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:25:42.433 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:25:42.433 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:25:42.434 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:42.434 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:42.434 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:25:42.434 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:25:42.677 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:25:42.677 | INFO     | __main__:main:1358 - i: 0
2024-09-19 00:25:42.677 | INFO     | __main__:main:1386 - All GPUs
2024-09-19 00:25:42.678 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:42.678 | INFO     | __main__:main:1393 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:42.678 | INFO     | __main__:main:1399 - Inside train_test_fisher
2024-09-19 00:25:42.678 | INFO     | __main__:main:1400 - Starting training at epoch 16
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
2024-09-19 00:25:44.994 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:45.066 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:45.103 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:25:45.104 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-09-19 00:25:45.112 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:25:45.112 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-19 00:25:45.206 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:25:45.206 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:25:45.230 | INFO     | __main__:main:1424 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_
0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:25:45.281 | INFO     | __main__:main:1482 - right before barrier for data module
2024-09-19 00:25:45.281 | INFO     | __main__:main:1497 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: Fut
ureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depr
acted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://git
hub.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-19 00:25:45.380 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:25:55.080 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:25:55.094 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:55.108 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:25:55.108 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:25:55.108 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:25:55.108 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:25:55.108 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:25:55.108 | INFO     | __main__:main:1518 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-19 00:25:55.498 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:25:55.508 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:55.519 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:25:55.519 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:25:55.520 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:25:55.520 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:25:55.520 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:25:55.520 | INFO     | __main__:main:1518 - hit the barrier before training
2024-09-19 00:25:55.544 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:25:55.609 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:55.629 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:25:55.630 | INFO     | __main__:main:1511 - Training dataset size after load: 146704
2024-09-19 00:25:55.630 | INFO     | __main__:main:1512 - Validation dataset size after load: 2037
2024-09-19 00:25:55.630 | INFO     | __main__:main:1513 - Testing dataset size after load: 2267
2024-09-19 00:25:55.630 | INFO     | __main__:main:1515 - Starting progressive training from epoch 16 to 17
2024-09-19 00:25:55.630 | INFO     | __main__:main:1518 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-19 00:25:57.519 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:25:57.608 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:57.625 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:6
53: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum exists and is not em
pty.
2024-09-19 00:25:58.763 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
2024-09-19 00:25:58.836 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:59.741 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
2024-09-19 00:25:59.752 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146704
Training dataset size: 146704
2024-09-19 00:25:59.849 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:25:59.858 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_val/cached_data.pkl
Validation dataset size: 2037
2024-09-19 00:26:00.034 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:26:01.778 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
2024-09-19 00:26:01.791 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50
dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2267
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/
merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You ar
e using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implic
itly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https:
//github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default
 value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling
. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case wh
ere you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this exper
imental feature.
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-19 00:26:03.101 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-19 00:26:03.102 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-19 00:26:03.105 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-19 00:26:03.105 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/me
rged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
`Trainer.fit` stopped: `max_epochs=17` reached.
2024-09-19 00:26:06.485 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:26:06.605 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:26:06.631 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:26:06.645 | INFO     | __main__:main:1521 - hit the barrier after training
2024-09-19 00:26:06.646 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:26:06.646 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:26:06.646 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:26:06.646 | INFO     | __main__:main:1527 - Finished progressive training at epoch 17
2024-09-19 00:26:06.647 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:find_latest_checkpoint:547 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d
50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:06.647 | INFO     | __main__:main:1534 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00_lambda_0.1
_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:09.546 | INFO     | __main__:main:1684 - Finished processing the repository
2024-09-19 00:26:09.547 | INFO     | __main__:main:1686 - current epoch: 17
2024-09-19 00:26:09.547 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:26:09.547 | INFO     | __main__:main:1358 - i: 1
2024-09-19 00:26:09.547 | INFO     | __main__:main:2066 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1359, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-19 00:26:09.566 | INFO     | __main__:main:1622 - Starting the prover
2024-09-19 00:26:09.567 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-19 00:26:09.567 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-19 00:26:09.567 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-19 00:26:09.567 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b8
8b44a98436d50dd7abd00_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:09.584 | INFO     | __main__:main:1684 - Finished processing the repository
2024-09-19 00:26:09.584 | INFO     | __main__:main:1686 - current epoch: 17
2024-09-19 00:26:09.585 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:26:09.585 | INFO     | __main__:main:1358 - i: 1
2024-09-19 00:26:09.585 | INFO     | __main__:main:2066 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1359, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-19 00:26:09.587 | INFO     | __main__:main:1684 - Finished processing the repository
2024-09-19 00:26:09.587 | INFO     | __main__:main:1686 - current epoch: 17
2024-09-19 00:26:09.587 | INFO     | __main__:main:1357 - length of lean_git_repos: 1
2024-09-19 00:26:09.587 | INFO     | __main__:main:1358 - i: 1
2024-09-19 00:26:09.587 | INFO     | __main__:main:2066 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_minif2f.py", line 1359, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files perma
nently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-19 00:26:09.875 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd0
0_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:09.875 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd0
0_lambda_0.1_epoch=16-Recall@10_val=72.09.ckpt
2024-09-19 00:26:12.730 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys
that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.enco
der.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encode
r.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriev
er.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.re
lative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encode
r.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight',
'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_
norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.la
yer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriev
er.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block
.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.e
ncoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 're
triever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.
weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.lay
er.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 're
triever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttenti
on.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.la
yer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.en
coder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight'
, 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttenti
on.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.la
yer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.e
ncoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'ret
riever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseRel
uDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.la
yer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.e
ncoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.w
i_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5
.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.e
ncoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 're
triever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1
.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encode
r.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 're
triever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.la
yer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encode
r.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight',
'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_
norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.la
yer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriev
er.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block
.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.e
ncoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 're
triever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.
weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.lay
er.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'r
etriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAtte
ntion.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.
10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.enco
der.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo
.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.S
elfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder
.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_
0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11
.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys
that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'stat
e_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-19 00:26:13.439 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/
model_lightning.ckpt
2024-09-19 00:26:13.440 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-19 00:26:13.440 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lea
n_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7ab
d00/corpus.jsonl
2024-09-19 00:26:13.440 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datase
ts_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-09-19 00:26:18.962 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-19 00:26:18.962 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean
_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd
00/corpus.jsonl
2024-09-19 00:26:18.962 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████████| 3976/3976 [05:27<00:00, 12.13it/s]
2024-09-19 00:31:46.683 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-09-19 00:31:46.683 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-09-19 00:31:51,298 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=257938) [2024-09-19 00:32:25,903] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda
(auto detect)
(ProverActor pid=257938) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: Fu
tureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default p
ickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unp
ickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future r
elease, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be execute
d during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly
allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True`
for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues re
lated to this experimental feature.
(ProverActor pid=257938)   return torch.load(io.BytesIO(b))
(pid=258124) [2024-09-19 00:32:35,494] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda
(auto detect)
(ProverActor pid=258124) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: Fu
tureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default p
ickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unp
ickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future r
elease, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be execute
d during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly
allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True`
for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues re
lated to this experimental feature.
(ProverActor pid=258124)   return torch.load(io.BytesIO(b))
(pid=258307) [2024-09-19 00:32:45,967] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda
(auto detect)
(ProverActor pid=258307) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: Fu
tureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default p
ickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unp
ickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future r
elease, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be execute
d during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly
allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True`
for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues re
lated to this experimental feature.
(ProverActor pid=258307)   return torch.load(io.BytesIO(b))
2024-09-19 00:32:52.816 | INFO     | __main__:load_encountered_theorems:826 - The file encountered_theorems_PT_single_r
epo_no_ewc_curriculum_full_minif2f.pkl does not exist. Starting with an empty set.
2024-09-19 00:32:52.816 | INFO     | __main__:prove_sorry_theorems:852 - Found 358 sorry theorems to prove
Processing theorems from yangky11/miniF2F-lean4:   0%|                                    | 0/358 [00:00<?, ?theorem/s]
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for amc12a_2020_p7
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:876 - Position: (566, 1)
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for aime_1983_p1
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:876 - Position: (24, 1)
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for mathd_numbertheory_353
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:876 - Position: (230, 1)
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for aime_1988_p8
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:876 - Position: (990, 1)
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for amc12_2000_p6
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:876 - Position: (983, 1)
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for mathd_algebra_756
2024-09-19 00:32:52.817 | INFO     | __main__:prove_sorry_theorems:876 - Position: (512, 1)
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for mathd_numbertheory_126
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:876 - Position: (899, 1)
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for imo_1967_p3
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:876 - Position: (806, 1)
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for imo_1960_p2
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:876 - Position: (123, 1)
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for mathd_numbertheory_629
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:876 - Position: (1119, 1)
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for aime_1983_p3
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:876 - Position: (1037, 1)
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:875 - Searching for proof for mathd_numbertheory_764
2024-09-19 00:32:52.818 | INFO     | __main__:prove_sorry_theorems:876 - Position: (600, 1)
2024-09-19 00:32:52.818 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=257938) 2024-09-19 00:32:52.826 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='aime_1988_p8')
(pid=258882) [2024-09-19 00:32:59,805] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda
(auto detect)
(ProverActor pid=258882) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: Fu
tureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default p
ickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unp
ickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future r
elease, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be execute
d during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly
allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True`
for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues re
lated to this experimental feature.
(ProverActor pid=258882)   return torch.load(io.BytesIO(b))
(ProverActor pid=258307) 2024-09-19 00:32:57.417 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=Lean
GitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=
PosixPath('MiniF2F/Test.lean'), full_name='aime_1983_p1') [repeated 2x across cluster] (Ray deduplicates logs by defaul
t. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guide
s/configure-logging.html#log-deduplication for more options.)

