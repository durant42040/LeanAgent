2024-09-08 15:39:34.011 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:39:34.014 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:39:34.014 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:39:34.014 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 15:39:34.014 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:39:48.537 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:39:48.538 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:39:53.994 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:39:53.995 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:39:54.224 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:39:54.225 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:39:54.225 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:39:54.225 | INFO     | __main__:main:1631 - An error occurred: AlexKontorovich/PrimeNumberTheoremAnd is not a Github URL
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1271, in main
    lean_git_repo = LeanGitRepo(url, commit)
  File "<string>", line 5, in __init__
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/data_extraction/lean.py", line 420, in __post_init__
    raise ValueError(f"{self.url} is not a Github URL")
ValueError: AlexKontorovich/PrimeNumberTheoremAnd is not a Github URL
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
^Z
[30]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 15:40:13,189] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:40:16.994 | INFO     | __main__:main:1145 - Running retrieval baseline
2024-09-08 15:40:16.994 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:40:16.997 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:40:16.997 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:40:16.997 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 15:40:16.997 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:40:31.353 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:40:31.354 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:40:36.825 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:40:36.825 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:40:37.057 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:40:37.057 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:40:37.057 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:40:37.418 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 15:40:52.645 | INFO     | __main__:main:1299 - length of lean_git_repos: 1
2024-09-08 15:40:52.645 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:40:52.645 | INFO     | __main__:main:1305 - Main process
2024-09-08 15:40:52.645 | INFO     | __main__:main:1306 - Using lambda = 0.0
2024-09-08 15:40:52.645 | INFO     | __main__:main:1307 - Processing https://github.com/AlexKontorovich/PrimeNumberTheoremAnd
2024-09-08 15:40:52.646 | INFO     | __main__:main:1329 - Adding repo to repos_for_merged_dataset
2024-09-08 15:40:52.646 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:40:52.646 | INFO     | __main__:main:1569 - Starting the prover
2024-09-08 15:40:52.646 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 15:40:52.646 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 15:40:52.646 | INFO     | prover.proof_search:__init__:427 - Using RAG
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/mo
del_lightning.ckpt`
2024-09-08 15:40:53.321 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:40:53.321 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge_each_time_ewc/mathlib4_29d
cec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 15:40:56.122 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 15:40:56.659 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 15:40:56.660 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 15:40:56.660 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2425
3d566/corpus.jsonl
2024-09-08 15:40:56.660 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpus.jso
nl
2024-09-08 15:41:05.551 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 15:41:05.551 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/corpus.jsonl
2024-09-08 15:41:05.551 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 15:41:08,314 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=954813) [2024-09-08 15:41:46,735] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=954813) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=954813)   return torch.load(io.BytesIO(b))
(pid=954981) [2024-09-08 15:41:59,176] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=954981) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=954981)   return torch.load(io.BytesIO(b))
(pid=955142) [2024-09-08 15:42:09,024] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=955142) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=955142)   return torch.load(io.BytesIO(b))
2024-09-08 15:42:14.982 | INFO     | __main__:prove_sorry_theorems:781 - Found 27 sorry theorems to prove
Processing theorems from AlexKontorovich/PrimeNumberTheoremAnd:   0%|                                                                                                                                                   | 0/27 [00:00<?, ?theorem/s]
2024-09-08 15:42:14.984 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for integrable_x_mul_Smooth1
2024-09-08 15:42:14.984 | INFO     | __main__:prove_sorry_theorems:805 - Position: (63, 1)
2024-09-08 15:42:14.984 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for lambda_pnt
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (326, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for continuousAt_Smooth1
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (76, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for mu_pnt
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (291, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for crude_upper_bound
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (2240, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for pi_asymp
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (95, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for chebyshev_asymptotic_finsum
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (47, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for mu_pnt_alt
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (351, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for MellinInversion_aux1
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (422, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for MellinInversion_aux2
2024-09-08 15:42:14.987 | INFO     | __main__:prove_sorry_theorems:805 - Position: (446, 1)
2024-09-08 15:42:14.987 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(ProverActor pid=954813) 2024-09-08 15:42:15.002 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/Consequences.lean'), full_name='mu_pnt')
(ProverActor pid=954981) 2024-09-08 15:42:15.001 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/MediumPNT.lean'), full_name='continuousAt_Smooth1')
(ProverActor pid=955142) 2024-09-08 15:42:21.962 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/Consequences.lean'), full_name='lambda_pnt')
(pid=955320) [2024-09-08 15:42:22,142] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=955320) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=955320)   return torch.load(io.BytesIO(b))
(ProverActor pid=955320) 2024-09-08 15:42:34.422 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/MediumPNT.lean'), full_name='integrable_x_mul_Smooth1')
(ProverActor pid=954981) 2024-09-08 15:43:06.469 | INFO     | lean_dojo.utils:execute:88 -
(ProverActor pid=954813) 2024-09-08 15:43:06.558 | ERROR    | lean_dojo.utils:execute:89 - info: downloading component 'lean'
(ProverActor pid=954813) info: installing component 'lean'
(ProverActor pid=954813) error: could not remove 'temp toolchain directory' directory: '/data/yingzi_ma/.elan/toolchains/leanprover--lean4---v4.8.tmp'
(ProverActor pid=954813) info: caused by: Directory not empty (os error 39)
(ProverActor pid=954813)
(ProverActor pid=954981) info: caused by: No such file or directory (os error 2)
(ProverActor pid=954981)
Processing theorems from AlexKontorovich/PrimeNumberTheoremAnd:  33%|██████████████████████████████████████████████▎                                                                                            | 9/27 [00:54<01:49,  6.06s/theorem]
2024-09-08 15:43:09.500 | INFO     | __main__:main:1631 - An error occurred: ray::ProverActor.search() (pid=954813, ip=10.0.4.105, actor_id=975d90db15c7128ac695ac7601000000, repr=<prover.proof_search.ProverActor object at 0x73691ad53400>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1600, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_merged_dataset)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 818, in prove_sorry_theorems
    process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 710, in process_theorem_batch
    results = prover.search_unordered(LeanGitRepo(repo.url, repo.commit), lean_dojo_theorems, positions_batch)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 515, in search_unordered
    results = list(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 170, in get_generator
    yield self.get_next_unordered()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 370, in get_next_unordered
    return ray.get(future)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
(ProverActor pid=954813) 2024-09-08 15:43:09.501 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/Wiener.lean'), full_name='crude_upper_bound')
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 2661, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 871, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(CalledProcessError): ray::ProverActor.search() (pid=954813, ip=10.0.4.105, actor_id=975d90db15c7128ac695ac7601000000, repr=<prover.proof_search.ProverActor object at 0x73691ad53400>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
2024-09-08 15:43:10,223 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=954981, ip=10.0.4.105, actor_id=15ff1172ca596abeb702457d01000000, repr=<prover.proof_search.ProverAct
or object at 0x76851210f460>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(ProverActor pid=954813) 2024-09-08 15:43:06.470 | INFO     | lean_dojo.utils:execute:88 -
(ProverActor pid=954981) 2024-09-08 15:43:06.558 | ERROR    | lean_dojo.utils:execute:89 - info: downloading component 'lean'
(ProverActor pid=954981) info: installing component 'lean'
(ProverActor pid=954981) error: could not remove 'temp toolchain directory' directory: '/data/yingzi_ma/.elan/toolchains/leanprover--lean4---v4.8.tmp'
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 15:49:47,029] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:49:50.841 | INFO     | __main__:main:1145 - Running retrieval baseline
2024-09-08 15:49:50.842 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:49:50.844 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:49:50.844 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:49:50.845 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 15:49:50.845 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 15:49:59.849 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:49:59.849 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:49:59.964 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 15:49:59.964 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:49:59.964 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:50:00.379 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 15:50:15.637 | INFO     | __main__:main:1305 - length of lean_git_repos: 1
2024-09-08 15:50:15.638 | INFO     | __main__:main:1306 - i: 0
2024-09-08 15:50:15.638 | INFO     | __main__:main:1311 - Main process
2024-09-08 15:50:15.638 | INFO     | __main__:main:1312 - Using lambda = 0.0
2024-09-08 15:50:15.638 | INFO     | __main__:main:1313 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 15:50:15.638 | INFO     | __main__:add_repo_to_database:855 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:15.939 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 15:50:15.939 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 15:50:15.939 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:15.940 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:15.942 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 15:50:15.944 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:25.712 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:25.717 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:25.726 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:50:26.214 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 15:50:44.031 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 15:51:03.829 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 15:51:18.756 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:51:18.756 | INFO     | __main__:add_repo_to_database:874 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 15:51:18.756 | INFO     | __main__:add_repo_to_database:875 - Lean version: v4.8.0-rc2
2024-09-08 15:51:18.756 | INFO     | __main__:add_repo_to_database:880 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.757 | INFO     | generate_benchmark_lean4:main:377 - Lean toolchain path 1 does not exist: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.758 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.758 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.758 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 15:51:18.829 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-09-08 15:51:18.829 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 15:51:18.829 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-09-08 15:51:18.835 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:51:18.835 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-09-08 15:51:18.835 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-09-08 15:51:18.838 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-08 15:51:18.838 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_i
n_lean_source
2024-09-08 15:51:21.911 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a57
6389ecf5/mathematics_in_lean_source with 31 workers
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|███████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3143/3143 [07:02<00:00,  7.44it/s]
2024-09-08 15:58:24.495 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 15:58:25.920 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-08 15:58:42.488 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:58:58.300 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-08 15:59:14.040 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-08 15:59:15.166 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-08 15:59:18.384 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0-rc1
2024-09-08 15:59:33.481 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3fecb249afcf5ba40efe0a3f92f69e2460f142c7')
2024-09-08 15:59:34.637 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-08 16:00:05.056 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a
576389ecf5'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='e9e858a4484905a0bfe97c4f05c3924ead02eed8'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='8feac540ab
b781cb1349688c816dc02fae66b49c'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='2c8ae451ce9ffc83554322b14437159c1a9703f9'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='e291
aa4de57079b3d2199b9eb7b4b00922b85a7c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='eb08eee94098fe530ccd6d8751a86fe405473d4c'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli
', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3fecb249afcf5ba40efe0a3f92f69e2460f142c7'), 'importGraph': LeanGitRepo(url='https://github.com/leanpro
ver-community/import-graph', commit='fb7841a6f4fb389ec0e47dd4677844d49906af3c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_in_lean_s
ource'))
2024-09-08 16:00:19.313 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-09-08 16:00:19.314 | WARNING  | generate_benchmark_lean4:safe_remove_dir:281 - /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already exists. Remov
ing it now.
2024-09-08 16:00:26.151 | INFO     | generate_benchmark_lean4:split_data:133 - 78886 theorems in total
2024-09-08 16:00:26.151 | INFO     | generate_benchmark_lean4:split_data:138 - 78886 theorems in total, with 1577 for validation and 1577 for testing
2024-09-08 16:00:26.151 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-09-08 16:00:26.178 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-09-08 16:00:31.820 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-09-08 16:00:46.080 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 126314 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/random/train.json
2024-09-08 16:00:46.520 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2921 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random/val.json
2024-09-08 16:00:46.807 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2555 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random/test.json
2024-09-08 16:01:00.207 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 123871 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/novel_premises/train.json
2024-09-08 16:01:00.713 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 3849 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/novel_premises/val.json
2024-09-08 16:01:01.117 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 4070 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/novel_premises/test.json
2024-09-08 16:01:01.117 | INFO     | generate_benchmark_lean4:export_proofs:206 - 157772 theorems saved in total
2024-09-08 16:01:01.120 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-09-08 16:01:18.090 | INFO     | generate_benchmark_lean4:export_premises:229 - 117699 theorems/definitions from 3143 files saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb0
51367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-08 16:01:18.104 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-09-08 16:01:18.105 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-09-08 16:01:18.105 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-09-08 16:01:18.165 | INFO     | __main__:add_repo_to_database:888 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 75732/75732 [00:01<00:00, 58152.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 57955.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 60322.45it/s]
2024-09-08 16:01:21.448 | INFO     | __main__:add_repo_to_database:913 - Before adding new repo:
2024-09-08 16:01:21.448 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-08 16:01:21.448 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:01:21.449 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:01:21.449 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:01:21.449 | INFO     | __main__:add_repo_to_database:916 - After adding new repo:
2024-09-08 16:01:21.449 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-08 16:01:21.449 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:01:21.449 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:01:36.417 | INFO     | __main__:main:1335 - Adding repo to repos_for_merged_dataset
2024-09-08 16:01:36.419 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-08 16:01:36.419 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: cfe61bc71b5ea501f89df36c945949a1febf5e75)
2024-09-08 16:01:36.419 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e75 already
exists. Removing it now.
2024-09-08 16:01:36.452 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945
949a1febf5e75
2024-09-08 16:01:36.453 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501
f89df36c945949a1febf5e75
2024-09-08 16:01:36.454 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df
36c945949a1febf5e75
2024-09-08 16:01:36.455 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c9
45949a1febf5e75
2024-09-08 16:01:36.455 | INFO     | __main__:main:1346 - All GPUs
2024-09-08 16:01:36.455 | INFO     | __main__:main:1575 - Starting the prover
2024-09-08 16:01:36.455 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 16:01:36.455 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 16:01:36.455 | INFO     | prover.proof_search:__init__:427 - Using RAG
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/mo
del_lightning.ckpt`
2024-09-08 16:01:37.165 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 16:01:37.165 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge_each_time_ewc/mathlib4_29d
cec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 16:01:38.855 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 16:01:39.395 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 16:01:39.396 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 16:01:39.396 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949
a1febf5e75/corpus.jsonl
2024-09-08 16:01:39.396 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e75/corpu
s.jsonl
2024-09-08 16:01:39.397 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 16:01:39.397 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a
1febf5e75/corpus.jsonl
2024-09-08 16:01:39.397 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 16:01:42,759 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=989478) [2024-09-08 16:02:14,142] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=989478) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=989478)   return torch.load(io.BytesIO(b))
2024-09-08 16:02:19.873 | INFO     | __main__:save_progress:736 - Saving encountered theorems...
2024-09-08 16:02:19.875 | INFO     | __main__:prove_sorry_theorems:832 - Finished attempting to prove sorry theorems
(pid=989840) [2024-09-08 16:02:24,243] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect) [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplicati
on, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ProverActor pid=989840) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature. [repeated 2x across cluster]
(ProverActor pid=989840)   return torch.load(io.BytesIO(b)) [repeated 2x across cluster]
2024-09-08 16:02:37.936 | INFO     | __main__:main:1609 - Finished searching for proofs of sorry theorems
2024-09-08 16:02:37.936 | INFO     | __main__:main:1635 - current epoch: 1
2024-09-08 16:02:37.936 | INFO     | __main__:main:1305 - length of lean_git_repos: 1
2024-09-08 16:02:37.936 | INFO     | __main__:main:1306 - i: 1
2024-09-08 16:02:37.936 | INFO     | __main__:main:1637 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1307, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
(pid=990007) [2024-09-08 16:02:27,873] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=990007) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=990007)   return torch.load(io.BytesIO(b))
^Z
[31]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:03:28,500] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:03:32.454 | INFO     | __main__:main:1147 - Running retrieval baseline
2024-09-08 16:03:32.454 | INFO     | __main__:main:1150 - Configuring LeanDojo...
2024-09-08 16:03:32.457 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:03:32.457 | INFO     | __main__:main:1152 - LeanDojo configured
2024-09-08 16:03:32.457 | INFO     | __main__:main:1157 - Starting the main process
2024-09-08 16:03:32.458 | INFO     | __main__:main:1165 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:03:46.932 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:03:46.932 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:03:52.562 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:03:52.562 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:03:52.793 | INFO     | __main__:main:1167 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:03:52.793 | INFO     | __main__:main:1174 - Found 15 repositories
2024-09-08 16:03:52.793 | INFO     | __main__:main:1265 - Starting without curriculum learning
2024-09-08 16:03:53.168 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 16:04:08.291 | INFO     | __main__:main:1313 - length of lean_git_repos: 2
2024-09-08 16:04:08.291 | INFO     | __main__:main:1314 - i: 0
2024-09-08 16:04:08.291 | INFO     | __main__:main:1319 - Main process
2024-09-08 16:04:08.291 | INFO     | __main__:main:1320 - Using lambda = 0.0
2024-09-08 16:04:08.291 | INFO     | __main__:main:1321 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:04:08.291 | INFO     | __main__:main:1343 - Adding repo to repos_for_merged_dataset
2024-09-08 16:04:08.291 | INFO     | __main__:main:1354 - All GPUs
2024-09-08 16:04:08.291 | INFO     | __main__:main:1583 - Starting the prover
2024-09-08 16:04:08.292 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 16:04:08.292 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 16:04:08.292 | INFO     | prover.proof_search:__init__:427 - Using RAG
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/mo
del_lightning.ckpt`
2024-09-08 16:04:08.963 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 16:04:08.963 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge_each_time_ewc/mathlib4_29d
cec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 16:04:10.537 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 16:04:11.076 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 16:04:11.077 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 16:04:11.077 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a
576389ecf5/corpus.jsonl
2024-09-08 16:04:11.077 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/corpu
s.jsonl
2024-09-08 16:04:11.077 | INFO     | __main__:main:1645 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c
48c0a084411853a576389ecf5/corpus.jsonl'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1596, in main
    prover = DistributedProver(
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 456, in __init__
    tac_gen.retriever.load_corpus(indexed_corpus_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 156, in load_corpus
    self.corpus = Corpus(path)
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 210, in __init__
    for line in open(jsonl_path):
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl'
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
^Z
[32]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:25:07,441] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:25:11.246 | INFO     | __main__:main:1148 - Running retrieval baseline
2024-09-08 16:25:11.247 | INFO     | __main__:main:1151 - Configuring LeanDojo...
2024-09-08 16:25:11.249 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:25:11.249 | INFO     | __main__:main:1153 - LeanDojo configured
2024-09-08 16:25:11.249 | INFO     | __main__:main:1158 - Starting the main process
2024-09-08 16:25:11.250 | INFO     | __main__:main:1166 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:25:25.577 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:25:25.577 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:25:31.069 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:25:31.069 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:25:31.299 | INFO     | __main__:main:1168 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:25:31.299 | INFO     | __main__:main:1175 - Found 15 repositories
2024-09-08 16:25:31.299 | INFO     | __main__:main:1266 - Starting without curriculum learning
2024-09-08 16:25:31.660 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:25:46.840 | INFO     | __main__:main:1314 - length of lean_git_repos: 2
2024-09-08 16:25:46.840 | INFO     | __main__:main:1315 - i: 0
2024-09-08 16:25:46.840 | INFO     | __main__:main:1668 - An error occurred: 'LeanGitRepo' object is not subscriptable
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1338, in main
    lean_git_repos[i] = (lean_git_repos[i][0], sha)
TypeError: 'LeanGitRepo' object is not subscriptable
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:26:12,190] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:26:16.018 | INFO     | __main__:main:1148 - Running retrieval baseline
2024-09-08 16:26:16.018 | INFO     | __main__:main:1151 - Configuring LeanDojo...
2024-09-08 16:26:16.021 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:26:16.021 | INFO     | __main__:main:1153 - LeanDojo configured
2024-09-08 16:26:16.021 | INFO     | __main__:main:1158 - Starting the main process
2024-09-08 16:26:16.021 | INFO     | __main__:main:1166 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:26:30.865 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:26:30.865 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:26:36.561 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:26:36.561 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:26:36.803 | INFO     | __main__:main:1168 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:26:36.803 | INFO     | __main__:main:1175 - Found 15 repositories
2024-09-08 16:26:36.803 | INFO     | __main__:main:1266 - Starting without curriculum learning
2024-09-08 16:26:36.996 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:26:52.602 | INFO     | __main__:main:1314 - length of lean_git_repos: 2
2024-09-08 16:26:52.602 | INFO     | __main__:main:1315 - i: 0
2024-09-08 16:26:52.602 | INFO     | __main__:main:1668 - An error occurred: 'tuple' object has no attribute 'url'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1340, in main
    dir_name = repo.url.split("/")[-1] + "_" + sha
AttributeError: 'tuple' object has no attribute 'url'
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:27:20,048] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:27:23.887 | INFO     | __main__:main:1148 - Running retrieval baseline
2024-09-08 16:27:23.888 | INFO     | __main__:main:1151 - Configuring LeanDojo...
2024-09-08 16:27:23.891 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:27:23.891 | INFO     | __main__:main:1153 - LeanDojo configured
2024-09-08 16:27:23.891 | INFO     | __main__:main:1158 - Starting the main process
2024-09-08 16:27:23.891 | INFO     | __main__:main:1166 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:27:38.504 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:27:38.504 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:27:44.213 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:27:44.213 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:27:44.451 | INFO     | __main__:main:1168 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:27:44.451 | INFO     | __main__:main:1175 - Found 15 repositories
2024-09-08 16:27:44.451 | INFO     | __main__:main:1266 - Starting without curriculum learning
2024-09-08 16:27:44.687 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:28:00.286 | INFO     | __main__:main:1314 - length of lean_git_repos: 2
2024-09-08 16:28:00.286 | INFO     | __main__:main:1315 - i: 0
2024-09-08 16:28:00.508 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 16:28:15.868 | INFO     | __main__:main:1342 - Main process
2024-09-08 16:28:15.868 | INFO     | __main__:main:1343 - Using lambda = 0.0
2024-09-08 16:28:15.868 | INFO     | __main__:main:1344 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:28:15.868 | INFO     | __main__:add_repo_to_database:857 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:16.167 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:28:16.167 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:28:16.167 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:16.167 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:16.171 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:28:16.172 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:18.286 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:18.290 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:18.299 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:18.788 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 16:28:36.188 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 16:28:55.058 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:55.058 | INFO     | __main__:add_repo_to_database:877 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:28:55.058 | INFO     | __main__:add_repo_to_database:878 - Lean version: v4.8.0-rc2
2024-09-08 16:28:55.058 | INFO     | __main__:add_repo_to_database:883 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 16:28:55.058 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 16:28:55.058 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-09-08 16:28:55.058 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-09-08 16:28:55.058 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:377 - Lean toolchain path 1 does not exist: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.059 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:28:55.096 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-09-08 16:28:55.096 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 16:28:55.096 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-09-08 16:28:55.102 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:28:55.102 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-09-08 16:28:55.102 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-09-08 16:28:55.105 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-08 16:28:55.105 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_i
n_lean_source
2024-09-08 16:28:56.837 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a57
6389ecf5/mathematics_in_lean_source with 31 workers
 38%|█████████████████████████████████████████████████████████████████████████████▉                                                                                                                             | 1207/3143 [01:12<00:56, 34.20it/s]
^Z
[33]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:30:24,270] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:30:28.112 | INFO     | __main__:main:1181 - Running retrieval baseline
2024-09-08 16:30:28.112 | INFO     | __main__:main:1184 - Configuring LeanDojo...
2024-09-08 16:30:28.115 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:30:28.115 | INFO     | __main__:main:1186 - LeanDojo configured
2024-09-08 16:30:28.115 | INFO     | __main__:main:1191 - Starting the main process
2024-09-08 16:30:28.116 | INFO     | __main__:main:1199 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
^Z
[34]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:30:41,917] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:30:45.765 | INFO     | __main__:main:1181 - Running retrieval baseline
2024-09-08 16:30:45.765 | INFO     | __main__:main:1184 - Configuring LeanDojo...
2024-09-08 16:30:45.768 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:30:45.768 | INFO     | __main__:main:1186 - LeanDojo configured
2024-09-08 16:30:45.768 | INFO     | __main__:main:1191 - Starting the main process
2024-09-08 16:30:45.768 | INFO     | __main__:main:1199 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:31:00.069 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:31:00.069 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
^Z
[35]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:31:35,700] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:31:39.502 | INFO     | __main__:main:1181 - Running retrieval baseline
2024-09-08 16:31:39.503 | INFO     | __main__:main:1184 - Configuring LeanDojo...
2024-09-08 16:31:39.505 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:31:39.506 | INFO     | __main__:main:1186 - LeanDojo configured
2024-09-08 16:31:39.506 | INFO     | __main__:main:1191 - Starting the main process
2024-09-08 16:31:39.506 | INFO     | __main__:main:1199 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:31:53.746 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:31:53.746 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:31:59.269 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:31:59.270 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:31:59.499 | INFO     | __main__:main:1201 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:31:59.500 | INFO     | __main__:main:1208 - Found 15 repositories
2024-09-08 16:31:59.500 | INFO     | __main__:main:1299 - Starting without curriculum learning
2024-09-08 16:31:59.929 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
^Z
[36]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:34:00,390] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:34:04.236 | INFO     | __main__:main:1181 - Running retrieval baseline
2024-09-08 16:34:04.236 | INFO     | __main__:main:1184 - Configuring LeanDojo...
2024-09-08 16:34:04.239 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:34:04.239 | INFO     | __main__:main:1186 - LeanDojo configured
2024-09-08 16:34:04.239 | INFO     | __main__:main:1191 - Starting the main process
2024-09-08 16:34:04.239 | INFO     | __main__:main:1199 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:34:18.498 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:34:18.498 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:34:23.978 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:34:23.978 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:34:24.205 | INFO     | __main__:main:1201 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:34:24.206 | INFO     | __main__:main:1208 - Found 15 repositories
2024-09-08 16:34:24.206 | INFO     | __main__:main:1299 - Starting without curriculum learning
2024-09-08 16:34:24.391 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:34:40.608 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:34:40.608 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:34:40.608 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:34:40.609 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:34:40.612 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:34:40.613 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:34:42.642 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:34:42.646 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:34:42.656 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:34:43.121 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 16:34:59.284 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 16:35:18.828 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 16:35:33.986 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
> /data/yingzi_ma/lean_project/ReProver/main.py(407)find_and_save_compatible_commits()
    406
--> 407         updated_repos.append({"url": url, "commit": sha, "version": v})
    408

ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(383)find_and_save_compatible_commits()
    382     updated_repos = []
--> 383     for repo in lean_git_repos:
    384         url = repo.url

ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(384)find_and_save_compatible_commits()
    383     for repo in lean_git_repos:
--> 384         url = repo.url
    385         if not url.endswith('.git'):

ipdb> c
2024-09-08 16:36:00.093 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:36:00.094 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:36:00.094 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:36:00.094 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:36:00.097 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:36:00.098 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:36:02.093 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:36:02.097 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:36:02.107 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:36:02.107 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
> /data/yingzi_ma/lean_project/ReProver/main.py(407)find_and_save_compatible_commits()
    406
--> 407         updated_repos.append({"url": url, "commit": sha, "version": v})
    408

ipdb> url
'https://github.com/avigad/mathematics_in_lean_source.git'
ipdb> sha
'5297e0fb051367c48c0a084411853a576389ecf5'
ipdb> v
'v4.8.0-rc2'
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(383)find_and_save_compatible_commits()
    382     updated_repos = []
--> 383     for repo in lean_git_repos:
    384         url = repo.url

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(409)find_and_save_compatible_commits()
    408
--> 409     with open(repo_info_file, 'w') as f:
    410         json.dump(updated_repos, f)

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(410)find_and_save_compatible_commits()
    409     with open(repo_info_file, 'w') as f:
--> 410         json.dump(updated_repos, f)
    411

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(409)find_and_save_compatible_commits()
    408
--> 409     with open(repo_info_file, 'w') as f:
    410         json.dump(updated_repos, f)

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(412)find_and_save_compatible_commits()
    411
--> 412     return updated_repos
    413

ipdb> n
--Return--
[{'commit': '5297e0fb0513...53a576389ecf5', 'url': 'https://gith...an_source.git', 'version': 'v4.8.0-rc2'}, {'commit': '5297e0fb0513...53a576389ecf5', 'url': 'https://gith...an_source.git', 'version': 'v4.8.0-rc2'}]
> /data/yingzi_ma/lean_project/ReProver/main.py(412)find_and_save_compatible_commits()
    411
--> 412     return updated_repos
    413

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1329)main()
   1328                 updated_repos = find_and_save_compatible_commits(repo_info_file, lean_git_repos)
-> 1329                 lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
   1330

ipdb> n
2024-09-08 16:36:36.050 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/avigad/mathematics_in_lean_source.git") failed. Retrying...
2024-09-08 16:36:37.195 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/avigad/mathematics_in_lean_source.git") failed. Retrying...
github.GithubException.UnknownObjectException: 404 {"message": "Not Found", "documentation_url": "https://docs.github.com/rest/repos/repos#get-a-repository", "status": "404"}
> /data/yingzi_ma/lean_project/ReProver/main.py(1329)main()
   1328                 updated_repos = find_and_save_compatible_commits(repo_info_file, lean_git_repos)
-> 1329                 lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
   1330

ipdb> lean_git_repos
[LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='cfe61bc71b5ea501f89df36c945949a1febf5e75'), LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='cfe61bc71b5ea501f89df36c945949a1febf5e7
5')]
ipdb> repo_info_file
'/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/repo_info_compatible.json'
ipdb> updated_repos
[{'url': 'https://github.com/avigad/mathematics_in_lean_source.git', 'commit': '5297e0fb051367c48c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}, {'url': 'https://github.com/avigad/mathematics_in_lean_source.git', 'commit': '5297e0fb051367c4
8c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}]
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1678)main()
   1677                     logger.info(f"current epoch: {current_epoch}")
-> 1678     except Exception as e:
   1679         logger.info(f"An error occurred: {e}", file=sys.stderr)

ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1679)main()
   1678     except Exception as e:
-> 1679         logger.info(f"An error occurred: {e}", file=sys.stderr)
   1680         traceback.print_exc()

ipdb>
KeyError: '"message"'
> /data/yingzi_ma/lean_project/ReProver/main.py(1679)main()
   1678     except Exception as e:
-> 1679         logger.info(f"An error occurred: {e}", file=sys.stderr)
   1680         traceback.print_exc()

ipdb> c
Error in sys.excepthook:
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/IPython/core/debugger.py", line 145, in BdbQuit_excepthook
    raise ValueError(
ValueError: `BdbQuit_excepthook` is deprecated since version 5.1

Original exception was:
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1329, in main
    lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1329, in <listcomp>
    lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
  File "<string>", line 5, in __init__
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/data_extraction/lean.py", line 424, in __post_init__
    object.__setattr__(self, "repo", url_to_repo(self.url))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/data_extraction/lean.py", line 68, in url_to_repo
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/data_extraction/lean.py", line 65, in url_to_repo
    return GITHUB.get_repo("/".join(url.split("/")[-2:]))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/github/MainClass.py", line 434, in get_repo
    headers, data = self.__requester.requestJsonAndCheck("GET", url)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/github/Requester.py", line 550, in requestJsonAndCheck
    return self.__check(*self.requestJson(verb, url, parameters, headers, input, self.__customConnection(url)))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/github/Requester.py", line 611, in __check
    raise self.createException(status, responseHeaders, data)
github.GithubException.UnknownObjectException: 404 {"message": "Not Found", "documentation_url": "https://docs.github.com/rest/repos/repos#get-a-repository", "status": "404"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1683, in <module>
    main()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1679, in main
    logger.info(f"An error occurred: {e}", file=sys.stderr)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2044, in info
    __self._log("INFO", False, __self._options, __message, args, kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2021, in _log
    log_record["message"] = message.format(*args, **kwargs)
KeyError: '"message"'
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
^Z
[37]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:38:35,214] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:38:39.041 | INFO     | __main__:main:1179 - Running retrieval baseline
2024-09-08 16:38:39.041 | INFO     | __main__:main:1182 - Configuring LeanDojo...
2024-09-08 16:38:39.044 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:38:39.044 | INFO     | __main__:main:1184 - LeanDojo configured
2024-09-08 16:38:39.044 | INFO     | __main__:main:1189 - Starting the main process
2024-09-08 16:38:39.044 | INFO     | __main__:main:1197 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:38:53.595 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:38:53.595 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:38:59.293 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:38:59.293 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:38:59.536 | INFO     | __main__:main:1199 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:38:59.537 | INFO     | __main__:main:1206 - Found 15 repositories
2024-09-08 16:38:59.537 | INFO     | __main__:main:1297 - Starting without curriculum learning
2024-09-08 16:38:59.862 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:39:15.618 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:39:15.618 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:39:15.618 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:39:15.618 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:39:15.621 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:39:15.623 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:39:17.667 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:39:17.671 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:39:17.681 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:39:17.737 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 16:39:33.239 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 16:39:48.957 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 16:40:04.265 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:04.551 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:40:04.551 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:40:04.552 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:04.552 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:04.555 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:40:04.556 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:06.609 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:06.613 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:06.625 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:40:06.625 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
> /data/yingzi_ma/lean_project/ReProver/main.py(1328)main()
   1327                 import ipdb; ipdb.set_trace()
-> 1328                 lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
   1329

ipdb> updated_repos
[{'url': 'https://github.com/avigad/mathematics_in_lean_source.git', 'commit': '5297e0fb051367c48c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}, {'url': 'https://github.com/avigad/mathematics_in_lean_source.git', 'commit': '5297e0fb051367c4
8c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}]
ipdb> updated_repos[0]
{'url': 'https://github.com/avigad/mathematics_in_lean_source.git', 'commit': '5297e0fb051367c48c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}
ipdb> LeanGitRepo("https://github.com/avigad/mathematics_in_lean_source.git", "5297e0fb051367c48c0a084411853a576389ecf5")
2024-09-08 16:40:56.272 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/avigad/mathematics_in_lean_source.git") failed. Retrying...
2024-09-08 16:40:57.393 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/avigad/mathematics_in_lean_source.git") failed. Retrying...
*** github.GithubException.UnknownObjectException: 404 {"message": "Not Found", "documentation_url": "https://docs.github.com/rest/repos/repos#get-a-repository", "status": "404"}
ipdb> LeanGitRepo("https://github.com/avigad/mathematics_in_lean_source", "5297e0fb051367c48c0a084411853a576389ecf5")
LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
ipdb> exit()
2024-09-08 16:41:30.989 | INFO     | __main__:main:1678 - An error occurred:
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1328, in main
    lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1328, in main
    lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
^Z
[38]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
^Z
[39]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:41:52,217] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:41:56.046 | INFO     | __main__:main:1179 - Running retrieval baseline
2024-09-08 16:41:56.046 | INFO     | __main__:main:1182 - Configuring LeanDojo...
2024-09-08 16:41:56.049 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:41:56.049 | INFO     | __main__:main:1184 - LeanDojo configured
2024-09-08 16:41:56.049 | INFO     | __main__:main:1189 - Starting the main process
2024-09-08 16:41:56.049 | INFO     | __main__:main:1197 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:42:10.452 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:42:10.452 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:42:15.911 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:42:15.911 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:42:16.144 | INFO     | __main__:main:1199 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:42:16.145 | INFO     | __main__:main:1206 - Found 15 repositories
2024-09-08 16:42:16.145 | INFO     | __main__:main:1297 - Starting without curriculum learning
2024-09-08 16:42:16.329 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:42:31.941 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:42:31.942 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:42:31.942 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:42:31.942 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:42:31.945 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:42:31.946 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:42:33.934 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:42:33.938 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:42:33.948 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:42:34.325 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 16:42:50.852 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 16:43:09.799 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 16:43:24.986 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:25.293 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:43:25.294 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:43:25.294 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:25.294 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:25.297 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:43:25.298 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:27.326 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:27.330 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:27.340 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:43:27.340 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
> /data/yingzi_ma/lean_project/ReProver/main.py(1328)main()
   1327                 import ipdb; ipdb.set_trace()
-> 1328                 lean_git_repos = [LeanGitRepo(repo['url'], repo['commit']) for repo in updated_repos]
   1329

ipdb> updated_repos
[{'url': 'https://github.com/avigad/mathematics_in_lean_source', 'commit': '5297e0fb051367c48c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}, {'url': 'https://github.com/avigad/mathematics_in_lean_source', 'commit': '5297e0fb051367c48c0a0844
11853a576389ecf5', 'version': 'v4.8.0-rc2'}]
ipdb>
[{'url': 'https://github.com/avigad/mathematics_in_lean_source', 'commit': '5297e0fb051367c48c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}, {'url': 'https://github.com/avigad/mathematics_in_lean_source', 'commit': '5297e0fb051367c48c0a0844
11853a576389ecf5', 'version': 'v4.8.0-rc2'}]
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1331)main()
   1330             # All processes wait for the file to be created and then read from it
-> 1331             max_attempts = 30
   1332             for attempt in range(max_attempts):

ipdb> lean_git_repos
[LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5'), LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf
5')]
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1332)main()
   1331             max_attempts = 30
-> 1332             for attempt in range(max_attempts):
   1333                 try:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1333)main()
   1332             for attempt in range(max_attempts):
-> 1333                 try:
   1334                     with open(repo_info_file, 'r') as f:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1334)main()
   1333                 try:
-> 1334                     with open(repo_info_file, 'r') as f:
   1335                         repo_info = json.load(f)

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1335)main()
   1334                     with open(repo_info_file, 'r') as f:
-> 1335                         repo_info = json.load(f)
   1336                     break

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1334)main()
   1333                 try:
-> 1334                     with open(repo_info_file, 'r') as f:
   1335                         repo_info = json.load(f)

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1336)main()
   1335                         repo_info = json.load(f)
-> 1336                     break
   1337                 except (json.JSONDecodeError, FileNotFoundError):

ipdb> repo_info
[{'url': 'https://github.com/avigad/mathematics_in_lean_source', 'commit': '5297e0fb051367c48c0a084411853a576389ecf5', 'version': 'v4.8.0-rc2'}, {'url': 'https://github.com/avigad/mathematics_in_lean_source', 'commit': '5297e0fb051367c48c0a0844
11853a576389ecf5', 'version': 'v4.8.0-rc2'}]
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1342)main()
   1341
-> 1342             lean_git_repos = [LeanGitRepo(info['url'].replace('.git', ''), info['commit']) for info in repo_info]
   1343

ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1344)main()
   1343
-> 1344             for i in range(num_repos):
   1345                 for lambda_value in lambdas:

ipdb> lean_git_repos
[LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5'), LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf
5')]
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1345)main()
   1344             for i in range(num_repos):
-> 1345                 for lambda_value in lambdas:
   1346                     logger.info(f"length of lean_git_repos: {len(lean_git_repos)}")

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1346)main()
   1345                 for lambda_value in lambdas:
-> 1346                     logger.info(f"length of lean_git_repos: {len(lean_git_repos)}")
   1347                     logger.info(f"i: {i}")

ipdb>
2024-09-08 16:44:02.231 | INFO     | __main__:main:1346 - length of lean_git_repos: 2
> /data/yingzi_ma/lean_project/ReProver/main.py(1347)main()
   1346                     logger.info(f"length of lean_git_repos: {len(lean_git_repos)}")
-> 1347                     logger.info(f"i: {i}")
   1348                     repo = lean_git_repos[i]

ipdb>
2024-09-08 16:44:03.011 | INFO     | __main__:main:1347 - i: 0
> /data/yingzi_ma/lean_project/ReProver/main.py(1348)main()
   1347                     logger.info(f"i: {i}")
-> 1348                     repo = lean_git_repos[i]
   1349                     sha = repo.commit

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1349)main()
   1348                     repo = lean_git_repos[i]
-> 1349                     sha = repo.commit
   1350                     dir_name = repo.url.split("/")[-1] + "_" + sha

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1350)main()
   1349                     sha = repo.commit
-> 1350                     dir_name = repo.url.split("/")[-1] + "_" + sha
   1351                     if is_main_process:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1351)main()
   1350                     dir_name = repo.url.split("/")[-1] + "_" + sha
-> 1351                     if is_main_process:
   1352                         logger.info("Main process")

ipdb> repo
LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
ipdb> sha
'5297e0fb051367c48c0a084411853a576389ecf5'
ipdb> dir_name
'mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5'
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(1352)main()
   1351                     if is_main_process:
-> 1352                         logger.info("Main process")
   1353                         logger.info(f"Using lambda = {lambda_value}")

ipdb>
2024-09-08 16:44:16.628 | INFO     | __main__:main:1352 - Main process
> /data/yingzi_ma/lean_project/ReProver/main.py(1353)main()
   1352                         logger.info("Main process")
-> 1353                         logger.info(f"Using lambda = {lambda_value}")
   1354                         logger.info(f"Processing {repo.url}")

ipdb>
2024-09-08 16:44:17.028 | INFO     | __main__:main:1353 - Using lambda = 0.0
> /data/yingzi_ma/lean_project/ReProver/main.py(1354)main()
   1353                         logger.info(f"Using lambda = {lambda_value}")
-> 1354                         logger.info(f"Processing {repo.url}")
   1355                         if start_with_pfr:

ipdb>
2024-09-08 16:44:17.531 | INFO     | __main__:main:1354 - Processing https://github.com/avigad/mathematics_in_lean_source
> /data/yingzi_ma/lean_project/ReProver/main.py(1355)main()
   1354                         logger.info(f"Processing {repo.url}")
-> 1355                         if start_with_pfr:
   1356                             if "pfr" not in repo.url:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1361)main()
   1360
-> 1361                         if single_repo:
   1362                             repos_for_merged_dataset = []

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1362)main()
   1361                         if single_repo:
-> 1362                             repos_for_merged_dataset = []
   1363

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1366)main()
   1365                         # TODO: ensure all returns are taken care of
-> 1366                         if not curriculum_learning:
   1367                             result = add_repo_to_database(dynamic_database_json_path, repo, db)

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(1367)main()
   1366                         if not curriculum_learning:
-> 1367                             result = add_repo_to_database(dynamic_database_json_path, repo, db)
   1368                             if result is None:

ipdb> n
2024-09-08 16:44:30.915 | INFO     | __main__:add_repo_to_database:888 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:31.264 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:44:31.265 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:44:31.266 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:31.266 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:31.271 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:44:31.274 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:33.210 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:33.216 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:33.226 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:33.229 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:33.229 | INFO     | __main__:add_repo_to_database:908 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:44:33.230 | INFO     | __main__:add_repo_to_database:909 - Lean version: v4.8.0-rc2
2024-09-08 16:44:33.230 | INFO     | __main__:add_repo_to_database:914 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 16:44:33.231 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 16:44:33.231 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-09-08 16:44:33.232 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-09-08 16:44:33.232 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-09-08 16:44:33.233 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.233 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.234 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.234 | INFO     | generate_benchmark_lean4:main:377 - Lean toolchain path 1 does not exist: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.235 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.235 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.236 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:44:33.274 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-09-08 16:44:33.274 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 16:44:33.275 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-09-08 16:44:33.293 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:44:33.294 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-09-08 16:44:33.295 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-09-08 16:44:33.299 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-08 16:44:33.299 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_i
n_lean_source
2024-09-08 16:44:35.340 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a57
6389ecf5/mathematics_in_lean_source with 31 workers
  0%|▊                                                                                                                                                                                                          | 12/3143 [00:12<1:17:52,  1.49s/it]
^Z
[40]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 16:45:09,534] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 16:45:13.333 | INFO     | __main__:main:1179 - Running retrieval baseline
2024-09-08 16:45:13.334 | INFO     | __main__:main:1182 - Configuring LeanDojo...
2024-09-08 16:45:13.336 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:45:13.336 | INFO     | __main__:main:1184 - LeanDojo configured
2024-09-08 16:45:13.336 | INFO     | __main__:main:1189 - Starting the main process
2024-09-08 16:45:13.337 | INFO     | __main__:main:1197 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:45:27.643 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:45:27.643 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:45:33.094 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:45:33.095 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:45:33.321 | INFO     | __main__:main:1199 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 16:45:33.321 | INFO     | __main__:main:1206 - Found 15 repositories
2024-09-08 16:45:33.322 | INFO     | __main__:main:1297 - Starting without curriculum learning
2024-09-08 16:45:33.745 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 16:45:48.930 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:45:48.930 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:45:48.931 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:45:48.931 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:45:48.934 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:45:48.935 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:45:50.902 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:45:50.907 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:45:50.917 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:45:50.976 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 16:46:06.292 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 16:46:21.983 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 16:46:36.987 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:37.272 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:46:37.272 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:46:37.272 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:37.272 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:37.275 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:46:37.276 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.391 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.395 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.405 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.405 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.407 | INFO     | __main__:main:1345 - length of lean_git_repos: 2
2024-09-08 16:46:39.407 | INFO     | __main__:main:1346 - i: 0
2024-09-08 16:46:39.407 | INFO     | __main__:main:1351 - Main process
2024-09-08 16:46:39.407 | INFO     | __main__:main:1352 - Using lambda = 0.0
2024-09-08 16:46:39.407 | INFO     | __main__:main:1353 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:46:39.407 | INFO     | __main__:add_repo_to_database:888 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.688 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 16:46:39.688 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 16:46:39.688 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.688 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:39.691 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 16:46:39.693 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:41.588 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:41.592 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:41.602 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:41.602 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:41.602 | INFO     | __main__:add_repo_to_database:908 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 16:46:41.602 | INFO     | __main__:add_repo_to_database:909 - Lean version: v4.8.0-rc2
2024-09-08 16:46:41.602 | INFO     | __main__:add_repo_to_database:914 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:377 - Lean toolchain path 1 does not exist: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.603 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 16:46:41.638 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-09-08 16:46:41.638 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 16:46:41.639 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-09-08 16:46:41.644 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 16:46:41.644 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-09-08 16:46:41.644 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-09-08 16:46:41.647 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-08 16:46:41.647 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_i
n_lean_source
2024-09-08 16:46:42.781 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a57
6389ecf5/mathematics_in_lean_source with 31 workers
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              77%|█████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             77%|███████████████████████████████████████████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████▎                             77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍
                             77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             77%|█████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                             77%|███████████████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████▉                             77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████                             77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
   77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            77%|███████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            78%|█████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████▍                            78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██▌                            78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                            78%|███████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            78%|█████████████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████                            78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████▏                           78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎
     78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           78%|█████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           78%|███████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████▉                           78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████                           78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          78%|█████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          79%|███████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████▍                          79%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████▌                          79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋
       79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                          79%|███████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          79%|█████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████                          79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
█████████                          79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                         79%|███████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                         79%|█████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████▌                         79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
█████████████████████████████████████▋                         79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊
         79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         79%|█████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         79%|███████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████▏                        79%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████▎                        80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        80%|█████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        80%|███████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████▌                        80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████▋                        80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊
           80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                        80%|███████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       80%|█████████████████████████████████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████▎                       80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████▍                       80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       80%|███████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       80%|█████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████▉                       80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████                       80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏
             80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                      80%|█████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      81%|███████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████▌                      81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████▋                      81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                      81%|█████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      81%|███████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████▏                     81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▎                     81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍
               81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     81%|███████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    82%|█████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████▍                    82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████▉                    82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   82%|███████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   82%|█████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████▌                  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉
                 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 83%|█████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 83%|███████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████▏                84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████▌                84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                84%|█████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               84%|███████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████▏              85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████▌              85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              85%|███████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             85%|█████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████▌             85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████             86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            86%|███
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            86%|█████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍           86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████▊           86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████▏          86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍          87%|█████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          87%|███████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████▊          87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████▎         87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         87%|█
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         87%|███████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████▏        87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████▍        87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        88%|███████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉        88%|█████████████████████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████▎       88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████▌       88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊       88%
|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       88%|█████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████▎      88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████▍      88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      89%|█████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      89%|███████████████████████████████████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████      89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▎     89%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     8
9%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     89%|███████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████▏    89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████▎    89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    90%|███████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    90%|█████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████▊    90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████▉    90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   90%|█████████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   90%|███████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████▌   90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
█████████████████████████▋   90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   90%|█████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  90%|███████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████▉  91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
█▏ 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ 91%|███████████████████████████████████████████████
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████▊ 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████ 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 91%|███████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 91%|█████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████ 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████ 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 92%|█████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 92%|███████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████ 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████ 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 92%|█████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 92%|███████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████ 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████ 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|███████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|█████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████ 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████ 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|███████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|█████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████ 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████ 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|█████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|███████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████ 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████ 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 93%|█████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|███████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████ 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████ 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|███████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|█████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████ 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████ 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|███████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|█████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████ 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████ 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 95%|█████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 95%|███████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████ 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████ 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 95%|█████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 95%|███████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████ 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████ 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 96%|███████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 96%|█████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████ 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████ 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 96%|███████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 96%|█████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████ 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████ 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 96%|█████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|███████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|█████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|███████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████ 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|███████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|███
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████ 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 97%|█████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%
|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████ 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 9
9%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████ 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████ 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|███████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|█████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|███████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████| 3143/3143 [07:22<00:00,  7.10it/s]
2024-09-08 16:54:05.768 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 16:54:07.088 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-08 16:54:23.486 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 16:54:39.311 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-08 16:54:54.578 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-08 16:54:55.693 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-08 16:54:58.897 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0-rc1
2024-09-08 16:55:13.940 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3fecb249afcf5ba40efe0a3f92f69e2460f142c7')
2024-09-08 16:55:15.040 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-08 16:55:45.624 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a
576389ecf5'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='e9e858a4484905a0bfe97c4f05c3924ead02eed8'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='8feac540ab
b781cb1349688c816dc02fae66b49c'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='2c8ae451ce9ffc83554322b14437159c1a9703f9'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='e291
aa4de57079b3d2199b9eb7b4b00922b85a7c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='eb08eee94098fe530ccd6d8751a86fe405473d4c'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli
', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3fecb249afcf5ba40efe0a3f92f69e2460f142c7'), 'importGraph': LeanGitRepo(url='https://github.com/leanpro
ver-community/import-graph', commit='fb7841a6f4fb389ec0e47dd4677844d49906af3c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathematics_in_lean_s
ource'))
2024-09-08 16:55:57.644 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-09-08 16:55:57.645 | WARNING  | generate_benchmark_lean4:safe_remove_dir:281 - /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already exists. Remov
ing it now.
2024-09-08 16:56:04.468 | INFO     | generate_benchmark_lean4:split_data:133 - 78886 theorems in total
2024-09-08 16:56:04.468 | INFO     | generate_benchmark_lean4:split_data:138 - 78886 theorems in total, with 1577 for validation and 1577 for testing
2024-09-08 16:56:04.469 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-09-08 16:56:04.492 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-09-08 16:56:10.319 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-09-08 16:56:24.850 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 126314 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/random/train.json
2024-09-08 16:56:25.307 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2921 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random/val.json
2024-09-08 16:56:25.599 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2555 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random/test.json
2024-09-08 16:56:39.187 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 123871 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/novel_premises/train.json
2024-09-08 16:56:39.717 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 3836 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/novel_premises/val.json
2024-09-08 16:56:40.128 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 4083 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/novel_premises/test.json
2024-09-08 16:56:40.129 | INFO     | generate_benchmark_lean4:export_proofs:206 - 157772 theorems saved in total
2024-09-08 16:56:40.132 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-09-08 16:56:57.430 | INFO     | generate_benchmark_lean4:export_premises:229 - 117699 theorems/definitions from 3143 files saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb0
51367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-08 16:56:57.444 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-09-08 16:56:57.445 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-09-08 16:56:57.445 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-09-08 16:56:57.504 | INFO     | __main__:add_repo_to_database:922 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 75732/75732 [00:01<00:00, 58645.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 58679.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 61712.59it/s]
2024-09-08 16:57:00.796 | INFO     | __main__:add_repo_to_database:947 - Before adding new repo:
2024-09-08 16:57:00.796 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-08 16:57:00.796 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:57:00.796 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:57:00.796 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:57:00.797 | INFO     | dynamic_database:add_repository:605 - Repository 'https://github.com/avigad/mathematics_in_lean_source' with commit '5297e0fb051367c48c0a084411853a576389ecf5' already exists in the database.
2024-09-08 16:57:00.797 | INFO     | __main__:add_repo_to_database:950 - After adding new repo:
2024-09-08 16:57:00.797 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-08 16:57:00.797 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 16:57:00.797 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:57:15.754 | INFO     | __main__:main:1375 - Adding repo to repos_for_merged_dataset
2024-09-08 16:57:15.755 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-08 16:57:15.755 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 16:58:16.140 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already
exists. Removing it now.
2024-09-08 16:58:28.056 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5
2024-09-08 16:58:28.431 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c4
8c0a084411853a576389ecf5
2024-09-08 16:58:28.440 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5
2024-09-08 16:58:28.442 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441
1853a576389ecf5
2024-09-08 16:58:28.455 | INFO     | __main__:main:1386 - All GPUs
2024-09-08 16:58:28.455 | INFO     | __main__:main:1615 - Starting the prover
2024-09-08 16:58:28.455 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 16:58:28.455 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 16:58:28.455 | INFO     | prover.proof_search:__init__:427 - Using RAG
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/mo
del_lightning.ckpt`
2024-09-08 16:58:29.121 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 16:58:29.122 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge_each_time_ewc/mathlib4_29d
cec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 16:58:30.601 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 16:58:31.130 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 16:58:31.131 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 16:58:31.131 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a
576389ecf5/corpus.jsonl
2024-09-08 16:58:31.131 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/corpu
s.jsonl
2024-09-08 16:58:38.498 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 16:58:38.498 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5
76389ecf5/corpus.jsonl
2024-09-08 16:58:38.498 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 16:58:41,441 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8266
(pid=1034992) [2024-09-08 16:59:20,750] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1034992) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=1034992)   return torch.load(io.BytesIO(b))
(pid=1035211) [2024-09-08 16:59:32,177] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1035211) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=1035211)   return torch.load(io.BytesIO(b))

