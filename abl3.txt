Testing dataset size: 4889
2024-09-23 14:17:09.369 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-23 14:17:15.497 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-23 14:17:15.526 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 14:17:18.225 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:17:18.226 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/2783 [00:00<?, ?it/s]2024
-09-23 14:17:18.317 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:17:18.329 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/2783 [00:00<02:49, 16.40it/s]2024
-09-23 14:17:18.368 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:17:18.369 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 14:17:19.231 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:17:19.232 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 2783/2783 [16:19<00:00,  2.84it/s]
100%|██████████████████████████████████████████████████████████████████████████| 2783/2783 [16:21<00:00,  2.83it/s]
100%|██████████████████████████████████████████████████████████████████████████| 2783/2783 [16:28<00:00,  2.82it/s]
100%|██████████████████████████████████████████████████████████████████████████| 2783/2783 [16:34<00:00,  2.80it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 20/20 [00:59<00:00,  0.34it/s]2024
-09-23 14:34:52.665 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:34:52.666 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:34:52.666 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:34:52.666 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:34:52.890 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 14:34:52.890 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:34:52.891 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 14:34:52.891 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:34:52.946 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 14:34:52.946 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:34:52.966 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 14:34:52.966 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:34:52.966 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 20/20 [00:59<00:00,  0.34it/s]
2024-09-23 14:34:53.829 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
2024-09-23 14:34:54.023 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
2024-09-23 14:34:54.063 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
[rank: 2] Seed set to 3407
2024-09-23 14:34:54.119 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random
2024-09-23 14:34:54.119 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-23 14:34:54.300 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random
2024-09-23 14:34:54.300 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 14:34:54.339 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random
2024-09-23 14:34:54.339 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5/corpus.jsonl
2024-09-23 14:34:55.132 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 14:34:55.206 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
100%|███████████████████████████████████████████████████████████████████████| 2427/2427 [00:00<00:00, 32311.29it/s]
2024-09-23 14:34:55.283 | INFO     | __main__:main:1737 - R@1 = 24.319021143361454 %, R@10 = 63.646689620031374 %, MRR
= 0.5364226493683534
2024-09-23 14:34:55.284 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 14:34:55.565 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random
2024-09-23 14:34:55.565 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-23 14:35:15.574 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-23 14:35:15.605 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
2024-09-23 14:35:17.694 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-23 14:35:17.716 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
2024-09-23 14:35:17.771 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-23 14:35:17.788 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
2024-09-23 14:35:17.952 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179343
2024-09-23 14:35:17.966 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2489
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 14:35:20.941 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:35:20.945 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/1840 [00:00<01:50, 16.60it/s]2024
-09-23 14:35:21.080 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:35:21.081 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/1840 [00:00<01:59, 15.38it/s]2024
-09-23 14:35:21.293 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:35:21.294 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                            | 7/1840 [00:01<05:39,  5.39it/s]2024
-09-23 14:35:22.198 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:35:22.198 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1840/1840 [09:47<00:00,  3.13it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1840/1840 [09:49<00:00,  3.12it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1840/1840 [09:53<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1840/1840 [09:57<00:00,  3.08it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:22<00:00,  0.45it/s]2024
-09-23 14:45:41.874 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:45:41.875 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:45:42.011 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 14:45:42.011 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:45:42.074 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 14:45:42.074 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:45:44.980 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:45:44.980 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:45:45.126 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 14:45:45.126 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:45:45.163 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 14:45:45.163 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:45:45.163 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:25<00:00,  0.39it/s]
2024-09-23 14:45:46.168 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
2024-09-23 14:45:46.295 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 14:45:46.318 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
[rank: 3] Seed set to 3407
2024-09-23 14:45:46.430 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1ba
f261445d/random
2024-09-23 14:45:46.430 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1
baf261445d/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 14:45:46.545 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1ba
f261445d/random
2024-09-23 14:45:46.545 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1
baf261445d/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-23 14:45:46.563 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1ba
f261445d/random
2024-09-23 14:45:46.563 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1
baf261445d/corpus.jsonl
2024-09-23 14:45:47.155 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 14:45:47.200 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
/test.json
100%|███████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 46057.23it/s]
2024-09-23 14:45:47.236 | INFO     | __main__:main:1737 - R@1 = 27.39068657577375 %, R@10 = 67.3794552444926 %, MRR = 0
.57368432605338
2024-09-23 14:45:47.237 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 14:45:47.436 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1ba
f261445d/random
2024-09-23 14:45:47.436 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1
baf261445d/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-23 14:46:01.779 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-23 14:46:01.811 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
2024-09-23 14:46:03.057 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-23 14:46:03.073 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
2024-09-23 14:46:03.932 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-23 14:46:03.945 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
2024-09-23 14:46:04.787 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166265
2024-09-23 14:46:04.810 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c103279
8a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2484
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 14:46:07.846 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:46:07.847 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1805 [00:00<?, ?it/s]2024
-09-23 14:46:07.939 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:46:07.939 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/1805 [00:00<01:54, 15.73it/s]2024
-09-23 14:46:08.106 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:46:08.107 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                            | 7/1805 [00:01<05:33,  5.38it/s]2024
-09-23 14:46:09.055 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:46:09.059 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1805/1805 [09:40<00:00,  3.11it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1805/1805 [09:41<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1805/1805 [09:44<00:00,  3.09it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1805/1805 [09:49<00:00,  3.06it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:20<00:00,  0.49it/s]2024
-09-23 14:56:19.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:56:19.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:56:19.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:56:19.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 14:56:19.492 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 14:56:19.492 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:56:19.496 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 14:56:19.496 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:56:19.498 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 14:56:19.498 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:56:19.501 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 14:56:19.501 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 14:56:19.502 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:20<00:00,  0.48it/s]
2024-09-23 14:56:20.500 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 14:56:20.637 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
[rank: 1] Seed set to 3407
2024-09-23 14:56:20.737 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916
ae24253d566/random
2024-09-23 14:56:20.738 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f99
16ae24253d566/corpus.jsonl
2024-09-23 14:56:20.742 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
[rank: 2] Seed set to 3407
2024-09-23 14:56:20.878 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916
ae24253d566/random
2024-09-23 14:56:20.878 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f99
16ae24253d566/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-23 14:56:20.968 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916
ae24253d566/random
2024-09-23 14:56:20.968 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f99
16ae24253d566/corpus.jsonl
2024-09-23 14:56:21.442 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 14:56:21.481 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/test.js
on
100%|███████████████████████████████████████████████████████████████████████| 1538/1538 [00:00<00:00, 50324.45it/s]
2024-09-23 14:56:21.512 | INFO     | __main__:main:1737 - R@1 = 28.482850696072397 %, R@10 = 69.07328867315819 %, MRR =
 0.5854836098703529
2024-09-23 14:56:21.513 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 14:56:21.705 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916
ae24253d566/random
2024-09-23 14:56:21.705 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f99
16ae24253d566/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-23 14:56:38.517 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 14:56:40.375 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 14:56:40.394 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
2024-09-23 14:56:40.431 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
2024-09-23 14:56:42.438 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 14:56:42.477 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
2024-09-23 14:56:58.299 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195152
2024-09-23 14:56:58.318 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd
7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 3036
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 14:57:01.235 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:57:01.235 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1809 [00:00<?, ?it/s]2024
-09-23 14:57:01.349 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:57:01.356 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/1809 [00:00<02:08, 14.07it/s]2024
-09-23 14:57:01.505 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:57:01.506 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 14:57:02.694 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 14:57:02.695 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1809/1809 [09:42<00:00,  3.11it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1809/1809 [09:43<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1809/1809 [09:47<00:00,  3.08it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1809/1809 [09:50<00:00,  3.06it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 12/12 [00:28<00:00,  0.42it/s]2024
-09-23 15:07:22.234 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:07:22.234 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:07:22.234 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:07:22.234 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:07:22.394 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 15:07:22.395 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:07:22.407 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 15:07:22.407 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:07:22.420 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 15:07:22.420 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:07:22.430 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 15:07:22.430 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:07:22.430 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 12/12 [00:28<00:00,  0.41it/s]
2024-09-23 15:07:23.708 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
2024-09-23 15:07:23.754 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
2024-09-23 15:07:23.784 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
[rank: 2] Seed set to 3407
2024-09-23 15:07:23.949 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/ra
ndom
2024-09-23 15:07:23.949 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/
corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 15:07:23.969 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/ra
ndom
2024-09-23 15:07:23.969 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/
corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-23 15:07:23.983 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/ra
ndom
2024-09-23 15:07:23.983 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/
corpus.jsonl
2024-09-23 15:07:24.262 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 15:07:24.313 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test
.json
100%|███████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 37001.41it/s]
2024-09-23 15:07:24.357 | INFO     | __main__:main:1737 - R@1 = 25.55741197577932 %, R@10 = 65.47794736442695 %, MRR =
0.551125103105645
2024-09-23 15:07:24.359 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 15:07:24.545 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/ra
ndom
2024-09-23 15:07:24.545 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-23 15:07:40.343 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-23 15:07:40.363 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
2024-09-23 15:07:42.273 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-23 15:07:42.298 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
2024-09-23 15:07:43.075 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-23 15:07:43.095 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
2024-09-23 15:07:43.334 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_train/cached_data.pkl
Training dataset size: 149016
2024-09-23 15:07:43.347 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e6
2655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2427
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-23 15:07:46.242 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:07:46.242 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/2027 [00:00<02:17, 14.68it/s]2024
-09-23 15:07:46.525 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:07:46.541 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/2027 [00:00<?, ?it/s]2024
-09-23 15:07:46.613 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:07:46.614 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 15:07:47.493 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:07:47.493 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 2027/2027 [09:18<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████| 2027/2027 [09:20<00:00,  3.62it/s]
100%|██████████████████████████████████████████████████████████████████████████| 2027/2027 [09:23<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████| 2027/2027 [09:27<00:00,  3.57it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:24<00:00,  0.41it/s]2024
-09-23 15:17:39.237 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:17:39.238 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:17:39.238 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:17:39.238 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:17:39.330 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 15:17:39.331 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:17:39.332 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 15:17:39.332 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:17:39.369 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 15:17:39.369 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:17:39.380 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 15:17:39.380 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:17:39.381 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:24<00:00,  0.41it/s]
2024-09-23 15:17:40.303 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
2024-09-23 15:17:40.455 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 15:17:40.457 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
[rank: 3] Seed set to 3407
2024-09-23 15:17:40.581 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/ran
dom
2024-09-23 15:17:40.581 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/c
orpus.jsonl
[rank: 2] Seed set to 3407
2024-09-23 15:17:40.697 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/ran
dom
2024-09-23 15:17:40.697 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/c
orpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 15:17:40.705 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/ran
dom
2024-09-23 15:17:40.705 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/c
orpus.jsonl
2024-09-23 15:17:41.211 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 15:17:41.249 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/test.json
100%|███████████████████████████████████████████████████████████████████████| 1444/1444 [00:00<00:00, 36664.52it/s]
2024-09-23 15:17:41.289 | INFO     | __main__:main:1737 - R@1 = 28.137522236000073 %, R@10 = 70.04050605576971 %, MRR =
 0.5972864121407856
2024-09-23 15:17:41.291 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 15:17:41.563 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/ran
dom
2024-09-23 15:17:41.563 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/c
orpus.jsonl
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-23 15:17:48.485 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-23 15:17:48.494 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_pred/cached_data.pkl
Testing dataset size: 853
2024-09-23 15:17:49.982 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-23 15:17:49.991 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_pred/cached_data.pkl
Testing dataset size: 853
2024-09-23 15:17:51.582 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-23 15:17:51.584 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_train/cached_data.pkl
Training dataset size: 50868
2024-09-23 15:17:51.588 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_pred/cached_data.pkl
Testing dataset size: 853
2024-09-23 15:17:51.589 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06
fa3856/random/cache_pred/cached_data.pkl
Testing dataset size: 853
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:17:54.635 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:17:54.636 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1003 [00:00<?, ?it/s]2024
-09-23 15:17:54.680 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:17:54.681 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1003 [00:00<?, ?it/s]2024
-09-23 15:17:54.742 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:17:54.743 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 15:17:55.655 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:17:55.655 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1003/1003 [04:53<00:00,  3.42it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1003/1003 [04:54<00:00,  3.41it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1003/1003 [04:56<00:00,  3.39it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1003/1003 [04:58<00:00,  3.36it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████| 4/4 [00:04<00:00,  0.80it/s]2024
-09-23 15:22:58.913 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:22:58.914 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:22:58.914 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:22:58.914 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:22:58.964 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 15:22:58.964 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:22:58.965 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 15:22:58.965 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:22:58.966 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 15:22:58.966 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:22:58.968 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 15:22:58.968 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:22:58.969 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████| 4/4 [00:05<00:00,  0.79it/s]
2024-09-23 15:23:00.068 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
2024-09-23 15:23:00.246 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 15:23:00.286 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
[rank: 2] Seed set to 3407
2024-09-23 15:23:00.336 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
/random
2024-09-23 15:23:00.336 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c
21/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 15:23:00.476 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
/random
2024-09-23 15:23:00.476 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c
21/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-23 15:23:00.487 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
/random
2024-09-23 15:23:00.487 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c
21/corpus.jsonl
2024-09-23 15:23:00.665 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 15:23:00.682 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/test.json
100%|█████████████████████████████████████████████████████████████████████████| 589/589 [00:00<00:00, 55394.87it/s]
2024-09-23 15:23:00.693 | INFO     | __main__:main:1737 - R@1 = 31.190426119375225 %, R@10 = 71.41535146574803 %, MRR =
 0.6066150167974133
2024-09-23 15:23:00.694 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 15:23:00.881 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
/random
2024-09-23 15:23:00.881 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c
21/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-23 15:23:05.171 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-23 15:23:05.174 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-23 15:23:05.177 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
2024-09-23 15:23:05.332 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-23 15:23:05.336 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
2024-09-23 15:23:05.350 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_train/cached_data.pkl
Training dataset size: 40678
2024-09-23 15:23:05.355 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
2024-09-23 15:23:06.091 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b
6621490c21/random/cache_pred/cached_data.pkl
Testing dataset size: 661
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:23:08.570 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:23:08.570 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                      | 0/906 [00:00<?, ?it/s]2024
-09-23 15:23:08.635 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:23:08.648 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                             | 2/906 [00:00<00:55, 16.16it/s]2024
-09-23 15:23:08.699 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:23:08.700 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 15:23:10.055 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:23:10.055 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████| 906/906 [04:36<00:00,  3.27it/s]
100%|████████████████████████████████████████████████████████████████████████████| 906/906 [04:37<00:00,  3.27it/s]
100%|████████████████████████████████████████████████████████████████████████████| 906/906 [04:38<00:00,  3.25it/s]
100%|████████████████████████████████████████████████████████████████████████████| 906/906 [04:41<00:00,  3.22it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████| 3/3 [00:04<00:00,  0.71it/s]2024
-09-23 15:27:55.452 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:27:55.453 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:27:55.453 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:27:55.453 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:27:55.496 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 15:27:55.496 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:27:55.499 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 15:27:55.499 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:27:55.500 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 15:27:55.501 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:27:55.502 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 15:27:55.503 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:27:55.503 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████| 3/3 [00:04<00:00,  0.71it/s]
2024-09-23 15:27:56.798 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
2024-09-23 15:27:56.829 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
2024-09-23 15:27:56.853 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
[rank: 2] Seed set to 3407
2024-09-23 15:27:57.001 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/ran
dom
2024-09-23 15:27:57.001 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/c
orpus.jsonl
[rank: 3] Seed set to 3407
2024-09-23 15:27:57.036 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/ran
dom
2024-09-23 15:27:57.036 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/c
orpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 15:27:57.061 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/ran
dom
2024-09-23 15:27:57.061 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/c
orpus.jsonl
2024-09-23 15:27:57.101 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 15:27:57.112 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/test.json
100%|█████████████████████████████████████████████████████████████████████████| 500/500 [00:00<00:00, 56334.17it/s]
2024-09-23 15:27:57.121 | INFO     | __main__:main:1737 - R@1 = 29.24234485970427 %, R@10 = 67.38822913028292 %, MRR =
0.584587641118783
2024-09-23 15:27:57.123 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 15:27:57.309 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/ran
dom
2024-09-23 15:27:57.309 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/c
orpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-23 15:28:08.951 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-23 15:28:08.980 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-23 15:28:09.775 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-23 15:28:09.786 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-23 15:28:10.597 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-23 15:28:10.610 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-23 15:28:10.658 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136697
2024-09-23 15:28:10.675 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29
a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:28:13.734 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:28:13.735 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1620 [00:00<?, ?it/s]2024
-09-23 15:28:13.750 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:28:13.750 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/1620 [00:00<02:29, 10.82it/s]2024
-09-23 15:28:14.025 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:28:14.026 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 15:28:14.906 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:28:14.907 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1620/1620 [08:31<00:00,  3.17it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1620/1620 [08:33<00:00,  3.16it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1620/1620 [08:35<00:00,  3.14it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1620/1620 [08:39<00:00,  3.12it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████| 8/8 [00:16<00:00,  0.48it/s]2024
-09-23 15:37:10.745 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:37:10.746 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:37:10.746 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:37:10.746 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:37:10.858 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 15:37:10.858 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:37:10.860 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 15:37:10.860 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:37:10.861 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 15:37:10.861 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:37:10.868 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 15:37:10.868 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:37:10.868 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████| 8/8 [00:16<00:00,  0.48it/s]
2024-09-23 15:37:11.835 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
2024-09-23 15:37:11.990 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 15:37:12.093 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
[rank: 2] Seed set to 3407
2024-09-23 15:37:12.110 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-23 15:37:12.110 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corp
us.jsonl
[rank: 1] Seed set to 3407
2024-09-23 15:37:12.217 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-23 15:37:12.217 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corp
us.jsonl
[rank: 3] Seed set to 3407
2024-09-23 15:37:12.308 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-23 15:37:12.308 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corp
us.jsonl
2024-09-23 15:37:12.722 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 15:37:12.754 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/random/test.json
100%|███████████████████████████████████████████████████████████████████████| 1376/1376 [00:00<00:00, 54510.58it/s]
2024-09-23 15:37:12.780 | INFO     | __main__:main:1737 - R@1 = 29.309267995710954 %, R@10 = 70.03317010746586 %, MRR =
 0.5950983479539789
2024-09-23 15:37:12.781 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 15:37:13.049 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-09-23 15:37:13.049 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corp
us.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-23 15:37:37.969 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-23 15:37:37.990 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-23 15:37:41.141 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-23 15:37:41.157 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-23 15:37:41.374 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-23 15:37:41.386 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-23 15:37:41.392 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-23 15:37:41.405 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2
147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:37:43.997 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:37:43.997 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1795 [00:00<?, ?it/s]2024
-09-23 15:37:44.069 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:37:44.070 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                     | 0/1795 [00:00<?, ?it/s]2024
-09-23 15:37:44.149 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:37:44.150 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 15:37:45.028 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:37:45.029 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1795/1795 [09:38<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1795/1795 [09:39<00:00,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1795/1795 [09:44<00:00,  3.07it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1795/1795 [09:47<00:00,  3.06it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:19<00:00,  0.52it/s]2024
-09-23 15:47:51.415 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:47:51.415 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:47:51.415 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:47:51.415 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 15:47:51.548 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 15:47:51.548 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:47:51.551 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 15:47:51.551 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:47:51.552 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 15:47:51.552 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:47:51.567 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 15:47:51.568 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 15:47:51.568 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████| 10/10 [00:19<00:00,  0.51it/s]
2024-09-23 15:47:52.560 | INFO     | __main__:main:1854 - Finished processing the repository
2024-09-23 15:47:52.561 | INFO     | __main__:main:1856 - current epoch: 10
2024-09-23 15:47:52.561 | INFO     | __main__:main:1517 - length of lean_git_repos: 6
2024-09-23 15:47:52.561 | INFO     | __main__:main:1518 - i: 3
2024-09-23 15:47:52.561 | INFO     | __main__:main:1546 - All GPUs
2024-09-23 15:47:52.564 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a
1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:52.564 | INFO     | __main__:main:1553 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0
.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:52.564 | INFO     | __main__:main:1559 - Inside train_test_fisher
2024-09-23 15:47:52.564 | INFO     | __main__:main:1560 - Starting training at epoch 10
[rank: 1] Seed set to 3407
2024-09-23 15:47:52.602 | INFO     | __main__:main:1854 - Finished processing the repository
2024-09-23 15:47:52.603 | INFO     | __main__:main:1856 - current epoch: 10
2024-09-23 15:47:52.603 | INFO     | __main__:main:1517 - length of lean_git_repos: 6
2024-09-23 15:47:52.603 | INFO     | __main__:main:1518 - i: 3
2024-09-23 15:47:52.603 | INFO     | __main__:main:1546 - All GPUs
2024-09-23 15:47:52.605 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a
1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:52.605 | INFO     | __main__:main:1553 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0
.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:52.605 | INFO     | __main__:main:1559 - Inside train_test_fisher
2024-09-23 15:47:52.605 | INFO     | __main__:main:1560 - Starting training at epoch 10
[rank: 2] Seed set to 3407
2024-09-23 15:47:52.696 | INFO     | __main__:main:1854 - Finished processing the repository
2024-09-23 15:47:52.698 | INFO     | __main__:main:1856 - current epoch: 10
2024-09-23 15:47:52.699 | INFO     | __main__:main:1517 - length of lean_git_repos: 6
2024-09-23 15:47:52.699 | INFO     | __main__:main:1518 - i: 3
2024-09-23 15:47:52.699 | INFO     | __main__:main:1546 - All GPUs
2024-09-23 15:47:52.702 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a
1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:52.702 | INFO     | __main__:main:1553 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0
.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:52.702 | INFO     | __main__:main:1559 - Inside train_test_fisher
2024-09-23 15:47:52.702 | INFO     | __main__:main:1560 - Starting training at epoch 10
[rank: 3] Seed set to 3407
2024-09-23 15:47:53.903 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 15:47:53.945 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
100%|███████████████████████████████████████████████████████████████████████| 1501/1501 [00:00<00:00, 42155.36it/s]
2024-09-23 15:47:53.982 | INFO     | __main__:main:1737 - R@1 = 26.860825989102178 %, R@10 = 68.8948583949698 %, MRR =
0.5748120404902689
2024-09-23 15:47:53.983 | INFO     | __main__:main:1756 - Average R@1 = 27.947092216519422 %, R@10 = 68.3673460062769 %
, MRR = 0.5807622144669946
2024-09-23 15:47:53.984 | INFO     | __main__:main:1854 - Finished processing the repository
2024-09-23 15:47:53.984 | INFO     | __main__:main:1856 - current epoch: 10
2024-09-23 15:47:53.984 | INFO     | __main__:main:1517 - length of lean_git_repos: 6
2024-09-23 15:47:53.984 | INFO     | __main__:main:1518 - i: 3
2024-09-23 15:47:53.984 | INFO     | __main__:main:1524 - Main process
2024-09-23 15:47:53.984 | INFO     | __main__:main:1525 - Using lambda = 0.1
2024-09-23 15:47:53.984 | INFO     | __main__:main:1526 - Processing https://github.com/siddhartha-gadgil/Saturn
2024-09-23 15:47:53.984 | INFO     | __main__:main:1533 - Adding repo to repos_for_merged_dataset
2024-09-23 15:47:53.986 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in th
e database:
2024-09-23 15:47:53.986 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/siddhartha-g
adgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-09-23 15:47:54.750 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_
PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a already exists. R
emoving it now.
2024-09-23 15:47:55.988 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/
lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4
a42a
2024-09-23 15:47:56.134 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data
/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896
720c28d2ec4a42a
2024-09-23 15:47:56.141 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/ying
zi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c2
8d2ec4a42a
2024-09-23 15:47:56.142 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a
2024-09-23 15:47:56.145 | INFO     | __main__:main:1546 - All GPUs
2024-09-23 15:47:56.148 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a
1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:56.148 | INFO     | __main__:main:1553 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0
.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:47:56.148 | INFO     | __main__:main:1559 - Inside train_test_fisher
2024-09-23 15:47:56.148 | INFO     | __main__:main:1560 - Starting training at epoch 10
[rank: 0] Seed set to 3407
2024-09-23 15:48:02.932 | INFO     | __main__:main:1584 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambd
a_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:48:02.937 | INFO     | __main__:main:1584 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambd
a_0.1_epoch=9-Recall@10_val=68.42.ckpt
Using bfloat16 Automatic Mixed Precision (AMP)
2024-09-23 15:48:02.963 | INFO     | __main__:main:1584 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambd
a_0.1_epoch=9-Recall@10_val=68.42.ckpt
2024-09-23 15:48:02.964 | INFO     | __main__:main:1584 - Loaded premise retriever at /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambd
a_0.1_epoch=9-Recall@10_val=68.42.ckpt
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-23 15:48:03.036 | INFO     | __main__:main:1642 - right before barrier for data module
2024-09-23 15:48:03.036 | INFO     | __main__:main:1642 - right before barrier for data module
2024-09-23 15:48:03.036 | INFO     | __main__:main:1642 - right before barrier for data module
2024-09-23 15:48:03.036 | INFO     | __main__:main:1642 - right before barrier for data module
2024-09-23 15:48:03.037 | INFO     | __main__:main:1657 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-23 15:48:03.037 | INFO     | __main__:main:1657 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-23 15:48:03.037 | INFO     | __main__:main:1657 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-09-23 15:48:03.037 | INFO     | __main__:main:1657 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_re
po_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
100%|█████████████████████████████████████████████████████████████████████| 10544/10544 [00:00<00:00, 11076.11it/s]
2024-09-23 15:48:05.699 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/ying
zi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c2
8d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
100%|█████████████████████████████████████████████████████████████████████████| 219/219 [00:00<00:00, 13803.27it/s]
2024-09-23 15:48:05.722 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/ying
zi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c2
8d2ec4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
100%|█████████████████████████████████████████████████████████████████████████| 219/219 [00:00<00:00, 11598.47it/s]
2024-09-23 15:48:05.749 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/ying
zi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c2
8d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-23 15:48:05.749 | INFO     | __main__:main:1671 - Training dataset size after load: 15149
2024-09-23 15:48:05.749 | INFO     | __main__:main:1672 - Validation dataset size after load: 200
2024-09-23 15:48:05.750 | INFO     | __main__:main:1673 - Testing dataset size after load: 298
2024-09-23 15:48:05.750 | INFO     | __main__:main:1675 - Starting progressive training from epoch 10 to 11
2024-09-23 15:48:05.750 | INFO     | __main__:main:1678 - hit the barrier before training
  0%|                                                                                    | 0/10544 [00:00<?, ?it/s]2024
-09-23 15:48:07.462 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/le
an_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a4
2a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-23 15:48:07.463 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:07.465 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-23 15:48:07.465 | INFO     | __main__:main:1671 - Training dataset size after load: 15149
2024-09-23 15:48:07.466 | INFO     | __main__:main:1672 - Validation dataset size after load: 200
2024-09-23 15:48:07.466 | INFO     | __main__:main:1673 - Testing dataset size after load: 298
2024-09-23 15:48:07.466 | INFO     | __main__:main:1675 - Starting progressive training from epoch 10 to 11
2024-09-23 15:48:07.466 | INFO     | __main__:main:1678 - hit the barrier before training
100%|█████████████████████████████████████████████████████████████████████| 10544/10544 [00:00<00:00, 12307.63it/s]
2024-09-23 15:48:08.126 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/ying
zi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c2
8d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-23 15:48:08.128 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:08.130 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-23 15:48:08.130 | INFO     | __main__:main:1671 - Training dataset size after load: 15149
2024-09-23 15:48:08.130 | INFO     | __main__:main:1672 - Validation dataset size after load: 200
2024-09-23 15:48:08.130 | INFO     | __main__:main:1673 - Testing dataset size after load: 298
2024-09-23 15:48:08.130 | INFO     | __main__:main:1675 - Starting progressive training from epoch 10 to 11
2024-09-23 15:48:08.130 | INFO     | __main__:main:1678 - hit the barrier before training
100%|█████████████████████████████████████████████████████████████████████| 10544/10544 [00:00<00:00, 12636.93it/s]
2024-09-23 15:48:08.312 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/ying
zi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c2
8d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-23 15:48:08.314 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:08.315 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-23 15:48:08.315 | INFO     | __main__:main:1671 - Training dataset size after load: 15149
2024-09-23 15:48:08.316 | INFO     | __main__:main:1672 - Validation dataset size after load: 200
2024-09-23 15:48:08.316 | INFO     | __main__:main:1673 - Testing dataset size after load: 298
2024-09-23 15:48:08.316 | INFO     | __main__:main:1675 - Starting progressive training from epoch 10 to 11
2024-09-23 15:48:08.316 | INFO     | __main__:main:1678 - hit the barrier before training
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 0] Seed set to 3407
2024-09-23 15:48:08.365 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_train/cached_data.pkl
2024-09-23 15:48:08.365 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_train/cached_data.pkl
2024-09-23 15:48:08.372 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
Training dataset size: 15149
2024-09-23 15:48:08.376 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:08.376 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:08.378 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-23 15:48:08.378 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
Training dataset size: 15149
2024-09-23 15:48:08.381 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:08.383 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
2024-09-23 15:48:08.740 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_train/cached_data.pkl
Training dataset size: 15149
2024-09-23 15:48:08.749 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_val/cached_data.pkl
Validation dataset size: 200
2024-09-23 15:48:08.751 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2e
c4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 298
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-23 15:48:09.857 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-09-23 15:48:09.858 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-09-23 15:48:09.858 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-09-23 15:48:09.858 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_ab
l3/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21_lambda_0.1_epoch=9-Recall@10_val=68.42.ckpt
Epoch 10: 100%|█████████████████████████████████████████████████████████| 947/947 [05:10<00:00,  3.05it/s, v_num=7]2024
-09-23 15:53:23.046 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                      | 0/540 [00:00<?, ?it/s]2024
-09-23 15:53:23.136 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  1%|▌                                                                             | 4/540 [00:00<00:48, 11.04it/s]2024
-09-23 15:53:23.426 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  1%|█                                                                             | 7/540 [00:01<01:31,  5.84it/s2024-
09-23 15:53:24.174 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████| 540/540 [01:49<00:00,  4.94it/s]
2024-09-23 15:55:12.362 | INFO     | retrieval.model:validation_step:316 - Inside validation_step
2024-09-23 15:55:12.379 | INFO     | retrieval.model:validation_step:320 - Embeddings staled validation step: False
100%|████████████████████████████████████████████████████████████████████████████| 540/540 [01:49<00:00,  4.94it/s]
                                                                                                                  2024-
09-23 15:55:12.758 | INFO     | retrieval.model:validation_step:316 - Inside validation_step8<00:02,  4.10it/s]
2024-09-23 15:55:12.772 | INFO     | retrieval.model:validation_step:320 - Embeddings staled validation step: False
100%|████████████████████████████████████████████████████████████████████████████| 540/540 [01:50<00:00,  4.90it/s]
2024-09-23 15:55:13.222 | INFO     | retrieval.model:validation_step:316 - Inside validation_step
2024-09-23 15:55:13.236 | INFO     | retrieval.model:validation_step:320 - Embeddings staled validation step: False
                                                                                                                  2024-
09-23 15:55:13.282 | INFO     | retrieval.model:validation_step:370 - Recall@1_val: 29.629629629629626
2024-09-23 15:55:13.284 | INFO     | retrieval.model:validation_step:370 - Recall@2_val: 49.074074074074076.09it/s]
2024-09-23 15:55:13.285 | INFO     | retrieval.model:validation_step:370 - Recall@3_val: 53.395061728395056
2024-09-23 15:55:13.286 | INFO     | retrieval.model:validation_step:370 - Recall@4_val: 63.271604938271594
2024-09-23 15:55:13.287 | INFO     | retrieval.model:validation_step:370 - Recall@5_val: 70.06172839506172
2024-09-23 15:55:13.288 | INFO     | retrieval.model:validation_step:370 - Recall@6_val: 76.23456790123456
2024-09-23 15:55:13.289 | INFO     | retrieval.model:validation_step:370 - Recall@7_val: 76.23456790123456
2024-09-23 15:55:13.290 | INFO     | retrieval.model:validation_step:370 - Recall@8_val: 78.08641975308642
2024-09-23 15:55:13.291 | INFO     | retrieval.model:validation_step:370 - Recall@9_val: 79.93827160493827
2024-09-23 15:55:13.292 | INFO     | retrieval.model:validation_step:370 - Recall@10_val: 79.93827160493827
2024-09-23 15:55:13.293 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 83.9506172839506
2024-09-23 15:55:13.294 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 83.9506172839506
2024-09-23 15:55:13.295 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 83.9506172839506
2024-09-23 15:55:13.296 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 89.50617283950616
2024-09-23 15:55:13.298 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 91.66666666666666
2024-09-23 15:55:13.299 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 92.90123456790123
2024-09-23 15:55:13.300 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 92.90123456790123
2024-09-23 15:55:13.301 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 92.90123456790123
2024-09-23 15:55:13.302 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 94.1358024691358
2024-09-23 15:55:13.303 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 94.1358024691358
2024-09-23 15:55:13.304 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 94.1358024691358
2024-09-23 15:55:13.305 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 94.1358024691358
2024-09-23 15:55:13.306 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 94.1358024691358
2024-09-23 15:55:13.307 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 94.1358024691358
2024-09-23 15:55:13.308 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 94.1358024691358
2024-09-23 15:55:13.309 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 94.1358024691358
2024-09-23 15:55:13.310 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 94.1358024691358
2024-09-23 15:55:13.311 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 94.1358024691358
2024-09-23 15:55:13.312 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 94.1358024691358
2024-09-23 15:55:13.314 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 94.1358024691358
2024-09-23 15:55:13.315 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 94.1358024691358
2024-09-23 15:55:13.316 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 94.1358024691358
2024-09-23 15:55:13.317 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 94.1358024691358
2024-09-23 15:55:13.318 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 94.1358024691358
2024-09-23 15:55:13.319 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 94.1358024691358
2024-09-23 15:55:13.320 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 95.06172839506172
2024-09-23 15:55:13.321 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 95.06172839506172
2024-09-23 15:55:13.322 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 95.06172839506172
2024-09-23 15:55:13.323 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 95.06172839506172
2024-09-23 15:55:13.324 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 95.06172839506172
2024-09-23 15:55:13.326 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 95.06172839506172
2024-09-23 15:55:13.327 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 95.06172839506172
2024-09-23 15:55:13.329 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 95.06172839506172
2024-09-23 15:55:13.330 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 95.06172839506172
2024-09-23 15:55:13.332 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 95.06172839506172
2024-09-23 15:55:13.333 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 95.06172839506172
2024-09-23 15:55:13.334 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 95.06172839506172
2024-09-23 15:55:13.336 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 95.06172839506172
2024-09-23 15:55:13.337 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 96.29629629629629
2024-09-23 15:55:13.338 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 96.29629629629629
2024-09-23 15:55:13.340 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 96.29629629629629
2024-09-23 15:55:13.341 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 96.29629629629629

                                                                                                                  2024-
09-23 15:55:13.343 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 96.296296296296299
2024-09-23 15:55:13.345 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 96.29629629629629.94it/s]
2024-09-23 15:55:13.346 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 96.29629629629629
2024-09-23 15:55:13.347 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 96.29629629629629
2024-09-23 15:55:13.348 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 96.29629629629629
2024-09-23 15:55:13.349 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 96.29629629629629
2024-09-23 15:55:13.350 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 96.29629629629629
2024-09-23 15:55:13.352 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 96.29629629629629
2024-09-23 15:55:13.353 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 96.29629629629629
2024-09-23 15:55:13.354 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 96.29629629629629
2024-09-23 15:55:13.355 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 96.29629629629629
2024-09-23 15:55:13.356 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 96.29629629629629
2024-09-23 15:55:13.358 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 96.29629629629629
2024-09-23 15:55:13.359 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 96.29629629629629
2024-09-23 15:55:13.360 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 96.29629629629629
2024-09-23 15:55:13.361 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 96.29629629629629
2024-09-23 15:55:13.362 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 96.29629629629629
2024-09-23 15:55:13.363 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 96.29629629629629
2024-09-23 15:55:13.365 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 96.29629629629629
2024-09-23 15:55:13.366 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 96.29629629629629
2024-09-23 15:55:13.367 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 96.29629629629629
2024-09-23 15:55:13.368 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 96.29629629629629
2024-09-23 15:55:13.369 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 96.29629629629629
2024-09-23 15:55:13.370 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 96.29629629629629
2024-09-23 15:55:13.371 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 96.29629629629629
2024-09-23 15:55:13.372 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 96.29629629629629
2024-09-23 15:55:13.373 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 96.29629629629629
2024-09-23 15:55:13.374 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 96.29629629629629
2024-09-23 15:55:13.375 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 96.29629629629629
2024-09-23 15:55:13.377 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 96.29629629629629
2024-09-23 15:55:13.378 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 96.29629629629629
2024-09-23 15:55:13.379 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 96.29629629629629
2024-09-23 15:55:13.380 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 96.29629629629629
2024-09-23 15:55:13.381 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 96.29629629629629
2024-09-23 15:55:13.382 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 96.29629629629629
2024-09-23 15:55:13.383 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 96.29629629629629
2024-09-23 15:55:13.384 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 96.29629629629629
2024-09-23 15:55:13.385 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 96.29629629629629
2024-09-23 15:55:13.386 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 96.29629629629629
2024-09-23 15:55:13.387 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 96.29629629629629
2024-09-23 15:55:13.388 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 96.29629629629629
2024-09-23 15:55:13.389 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 96.29629629629629
2024-09-23 15:55:13.390 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 96.29629629629629
2024-09-23 15:55:13.391 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 96.29629629629629
2024-09-23 15:55:13.392 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 96.29629629629629
2024-09-23 15:55:13.393 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 96.29629629629629
2024-09-23 15:55:13.394 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 96.29629629629629
2024-09-23 15:55:13.395 | INFO     | retrieval.model:validation_step:379 - MRR: 0.6538520121853456
2024-09-23 15:55:13.397 | INFO     | retrieval.model:validation_step:387 - End of validation_step
2024-09-23 15:55:13.418 | INFO     | retrieval.model:validation_step:370 - Recall@1_val: 31.290322580645157
2024-09-23 15:55:13.420 | INFO     | retrieval.model:validation_step:370 - Recall@2_val: 43.11827956989248
2024-09-23 15:55:13.421 | INFO     | retrieval.model:validation_step:370 - Recall@3_val: 51.962365591397855
2024-09-23 15:55:13.421 | INFO     | retrieval.model:validation_step:370 - Recall@4_val: 61.63978494623657
2024-09-23 15:55:13.422 | INFO     | retrieval.model:validation_step:370 - Recall@5_val: 65.61827956989247
2024-09-23 15:55:13.423 | INFO     | retrieval.model:validation_step:370 - Recall@6_val: 67.60752688172042
2024-09-23 15:55:13.424 | INFO     | retrieval.model:validation_step:370 - Recall@7_val: 68.65591397849462
2024-09-23 15:55:13.425 | INFO     | retrieval.model:validation_step:370 - Recall@8_val: 71.02150537634408
2024-09-23 15:55:13.426 | INFO     | retrieval.model:validation_step:370 - Recall@9_val: 73.2795698924731
2024-09-23 15:55:13.426 | INFO     | retrieval.model:validation_step:370 - Recall@10_val: 74.46236559139786
2024-09-23 15:55:13.427 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 77.68817204301075
2024-09-23 15:55:13.428 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 77.68817204301075
2024-09-23 15:55:13.429 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 77.68817204301075
2024-09-23 15:55:13.429 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 79.3010752688172
2024-09-23 15:55:13.430 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 79.70430107526882
2024-09-23 15:55:13.431 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 80.88709677419355
2024-09-23 15:55:13.432 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 83.41397849462366
2024-09-23 15:55:13.433 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 85.02688172043011
2024-09-23 15:55:13.434 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 85.56451612903226
2024-09-23 15:55:13.434 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 85.56451612903226
2024-09-23 15:55:13.435 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 85.56451612903226
2024-09-23 15:55:13.436 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 85.56451612903226
2024-09-23 15:55:13.437 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 85.56451612903226
2024-09-23 15:55:13.438 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 86.20967741935485
2024-09-23 15:55:13.438 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 86.20967741935485
2024-09-23 15:55:13.439 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 87.8225806451613
2024-09-23 15:55:13.440 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 87.8225806451613
2024-09-23 15:55:13.441 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 87.8225806451613
2024-09-23 15:55:13.442 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 88.22580645161291
2024-09-23 15:55:13.443 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 88.22580645161291
2024-09-23 15:55:13.443 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 89.2741935483871
2024-09-23 15:55:13.444 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 89.2741935483871
2024-09-23 15:55:13.445 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 89.2741935483871
2024-09-23 15:55:13.446 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 89.2741935483871
2024-09-23 15:55:13.447 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 89.2741935483871
2024-09-23 15:55:13.447 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 89.2741935483871
2024-09-23 15:55:13.448 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 89.2741935483871
2024-09-23 15:55:13.449 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 89.67741935483872
2024-09-23 15:55:13.450 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 89.67741935483872
2024-09-23 15:55:13.450 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 89.67741935483872
2024-09-23 15:55:13.451 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 89.67741935483872
2024-09-23 15:55:13.452 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 90.32258064516128
2024-09-23 15:55:13.453 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 90.32258064516128
2024-09-23 15:55:13.454 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 93.54838709677419
2024-09-23 15:55:13.455 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 93.54838709677419
2024-09-23 15:55:13.455 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 93.54838709677419
2024-09-23 15:55:13.456 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 93.54838709677419
2024-09-23 15:55:13.457 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 93.54838709677419
2024-09-23 15:55:13.458 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 95.16129032258065
2024-09-23 15:55:13.458 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 95.16129032258065
2024-09-23 15:55:13.459 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 95.16129032258065
2024-09-23 15:55:13.460 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 95.16129032258065
2024-09-23 15:55:13.461 | INFO     | retrieval.model:validation_step:370 - Recall@53_val: 95.16129032258065
2024-09-23 15:55:13.462 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 95.16129032258065
2024-09-23 15:55:13.462 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 95.16129032258065
2024-09-23 15:55:13.463 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 95.16129032258065
2024-09-23 15:55:13.464 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 95.16129032258065
2024-09-23 15:55:13.465 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 95.16129032258065
2024-09-23 15:55:13.466 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 95.16129032258065
2024-09-23 15:55:13.466 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 95.16129032258065
2024-09-23 15:55:13.467 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 95.96774193548387
2024-09-23 15:55:13.468 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 95.96774193548387
2024-09-23 15:55:13.469 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 95.96774193548387
2024-09-23 15:55:13.470 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 95.96774193548387
2024-09-23 15:55:13.470 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 95.96774193548387
2024-09-23 15:55:13.471 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 95.96774193548387
2024-09-23 15:55:13.472 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 95.96774193548387
2024-09-23 15:55:13.473 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 95.96774193548387
2024-09-23 15:55:13.474 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 95.96774193548387
2024-09-23 15:55:13.475 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 95.96774193548387
2024-09-23 15:55:13.475 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 95.96774193548387
2024-09-23 15:55:13.476 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 95.96774193548387
2024-09-23 15:55:13.477 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 95.96774193548387
2024-09-23 15:55:13.478 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 95.96774193548387
2024-09-23 15:55:13.479 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 95.96774193548387
2024-09-23 15:55:13.479 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 95.96774193548387
2024-09-23 15:55:13.480 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 95.96774193548387
2024-09-23 15:55:13.481 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 95.96774193548387
2024-09-23 15:55:13.482 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 95.96774193548387
2024-09-23 15:55:13.483 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 95.96774193548387
2024-09-23 15:55:13.483 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 96.37096774193549
2024-09-23 15:55:13.484 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 96.37096774193549
2024-09-23 15:55:13.485 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 96.37096774193549
2024-09-23 15:55:13.486 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 96.37096774193549
2024-09-23 15:55:13.487 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 96.37096774193549
2024-09-23 15:55:13.487 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 96.37096774193549
2024-09-23 15:55:13.488 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 96.37096774193549
2024-09-23 15:55:13.489 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 96.37096774193549
2024-09-23 15:55:13.490 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 96.37096774193549
2024-09-23 15:55:13.491 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 96.37096774193549
2024-09-23 15:55:13.491 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 96.37096774193549
2024-09-23 15:55:13.492 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 96.37096774193549
2024-09-23 15:55:13.493 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 96.37096774193549
2024-09-23 15:55:13.494 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 96.37096774193549
2024-09-23 15:55:13.495 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 96.37096774193549
2024-09-23 15:55:13.495 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 96.37096774193549
2024-09-23 15:55:13.496 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 96.37096774193549
2024-09-23 15:55:13.497 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 96.37096774193549
2024-09-23 15:55:13.498 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 96.37096774193549
2024-09-23 15:55:13.499 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 96.37096774193549
2024-09-23 15:55:13.500 | INFO     | retrieval.model:validation_step:379 - MRR: 0.571228413163897
2024-09-23 15:55:13.500 | INFO     | retrieval.model:validation_step:387 - End of validation_step
                                                                                                                  2024-
09-23 15:55:13.875 | INFO     | retrieval.model:validation_step:370 - Recall@1_val: 44.642857142857146
2024-09-23 15:55:13.876 | INFO     | retrieval.model:validation_step:370 - Recall@2_val: 53.781512605042025.31it/s]
2024-09-23 15:55:13.877 | INFO     | retrieval.model:validation_step:370 - Recall@3_val: 62.32492997198881
2024-09-23 15:55:13.878 | INFO     | retrieval.model:validation_step:370 - Recall@4_val: 67.29691876750701
2024-09-23 15:55:13.879 | INFO     | retrieval.model:validation_step:370 - Recall@5_val: 68.4873949579832
2024-09-23 15:55:13.880 | INFO     | retrieval.model:validation_step:370 - Recall@6_val: 68.69747899159664
2024-09-23 15:55:13.881 | INFO     | retrieval.model:validation_step:370 - Recall@7_val: 69.88795518207283
2024-09-23 15:55:13.882 | INFO     | retrieval.model:validation_step:370 - Recall@8_val: 69.88795518207283
2024-09-23 15:55:13.882 | INFO     | retrieval.model:validation_step:370 - Recall@9_val: 73.45938375350141
2024-09-23 15:55:13.883 | INFO     | retrieval.model:validation_step:370 - Recall@10_val: 74.64985994397757
2024-09-23 15:55:13.884 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 74.64985994397757
2024-09-23 15:55:13.885 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 82.00280112044818
2024-09-23 15:55:13.886 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 82.21288515406162
2024-09-23 15:55:13.886 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 85.7843137254902
2024-09-23 15:55:13.887 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 85.99439775910363
2024-09-23 15:55:13.888 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 86.20448179271708
2024-09-23 15:55:13.889 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 86.41456582633053
2024-09-23 15:55:13.890 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 88.20028011204482
2024-09-23 15:55:13.891 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 88.20028011204482
2024-09-23 15:55:13.891 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 88.41036414565826
2024-09-23 15:55:13.892 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 88.41036414565826
2024-09-23 15:55:13.893 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 88.41036414565826
2024-09-23 15:55:13.894 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 88.41036414565826
2024-09-23 15:55:13.895 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 88.41036414565826
2024-09-23 15:55:13.895 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 88.41036414565826
2024-09-23 15:55:13.896 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 88.41036414565826
2024-09-23 15:55:13.897 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 88.41036414565826
2024-09-23 15:55:13.898 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 88.6204481792717
2024-09-23 15:55:13.899 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 92.19187675070027
2024-09-23 15:55:13.900 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 92.40196078431373
2024-09-23 15:55:13.900 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 92.61204481792717
2024-09-23 15:55:13.901 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 92.61204481792717
2024-09-23 15:55:13.902 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 94.39775910364145
2024-09-23 15:55:13.903 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 94.39775910364145
2024-09-23 15:55:13.904 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 94.39775910364145
2024-09-23 15:55:13.904 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 97.96918767507002
2024-09-23 15:55:13.905 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 97.96918767507002
2024-09-23 15:55:13.906 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 97.96918767507002
2024-09-23 15:55:13.907 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 97.96918767507002
2024-09-23 15:55:13.908 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 98.17927170868347
2024-09-23 15:55:13.908 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 98.17927170868347
2024-09-23 15:55:13.909 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 98.17927170868347
2024-09-23 15:55:13.910 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 98.17927170868347
2024-09-23 15:55:13.911 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 98.17927170868347
2024-09-23 15:55:13.912 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 98.17927170868347
2024-09-23 15:55:13.913 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 98.17927170868347
2024-09-23 15:55:13.913 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 98.17927170868347
2024-09-23 15:55:13.914 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 98.17927170868347
2024-09-23 15:55:13.915 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 98.17927170868347
2024-09-23 15:55:13.916 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 98.17927170868347
2024-09-23 15:55:13.917 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 98.17927170868347
2024-09-23 15:55:13.917 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 98.17927170868347
2024-09-23 15:55:13.918 | INFO     | retrieval.model:validation_step:370 - Recall@53_val: 98.17927170868347
2024-09-23 15:55:13.919 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 98.17927170868347
2024-09-23 15:55:13.920 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 98.17927170868347
2024-09-23 15:55:13.921 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 98.17927170868347
2024-09-23 15:55:13.921 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 98.17927170868347
2024-09-23 15:55:13.922 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 98.17927170868347
2024-09-23 15:55:13.923 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 98.17927170868347
2024-09-23 15:55:13.924 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 98.17927170868347
2024-09-23 15:55:13.925 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 98.17927170868347
2024-09-23 15:55:13.925 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 98.17927170868347
2024-09-23 15:55:13.926 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 98.17927170868347
2024-09-23 15:55:13.927 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 98.17927170868347
2024-09-23 15:55:13.928 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 98.17927170868347
2024-09-23 15:55:13.929 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 98.17927170868347
2024-09-23 15:55:13.929 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 98.17927170868347
2024-09-23 15:55:13.930 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 98.17927170868347
2024-09-23 15:55:13.931 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 98.17927170868347
2024-09-23 15:55:13.932 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 98.17927170868347
                                                                                                                  2024-
09-23 15:55:13.933 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 98.17927170868347
2024-09-23 15:55:13.933 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 98.17927170868347.94it/s]
2024-09-23 15:55:13.934 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 98.17927170868347
2024-09-23 15:55:13.935 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 98.17927170868347
2024-09-23 15:55:13.936 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 98.17927170868347
2024-09-23 15:55:13.937 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 98.17927170868347
2024-09-23 15:55:13.937 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 98.17927170868347
2024-09-23 15:55:13.938 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 98.17927170868347
2024-09-23 15:55:13.939 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 98.17927170868347
2024-09-23 15:55:13.940 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 98.17927170868347
2024-09-23 15:55:13.941 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 98.38935574229691
2024-09-23 15:55:13.941 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 98.38935574229691
2024-09-23 15:55:13.942 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 98.38935574229691
2024-09-23 15:55:13.943 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 98.38935574229691
2024-09-23 15:55:13.944 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 98.38935574229691
2024-09-23 15:55:13.945 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 98.38935574229691
2024-09-23 15:55:13.945 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 98.38935574229691
2024-09-23 15:55:13.946 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 98.38935574229691
2024-09-23 15:55:13.947 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 98.38935574229691
2024-09-23 15:55:13.948 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 98.38935574229691
2024-09-23 15:55:13.949 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 98.38935574229691
2024-09-23 15:55:13.949 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 98.38935574229691
2024-09-23 15:55:13.950 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 98.38935574229691
2024-09-23 15:55:13.951 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 98.59943977591037
2024-09-23 15:55:13.952 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 98.59943977591037
2024-09-23 15:55:13.953 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 98.59943977591037
2024-09-23 15:55:13.953 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 98.59943977591037
2024-09-23 15:55:13.954 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 98.59943977591037
2024-09-23 15:55:13.955 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 98.59943977591037
2024-09-23 15:55:13.956 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 98.59943977591037
2024-09-23 15:55:13.957 | INFO     | retrieval.model:validation_step:379 - MRR: 0.6962428649620768
2024-09-23 15:55:13.957 | INFO     | retrieval.model:validation_step:387 - End of validation_step
100%|████████████████████████████████████████████████████████████████████████████| 540/540 [01:50<00:00,  4.89it/s]
                                                                                                                  2024-
09-23 15:55:14.679 | INFO     | retrieval.model:validation_step:316 - Inside validation_step/1 [00:00<?, ?it/s]
2024-09-23 15:55:14.698 | INFO     | retrieval.model:validation_step:320 - Embeddings staled validation step: False
2024-09-23 15:55:15.531 | INFO     | retrieval.model:validation_step:370 - Recall@1_val: 30.22222222222222
2024-09-23 15:55:15.534 | INFO     | retrieval.model:validation_step:370 - Recall@2_val: 51.700854700854705
2024-09-23 15:55:15.535 | INFO     | retrieval.model:validation_step:370 - Recall@3_val: 57.53418803418804
2024-09-23 15:55:15.536 | INFO     | retrieval.model:validation_step:370 - Recall@4_val: 61.123931623931625
2024-09-23 15:55:15.537 | INFO     | retrieval.model:validation_step:370 - Recall@5_val: 65.7905982905983
2024-09-23 15:55:15.539 | INFO     | retrieval.model:validation_step:370 - Recall@6_val: 70.2136752136752
2024-09-23 15:55:15.540 | INFO     | retrieval.model:validation_step:370 - Recall@7_val: 71.04700854700855
2024-09-23 15:55:15.541 | INFO     | retrieval.model:validation_step:370 - Recall@8_val: 71.04700854700855
2024-09-23 15:55:15.542 | INFO     | retrieval.model:validation_step:370 - Recall@9_val: 71.04700854700855
2024-09-23 15:55:15.543 | INFO     | retrieval.model:validation_step:370 - Recall@10_val: 73.82478632478633
2024-09-23 15:55:15.544 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 74.08119658119658
2024-09-23 15:55:15.545 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 76.02564102564102
2024-09-23 15:55:15.546 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 76.02564102564102
2024-09-23 15:55:15.548 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 77.11538461538461
2024-09-23 15:55:15.549 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 77.11538461538461
2024-09-23 15:55:15.550 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 79.03846153846153
2024-09-23 15:55:15.551 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 79.2948717948718
2024-09-23 15:55:15.552 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 80.12820512820514
2024-09-23 15:55:15.553 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 80.96153846153847
2024-09-23 15:55:15.554 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 80.96153846153847
2024-09-23 15:55:15.556 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 81.2179487179487
2024-09-23 15:55:15.557 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 81.47435897435898
2024-09-23 15:55:15.558 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 82.14102564102565
2024-09-23 15:55:15.559 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 83.8076923076923
2024-09-23 15:55:15.560 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 84.06410256410255
2024-09-23 15:55:15.561 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 84.06410256410255
2024-09-23 15:55:15.562 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 84.8974358974359
2024-09-23 15:55:15.563 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 84.8974358974359
2024-09-23 15:55:15.565 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 84.8974358974359
2024-09-23 15:55:15.566 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 84.8974358974359
2024-09-23 15:55:15.567 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 84.8974358974359
2024-09-23 15:55:15.568 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 84.8974358974359
2024-09-23 15:55:15.569 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 84.8974358974359
2024-09-23 15:55:15.570 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 84.8974358974359
2024-09-23 15:55:15.571 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 84.8974358974359
2024-09-23 15:55:15.572 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 84.8974358974359
2024-09-23 15:55:15.574 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 84.8974358974359
2024-09-23 15:55:15.575 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 84.8974358974359
2024-09-23 15:55:15.576 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 88.23076923076924
2024-09-23 15:55:15.577 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 88.23076923076924
2024-09-23 15:55:15.578 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 88.23076923076924
2024-09-23 15:55:15.579 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 88.23076923076924
2024-09-23 15:55:15.580 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 88.48717948717949
2024-09-23 15:55:15.581 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 89.32051282051282
2024-09-23 15:55:15.583 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 89.32051282051282
2024-09-23 15:55:15.584 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 89.32051282051282
2024-09-23 15:55:15.585 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 89.32051282051282
2024-09-23 15:55:15.586 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 89.32051282051282
2024-09-23 15:55:15.587 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 89.32051282051282
2024-09-23 15:55:15.588 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 89.32051282051282
2024-09-23 15:55:15.589 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 89.32051282051282
2024-09-23 15:55:15.590 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 89.32051282051282
2024-09-23 15:55:15.591 | INFO     | retrieval.model:validation_step:370 - Recall@53_val: 89.32051282051282
2024-09-23 15:55:15.593 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 89.32051282051282
2024-09-23 15:55:15.594 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 89.98717948717947
2024-09-23 15:55:15.595 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 91.65384615384615
2024-09-23 15:55:15.596 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 91.65384615384615
2024-09-23 15:55:15.597 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 91.65384615384615
2024-09-23 15:55:15.598 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 91.65384615384615
2024-09-23 15:55:15.599 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 91.65384615384615
2024-09-23 15:55:15.600 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 91.65384615384615
2024-09-23 15:55:15.601 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 91.65384615384615
2024-09-23 15:55:15.603 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 91.65384615384615
2024-09-23 15:55:15.604 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 91.65384615384615
2024-09-23 15:55:15.605 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 91.91025641025642
2024-09-23 15:55:15.606 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 91.91025641025642
2024-09-23 15:55:15.607 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 91.91025641025642
2024-09-23 15:55:15.608 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 91.91025641025642
2024-09-23 15:55:15.609 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 91.91025641025642
2024-09-23 15:55:15.610 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 91.91025641025642
2024-09-23 15:55:15.612 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 91.91025641025642
2024-09-23 15:55:15.613 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 91.91025641025642
2024-09-23 15:55:15.614 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 91.91025641025642
2024-09-23 15:55:15.615 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 91.91025641025642
2024-09-23 15:55:15.616 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 91.91025641025642
2024-09-23 15:55:15.617 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 91.91025641025642
2024-09-23 15:55:15.618 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 91.91025641025642
2024-09-23 15:55:15.619 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 91.91025641025642
2024-09-23 15:55:15.620 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 91.91025641025642
2024-09-23 15:55:15.622 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 91.91025641025642
2024-09-23 15:55:15.623 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 91.91025641025642
2024-09-23 15:55:15.624 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 91.91025641025642
2024-09-23 15:55:15.625 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 91.91025641025642
2024-09-23 15:55:15.626 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 93.57692307692308
2024-09-23 15:55:15.627 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 93.57692307692308
2024-09-23 15:55:15.628 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 93.57692307692308
2024-09-23 15:55:15.630 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 93.57692307692308
2024-09-23 15:55:15.631 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 94.24358974358974
2024-09-23 15:55:15.632 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 94.24358974358974
2024-09-23 15:55:15.633 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 94.24358974358974
2024-09-23 15:55:15.634 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 94.24358974358974
2024-09-23 15:55:15.635 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 94.24358974358974
2024-09-23 15:55:15.636 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 94.24358974358974
2024-09-23 15:55:15.637 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 94.24358974358974
2024-09-23 15:55:15.638 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 94.24358974358974
2024-09-23 15:55:15.640 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 94.24358974358974
2024-09-23 15:55:15.641 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 94.24358974358974
2024-09-23 15:55:15.642 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 94.24358974358974
2024-09-23 15:55:15.643 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 94.24358974358974
2024-09-23 15:55:15.644 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 94.5
2024-09-23 15:55:15.645 | INFO     | retrieval.model:validation_step:379 - MRR: 0.6608943833943833
2024-09-23 15:55:15.646 | INFO     | retrieval.model:validation_step:387 - End of validation_step
Epoch 10: 100%|█████████████████████████████████████████████████████████| 947/947 [07:03<00:00,  2.24it/s, v_num=7][ran
k: 1] Metric Recall@10_val improved by 4.083 >= min_delta = 0.0. New best score: 75.617
[rank: 2] Metric Recall@10_val improved by 4.083 >= min_delta = 0.0. New best score: 75.617
[rank: 0] Metric Recall@10_val improved by 4.083 >= min_delta = 0.0. New best score: 75.617
[rank: 3] Metric Recall@10_val improved by 4.083 >= min_delta = 0.0. New best score: 75.617
Epoch 10, global step 24773: 'Recall@10_val' reached 75.61729 (best 75.61729), saving model to '/data/yingzi_ma/lean_pr
oject/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt' as top 11
`Trainer.fit` stopped: `max_epochs=11` reached.
Epoch 10: 100%|█████████████████████████████████████████████████████████| 947/947 [07:09<00:00,  2.21it/s, v_num=7]
2024-09-23 15:55:24.558 | INFO     | __main__:main:1681 - hit the barrier after training
2024-09-23 15:55:24.875 | INFO     | __main__:main:1681 - hit the barrier after training
2024-09-23 15:55:24.914 | INFO     | __main__:main:1681 - hit the barrier after training
2024-09-23 15:55:24.980 | INFO     | __main__:main:1681 - hit the barrier after training
2024-09-23 15:55:24.980 | INFO     | __main__:main:1687 - Finished progressive training at epoch 11
2024-09-23 15:55:24.980 | INFO     | __main__:main:1687 - Finished progressive training at epoch 11
2024-09-23 15:55:24.980 | INFO     | __main__:main:1687 - Finished progressive training at epoch 11
2024-09-23 15:55:24.980 | INFO     | __main__:main:1687 - Finished progressive training at epoch 11
2024-09-23 15:55:24.981 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d
2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d
2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d
2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:find_latest_checkpoint:705 - Using the latest checkpoint: /data/yingzi_ma
/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d
2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:main:1694 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_e
poch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:main:1694 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_e
poch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:main:1694 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_e
poch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:24.981 | INFO     | __main__:main:1694 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpo
ints_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_e
poch=10-Recall@10_val=75.62.ckpt
2024-09-23 15:55:27.079 | INFO     | __main__:main:1704 - Testing...
2024-09-23 15:55:27.081 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
2024-09-23 15:55:27.171 | INFO     | __main__:main:1704 - Testing...
2024-09-23 15:55:27.172 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 15:55:27.188 | INFO     | __main__:main:1704 - Testing...
2024-09-23 15:55:27.189 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 3] Seed set to 3407
2024-09-23 15:55:27.278 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e78
82f564669f/random
2024-09-23 15:55:27.279 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e
7882f564669f/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 15:55:27.356 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e78
82f564669f/random
2024-09-23 15:55:27.356 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e
7882f564669f/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-23 15:55:27.379 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e78
82f564669f/random
2024-09-23 15:55:27.379 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e
7882f564669f/corpus.jsonl
2024-09-23 15:55:27.407 | INFO     | __main__:main:1704 - Testing...
2024-09-23 15:55:27.407 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
[rank: 2] Seed set to 3407
2024-09-23 15:55:27.593 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e78
82f564669f/random
2024-09-23 15:55:27.593 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e
7882f564669f/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-23 15:55:38.081 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-23 15:55:38.097 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-23 15:55:40.005 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-23 15:55:40.017 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-23 15:55:41.263 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-23 15:55:41.280 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
2024-09-23 15:55:41.338 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134390
2024-09-23 15:55:41.355 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9
c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 2011
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-23 15:55:44.500 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:55:44.501 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                             | 2/1599 [00:00<01:33, 17.03it/s]2024
-09-23 15:55:44.809 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:55:44.810 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                            | 4/1599 [00:00<02:26, 10.92it/s]2024
-09-23 15:55:44.913 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:55:44.914 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                | 0/? [00:00<?, ?it/s]2024
-09-23 15:55:45.663 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 15:55:45.663 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|██████████████████████████████████████████████████████████████████████████| 1599/1599 [08:27<00:00,  3.15it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1599/1599 [08:28<00:00,  3.14it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1599/1599 [08:31<00:00,  3.12it/s]
100%|██████████████████████████████████████████████████████████████████████████| 1599/1599 [08:35<00:00,  3.10it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:18<00:00,  0.43it/s]
2024-09-23 16:04:39.437 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 16:04:39.438 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 16:04:39.438 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 16:04:39.438 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-09-23 16:04:39.546 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_3.pkl
2024-09-23 16:04:39.546 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 16:04:39.548 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_1.pkl
2024-09-23 16:04:39.549 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 16:04:39.572 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_2.pkl
2024-09-23 16:04:39.572 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 16:04:39.574 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pic
kle_0.pkl
2024-09-23 16:04:39.574 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-09-23 16:04:39.575 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictio
ns and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████| 8/8 [00:18<00:00,  0.43it/s]
2024-09-23 16:04:40.546 | INFO     | retrieval.main:run_cli:60 - PID: 3682900
2024-09-23 16:04:40.581 | INFO     | retrieval.main:run_cli:60 - PID: 3682899
2024-09-23 16:04:40.598 | INFO     | retrieval.main:run_cli:60 - PID: 3682901
[rank: 2] Seed set to 3407
2024-09-23 16:04:40.803 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/
random
2024-09-23 16:04:40.804 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f09
1/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-23 16:04:40.816 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/
random
2024-09-23 16:04:40.816 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f09
1/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-23 16:04:40.827 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/
random
2024-09-23 16:04:40.827 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f09
1/corpus.jsonl
2024-09-23 16:04:41.466 | INFO     | __main__:main:1732 - Loaded the predictions pickle files
2024-09-23 16:04:41.500 | INFO     | __main__:main:1735 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single
_repo_no_ewc_curriculum_abl3/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.
json
100%|███████████████████████████████████████████████████████████████████████████| 1351/1351 [00:00<00:00, 52836.51it/s]
2024-09-23 16:04:41.526 | INFO     | __main__:main:1737 - R@1 = 30.078682853884466 %, R@10 = 70.48904657170786 %, MRR =
 0.6152965607322461
2024-09-23 16:04:41.528 | INFO     | retrieval.main:run_cli:60 - PID: 3679715
[rank: 0] Seed set to 3407
2024-09-23 16:04:41.779 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/
random
2024-09-23 16:04:41.780 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_p
roject/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f09
1/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-23 16:05:17.100 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-23 16:05:17.161 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-23 16:05:24.079 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-23 16:05:24.109 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-23 16:05:25.392 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-23 16:05:25.418 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
2024-09-23 16:05:29.168 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 361595
2024-09-23 16:05:29.207 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_m
a/lean_project/datasets_PT_single_repo_no_ewc_curriculum_abl3/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723
c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 4889
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_
abl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_a
bl3/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=10-Recall@10_val=75.62.ckpt
2024-09-23 16:05:32.447 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 16:05:32.448 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                         | 0/2783 [00:00<?, ?it/s]
2024-09-23 16:05:32.506 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 16:05:32.506 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                 | 2/2783 [00:00<02:55, 15.85it/s]
2024-09-23 16:05:32.784 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 16:05:32.785 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                    | 0/? [00:00<?, ?it/s]
2024-09-23 16:05:33.704 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-09-23 16:05:33.705 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  1%|▌                                                                               | 19/2783 [00:02<04:53,  9.41it/s]
  0%|▎                                                                               | 12/2783 [00:02<08:23,  5.51it/s]
