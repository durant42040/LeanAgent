rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_810522.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776337.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776344.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776103.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776220.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_812059.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776203.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776259.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776346.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776133.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_812819.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_810523.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776194.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776294.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776174.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_789537.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776157.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776177.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776250.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776137.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776187.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776280.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_807080.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_808157.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776129.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776098.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776164.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776131.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776301.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776218.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776299.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_810649.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776254.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776118.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776324.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776130.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776229.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776149.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_808276.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776252.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_811820.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776338.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776285.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776246.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776158.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776160.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776343.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776134.log': Permission denied
rm: cannot remove '/tmp/ray/session_2024-08-18_01-27-30_002267_774883/logs/events/event_CORE_WORKER_776296.log': Permission denied
Stopping ray
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=457290, name='python3')
Did not find any active Ray processes.
Running main.py
[2024-09-13 17:10:31,762] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-13 17:10:35.600 | INFO     | __main__:main:1197 - Running progressive training
2024-09-13 17:10:35.600 | INFO     | __main__:main:1203 - Configuring LeanDojo...
2024-09-13 17:10:35.603 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-13 17:10:35.603 | INFO     | __main__:main:1205 - LeanDojo configured
2024-09-13 17:10:35.603 | INFO     | __main__:main:1210 - Starting the main process
2024-09-13 17:10:35.604 | INFO     | __main__:main:1218 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc.json
2024-09-13 17:10:56.224 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-13 17:10:56.224 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-13 17:11:00.153 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-13 17:11:00.154 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-13 17:11:00.443 | INFO     | __main__:main:1220 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc.json
2024-09-13 17:11:00.444 | INFO     | __main__:main:1227 - Found 15 repositories
2024-09-13 17:11:00.444 | INFO     | __main__:main:1318 - Starting without curriculum learning
2024-09-13 17:11:00.834 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-13 17:11:16.674 | INFO     | __main__:main:1347 - Finding compatible repositories...
2024-09-13 17:11:16.676 | INFO     | __main__:main:1350 - Finished finding compatible repositories
2024-09-13 17:11:16.676 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:11:16.676 | INFO     | __main__:main:1369 - i: 0
2024-09-13 17:11:16.676 | INFO     | __main__:main:1375 - Main process
2024-09-13 17:11:16.676 | INFO     | __main__:main:1376 - Using lambda = 0.1
2024-09-13 17:11:16.676 | INFO     | __main__:main:1377 - Processing https://github.com/lecopivo/SciLean
2024-09-13 17:11:16.677 | INFO     | __main__:main:1398 - Adding repo to repos_for_merged_dataset
2024-09-13 17:11:16.677 | INFO     | __main__:main:1409 - All GPUs
2024-09-13 17:11:16.677 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb
9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:16.677 | INFO     | __main__:main:1416 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda
_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:16.677 | INFO     | __main__:main:1422 - Inside train_test_fisher
2024-09-13 17:11:16.677 | INFO     | __main__:main:1423 - Starting training at epoch 1
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-13 17:11:18.673 | INFO     | __main__:main:1447 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lam
bda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:18.674 | INFO     | __main__:find_latest_fisher:527 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da
6eb9c916e62655744_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-13 17:11:19.020 | INFO     | __main__:load_fisher_information:503 - Fisher Information successfully loaded.
2024-09-13 17:11:19.020 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-13 17:11:19.021 | INFO     | __main__:main:1454 - Fisher Information Matrix loaded.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-13 17:11:19.136 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-13 17:11:19.136 | INFO     | __main__:main:1522 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-13 17:11:19.232 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.j
sonl
2024-09-13 17:11:28.270 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:11:28.282 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
2024-09-13 17:11:28.295 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-13 17:11:28.295 | INFO     | __main__:main:1536 - Training dataset size after load: 149228
2024-09-13 17:11:28.295 | INFO     | __main__:main:1537 - Validation dataset size after load: 2087
2024-09-13 17:11:28.295 | INFO     | __main__:main:1538 - Testing dataset size after load: 2298
2024-09-13 17:11:28.295 | INFO     | __main__:main:1540 - Starting progressive training from epoch 1 to 2
2024-09-13 17:11:28.295 | INFO     | __main__:main:1543 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-13 17:11:33,943] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-13 17:11:33,944] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-13 17:11:33,944] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-13 17:11:37.990 | INFO     | __main__:main:1197 - Running progressive training
2024-09-13 17:11:37.990 | INFO     | __main__:main:1197 - Running progressive training
2024-09-13 17:11:37.990 | INFO     | __main__:main:1197 - Running progressive training
2024-09-13 17:11:37.990 | INFO     | __main__:main:1203 - Configuring LeanDojo...
2024-09-13 17:11:37.990 | INFO     | __main__:main:1203 - Configuring LeanDojo...
2024-09-13 17:11:37.990 | INFO     | __main__:main:1203 - Configuring LeanDojo...
2024-09-13 17:11:37.993 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-13 17:11:37.993 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-13 17:11:37.993 | INFO     | __main__:main:1205 - LeanDojo configured
2024-09-13 17:11:37.993 | INFO     | __main__:main:1205 - LeanDojo configured
2024-09-13 17:11:37.993 | INFO     | __main__:main:1227 - Found 15 repositories
2024-09-13 17:11:37.993 | INFO     | __main__:main:1227 - Found 15 repositories
2024-09-13 17:11:37.993 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-13 17:11:37.993 | INFO     | __main__:main:1318 - Starting without curriculum learning
2024-09-13 17:11:37.993 | INFO     | __main__:main:1318 - Starting without curriculum learning
2024-09-13 17:11:37.993 | INFO     | __main__:main:1205 - LeanDojo configured
2024-09-13 17:11:37.994 | INFO     | __main__:main:1227 - Found 15 repositories
2024-09-13 17:11:37.994 | INFO     | __main__:main:1318 - Starting without curriculum learning
2024-09-13 17:11:38.196 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-13 17:11:38.206 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-13 17:11:38.392 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-13 17:11:54.421 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:11:54.421 | INFO     | __main__:main:1369 - i: 0
2024-09-13 17:11:54.421 | INFO     | __main__:main:1409 - All GPUs
2024-09-13 17:11:54.422 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb
9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:54.422 | INFO     | __main__:main:1416 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda
_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:54.422 | INFO     | __main__:main:1422 - Inside train_test_fisher
2024-09-13 17:11:54.422 | INFO     | __main__:main:1423 - Starting training at epoch 1
[rank: 1] Seed set to 3407
2024-09-13 17:11:54.522 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:11:54.522 | INFO     | __main__:main:1369 - i: 0
2024-09-13 17:11:54.522 | INFO     | __main__:main:1409 - All GPUs
2024-09-13 17:11:54.523 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb
9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:54.523 | INFO     | __main__:main:1416 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda
_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:54.523 | INFO     | __main__:main:1422 - Inside train_test_fisher
2024-09-13 17:11:54.523 | INFO     | __main__:main:1423 - Starting training at epoch 1
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-13 17:11:54.952 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:11:54.953 | INFO     | __main__:main:1369 - i: 0
2024-09-13 17:11:54.953 | INFO     | __main__:main:1409 - All GPUs
2024-09-13 17:11:54.953 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb
9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:54.954 | INFO     | __main__:main:1416 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda
_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:54.954 | INFO     | __main__:main:1422 - Inside train_test_fisher
2024-09-13 17:11:54.954 | INFO     | __main__:main:1423 - Starting training at epoch 1
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-13 17:11:57.041 | INFO     | __main__:main:1447 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lam
bda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:57.042 | INFO     | __main__:find_latest_fisher:527 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da
6eb9c916e62655744_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-13 17:11:57.172 | INFO     | __main__:main:1447 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lam
bda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:57.173 | INFO     | __main__:find_latest_fisher:527 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da
6eb9c916e62655744_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-13 17:11:57.638 | INFO     | __main__:load_fisher_information:503 - Fisher Information successfully loaded.
2024-09-13 17:11:57.638 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-13 17:11:57.638 | INFO     | __main__:main:1454 - Fisher Information Matrix loaded.
2024-09-13 17:11:57.647 | INFO     | __main__:main:1447 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lam
bda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-13 17:11:57.647 | INFO     | __main__:find_latest_fisher:527 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da
6eb9c916e62655744_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-13 17:11:57.757 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-13 17:11:57.758 | INFO     | __main__:main:1522 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-09-13 17:11:57.815 | INFO     | __main__:load_fisher_information:503 - Fisher Information successfully loaded.
2024-09-13 17:11:57.815 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-13 17:11:57.815 | INFO     | __main__:main:1454 - Fisher Information Matrix loaded.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-13 17:11:57.856 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.j
sonl
2024-09-13 17:11:57.863 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-13 17:11:57.863 | INFO     | __main__:main:1522 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-13 17:11:57.957 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.j
sonl
2024-09-13 17:11:58.339 | INFO     | __main__:load_fisher_information:503 - Fisher Information successfully loaded.
2024-09-13 17:11:58.339 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-13 17:11:58.340 | INFO     | __main__:main:1454 - Fisher Information Matrix loaded.
2024-09-13 17:11:58.390 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-13 17:11:58.391 | INFO     | __main__:main:1522 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-13 17:11:58.488 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.j
sonl
2024-09-13 17:12:07.947 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:07.961 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
2024-09-13 17:12:07.974 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-13 17:12:07.974 | INFO     | __main__:main:1536 - Training dataset size after load: 149228
2024-09-13 17:12:07.974 | INFO     | __main__:main:1537 - Validation dataset size after load: 2087
2024-09-13 17:12:07.974 | INFO     | __main__:main:1538 - Testing dataset size after load: 2298
2024-09-13 17:12:07.974 | INFO     | __main__:main:1540 - Starting progressive training from epoch 1 to 2
2024-09-13 17:12:07.974 | INFO     | __main__:main:1543 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-09-13 17:12:08.309 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:08.322 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
2024-09-13 17:12:08.334 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-13 17:12:08.334 | INFO     | __main__:main:1536 - Training dataset size after load: 149228
2024-09-13 17:12:08.334 | INFO     | __main__:main:1537 - Validation dataset size after load: 2087
2024-09-13 17:12:08.334 | INFO     | __main__:main:1538 - Testing dataset size after load: 2298
2024-09-13 17:12:08.334 | INFO     | __main__:main:1540 - Starting progressive training from epoch 1 to 2
2024-09-13 17:12:08.334 | INFO     | __main__:main:1543 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-13 17:12:08.694 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:08.706 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
2024-09-13 17:12:08.718 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-13 17:12:08.718 | INFO     | __main__:main:1536 - Training dataset size after load: 149228
2024-09-13 17:12:08.718 | INFO     | __main__:main:1537 - Validation dataset size after load: 2087
2024-09-13 17:12:08.718 | INFO     | __main__:main:1538 - Testing dataset size after load: 2298
2024-09-13 17:12:08.719 | INFO     | __main__:main:1540 - Starting progressive training from epoch 1 to 2
2024-09-13 17:12:08.719 | INFO     | __main__:main:1543 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-13 17:12:10.489 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:10.578 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
2024-09-13 17:12:10.597 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc exists and
 is not empty.
2024-09-13 17:12:11.745 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
2024-09-13 17:12:11.760 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
2024-09-13 17:12:11.787 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:11.821 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
Training dataset size: 149228
2024-09-13 17:12:11.837 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
2024-09-13 17:12:11.838 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Testing dataset size: 2298
Validation dataset size: 2087
Training dataset size: 149228
2024-09-13 17:12:11.852 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-13 17:12:11.867 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_val/cached_data.pkl
Validation dataset size: 2087
2024-09-13 17:12:11.882 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-13 17:12:13.154 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-13 17:12:13.156 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-13 17:12:13.156 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-13 17:12:13.156 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
`Trainer.fit` stopped: `max_epochs=2` reached.
2024-09-13 17:12:15.902 | INFO     | __main__:main:1546 - hit the barrier after training
2024-09-13 17:12:16.513 | INFO     | __main__:main:1546 - hit the barrier after training
2024-09-13 17:12:16.592 | INFO     | __main__:main:1546 - hit the barrier after training
2024-09-13 17:12:16.742 | INFO     | __main__:main:1546 - hit the barrier after training
2024-09-13 17:12:16.743 | INFO     | __main__:main:1552 - Finished progressive training at epoch 2
2024-09-13 17:12:16.743 | INFO     | __main__:main:1552 - Finished progressive training at epoch 2
2024-09-13 17:12:16.743 | INFO     | __main__:main:1552 - Finished progressive training at epoch 2
2024-09-13 17:12:16.743 | INFO     | __main__:main:1552 - Finished progressive training at epoch 2
2024-09-13 17:12:16.743 | INFO     | __main__:main:1625 - Calculating Fisher Information Matrix for EWC
2024-09-13 17:12:16.743 | INFO     | __main__:main:1625 - Calculating Fisher Information Matrix for EWC
2024-09-13 17:12:16.743 | INFO     | __main__:main:1629 - right before barrier fisher
2024-09-13 17:12:16.743 | INFO     | __main__:main:1625 - Calculating Fisher Information Matrix for EWC
2024-09-13 17:12:16.743 | INFO     | __main__:main:1625 - Calculating Fisher Information Matrix for EWC
2024-09-13 17:12:16.743 | INFO     | __main__:main:1629 - right before barrier fisher
2024-09-13 17:12:16.743 | INFO     | __main__:main:1629 - right before barrier fisher
2024-09-13 17:12:16.743 | INFO     | __main__:main:1629 - right before barrier fisher
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 0] Seed set to 3407
2024-09-13 17:12:19.769 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:20.912 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-13 17:12:21.255 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
2024-09-13 17:12:21.337 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
Training dataset size: 149228
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:232: Using `DistributedSampler` with the dataloaders. During `trainer.test()`, it is recomme
nded to use `Trainer(devices=1, num_nodes=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices ha
ve same batch size in case of uneven inputs.
2024-09-13 17:12:21.921 | INFO     | retrieval.model:on_test_start:398 - Fisher info cleared
2024-09-13 17:12:21.970 | INFO     | retrieval.model:on_test_start:400 - Previous params saved
2024-09-13 17:12:22.009 | INFO     | retrieval.model:on_test_start:398 - Fisher info cleared
2024-09-13 17:12:22.031 | INFO     | retrieval.model:test_step:415 - Batch tensor context_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.031 | INFO     | retrieval.model:test_step:415 - Batch tensor context_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.031 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:415 - Batch tensor label dtype: torch.float32, requires_grad: True
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_ids dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_mask dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:420 - Model is in training mode: False
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:423 - Gradients enabled globally: False
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:427 - Parameter encoder.shared.weight requires_grad: True
2024-09-13 17:12:22.033 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.034 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.035 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.036 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.037 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.038 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.039 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.040 | INFO     | retrieval.model:on_test_start:398 - Fisher info cleared
2024-09-13 17:12:22.040 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.051 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.051 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.051 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.052 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.053 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.054 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.final_layer_norm.weight requires_grad: True
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:432 - Batch tensor context_ids requires_grad: False
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:432 - Batch tensor context_mask requires_grad: False
2024-09-13 17:12:22.055 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_ids requires_grad: False
2024-09-13 17:12:22.056 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_mask requires_grad: False
2024-09-13 17:12:22.056 | INFO     | retrieval.model:test_step:432 - Batch tensor label requires_grad: True
2024-09-13 17:12:22.056 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_ids requires_grad: [False, False, False]
2024-09-13 17:12:22.056 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_mask requires_grad: [False, False, False]
2024-09-13 17:12:22.057 | INFO     | retrieval.model:test_step:442 - Inside test_step
2024-09-13 17:12:22.084 | INFO     | retrieval.model:on_test_start:400 - Previous params saved
2024-09-13 17:12:22.156 | INFO     | retrieval.model:on_test_start:400 - Previous params saved
Testing: |                                                             | 0/? [00:00<?, ?it/s]2024-09-13 17:12:22.159 | INFO     | retrieval.model:on_test_start:398 - Fisher info cleared
2024-09-13 17:12:22.174 | INFO     | retrieval.model:test_step:415 - Batch tensor context_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:415 - Batch tensor context_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:415 - Batch tensor label dtype: torch.float32, requires_grad: True
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_ids dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_mask dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:420 - Model is in training mode: False
2024-09-13 17:12:22.175 | INFO     | retrieval.model:test_step:423 - Gradients enabled globally: False
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.shared.weight requires_grad: True
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight requires_grad: True
2024-09-13 17:12:22.178 | INFO     | retrieval.model:test_step:415 - Batch tensor context_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:415 - Batch tensor context_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:415 - Batch tensor label dtype: torch.float32, requires_grad: True
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_ids dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_mask dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.179 | INFO     | retrieval.model:on_test_start:400 - Previous params saved
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:420 - Model is in training mode: False
2024-09-13 17:12:22.179 | INFO     | retrieval.model:test_step:423 - Gradients enabled globally: False
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.shared.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.176 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.189 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.190 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.191 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.192 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.193 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.180 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.197 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.197 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.197 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.197 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.198 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.194 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.199 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.200 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.201 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.202 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.203 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.204 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.final_layer_norm.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:432 - Batch tensor context_ids requires_grad: False
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.210 | INFO     | retrieval.model:test_step:432 - Batch tensor context_mask requires_grad: False
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_ids requires_grad: False
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_mask requires_grad: False
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:432 - Batch tensor label requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_ids requires_grad: [False, False, False]
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_mask requires_grad: [False, False, False]
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.211 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.212 | INFO     | retrieval.model:test_step:442 - Inside test_step
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.final_layer_norm.weight requires_grad: True
2024-09-13 17:12:22.213 | INFO     | retrieval.model:test_step:432 - Batch tensor context_ids requires_grad: False
2024-09-13 17:12:22.214 | INFO     | retrieval.model:test_step:432 - Batch tensor context_mask requires_grad: False
2024-09-13 17:12:22.214 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_ids requires_grad: False
2024-09-13 17:12:22.214 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_mask requires_grad: False
2024-09-13 17:12:22.214 | INFO     | retrieval.model:test_step:432 - Batch tensor label requires_grad: True
2024-09-13 17:12:22.214 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_ids requires_grad: [False, False, False]
2024-09-13 17:12:22.214 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_mask requires_grad: [False, False, False]
2024-09-13 17:12:22.221 | INFO     | retrieval.model:test_step:442 - Inside test_step
Testing DataLoader 0:   0%|                                         | 0/9327 [00:00<?, ?it/s]2024-09-13 17:12:22.239 | INFO     | retrieval.model:test_step:415 - Batch tensor context_ids dtype: torch.int64, requires_g
rad: False
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:415 - Batch tensor context_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_ids dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:415 - Batch tensor pos_premise_mask dtype: torch.int64, requires_grad: False
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:415 - Batch tensor label dtype: torch.float32, requires_grad: True
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_ids dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:417 - Batch tensor list neg_premises_mask dtypes: [torch.int64, torch.int64, torch.int64], requires_grad: [False, False, False]
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:420 - Model is in training mode: False
2024-09-13 17:12:22.240 | INFO     | retrieval.model:test_step:423 - Gradients enabled globally: False
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.shared.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.241 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.0.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.242 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.1.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.243 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.2.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.244 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.3.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.245 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.4.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.246 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.5.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.247 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.6.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.248 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.7.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.249 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.8.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.250 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.9.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.251 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.10.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.q.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.k.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.v.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.SelfAttention.o.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.0.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight requires_grad: True
2024-09-13 17:12:22.252 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight requires_grad: True
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight requires_grad: True
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.block.11.layer.1.layer_norm.weight requires_grad: True
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:427 - Parameter encoder.encoder.final_layer_norm.weight requires_grad: True
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:432 - Batch tensor context_ids requires_grad: False
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:432 - Batch tensor context_mask requires_grad: False
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_ids requires_grad: False
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:432 - Batch tensor pos_premise_mask requires_grad: False
2024-09-13 17:12:22.253 | INFO     | retrieval.model:test_step:432 - Batch tensor label requires_grad: True
2024-09-13 17:12:22.254 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_ids requires_grad: [False, False, False]
2024-09-13 17:12:22.254 | INFO     | retrieval.model:test_step:434 - Batch tensor list neg_premises_mask requires_grad: [False, False, False]
2024-09-13 17:12:22.255 | INFO     | retrieval.model:test_step:442 - Inside test_step
2024-09-13 17:12:22.648 | INFO     | retrieval.model:test_step:452 - Test loss before EWC: 0.0264
2024-09-13 17:12:22.677 | INFO     | retrieval.model:test_step:452 - Test loss before EWC: 0.0288
2024-09-13 17:12:22.695 | INFO     | retrieval.model:test_step:452 - Test loss before EWC: 0.0132
2024-09-13 17:12:22.824 | INFO     | retrieval.model:test_step:452 - Test loss before EWC: 0.0350
An error occurred during fisher: element 0 of tensors does not require grad and does not have a grad_fn
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1631, in main
    trainer.test(model, datamodule=data_module)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 754, in test
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 794, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1026, in _run_stage
    return self._evaluation_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 182, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 453, in test_step
    loss.backward()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2024-09-13 17:12:23.383 | INFO     | __main__:main:1692 - Finished processing the repository
2024-09-13 17:12:23.383 | INFO     | __main__:main:1694 - current epoch: 2
2024-09-13 17:12:23.383 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:12:23.384 | INFO     | __main__:main:1369 - i: 1
2024-09-13 17:12:23.384 | INFO     | __main__:main:1696 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1370, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
An error occurred during fisher: element 0 of tensors does not require grad and does not have a grad_fn
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1631, in main
    trainer.test(model, datamodule=data_module)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 754, in test
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 794, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1026, in _run_stage
    return self._evaluation_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 182, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 453, in test_step
    loss.backward()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2024-09-13 17:12:23.415 | INFO     | __main__:main:1692 - Finished processing the repository
2024-09-13 17:12:23.415 | INFO     | __main__:main:1694 - current epoch: 2
2024-09-13 17:12:23.415 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:12:23.415 | INFO     | __main__:main:1369 - i: 1
2024-09-13 17:12:23.415 | INFO     | __main__:main:1696 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1370, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
An error occurred during fisher: element 0 of tensors does not require grad and does not have a grad_fn
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1631, in main
    trainer.test(model, datamodule=data_module)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 754, in test
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 794, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1026, in _run_stage
    return self._evaluation_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 182, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 453, in test_step
    loss.backward()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2024-09-13 17:12:23.435 | INFO     | __main__:main:1692 - Finished processing the repository
2024-09-13 17:12:23.435 | INFO     | __main__:main:1694 - current epoch: 2
2024-09-13 17:12:23.435 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:12:23.435 | INFO     | __main__:main:1369 - i: 1
2024-09-13 17:12:23.435 | INFO     | __main__:main:1696 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1370, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
An error occurred during fisher: element 0 of tensors does not require grad and does not have a grad_fn
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1631, in main
    trainer.test(model, datamodule=data_module)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 754, in test
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 794, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1026, in _run_stage
    return self._evaluation_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 182, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 453, in test_step
    loss.backward()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

2024-09-13 17:12:23.605 | INFO     | __main__:main:1692 - Finished processing the repository
2024-09-13 17:12:23.605 | INFO     | __main__:main:1694 - current epoch: 2
2024-09-13 17:12:23.605 | INFO     | __main__:main:1368 - length of lean_git_repos: 1
2024-09-13 17:12:23.605 | INFO     | __main__:main:1369 - i: 1
2024-09-13 17:12:23.605 | INFO     | __main__:main:1696 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1370, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
Testing DataLoader 0:   0%|                                         | 0/9327 [00:03<?, ?it/s]
[rank0]:[W913 17:12:26.028732193 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_proce
ss_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint h
as always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
(base) yingzi_ma@compute-permanent-node-824:~/lean_project/ReProver$
