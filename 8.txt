(base) yingzi_ma@cais-login-0:~/lean_project/ReProver$ srun --partition=compute --gpus=4 --nodes=1 --time=2-00:00:00 --pty /bin/bash
srun: job 104153 queued and waiting for resources
srun: job 104153 has been allocated resources
(base) yingzi_ma@compute-permanent-node-670:~/lean_project/ReProver$ ps aux | grep "python"
root        6974  0.0  0.0  33184 20400 ?        Ss   Sep03   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
root        9232  0.0  0.0 627628 26520 ?        Ssl  Sep03  49:38 /bin/python3 /usr/local/bin/cais-gpu-exporter.py
root        9317  0.0  0.0 262952  8160 ?        Ssl  Sep03   7:29 /usr/bin/python3 -Es /usr/sbin/tuned -l -P
root     1008108  0.0  0.0  60576 16320 ?        Ss   Sep09  49:12 /usr/bin/python2 /usr/local/bin/supervisord -n -c /etc/supervisord.conf
root     1008127  0.0  0.0  25664  6120 ?        S    Sep09   0:00 /usr/bin/python2 /weka/scripts/logger.py
root     1008128  0.0  0.0 126832 14280 ?        Sl   Sep09   0:00 /usr/bin/python2 /weka/scripts/events.py --rpcbind_register
root     1008129  0.0  0.0 1314208 12240 ?       S    Sep09   8:45 python2 /weka/scripts/shelld.py -p /var/run/shelld.sock -s
root     1008136  4.0  0.0  72776 16320 ?        S    Sep09 4579:08 python3-weka /weka/scripts/rotate_files.py
root     1009029  0.0  0.0  60604 16320 ?        Ss   Sep09  43:16 /usr/bin/python2 /usr/local/bin/supervisord -n -c /etc/supervisord.conf
root     1009051  0.0  0.0  25664  6120 ?        S    Sep09   0:00 /usr/bin/python2 /weka/scripts/logger.py
root     1009052  0.0  0.0 126832 14280 ?        Sl   Sep09   0:00 /usr/bin/python2 /weka/scripts/events.py --rpcbind_register
root     1009053  0.0  0.0 789920 12240 ?        S    Sep09   8:22 python2 /weka/scripts/shelld.py -p /var/run/shelld.sock -s
root     1009060  1.4  0.0  70596 16320 ?        S    Sep09 1642:05 python3-weka /weka/scripts/rotate_files.py
root     1009759  0.0  0.0  60556 16320 ?        Ss   Sep09  70:10 /usr/bin/python2 /usr/local/bin/supervisord -n -c /etc/supervisord.conf
root     1009778  0.0  0.0  25664  6120 ?        S    Sep09   0:00 /usr/bin/python2 /weka/scripts/logger.py
root     1009779  0.0  0.0 126832 14280 ?        Sl   Sep09   0:00 /usr/bin/python2 /weka/scripts/events.py --rpcbind_register
root     1009780  0.0  0.0 1248672 6120 ?        S    Sep09  13:56 python2 /weka/scripts/shelld.py -p /var/run/shelld.sock -s
root     1009787  2.4  0.0  75812 43064 ?        S    Sep09 2773:53 python3-weka /weka/scripts/rotate_files.py
divyam_+ 1096135 41.2  0.0 67543252 1611732 ?    Rl   21:01   3:28 python fh-gcg-binsearch_no_rulz.py --template llama-3 --finetuned_model_path ../data/adapters/llama3_epochs64_bot --base_model_path ../../models/Meta-
Llama-3-8B-Instruct --judge_path ../../models/HarmBench-Llama-2-13b-cls --save_path ../data --resume_idx 0 --dataset adv_harm_mistral_simple_goals --dataset_start_idx 39 --dataset_end_idx 40 --fbs 64 --tag binsearch_a
dv_harm_mistral_simple_goals_epoch_500_steps_200_with_actual_grad_updated_no_rulz --epochs 500 --steps 200 --no_sys_msg
divyam_+ 1096136 41.2  0.0 66610348 1578864 ?    Rl   21:01   3:28 python fh-gcg-binsearch_no_rulz.py --template llama-3 --finetuned_model_path ../data/adapters/llama3_epochs64_bot --base_model_path ../../models/Meta-
Llama-3-8B-Instruct --judge_path ../../models/HarmBench-Llama-2-13b-cls --save_path ../data --resume_idx 0 --dataset adv_harm_mistral_simple_goals --dataset_start_idx 38 --dataset_end_idx 39 --fbs 64 --tag binsearch_a
dv_harm_mistral_simple_goals_epoch_500_steps_200_with_actual_grad_updated_no_rulz --epochs 500 --steps 200 --no_sys_msg
divyam_+ 1096137 41.2  0.0 70215936 1522404 ?    Rl   21:01   3:28 python fh-gcg-binsearch_no_rulz.py --template llama-3 --finetuned_model_path ../data/adapters/llama3_epochs64_bot --base_model_path ../../models/Meta-
Llama-3-8B-Instruct --judge_path ../../models/HarmBench-Llama-2-13b-cls --save_path ../data --resume_idx 0 --dataset adv_harm_mistral_simple_goals --dataset_start_idx 44 --dataset_end_idx 45 --fbs 64 --tag binsearch_a
dv_harm_mistral_simple_goals_epoch_500_steps_200_with_actual_grad_updated_no_rulz --epochs 500 --steps 200 --no_sys_msg
divyam_+ 1096138 41.2  0.0 74754640 1615556 ?    Rl   21:01   3:28 python fh-gcg-binsearch_no_rulz.py --template llama-3 --finetuned_model_path ../data/adapters/llama3_epochs64_bot --base_model_path ../../models/Meta-
Llama-3-8B-Instruct --judge_path ../../models/HarmBench-Llama-2-13b-cls --save_path ../data --resume_idx 0 --dataset adv_harm_mistral_simple_goals --dataset_start_idx 43 --dataset_end_idx 44 --fbs 64 --tag binsearch_a
dv_harm_mistral_simple_goals_epoch_500_steps_200_with_actual_grad_updated_no_rulz --epochs 500 --steps 200 --no_sys_msg
yingzi_+ 1100955  0.0  0.0   7012  2040 pts/0    S+   21:10   0:00 grep --color=auto python
(base) yingzi_ma@compute-permanent-node-670:~/lean_project/ReProver$ bash run_code_reprover_finetune_all_10.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
kill: (6974): Operation not permitted
kill: (9232): Operation not permitted
kill: (9317): Operation not permitted
kill: (1008108): Operation not permitted
kill: (1008127): Operation not permitted
kill: (1008128): Operation not permitted
kill: (1008129): Operation not permitted
kill: (1008136): Operation not permitted
kill: (1009029): Operation not permitted
kill: (1009051): Operation not permitted
kill: (1009052): Operation not permitted
kill: (1009053): Operation not permitted
kill: (1009060): Operation not permitted
kill: (1009759): Operation not permitted
kill: (1009778): Operation not permitted
kill: (1009779): Operation not permitted
kill: (1009780): Operation not permitted
kill: (1009787): Operation not permitted
kill: (1096135): Operation not permitted
kill: (1096136): Operation not permitted
kill: (1096137): Operation not permitted
kill: (1096138): Operation not permitted
kill: (1101001): No such process
Tue Nov 26 21:10:37 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   38C    P0             84W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   37C    P0             89W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   36C    P0             83W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   36C    P0             81W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running reprover_finetune_all_10.py
[2024-11-26 21:10:46,058] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-11-26 21:10:50.464 | INFO     | __main__:main:1368 - Running progressive training
2024-11-26 21:10:50.464 | INFO     | __main__:main:1374 - Configuring LeanDojo...
2024-11-26 21:10:50.467 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-11-26 21:10:50.467 | INFO     | __main__:main:1376 - LeanDojo configured
2024-11-26 21:10:50.467 | INFO     | __main__:main:1381 - Starting the main process
2024-11-26 21:10:50.467 | INFO     | __main__:main:1389 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_merge_all_no_ewc_full_reprover_finetune_all_10.json
2024-11-26 21:12:26.692 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-11-26 21:12:26.693 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-11-26 21:12:38.742 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-11-26 21:12:38.742 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-11-26 21:12:51.045 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-11-26 21:12:51.046 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-11-26 21:12:53.042 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-11-26 21:12:53.042 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-11-26 21:13:06.528 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-11-26 21:13:06.528 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-11-26 21:13:08.304 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-11-26 21:13:08.304 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-11-26 21:13:10.077 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-11-26 21:13:10.077 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-11-26 21:13:25.082 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f5
15a0e52878)
2024-11-26 21:13:25.082 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f515a0e528
78)
2024-11-26 21:13:26.923 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-11-26 21:13:26.923 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-11-26 21:13:28.749 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-11-26 21:13:28.749 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-11-26 21:13:30.451 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-11-26 21:13:30.452 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-11-26 21:13:47.654 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/corent1234/hairy-ball-theorem-lean (commit: fa500d7d2e58580bac7c050f0f6c408041b70205)
2024-11-26 21:13:47.654 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/corent1234/hairy-ball-theorem-lean (commit: fa500d7d2e58580bac7c050f0f6c408041b70205)
2024-11-26 21:13:49.463 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-11-26 21:13:49.463 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-11-26 21:13:51.254 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-11-26 21:13:51.254 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-11-26 21:13:53.034 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-11-26 21:13:53.034 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-11-26 21:13:54.679 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-11-26 21:13:54.679 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-11-26 21:14:14.497 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-11-26 21:14:14.497 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-11-26 21:14:15.233 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-11-26 21:14:15.233 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-11-26 21:14:15.867 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-11-26 21:14:15.867 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-11-26 21:14:16.360 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-11-26 21:14:16.360 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-11-26 21:14:16.729 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-11-26 21:14:16.729 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-11-26 21:14:17.028 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-11-26 21:14:17.028 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-11-26 21:14:17.177 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-11-26 21:14:17.178 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-11-26 21:14:19.330 | INFO     | __main__:main:1391 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_merge_all_no_ewc_full_reprover_finetune_all_10.json
2024-11-26 21:14:19.332 | INFO     | __main__:main:1398 - Found 23 repositories
2024-11-26 21:14:19.332 | INFO     | __main__:main:1489 - Starting without curriculum learning
2024-11-26 21:14:19.334 | INFO     | __main__:get_sanitized_repo_info:1602 - Replacing zeta
2024-11-26 21:14:19.595 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-11-26 21:14:42.673 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
2024-11-26 21:15:06.904 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-11-26 21:15:30.966 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-11-26 21:15:53.970 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0-rc2
2024-11-26 21:16:19.645 | INFO     | __main__:main:1617 - length of lean_git_repos: 23
2024-11-26 21:16:19.646 | INFO     | __main__:main:1618 - i: 0
2024-11-26 21:16:19.646 | INFO     | __main__:main:1624 - Main process
2024-11-26 21:16:19.646 | INFO     | __main__:main:1625 - Using lambda = 0.1
2024-11-26 21:16:19.646 | INFO     | __main__:main:1626 - Processing https://github.com/dwrensha/compfiles
2024-11-26 21:16:19.646 | INFO     | __main__:main:1652 - Repo already in repos_for_merged_dataset
2024-11-26 21:16:19.648 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-11-26 21:16:19.648 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-11-26 21:16:19.648 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-11-26 21:16:19.649 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-11-26 21:16:19.650 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-11-26 21:16:19.650 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/corent1234/hairy-ball-theorem-lean (commit: fa500d7d2e58580bac7c050f0f6c408041b70205)
2024-11-26 21:16:19.650 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-11-26 21:16:19.650 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f515a0e52878)
2024-11-26 21:29:34.459 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091 already exists. Removing it now.
2024-11-26 21:30:37.301 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfiles_
f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-11-26 21:30:39.941 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new
_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-11-26 21:30:39.965 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_comp
files_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-11-26 21:30:39.987 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-11-26 21:30:40.062 | INFO     | __main__:main:1676 - All GPUs
2024-11-26 21:30:40.062 | INFO     | __main__:find_latest_checkpoint:627 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de16
8ac2bf835a77ef68bbe069194c5.ckpt
2024-11-26 21:30:40.063 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe06
9194c5.ckpt
2024-11-26 21:30:40.063 | INFO     | __main__:main:1689 - Inside train_test_fisher
2024-11-26 21:30:40.063 | INFO     | __main__:main:1690 - Starting training at epoch 0
[rank: 0] Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-11-26 21:30:42.727 | INFO     | __main__:main:1714 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bb
e069194c5.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python reprover_finetune_all_10.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-26 21:30:42.848 | INFO     | __main__:main:1772 - right before barrier for data module
2024-11-26 21:30:42.848 | INFO     | __main__:main:1787 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c26
65f091/random
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 259596/259596 [00:59<00:00, 4331.71it/s]
2024-11-26 21:32:16.391 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_comp
files_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5408/5408 [00:00<00:00, 6146.96it/s]
2024-11-26 21:32:17.474 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_comp
files_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5408/5408 [00:00<00:00, 6219.37it/s]
2024-11-26 21:32:18.549 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_comp
files_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
2024-11-26 21:32:18.549 | INFO     | __main__:main:1801 - Training dataset size after load: 639354
2024-11-26 21:32:18.549 | INFO     | __main__:main:1802 - Validation dataset size after load: 11356
2024-11-26 21:32:18.549 | INFO     | __main__:main:1803 - Testing dataset size after load: 11288
2024-11-26 21:32:18.549 | INFO     | __main__:main:1805 - Starting progressive training from epoch 0 to 10
2024-11-26 21:32:18.550 | INFO     | __main__:main:1808 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-11-26 21:32:26,956] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-26 21:32:26,956] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-26 21:32:26,956] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-11-26 21:32:31.252 | INFO     | __main__:main:1368 - Running progressive training
2024-11-26 21:32:31.252 | INFO     | __main__:main:1368 - Running progressive training
2024-11-26 21:32:31.252 | INFO     | __main__:main:1368 - Running progressive training
2024-11-26 21:32:31.253 | INFO     | __main__:main:1374 - Configuring LeanDojo...
2024-11-26 21:32:31.253 | INFO     | __main__:main:1374 - Configuring LeanDojo...
2024-11-26 21:32:31.253 | INFO     | __main__:main:1374 - Configuring LeanDojo...
2024-11-26 21:32:31.255 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-11-26 21:32:31.255 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-11-26 21:32:31.255 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-11-26 21:32:31.255 | INFO     | __main__:main:1376 - LeanDojo configured
2024-11-26 21:32:31.256 | INFO     | __main__:main:1376 - LeanDojo configured
2024-11-26 21:32:31.256 | INFO     | __main__:main:1398 - Found 23 repositories
2024-11-26 21:32:31.256 | INFO     | __main__:main:1376 - LeanDojo configured
2024-11-26 21:32:31.256 | INFO     | __main__:main:1398 - Found 23 repositories
2024-11-26 21:32:31.256 | INFO     | __main__:main:1489 - Starting without curriculum learning
2024-11-26 21:32:31.256 | INFO     | __main__:main:1398 - Found 23 repositories
2024-11-26 21:32:31.256 | INFO     | __main__:main:1489 - Starting without curriculum learning
2024-11-26 21:32:31.256 | INFO     | __main__:main:1489 - Starting without curriculum learning
2024-11-26 21:32:31.256 | INFO     | __main__:get_sanitized_repo_info:1602 - Replacing zeta
2024-11-26 21:32:31.256 | INFO     | __main__:get_sanitized_repo_info:1602 - Replacing zeta
2024-11-26 21:32:31.256 | INFO     | __main__:get_sanitized_repo_info:1602 - Replacing zeta
2024-11-26 21:32:31.444 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-11-26 21:32:31.459 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-11-26 21:32:31.499 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-11-26 21:32:54.244 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-11-26 21:32:54.424 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-11-26 21:32:54.486 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
2024-11-26 21:33:17.893 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
2024-11-26 21:33:18.415 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-11-26 21:33:18.462 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-11-26 21:33:41.751 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-11-26 21:33:41.944 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-11-26 21:33:42.318 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-11-26 21:34:04.935 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0-rc2
2024-11-26 21:34:05.035 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0-rc2
2024-11-26 21:34:05.174 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0-rc2
2024-11-26 21:34:30.342 | INFO     | __main__:main:1617 - length of lean_git_repos: 23
2024-11-26 21:34:30.342 | INFO     | __main__:main:1618 - i: 0
2024-11-26 21:34:30.342 | INFO     | __main__:main:1676 - All GPUs
2024-11-26 21:34:30.343 | INFO     | __main__:find_latest_checkpoint:627 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de16
8ac2bf835a77ef68bbe069194c5.ckpt
2024-11-26 21:34:30.343 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe06
9194c5.ckpt
2024-11-26 21:34:30.343 | INFO     | __main__:main:1689 - Inside train_test_fisher
2024-11-26 21:34:30.343 | INFO     | __main__:main:1690 - Starting training at epoch 0
[rank: 3] Seed set to 3407
2024-11-26 21:34:30.809 | INFO     | __main__:main:1617 - length of lean_git_repos: 23
2024-11-26 21:34:30.809 | INFO     | __main__:main:1618 - i: 0
2024-11-26 21:34:30.809 | INFO     | __main__:main:1676 - All GPUs
2024-11-26 21:34:30.810 | INFO     | __main__:find_latest_checkpoint:627 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de16
8ac2bf835a77ef68bbe069194c5.ckpt
2024-11-26 21:34:30.810 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe06
9194c5.ckpt
2024-11-26 21:34:30.810 | INFO     | __main__:main:1689 - Inside train_test_fisher
2024-11-26 21:34:30.810 | INFO     | __main__:main:1690 - Starting training at epoch 0
[rank: 1] Seed set to 3407
2024-11-26 21:34:30.876 | INFO     | __main__:main:1617 - length of lean_git_repos: 23
2024-11-26 21:34:30.876 | INFO     | __main__:main:1618 - i: 0
2024-11-26 21:34:30.876 | INFO     | __main__:main:1676 - All GPUs
2024-11-26 21:34:30.876 | INFO     | __main__:find_latest_checkpoint:627 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de16
8ac2bf835a77ef68bbe069194c5.ckpt
2024-11-26 21:34:30.877 | INFO     | __main__:main:1683 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe06
9194c5.ckpt
2024-11-26 21:34:30.877 | INFO     | __main__:main:1689 - Inside train_test_fisher
2024-11-26 21:34:30.877 | INFO     | __main__:main:1690 - Starting training at epoch 0
[rank: 2] Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-11-26 21:34:32.004 | INFO     | __main__:main:1714 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bb
e069194c5.ckpt
2024-11-26 21:34:32.118 | INFO     | __main__:main:1772 - right before barrier for data module
2024-11-26 21:34:32.118 | INFO     | __main__:main:1787 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c26
65f091/random
2024-11-26 21:34:33.908 | INFO     | __main__:main:1714 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bb
e069194c5.ckpt
2024-11-26 21:34:34.016 | INFO     | __main__:main:1714 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bb
e069194c5.ckpt
2024-11-26 21:34:34.027 | INFO     | __main__:main:1772 - right before barrier for data module
2024-11-26 21:34:34.027 | INFO     | __main__:main:1787 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c26
65f091/random
2024-11-26 21:34:34.058 | INFO     | __main__:main:1772 - right before barrier for data module
2024-11-26 21:34:34.058 | INFO     | __main__:main:1787 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c26
65f091/random
2024-11-26 21:35:16.956 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:17.020 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:17.090 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
2024-11-26 21:35:17.090 | INFO     | __main__:main:1801 - Training dataset size after load: 639354
2024-11-26 21:35:17.090 | INFO     | __main__:main:1802 - Validation dataset size after load: 11356
2024-11-26 21:35:17.090 | INFO     | __main__:main:1803 - Testing dataset size after load: 11288
2024-11-26 21:35:17.090 | INFO     | __main__:main:1805 - Starting progressive training from epoch 0 to 10
2024-11-26 21:35:17.090 | INFO     | __main__:main:1808 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-11-26 21:35:22.090 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:22.153 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:22.218 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
2024-11-26 21:35:22.219 | INFO     | __main__:main:1801 - Training dataset size after load: 639354
2024-11-26 21:35:22.219 | INFO     | __main__:main:1802 - Validation dataset size after load: 11356
2024-11-26 21:35:22.219 | INFO     | __main__:main:1803 - Testing dataset size after load: 11288
2024-11-26 21:35:22.219 | INFO     | __main__:main:1805 - Starting progressive training from epoch 0 to 10
2024-11-26 21:35:22.219 | INFO     | __main__:main:1808 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-11-26 21:35:27.819 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:27.879 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:27.947 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
2024-11-26 21:35:27.947 | INFO     | __main__:main:1801 - Training dataset size after load: 639354
2024-11-26 21:35:27.947 | INFO     | __main__:main:1802 - Validation dataset size after load: 11356
2024-11-26 21:35:27.947 | INFO     | __main__:main:1803 - Testing dataset size after load: 11288
2024-11-26 21:35:27.947 | INFO     | __main__:main:1805 - Starting progressive training from epoch 0 to 10
2024-11-26 21:35:27.947 | INFO     | __main__:main:1808 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-11-26 21:35:31.554 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:32.029 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:32.118 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprove
r_finetune_all_10 exists and is not empty.
2024-11-26 21:35:46.934 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:47.363 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:47.443 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
2024-11-26 21:35:53.974 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:54.468 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:54.589 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
2024-11-26 21:35:55.465 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 639354
2024-11-26 21:35:56.076 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 11356
2024-11-26 21:35:56.189 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full_reprover_finetune_all_10/merged_with_new_compfile
s_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 11288
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_merge_all_
no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-26 21:35:57.411 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-11-26 21:35:57.413 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-11-26 21:35:57.414 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-11-26 21:35:57.417 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params | Mode
---------------------------------------------------
0 | encoder | T5EncoderModel | 217 M  | train
---------------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
235       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full_reprover_finetune_all_10/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Epoch 0:   8%|████████████▉                                                                                                                                             | 3372/39959 [22:27<4:03:38,  2.50it/s, v_num=30]
