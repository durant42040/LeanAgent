(base) yingzi_ma@cais-login-0:~/lean_project/ReProver$ srun --partition=compute --gpus=4 --nodes=1 --time=0-02:00:00 --pty /bin/bash
srun: job 17058 queued and waiting for resources
srun: job 17058 has been allocated resources
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-01 19:13:47,366] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-01 19:13:51.322 | INFO     | __main__:main:1195 - Running progressive training
2024-09-01 19:13:51.322 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-01 19:13:51.326 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 19:13:51.326 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-01 19:13:52.948 | INFO     | __main__:search_github_repositories:383 - Processing leanprover/lean4
2024-09-01 19:13:52.949 | INFO     | __main__:search_github_repositories:401 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 19:13:52.949 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 19:13:53.914 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 19:13:54.953 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 19:13:56.993 | INFO     | __main__:search_github_repositories:399 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 19:13:56.994 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 19:13:57.774 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 19:14:13.322 | INFO     | __main__:search_github_repositories:383 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 19:14:14.064 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 19:14:15.102 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 19:14:17.140 | INFO     | __main__:search_github_repositories:399 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 19:14:17.141 | INFO     | __main__:search_github_repositories:383 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 19:14:17.833 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 19:14:18.872 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 19:14:20.911 | INFO     | __main__:search_github_repositories:399 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 19:14:20.912 | INFO     | __main__:search_github_repositories:383 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 19:14:21.559 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 19:14:22.597 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 19:14:24.638 | INFO     | __main__:search_github_repositories:399 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 19:14:24.639 | INFO     | __main__:search_github_repositories:383 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 19:14:25.339 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 19:14:26.376 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 19:14:28.415 | INFO     | __main__:search_github_repositories:399 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 19:14:28.416 | INFO     | __main__:search_github_repositories:383 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 19:14:29.229 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 19:14:30.268 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 19:14:32.307 | INFO     | __main__:search_github_repositories:399 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 19:14:32.308 | INFO     | __main__:search_github_repositories:383 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 19:14:32.856 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-01 19:14:48.386 | INFO     | __main__:search_github_repositories:383 - Processing ImperialCollegeLondon/natural_number_game
Cloning https://github.com/ImperialCollegeLondon/natural_number_game.git
Repo name: ImperialCollegeLondon/natural_number_game
2024-09-01 19:14:49.242 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/natural_number_game/6b30156c5025760d1ed8753de3b44a075e2f8a51/lean-toolchain failed
. Retrying...
2024-09-01 19:14:50.280 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/natural_number_game/6b30156c5025760d1ed8753de3b44a075e2f8a51/lean-toolchain failed
. Retrying...
2024-09-01 19:14:52.320 | INFO     | __main__:search_github_repositories:399 - Failed to clone ImperialCollegeLondon/natural_number_game because of HTTP Error 404: Not Found
2024-09-01 19:14:52.321 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/batteries
2024-09-01 19:14:52.321 | INFO     | __main__:search_github_repositories:401 - Skipping leanprover-community/batteries since it is a known repository
2024-09-01 19:14:52.321 | INFO     | __main__:search_github_repositories:383 - Processing kbuzzard/xena
Cloning https://github.com/kbuzzard/xena.git
Repo name: kbuzzard/xena
2024-09-01 19:14:53.031 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/kbuzzard/xena/936b113e4741ab2a3d9d9883d31cbe5ac5669bbb/lean-toolchain failed. Retrying...
2024-09-01 19:14:54.069 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/kbuzzard/xena/936b113e4741ab2a3d9d9883d31cbe5ac5669bbb/lean-toolchain failed. Retrying...
2024-09-01 19:14:56.116 | INFO     | __main__:search_github_repositories:399 - Failed to clone kbuzzard/xena because of HTTP Error 404: Not Found
2024-09-01 19:14:56.116 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/lean4-metaprogramming-book
2024-09-01 19:14:56.117 | INFO     | __main__:search_github_repositories:401 - Skipping leanprover-community/lean4-metaprogramming-book since it is a known repository
2024-09-01 19:14:56.117 | INFO     | __main__:search_github_repositories:383 - Processing ImperialCollegeLondon/FLT
Cloning https://github.com/ImperialCollegeLondon/FLT.git
Repo name: ImperialCollegeLondon/FLT
2024-09-01 19:14:56.725 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 19:15:12.498 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/tutorials
Cloning https://github.com/leanprover-community/tutorials.git
Repo name: leanprover-community/tutorials
2024-09-01 19:15:13.270 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/tutorials/cf6d067632cedda813d880eaf730324d021c653e/lean-toolchain failed. Retrying.
..
2024-09-01 19:15:14.309 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/tutorials/cf6d067632cedda813d880eaf730324d021c653e/lean-toolchain failed. Retrying.
..
2024-09-01 19:15:16.348 | INFO     | __main__:search_github_repositories:399 - Failed to clone leanprover-community/tutorials because of HTTP Error 404: Not Found
2024-09-01 19:15:16.349 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/aesop
2024-09-01 19:15:16.349 | INFO     | __main__:search_github_repositories:401 - Skipping leanprover-community/aesop since it is a known repository
2024-09-01 19:15:16.349 | INFO     | __main__:search_github_repositories:383 - Processing leanprover-community/lean-liquid
Cloning https://github.com/leanprover-community/lean-liquid.git
Repo name: leanprover-community/lean-liquid
2024-09-01 19:15:17.111 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/lean-liquid/087fffad55dc1dd8d54ab35c9816926a45b8c0fd/lean-toolchain failed. Retryin
g...
2024-09-01 19:15:18.148 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/lean-liquid/087fffad55dc1dd8d54ab35c9816926a45b8c0fd/lean-toolchain failed. Retryin
g...
2024-09-01 19:15:20.187 | INFO     | __main__:search_github_repositories:399 - Failed to clone leanprover-community/lean-liquid because of HTTP Error 404: Not Found
2024-09-01 19:15:20.188 | INFO     | __main__:search_github_repositories:383 - Processing openai/lean-gym
Cloning https://github.com/openai/lean-gym.git
Repo name: openai/lean-gym
2024-09-01 19:15:21.074 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/openai/lean-gym/1585ac4d2e56a1ceb72243ce859645b9d0069d34/lean-toolchain failed. Retrying...
2024-09-01 19:15:22.112 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/openai/lean-gym/1585ac4d2e56a1ceb72243ce859645b9d0069d34/lean-toolchain failed. Retrying...
2024-09-01 19:15:24.151 | INFO     | __main__:search_github_repositories:399 - Failed to clone openai/lean-gym because of HTTP Error 404: Not Found
2024-09-01 19:15:24.152 | INFO     | __main__:search_github_repositories:383 - Processing formalabstracts/formalabstracts
Cloning https://github.com/formalabstracts/formalabstracts.git
Repo name: formalabstracts/formalabstracts
2024-09-01 19:15:24.887 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/formalabstracts/formalabstracts/b0173da1af45421239d44492eeecd54bf65ee0f6/lean-toolchain failed. Retrying
...
2024-09-01 19:15:25.924 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/formalabstracts/formalabstracts/b0173da1af45421239d44492eeecd54bf65ee0f6/lean-toolchain failed. Retrying
...
2024-09-01 19:15:27.963 | INFO     | __main__:search_github_repositories:399 - Failed to clone formalabstracts/formalabstracts because of HTTP Error 404: Not Found
2024-09-01 19:15:27.964 | INFO     | __main__:search_github_repositories:383 - Processing ImperialCollegeLondon/M40001_lean
Cloning https://github.com/ImperialCollegeLondon/M40001_lean.git
Repo name: ImperialCollegeLondon/M40001_lean
2024-09-01 19:15:28.839 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/M40001_lean/8cc4a60897dabdd5bc0d116144776f3286fde70c/lean-toolchain failed. Retryi
ng...
2024-09-01 19:15:29.878 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/M40001_lean/8cc4a60897dabdd5bc0d116144776f3286fde70c/lean-toolchain failed. Retryi
ng...
2024-09-01 19:15:31.918 | INFO     | __main__:search_github_repositories:399 - Failed to clone ImperialCollegeLondon/M40001_lean because of HTTP Error 404: Not Found
2024-09-01 19:15:31.919 | INFO     | __main__:search_github_repositories:383 - Processing teorth/pfr
Cloning https://github.com/teorth/pfr.git
Repo name: teorth/pfr
2024-09-01 19:15:32.423 | INFO     | __main__:search_github_repositories:383 - Processing AlexKontorovich/PrimeNumberTheoremAnd
Cloning https://github.com/AlexKontorovich/PrimeNumberTheoremAnd.git
Repo name: AlexKontorovich/PrimeNumberTheoremAnd
2024-09-01 19:15:32.937 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-01 19:15:48.517 | INFO     | __main__:search_github_repositories:383 - Processing kmill/lean4-raytracer
Cloning https://github.com/kmill/lean4-raytracer.git
Repo name: kmill/lean4-raytracer
2024-09-01 19:15:49.013 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
Found 6 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 19:16:04.562 | INFO     | __main__:retrieve_proof:1008 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 19:16:04.562 | INFO     | __main__:retrieve_proof:1024 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 19:16:04.563 | INFO     | __main__:retrieve_proof:1025 - Lean version: v4.8.0
2024-09-01 19:16:04.601 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-01 19:16:20.060 | INFO     | __main__:retrieve_proof:1030 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 19:16:20.060 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 19:16:20.060 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 19:16:20.061 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 19:16:20.061 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 19:16:20.061 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 19:16:20.061 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 19:16:20.061 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 19:16:20.062 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 19:16:20.062 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 19:16:20.062 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 19:16:20.140 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 19:16:20.141 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 19:16:20.141 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 19:16:20.148 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 19:16:20.148 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 19:16:20.148 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 19:16:20.151 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 19:16:20.151 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe193
06beb1310/mathlib4
2024-09-01 19:16:23.294 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e7343
8e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [14:04<00:00,  6.53it/s]
2024-09-01 19:30:27.304 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bce
cc7c0fe19306beb1310')
2024-09-01 19:30:28.482 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-01 19:30:45.517 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 19:31:01.222 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 19:31:02.339 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 19:31:04.917 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 19:31:05.393 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 19:31:14.893 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 19:31:15.329 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 19:31:30.788 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 19:31:31.698 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 19:31:32.465 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 19:31:32.940 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 19:31:48.707 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 19:31:49.154 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426
b91a0d2fe')
2024-09-01 19:31:49.570 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 19:32:06.381 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 19:32:07.951 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupporte
d Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-01 19:32:07.951 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf1
0839227bbb9e8492be2d')
2024-09-01 19:32:07.994 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e
350841ce65a1ec42c')
2024-09-01 19:32:08.036 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c10664
93c3f5dc51c9713e')
2024-09-01 19:32:08.115 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77
ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 19:32:08.192 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b67
5ef3e347d0')
2024-09-01 19:32:08.231 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4
bc3c9a45fc03cf97a0b1a0c')
2024-09-01 19:32:40.006 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73
438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/l
eanprover-community/batteries', commit='021e272cb5cdcc82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop':
LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b
6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprov
er/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='h
ttps://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c424
13cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/le
anprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 19:33:18.486 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 19:33:18.488 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 19:33:18.488 | INFO     | __main__:retrieve_proof:1038 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 19:35:08.013 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 19:35:08.014 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 35530.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 34181.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:03<00:00, 33882.49it/s]
2024-09-01 19:35:17.474 | INFO     | __main__:retrieve_proof:1076 - Before adding new repo:
2024-09-01 19:35:17.474 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 19:35:17.475 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 19:35:17.475 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 19:35:17.475 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the dat
abase.
2024-09-01 19:35:17.475 | INFO     | __main__:retrieve_proof:1079 - After adding new repo:
2024-09-01 19:35:17.475 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 19:35:17.475 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 19:35:38.393 | INFO     | __main__:retrieve_proof:1088 - Adding repo to repos_for_merged_dataset
2024-09-01 19:35:38.396 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 19:35:38.396 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 19:39:09.057 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already
 exists. Removing it now.
2024-09-01 19:39:44.053 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe1
9306beb1310
2024-09-01 19:39:44.995 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427
bcecc7c0fe19306beb1310
2024-09-01 19:39:45.016 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310
2024-09-01 19:39:45.022 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0f
e19306beb1310
2024-09-01 19:39:45.054 | INFO     | __main__:find_latest_checkpoint:466 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c
0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 19:39:45.054 | INFO     | __main__:retrieve_proof:1100 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb
1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 19:39:45.054 | INFO     | __main__:train_test_fisher:606 - Inside train_test_fisher
2024-09-01 19:39:45.055 | INFO     | __main__:train_test_fisher:607 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-01 19:39:49.423 | INFO     | __main__:train_test_fisher:631 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe193
06beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-01 19:39:49.536 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.
jsonl
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:27<00:00, 4262.71it/s]
2024-09-01 19:40:48.504 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 4306.67it/s]
2024-09-01 19:40:49.194 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4904
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 4081.75it/s]
2024-09-01 19:40:49.930 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
Training dataset size after load: 358647
Validation dataset size after load: 4904
Testing dataset size after load: 5431
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python /data/yingzi_ma/lean_project/ReProver/main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-01 19:40:50.022 | INFO     | __main__:train_test_fisher:706 - Starting progressive training from epoch 0 to 1
2024-09-01 19:40:50.022 | INFO     | __main__:train_test_fisher:715 - Finished progressive training at epoch 0
2024-09-01 19:40:50.023 | WARNING  | __main__:train_test_fisher:725 - No best model found. Using the last trained model.
2024-09-01 19:40:50.024 | INFO     | __main__:train_test_fisher:734 - Testing...
2024-09-01 19:40:50.026 | INFO     | retrieval.main:run_cli:55 - PID: 95876
[rank: 0] Seed set to 3407
2024-09-01 19:40:50.297 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1
310/random
2024-09-01 19:40:50.297 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306be
b1310/corpus.jsonl
2024-09-01 19:40:50.898 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.
jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-01 19:41:19.003 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0f
e19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
2024-09-01 19:41:19.050 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0f
e19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-01 19:41:27.639 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-01 19:41:27.639 | INFO     | retrieval.model:reindex_corpus:281 - Inside reindex_corpus
2024-09-01 19:41:27.640 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2776/2776 [16:17<00:00,  2.84it/s]
2024-09-01 19:57:44.761 | INFO     | retrieval.model:reindex_corpus:308 - End of reindex_corpus██████████████████████████████████████████████████████████████████████████████████████| 2776/2776 [16:17<00:00,  1.91it/s]
2024-09-01 19:57:44.761 | INFO     | retrieval.model:reindex_corpus:309 - Embeddings staled end of reindex corpus: False
Predicting DataLoader 0:   0%|                                                                                                                                                                    | 0/85 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0:  13%|████████████████████                                                                                                                                       | 11/85 [00:31<03:30,  0.35it/s]
^C/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...
2024-09-01 19:58:17.005 | INFO     | retrieval.main:run_cli:59 - Configuration:

2024-09-01 19:58:17.227 | INFO     | __main__:train_test_fisher:754 - Loaded the predictions pickle files
2024-09-01 19:58:17.342 | INFO     | __main__:train_test_fisher:757 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/
test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 643743.50it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.                                                      | 0/2421 [00:00<?, ?it/s]
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-09-01 19:58:17.351 | INFO     | __main__:train_test_fisher:759 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-01 19:58:17.353 | INFO     | __main__:train_test_fisher:771 - Average R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-01 19:58:18.773 | INFO     | prover.proof_search:find_latest_checkpoint:308 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240
a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
^CTraceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1245, in <module>
    main()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1221, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1120, in retrieve_proof
    prover = DistributedProver(
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 364, in __init__
    tac_gen = RetrievalAugmentedGenerator.load(
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 142, in load
    return load_checkpoint(cls, ckpt_path, device, freeze, config)
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 482, in load_checkpoint
    model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1581, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 63, in _load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=map_location)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py", line 57, in _load
    return torch.load(f, map_location=map_location)  # type: ignore[arg-type]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line 1097, in load
    return _load(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line 1525, in _load
    result = unpickler.load()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/pickle.py", line 1213, in load
    dispatch[key[0]](self)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/pickle.py", line 1254, in load_binpersid
    self.append(self.persistent_load(pid))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line 1492, in persistent_load
    typed_storage = load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line 1457, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch.UntypedStorage)._typed_storage()._untyped_storage
KeyboardInterrupt
^C^Z
[1]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python fix_safetensors.py
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/fix_safetensors.py", line 1, in <module>
    from loguru import logger
ModuleNotFoundError: No module named 'loguru'
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ conda activate ReProver
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python fix_safetensors.py
[2024-09-01 19:59:03,480] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge
_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-01 19:59:07.615 | INFO     | generator.model:__init__:109 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckp
t
2024-09-01 19:59:07.615 | INFO     | generator.model:__init__:123 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckp
t
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge
_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
tokenizer_config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25.6k/25.6k [00:00<00:00, 166MB/s]
added_tokens.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3.02k/3.02k [00:00<00:00, 36.8MB/s]
special_tokens_map.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3.09k/3.09k [00:00<00:00, 36.3MB/s]
config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 825/825 [00:00<00:00, 10.2MB/s]
model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 871M/871M [00:22<00:00, 38.1MB/s]
tokenizer_config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25.6k/25.6k [00:00<00:00, 161MB/s]
added_tokens.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3.02k/3.02k [00:00<00:00, 37.6MB/s]
special_tokens_map.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3.09k/3.09k [00:00<00:00, 38.6MB/s]
config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 837/837 [00:00<00:00, 10.5MB/s]
model.safetensors: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1.20G/1.20G [00:05<00:00, 226MB/s]
generation_config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 142/142 [00:00<00:00, 1.53MB/s]
2024-09-01 19:59:43.773 | INFO     | generator.model:__init__:136 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'r
etriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encode
r.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.
layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtte
ntion.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', '
retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'ret
riever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer
.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.
layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.we
ight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.Den
seReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q
.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.en
coder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.bl
ock.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0
.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseRelu
Dense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight',
'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.en
coder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.laye
r.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense
.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight
', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encod
er.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.
layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.Se
lfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDens
e.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.enc
oder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight', 'generator.shared.weight', 'generator.encod
er.embed_tokens.weight', 'generator.encoder.block.0.layer.0.SelfAttention.q.weight', 'generator.encoder.block.0.layer.0.SelfAttention.k.weight', 'generator.encoder.block.0.layer.0.SelfAttention.v.weight', 'generator.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'generator.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'generator.encoder.block.0.layer.0.layer_norm.weight', 'generator.encoder.block.0.layer
.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.0.layer.1.layer_norm.weight', 'gen
erator.encoder.block.1.layer.0.SelfAttention.q.weight', 'generator.encoder.block.1.layer.0.SelfAttention.k.weight', 'generator.encoder.block.1.layer.0.SelfAttention.v.weight', 'generator.encoder.block.1.layer.0.SelfAt
tention.o.weight', 'generator.encoder.block.1.layer.0.layer_norm.weight', 'generator.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'generator.enco
der.block.1.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.1.layer.1.layer_norm.weight', 'generator.encoder.block.2.layer.0.SelfAttention.q.weight', 'generator.encoder.block.2.layer.0.SelfAttention.k.weig
ht', 'generator.encoder.block.2.layer.0.SelfAttention.v.weight', 'generator.encoder.block.2.layer.0.SelfAttention.o.weight', 'generator.encoder.block.2.layer.0.layer_norm.weight', 'generator.encoder.block.2.layer.1.De
nseReluDense.wi_0.weight', 'generator.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.2.layer.1.layer_norm.weight', 'generato
r.encoder.block.3.layer.0.SelfAttention.q.weight', 'generator.encoder.block.3.layer.0.SelfAttention.k.weight', 'generator.encoder.block.3.layer.0.SelfAttention.v.weight', 'generator.encoder.block.3.layer.0.SelfAttenti
on.o.weight', 'generator.encoder.block.3.layer.0.layer_norm.weight', 'generator.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.b
lock.3.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.3.layer.1.layer_norm.weight', 'generator.encoder.block.4.layer.0.SelfAttention.q.weight', 'generator.encoder.block.4.layer.0.SelfAttention.k.weight',
'generator.encoder.block.4.layer.0.SelfAttention.v.weight', 'generator.encoder.block.4.layer.0.SelfAttention.o.weight', 'generator.encoder.block.4.layer.0.layer_norm.weight', 'generator.encoder.block.4.layer.1.DenseRe
luDense.wi_0.weight', 'generator.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.4.layer.1.layer_norm.weight', 'generator.enc
oder.block.5.layer.0.SelfAttention.q.weight', 'generator.encoder.block.5.layer.0.SelfAttention.k.weight', 'generator.encoder.block.5.layer.0.SelfAttention.v.weight', 'generator.encoder.block.5.layer.0.SelfAttention.o.
weight', 'generator.encoder.block.5.layer.0.layer_norm.weight', 'generator.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.
5.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.5.layer.1.layer_norm.weight', 'generator.encoder.block.6.layer.0.SelfAttention.q.weight', 'generator.encoder.block.6.layer.0.SelfAttention.k.weight', 'gene
rator.encoder.block.6.layer.0.SelfAttention.v.weight', 'generator.encoder.block.6.layer.0.SelfAttention.o.weight', 'generator.encoder.block.6.layer.0.layer_norm.weight', 'generator.encoder.block.6.layer.1.DenseReluDen
se.wi_0.weight', 'generator.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.6.layer.1.layer_norm.weight', 'generator.encoder.
block.7.layer.0.SelfAttention.q.weight', 'generator.encoder.block.7.layer.0.SelfAttention.k.weight', 'generator.encoder.block.7.layer.0.SelfAttention.v.weight', 'generator.encoder.block.7.layer.0.SelfAttention.o.weigh
t', 'generator.encoder.block.7.layer.0.layer_norm.weight', 'generator.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.7.lay
er.1.DenseReluDense.wo.weight', 'generator.encoder.block.7.layer.1.layer_norm.weight', 'generator.encoder.block.8.layer.0.SelfAttention.q.weight', 'generator.encoder.block.8.layer.0.SelfAttention.k.weight', 'generator
.encoder.block.8.layer.0.SelfAttention.v.weight', 'generator.encoder.block.8.layer.0.SelfAttention.o.weight', 'generator.encoder.block.8.layer.0.layer_norm.weight', 'generator.encoder.block.8.layer.1.DenseReluDense.wi
_0.weight', 'generator.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.8.layer.1.layer_norm.weight', 'generator.encoder.block
.9.layer.0.SelfAttention.q.weight', 'generator.encoder.block.9.layer.0.SelfAttention.k.weight', 'generator.encoder.block.9.layer.0.SelfAttention.v.weight', 'generator.encoder.block.9.layer.0.SelfAttention.o.weight', '
generator.encoder.block.9.layer.0.layer_norm.weight', 'generator.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.9.layer.1.
DenseReluDense.wo.weight', 'generator.encoder.block.9.layer.1.layer_norm.weight', 'generator.encoder.block.10.layer.0.SelfAttention.q.weight', 'generator.encoder.block.10.layer.0.SelfAttention.k.weight', 'generator.en
coder.block.10.layer.0.SelfAttention.v.weight', 'generator.encoder.block.10.layer.0.SelfAttention.o.weight', 'generator.encoder.block.10.layer.0.layer_norm.weight', 'generator.encoder.block.10.layer.1.DenseReluDense.w
i_0.weight', 'generator.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.10.layer.1.layer_norm.weight', 'generator.encoder.b
lock.11.layer.0.SelfAttention.q.weight', 'generator.encoder.block.11.layer.0.SelfAttention.k.weight', 'generator.encoder.block.11.layer.0.SelfAttention.v.weight', 'generator.encoder.block.11.layer.0.SelfAttention.o.we
ight', 'generator.encoder.block.11.layer.0.layer_norm.weight', 'generator.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'generator.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'generator.encoder.block
.11.layer.1.DenseReluDense.wo.weight', 'generator.encoder.block.11.layer.1.layer_norm.weight', 'generator.encoder.final_layer_norm.weight', 'generator.decoder.embed_tokens.weight', 'generator.decoder.block.0.layer.0.S
elfAttention.q.weight', 'generator.decoder.block.0.layer.0.SelfAttention.k.weight', 'generator.decoder.block.0.layer.0.SelfAttention.v.weight', 'generator.decoder.block.0.layer.0.SelfAttention.o.weight', 'generator.de
coder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'generator.decoder.block.0.layer.0.layer_norm.weight', 'generator.decoder.block.0.layer.1.EncDecAttention.q.weight', 'generator.decoder.block.0.laye
r.1.EncDecAttention.k.weight', 'generator.decoder.block.0.layer.1.EncDecAttention.v.weight', 'generator.decoder.block.0.layer.1.EncDecAttention.o.weight', 'generator.decoder.block.0.layer.1.layer_norm.weight', 'genera
tor.decoder.block.0.layer.2.DenseReluDense.wi_0.weight', 'generator.decoder.block.0.layer.2.DenseReluDense.wi_1.weight', 'generator.decoder.block.0.layer.2.DenseReluDense.wo.weight', 'generator.decoder.block.0.layer.2
.layer_norm.weight', 'generator.decoder.block.1.layer.0.SelfAttention.q.weight', 'generator.decoder.block.1.layer.0.SelfAttention.k.weight', 'generator.decoder.block.1.layer.0.SelfAttention.v.weight', 'generator.decod
er.block.1.layer.0.SelfAttention.o.weight', 'generator.decoder.block.1.layer.0.layer_norm.weight', 'generator.decoder.block.1.layer.1.EncDecAttention.q.weight', 'generator.decoder.block.1.layer.1.EncDecAttention.k.wei
ght', 'generator.decoder.block.1.layer.1.EncDecAttention.v.weight', 'generator.decoder.block.1.layer.1.EncDecAttention.o.weight', 'generator.decoder.block.1.layer.1.layer_norm.weight', 'generator.decoder.block.1.layer
.2.DenseReluDense.wi_0.weight', 'generator.decoder.block.1.layer.2.DenseReluDense.wi_1.weight', 'generator.decoder.block.1.layer.2.DenseReluDense.wo.weight', 'generator.decoder.block.1.layer.2.layer_norm.weight', 'gen
erator.decoder.block.2.layer.0.SelfAttention.q.weight', 'generator.decoder.block.2.layer.0.SelfAttention.k.weight', 'generator.decoder.block.2.layer.0.SelfAttention.v.weight', 'generator.decoder.block.2.layer.0.SelfAt
tention.o.weight', 'generator.decoder.block.2.layer.0.layer_norm.weight', 'generator.decoder.block.2.layer.1.EncDecAttention.q.weight', 'generator.decoder.block.2.layer.1.EncDecAttention.k.weight', 'generator.decoder.
block.2.layer.1.EncDecAttention.v.weight', 'generator.decoder.block.2.layer.1.EncDecAttention.o.weight', 'generator.decoder.block.2.layer.1.layer_norm.weight', 'generator.decoder.block.2.layer.2.DenseReluDense.wi_0.we
ight', 'generator.decoder.block.2.layer.2.DenseReluDense.wi_1.weight', 'generator.decoder.block.2.layer.2.DenseReluDense.wo.weight', 'generator.decoder.block.2.layer.2.layer_norm.weight', 'generator.decoder.block.3.la
yer.0.SelfAttention.q.weight', 'generator.decoder.block.3.layer.0.SelfAttention.k.weight', 'generator.decoder.block.3.layer.0.SelfAttention.v.weight', 'generator.decoder.block.3.layer.0.SelfAttention.o.weight', 'gener
ator.decoder.block.3.layer.0.layer_norm.weight', 'generator.decoder.block.3.layer.1.EncDecAttention.q.weight', 'generator.decoder.block.3.layer.1.EncDecAttention.k.weight', 'generator.decoder.block.3.layer.1.EncDecAtt
ention.v.weight', 'generator.decoder.block.3.layer.1.EncDecAttention.o.weight', 'generator.decoder.block.3.layer.1.layer_norm.weight', 'generator.decoder.block.3.layer.2.DenseReluDense.wi_0.weight', 'generator.decoder
.block.3.layer.2.DenseReluDense.wi_1.weight', 'generator.decoder.block.3.layer.2.DenseReluDense.wo.weight', 'generator.decoder.block.3.layer.2.layer_norm.weight', 'generator.decoder.final_layer_norm.weight', 'generato
r.lm_head.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['encoder.shared.weight', 'encoder.enc
oder.block.0.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.0.layer.0.SelfAttention.o.weight
', 'encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'encoder.encoder.block.0.layer.0.layer_norm.weight', 'encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.bl
ock.0.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.0.layer.1.layer_norm.weight', 'encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'en
coder.encoder.block.1.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.1.layer.0.layer_norm.we
ight', 'encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.1.l
ayer.1.layer_norm.weight', 'encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'encoder.encoder
.block.2.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.2.layer.0.layer_norm.weight', 'encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight'
, 'encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.2.layer.1.layer_norm.weight', 'encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.3.layer.0.SelfAttenti
on.k.weight', 'encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.3.layer.0.layer_norm.weight', 'encoder.encoder.block.3.layer.1.D
enseReluDense.wi_0.weight', 'encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.3.layer.1.layer_norm.weight', 'encoder.encod
er.block.4.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.4.layer.0.SelfAttention.o.weight',
 'encoder.encoder.block.4.layer.0.layer_norm.weight', 'encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.4.layer.1.DenseR
eluDense.wo.weight', 'encoder.encoder.block.4.layer.1.layer_norm.weight', 'encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.5.la
yer.0.SelfAttention.v.weight', 'encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.5.layer.0.layer_norm.weight', 'encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'encoder.enco
der.block.5.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.5.layer.1.layer_norm.weight', 'encoder.encoder.block.6.layer.0.SelfAttention.q.weight
', 'encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.6.layer.0.layer_n
orm.weight', 'encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.blo
ck.6.layer.1.layer_norm.weight', 'encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'encoder.e
ncoder.block.7.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.7.layer.0.layer_norm.weight', 'encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.w
eight', 'encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.7.layer.1.layer_norm.weight', 'encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.8.layer.0.SelfA
ttention.k.weight', 'encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.8.layer.0.layer_norm.weight', 'encoder.encoder.block.8.lay
er.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.8.layer.1.layer_norm.weight', 'encoder
.encoder.block.9.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.9.layer.0.SelfAttention.o.we
ight', 'encoder.encoder.block.9.layer.0.layer_norm.weight', 'encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.9.layer.1.
DenseReluDense.wo.weight', 'encoder.encoder.block.9.layer.1.layer_norm.weight', 'encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'encoder.encoder.bl
ock.10.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'encoder.encoder.block.10.layer.0.layer_norm.weight', 'encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', '
encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'encoder.encoder.block.10.layer.1.layer_norm.weight', 'encoder.encoder.block.11.layer.0.SelfAt
tention.q.weight', 'encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'encoder.encoder.bloc
k.11.layer.0.layer_norm.weight', 'encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight
', 'encoder.encoder.block.11.layer.1.layer_norm.weight', 'encoder.encoder.final_layer_norm.weight', 'encoder.encoder.embed_tokens.weight']
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$
