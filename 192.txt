2024-10-30 02:47:56.103 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-30 02:47:56.103 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-10-30 02:47:56.103 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-10-30 02:48:23.294 | INFO     | __main__:main:1537 - Adding repo to repos_for_merged_dataset
2024-10-30 02:48:23.295 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.295 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-10-30 02:48:23.295 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744 already exists. Removing it now.
2024-10-30 02:48:23.319 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 02:48:23.322 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 02:48:23.323 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 02:48:23.324 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 02:48:23.324 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.324 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-10-30 02:48:23.324 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147 already exists. Removing it now.
2024-10-30 02:48:23.348 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 02:48:23.349 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 02:48:23.350 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 02:48:23.350 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 02:48:23.351 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.351 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-10-30 02:48:23.351 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687 already exists. Removing it now.
2024-10-30 02:48:23.373 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 02:48:23.374 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 02:48:23.375 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 02:48:23.376 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 02:48:23.376 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.376 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-10-30 02:48:23.376 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566 already exists. Rem
oving it now.
2024-10-30 02:48:23.399 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66
2024-10-30 02:48:23.400 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f99
16ae24253d566
2024-10-30 02:48:23.401 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2
4253d566
2024-10-30 02:48:23.402 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566
2024-10-30 02:48:23.402 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.402 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-10-30 02:48:23.402 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091 already exists. Removing it now
.
2024-10-30 02:48:23.424 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-10-30 02:48:23.425 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f09
1
2024-10-30 02:48:23.426 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-10-30 02:48:23.426 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-10-30 02:48:23.427 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.427 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-10-30 02:48:23.427 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0 already exists. Removing it now.
2024-10-30 02:48:23.448 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 02:48:23.449 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 02:48:23.450 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 02:48:23.451 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 02:48:23.451 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.451 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-10-30 02:48:23.451 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already exists
. Removing it now.
2024-10-30 02:48:23.473 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5
2024-10-30 02:48:23.474 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5
2024-10-30 02:48:23.475 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5
2024-10-30 02:48:23.476 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5
76389ecf5
2024-10-30 02:48:23.476 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.476 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-10-30 02:48:23.476 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f already exists. Remo
ving it now.
2024-10-30 02:48:23.498 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f
2024-10-30 02:48:23.499 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e
7882f564669f
2024-10-30 02:48:23.500 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f
2024-10-30 02:48:23.500 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f5646
69f
2024-10-30 02:48:23.500 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.501 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-10-30 02:48:23.501 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21 already exists. Removing it no
w.
2024-10-30 02:48:23.522 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
2024-10-30 02:48:23.523 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c
21
2024-10-30 02:48:23.524 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
2024-10-30 02:48:23.525 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
2024-10-30 02:48:23.525 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.525 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-10-30 02:48:23.525 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8 already exists. Removing it no
w.
2024-10-30 02:48:23.546 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
2024-10-30 02:48:23.547 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86b
b8
2024-10-30 02:48:23.548 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
2024-10-30 02:48:23.549 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
2024-10-30 02:48:23.549 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.549 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-10-30 02:48:23.549 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f already exists. Removing it now
.
2024-10-30 02:48:23.570 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f
2024-10-30 02:48:23.571 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0
f
2024-10-30 02:48:23.571 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f
2024-10-30 02:48:23.572 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f
2024-10-30 02:48:23.572 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.572 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-10-30 02:48:23.572 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d already exists. Removi
ng it now.
2024-10-30 02:48:23.592 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d
2024-10-30 02:48:23.593 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1
baf261445d
2024-10-30 02:48:23.594 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf26
1445d
2024-10-30 02:48:23.595 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445
d
2024-10-30 02:48:23.595 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.595 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-10-30 02:48:23.595 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856 already exists. Removing it now.
2024-10-30 02:48:23.615 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 02:48:23.617 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 02:48:23.618 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 02:48:23.618 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 02:48:23.619 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.619 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-10-30 02:48:23.619 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a already exists. Removing it now.
2024-10-30 02:48:23.640 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 02:48:23.641 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 02:48:23.642 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 02:48:23.643 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 02:48:23.643 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.643 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-10-30 02:48:23.643 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3 already exists. Removing it n
ow.
2024-10-30 02:48:23.664 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3
2024-10-30 02:48:23.665 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad
3a3
2024-10-30 02:48:23.666 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3
2024-10-30 02:48:23.666 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3
2024-10-30 02:48:23.667 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:48:23.667 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-30 02:49:13.086 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00 already exists. Removing it
 now.
2024-10-30 02:49:22.680 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00
2024-10-30 02:49:23.069 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7
abd00
2024-10-30 02:49:23.077 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00
2024-10-30 02:49:23.078 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00
2024-10-30 02:49:23.090 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:49:23.090 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-30 02:50:16.315 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37 already exists. Removing it now.
2024-10-30 02:50:27.119 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 02:50:27.466 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 02:50:27.474 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 02:50:27.475 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 02:50:27.488 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 02:50:27.488 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-30 02:51:16.158 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b already exists. Removing it now.
2024-10-30 02:51:25.621 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 02:51:25.965 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 02:51:25.974 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 02:51:25.975 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 02:51:25.987 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:51:25.987 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:51:25.988 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:51:25.988 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:51:25.988 | INFO     | __main__:main:1581 - Starting training at epoch 18
[rank: 0] Seed set to 3407
2024-10-30 02:51:29.185 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python mainfull.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-30 02:51:29.299 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:51:29.300 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 02:51:35.778 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:51:35.790 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:51:35.804 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 02:51:35.804 | INFO     | __main__:main:1692 - Training dataset size after load: 150559
2024-10-30 02:51:35.804 | INFO     | __main__:main:1693 - Validation dataset size after load: 2109
2024-10-30 02:51:35.804 | INFO     | __main__:main:1694 - Testing dataset size after load: 2448
2024-10-30 02:51:35.804 | INFO     | __main__:main:1696 - Starting progressive training from epoch 18 to 19
2024-10-30 02:51:35.804 | INFO     | __main__:main:1699 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-10-30 02:51:41,876] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-30 02:51:41,876] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-30 02:51:41,876] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-30 02:51:45.344 | INFO     | __main__:main:1317 - Running progressive training
2024-10-30 02:51:45.344 | INFO     | __main__:main:1317 - Running progressive training
2024-10-30 02:51:45.344 | INFO     | __main__:main:1317 - Running progressive training
2024-10-30 02:51:45.344 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-30 02:51:45.344 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-30 02:51:45.344 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-30 02:51:45.347 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-30 02:51:45.347 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-30 02:51:45.347 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-30 02:51:45.347 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-30 02:51:45.347 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-30 02:51:45.347 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-30 02:51:45.347 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-30 02:51:45.347 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-30 02:51:45.347 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-30 02:51:45.347 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-30 02:51:45.347 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-30 02:51:45.347 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-30 02:51:45.347 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-30 02:51:45.347 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-30 02:51:45.347 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-30 02:51:45.807 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-30 02:51:45.807 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-30 02:51:45.809 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-30 02:52:05.192 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-30 02:52:05.192 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-30 02:52:05.566 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-30 02:52:25.931 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-30 02:52:25.932 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-30 02:52:26.858 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-30 02:52:44.770 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 02:52:44.770 | INFO     | __main__:main:1508 - i: 0
2024-10-30 02:52:44.770 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:52:44.772 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:52:44.772 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:52:44.772 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:52:44.772 | INFO     | __main__:main:1581 - Starting training at epoch 18
[rank: 1] Seed set to 3407
2024-10-30 02:52:45.136 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 02:52:45.137 | INFO     | __main__:main:1508 - i: 0
2024-10-30 02:52:45.137 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:52:45.137 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:52:45.137 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:52:45.137 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:52:45.137 | INFO     | __main__:main:1581 - Starting training at epoch 18
[rank: 2] Seed set to 3407
2024-10-30 02:52:45.889 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 02:52:45.890 | INFO     | __main__:main:1508 - i: 0
2024-10-30 02:52:45.890 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:52:45.891 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:52:45.891 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:52:45.891 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:52:45.891 | INFO     | __main__:main:1581 - Starting training at epoch 18
[rank: 3] Seed set to 3407
2024-10-30 02:52:47.568 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
2024-10-30 02:52:47.685 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:52:47.685 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 02:52:47.727 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
2024-10-30 02:52:47.769 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:52:47.769 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 02:52:48.536 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
2024-10-30 02:52:48.583 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:52:48.583 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 02:52:57.810 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:52:57.822 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:52:57.836 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 02:52:57.836 | INFO     | __main__:main:1692 - Training dataset size after load: 150559
2024-10-30 02:52:57.837 | INFO     | __main__:main:1693 - Validation dataset size after load: 2109
2024-10-30 02:52:57.837 | INFO     | __main__:main:1694 - Testing dataset size after load: 2448
2024-10-30 02:52:57.837 | INFO     | __main__:main:1696 - Starting progressive training from epoch 18 to 19
2024-10-30 02:52:57.837 | INFO     | __main__:main:1699 - hit the barrier before training
2024-10-30 02:52:57.901 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:52:57.944 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:52:57.958 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 02:52:57.958 | INFO     | __main__:main:1692 - Training dataset size after load: 150559
2024-10-30 02:52:57.959 | INFO     | __main__:main:1693 - Validation dataset size after load: 2109
2024-10-30 02:52:57.959 | INFO     | __main__:main:1694 - Testing dataset size after load: 2448
2024-10-30 02:52:57.959 | INFO     | __main__:main:1696 - Starting progressive training from epoch 18 to 19
2024-10-30 02:52:57.959 | INFO     | __main__:main:1699 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-10-30 02:52:59.149 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:52:59.161 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:52:59.173 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 02:52:59.173 | INFO     | __main__:main:1692 - Training dataset size after load: 150559
2024-10-30 02:52:59.174 | INFO     | __main__:main:1693 - Validation dataset size after load: 2109
2024-10-30 02:52:59.174 | INFO     | __main__:main:1694 - Testing dataset size after load: 2448
2024-10-30 02:52:59.174 | INFO     | __main__:main:1696 - Starting progressive training from epoch 18 to 19
2024-10-30 02:52:59.174 | INFO     | __main__:main:1699 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-10-30 02:53:00.819 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:53:00.915 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:53:00.936 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full exists and is not empty.
2024-10-30 02:53:03.724 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
2024-10-30 02:53:03.793 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:53:03.810 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:53:03.825 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 02:53:03.857 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 02:53:03.876 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:53:03.891 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
Training dataset size: 150559
2024-10-30 02:53:03.934 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_val/cached_data.pkl
Validation dataset size: 2109
2024-10-30 02:53:03.948 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-30 02:53:05.324 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-30 02:53:05.324 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-30 02:53:05.325 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-30 02:53:05.326 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params | Mode
---------------------------------------------------
0 | encoder | T5EncoderModel | 217 M  | train
---------------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
235       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
`Trainer.fit` stopped: `max_epochs=19` reached.
2024-10-30 02:53:08.868 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 02:53:08.889 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 02:53:08.896 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 02:53:09.057 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 02:53:09.057 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 02:53:09.057 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 02:53:09.057 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 02:53:09.057 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 02:53:09.058 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:09.058 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:11.632 | INFO     | __main__:main:1804 - Starting the prover
2024-10-30 02:53:11.632 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-10-30 02:53:11.632 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-10-30 02:53:11.632 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-10-30 02:53:11.638 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f619
9856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:11.651 | INFO     | __main__:main:1857 - Finished processing the repository
2024-10-30 02:53:11.651 | INFO     | __main__:main:1859 - current epoch: 19
2024-10-30 02:53:11.651 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 02:53:11.652 | INFO     | __main__:main:1508 - i: 1
2024-10-30 02:53:11.652 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:53:11.653 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:11.653 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:11.653 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:53:11.653 | INFO     | __main__:main:1581 - Starting training at epoch 19
[rank: 1] Seed set to 3407
2024-10-30 02:53:11.656 | INFO     | __main__:main:1857 - Finished processing the repository
2024-10-30 02:53:11.656 | INFO     | __main__:main:1859 - current epoch: 19
2024-10-30 02:53:11.656 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 02:53:11.656 | INFO     | __main__:main:1508 - i: 1
2024-10-30 02:53:11.656 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:53:11.665 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:11.666 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:11.666 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:53:11.666 | INFO     | __main__:main:1581 - Starting training at epoch 19
[rank: 2] Seed set to 3407
2024-10-30 02:53:11.948 | INFO     | __main__:main:1857 - Finished processing the repository
2024-10-30 02:53:11.949 | INFO     | __main__:main:1859 - current epoch: 19
2024-10-30 02:53:11.949 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 02:53:11.949 | INFO     | __main__:main:1508 - i: 1
2024-10-30 02:53:11.949 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 02:53:11.965 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:11.965 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 02:53:11.965 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 02:53:11.965 | INFO     | __main__:main:1581 - Starting training at epoch 19
[rank: 3] Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-10-30 02:53:12.659 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epo
ch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:12.660 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epo
ch=19-Recall@10_val=81.44.ckpt
2024-10-30 02:53:13.981 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
2024-10-30 02:53:14.006 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
2024-10-30 02:53:14.091 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:53:14.091 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:53:14.151 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
2024-10-30 02:53:14.190 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 02:53:15.999 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-10-30 02:53:16.668 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-10-30 02:53:16.669 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-10-30 02:53:16.669 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-10-30 02:53:22.019 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-10-30 02:53:22.019 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3988/3988 [05:29<00:00, 12.09it/s]
2024-10-30 02:58:51.942 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-10-30 02:58:51.942 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-10-30 02:58:55,833 INFO worker.py:1777 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=1603757) [2024-10-30 02:59:39,433] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1603757) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=1603757)   return torch.load(io.BytesIO(b))
(pid=1603975) [2024-10-30 02:59:54,005] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1603975) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=1603975)   return torch.load(io.BytesIO(b))
(pid=1603488) [2024-10-30 03:00:11,922] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-30 03:00:13.233 | INFO     | __main__:prove_sorry_theorems:882 - Found 14 sorry theorems to prove
Processing theorems from NUS-Math-Formalization/coxeter:   0%|                                                                                                                               | 0/14 [00:00<?, ?theorem/s]2024-10-30 03:00:13.233 | I
NFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterGroup.Bruhat.fin_list_complement_incr
2024-10-30 03:00:13.233 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.Presentation.reduced_iff
2024-10-30 03:00:13.233 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.monoidLift.mapLift.of
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterGroup.Bruhat.fin_list_complement_loop_bound
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.Presentation.invmap_injective
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.strong_exchange
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.Presentation.invmap_surjective
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterGroup.Bruhat.le_iff_exists_reduced_subword
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.monoidLift.aux_symm_of_power
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterGroup.Bruhat.le_aux
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterSystem.Presentation.length_eq
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for CoxeterSystem.Presentation.gprod_eq
2024-10-30 03:00:13.234 | INFO     | __main__:prove_sorry_theorems:906 - Position: (170, 1)
2024-10-30 03:00:13.235 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterGroup.Bruhat.exists_intermediate_reduced_subword
2024-10-30 03:00:13.235 | INFO     | __main__:prove_sorry_theorems:895 - Skipping already encountered theorem: CoxeterGroup.Bruhat.fin_list_complement_complement
Processing theorems from NUS-Math-Formalization/coxeter: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 8891.62theorem/s]
2024-10-30 03:00:13.235 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=1603488) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=1603488)   return torch.load(io.BytesIO(b))
(pid=1603504) [2024-10-30 03:00:22,243] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1603504) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
 module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by th
e user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimen
tal feature.
(ProverActor pid=1603504)   return torch.load(io.BytesIO(b))
(ProverActor pid=1603504) 2024-10-30 03:00:39.873 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_pa
th=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.gprod_eq')
(ProverActor pid=1603504) 2024-10-30 03:11:27.972 | INFO     | prover.proof_search:_best_first_search:149 - 6919894.600759929
(ProverActor pid=1603504) 2024-10-30 03:11:27.972 | INFO     | prover.proof_search:_best_first_search:150 - 6919294.603564391
(ProverActor pid=1603504) 2024-10-30 03:11:27.972 | INFO     | prover.proof_search:_best_first_search:151 - 599.9975934959948
(ProverActor pid=1603504) 2024-10-30 03:11:27.972 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=1603504) 2024-10-30 03:11:27.976 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-10-30 03:11:34.947 | INFO     | __main__:process_theorem_batch:828 - No proof found for CoxeterSystem.Presentation.gprod_eq
(ProverActor pid=1603504) 2024-10-30 03:11:34.944 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389
a97'), file_path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.gprod_eq'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=526.7549320040271, environment_time=37.34258924610913, total_time=601.000813850201
7, num_total_nodes=347, num_searched_nodes=13)
2024-10-30 03:13:40.066 | INFO     | __main__:save_progress:837 - Saving encountered theorems...
2024-10-30 03:13:40.070 | INFO     | __main__:prove_sorry_theorems:933 - Finished attempting to prove sorry theorems
2024-10-30 03:14:20.613 | INFO     | __main__:main:1838 - Finished searching for proofs of sorry theorems
2024-10-30 03:14:20.614 | INFO     | __main__:main:1857 - Finished processing the repository
2024-10-30 03:14:20.614 | INFO     | __main__:main:1859 - current epoch: 19
2024-10-30 03:14:20.614 | INFO     | __main__:main:1507 - length of lean_git_repos: 5
2024-10-30 03:14:20.614 | INFO     | __main__:main:1508 - i: 1
2024-10-30 03:14:20.614 | INFO     | __main__:main:1514 - Main process
2024-10-30 03:14:20.614 | INFO     | __main__:main:1515 - Using lambda = 0.1
2024-10-30 03:14:20.614 | INFO     | __main__:main:1516 - Processing https://github.com/m4lvin/lean4-pdl
2024-10-30 03:14:20.614 | INFO     | __main__:add_repo_to_database:956 - Processing https://github.com/m4lvin/lean4-pdl.git
2024-10-30 03:14:20.614 | INFO     | __main__:add_repo_to_database:1036 - Found compatible commit c7f649fe3c4891cf1a01c120e82ebc5f6199856e for https://github.com/m4lvin/lean4-pdl.git
2024-10-30 03:14:20.614 | INFO     | __main__:add_repo_to_database:1037 - Lean version: v4.8.0
2024-10-30 03:14:20.615 | INFO     | __main__:add_repo_to_database:1042 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-10-30 03:14:20.615 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-10-30 03:14:20.617 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-10-30 03:14:20.617 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-10-30 03:14:20.617 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-10-30 03:14:20.720 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-10-30 03:14:20.720 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/m4lvin/lean4-pdl', commit='c7f649fe3c4891cf1a01c120e82ebc5f6199856e')
2024-10-30 03:14:20.721 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-10-30 03:14:20.727 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-30 03:14:20.727 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-10-30 03:14:20.727 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-10-30 03:14:20.732 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-10-30 03:14:20.732 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/m4lvin-lean4-pdl-c7f649fe3c4891cf1a01c120e82ebc5f6199856e/lean4-pdl
2024-10-30 03:14:21.686 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1125 - Loading 1706 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/m4lvin-lean4-pdl-c7f649fe3c4891cf1a01c120e82ebc5f6199856e/lean4-pd
l with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1706/1706 [03:25<00:00,  8.31it/s]
2024-10-30 03:17:46.924 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/m4lvin/lean4-pdl', commit='c7f649fe3c4891cf1a01c120e82ebc5f6199856e')
2024-10-30 03:17:48.331 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-30 03:17:49.470 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-30 03:17:52.297 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='801cc3e5f1f0b2dedcbe4166b7ca9ca98673eae6')
2024-10-30 03:18:00.065 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1010 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/m4lvin/lean4-pdl', commit='c7f649fe3c4891cf1a01c120e82ebc5f6199856e'), dep
endencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='01d414ac36dc28f3e424dabd36d818873fea655c'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='eb6c831c05bc6ca6d37454ca975
31a9b780dfcb5'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='1357f4f49450abb9dfd4783e38219f4ce84f9785'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='9ac12945862fa39eab779
5c2f79bb9aa0c8e332c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='baa65c6339a56bd22b7292aa4511c54b3cc7a6af'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf103
0dc2ae6b3632c84a09350b675ef3e347d0'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='801cc3e5f1f0b2dedcbe4166b7ca9ca98673eae6'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/imp
ort-graph', commit='1968db816bea6683ed2325b4995b22675c37a5df'), 'LeanSearchClient': LeanGitRepo(url='https://github.com/leanprover-community/LeanSearchClient', commit='7bedaed1ef024add1e171cc17706b012a9a37802')}, root_dir=PosixPath('/data/yingz
i_ma/lean_project/.cache/lean_dojo/m4lvin-lean4-pdl-c7f649fe3c4891cf1a01c120e82ebc5f6199856e/lean4-pdl'))
2024-10-30 03:18:08.606 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-10-30 03:18:08.607 | WARNING  | generate_benchmark_lean4:safe_remove_dir:281 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e already exists. Removing it now.
2024-10-30 03:18:12.248 | INFO     | generate_benchmark_lean4:split_data:133 - 20599 theorems in total
2024-10-30 03:18:12.248 | INFO     | generate_benchmark_lean4:split_data:138 - 20599 theorems in total, with 411 for validation and 411 for testing
2024-10-30 03:18:12.248 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-10-30 03:18:12.255 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-10-30 03:18:13.616 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-10-30 03:18:17.203 | INFO     | generate_benchmark_lean4:export_proofs:202 - 19777 theorems and 25204 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/rand
om/train.json
2024-10-30 03:18:17.334 | INFO     | generate_benchmark_lean4:export_proofs:202 - 411 theorems and 553 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/v
al.json
2024-10-30 03:18:17.417 | INFO     | generate_benchmark_lean4:export_proofs:202 - 411 theorems and 417 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/t
est.json
2024-10-30 03:18:21.023 | INFO     | generate_benchmark_lean4:export_proofs:202 - 19777 theorems and 24249 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/nove
l_premises/train.json
2024-10-30 03:18:21.170 | INFO     | generate_benchmark_lean4:export_proofs:202 - 411 theorems and 1007 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/novel_p
remises/val.json
2024-10-30 03:18:21.279 | INFO     | generate_benchmark_lean4:export_proofs:202 - 411 theorems and 918 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/novel_pr
emises/test.json
2024-10-30 03:18:21.279 | INFO     | generate_benchmark_lean4:export_proofs:206 - 41198 theorems saved in total
2024-10-30 03:18:21.280 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-10-30 03:18:28.871 | INFO     | generate_benchmark_lean4:export_premises:229 - 46400 theorems/definitions from 1706 files saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6
199856e/corpus.jsonl
2024-10-30 03:18:28.881 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-10-30 03:18:28.882 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-10-30 03:18:28.882 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-10-30 03:18:28.899 | INFO     | __main__:add_repo_to_database:1050 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 411/411 [00:00<00:00, 53544.31it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19777/19777 [00:00<00:00, 51528.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 411/411 [00:00<00:00, 58441.84it/s]
2024-10-30 03:18:29.905 | INFO     | __main__:add_repo_to_database:1075 - Before adding new repo:
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-10-30 03:18:29.906 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-10-30 03:18:29.906 | INFO     | dynamic_database:add_repository:605 - Repository 'https://github.com/m4lvin/lean4-pdl' with commit 'c7f649fe3c4891cf1a01c120e82ebc5f6199856e' already exists in the database.
2024-10-30 03:18:29.906 | INFO     | __main__:add_repo_to_database:1078 - After adding new repo:
2024-10-30 03:18:29.906 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-30 03:18:29.907 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-30 03:18:29.907 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-30 03:18:29.907 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-30 03:18:29.907 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-10-30 03:18:29.907 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-10-30 03:19:10.860 | INFO     | __main__:main:1537 - Adding repo to repos_for_merged_dataset
2024-10-30 03:19:10.864 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:10.864 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-10-30 03:19:10.864 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744 already exists. Removing it now.
2024-10-30 03:19:10.887 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 03:19:10.888 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 03:19:10.889 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 03:19:10.890 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744
2024-10-30 03:19:10.890 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:10.890 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-10-30 03:19:10.890 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147 already exists. Removing it now.
2024-10-30 03:19:10.910 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 03:19:10.911 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 03:19:10.912 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 03:19:10.913 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147
2024-10-30 03:19:10.914 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:10.914 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-10-30 03:19:10.914 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687 already exists. Removing it now.
2024-10-30 03:19:10.935 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 03:19:10.936 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 03:19:10.937 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 03:19:10.938 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
2024-10-30 03:19:10.938 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:10.938 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-10-30 03:19:10.938 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566 already exists. Rem
oving it now.
2024-10-30 03:19:10.958 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66
2024-10-30 03:19:10.959 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f99
16ae24253d566
2024-10-30 03:19:10.960 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2
4253d566
2024-10-30 03:19:10.961 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566
2024-10-30 03:19:10.962 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:10.962 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-10-30 03:19:10.962 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091 already exists. Removing it now
.
2024-10-30 03:19:10.982 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-10-30 03:19:10.983 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f09
1
2024-10-30 03:19:10.984 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-10-30 03:19:10.985 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091
2024-10-30 03:19:10.985 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:10.985 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/google-deepmind/debate (commit: de3a6e500ae1a65dfeea2f91ef519ebad9704be0)
2024-10-30 03:19:10.986 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0 already exists. Removing it now.
2024-10-30 03:19:11.005 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 03:19:11.006 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 03:19:11.007 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 03:19:11.008 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0
2024-10-30 03:19:11.008 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.008 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-10-30 03:19:11.009 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already exists
. Removing it now.
2024-10-30 03:19:11.029 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5
2024-10-30 03:19:11.030 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08
4411853a576389ecf5
2024-10-30 03:19:11.031 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5
2024-10-30 03:19:11.032 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a5
76389ecf5
2024-10-30 03:19:11.032 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.032 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-10-30 03:19:11.032 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f already exists. Remo
ving it now.
2024-10-30 03:19:11.052 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f
2024-10-30 03:19:11.053 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e
7882f564669f
2024-10-30 03:19:11.054 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f
2024-10-30 03:19:11.055 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f5646
69f
2024-10-30 03:19:11.055 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.055 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-10-30 03:19:11.055 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21 already exists. Removing it no
w.
2024-10-30 03:19:11.076 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
2024-10-30 03:19:11.077 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c
21
2024-10-30 03:19:11.078 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
2024-10-30 03:19:11.079 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21
2024-10-30 03:19:11.080 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.080 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-10-30 03:19:11.080 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8 already exists. Removing it no
w.
2024-10-30 03:19:11.100 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
2024-10-30 03:19:11.101 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86b
b8
2024-10-30 03:19:11.102 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
2024-10-30 03:19:11.103 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8
2024-10-30 03:19:11.103 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.104 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-10-30 03:19:11.104 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f already exists. Removing it now
.
2024-10-30 03:19:11.124 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f
2024-10-30 03:19:11.125 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0
f
2024-10-30 03:19:11.126 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f
2024-10-30 03:19:11.127 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f
2024-10-30 03:19:11.127 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.127 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-10-30 03:19:11.127 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d already exists. Removi
ng it now.
2024-10-30 03:19:11.148 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d
2024-10-30 03:19:11.149 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1
baf261445d
2024-10-30 03:19:11.150 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf26
1445d
2024-10-30 03:19:11.151 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445
d
2024-10-30 03:19:11.151 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.152 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-10-30 03:19:11.152 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856 already exists. Removing it now.
2024-10-30 03:19:11.171 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 03:19:11.172 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 03:19:11.173 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 03:19:11.174 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856
2024-10-30 03:19:11.174 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.174 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/siddhartha-gadgil/Saturn (commit: 3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a)
2024-10-30 03:19:11.174 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a already exists. Removing it now.
2024-10-30 03:19:11.194 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 03:19:11.195 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 03:19:11.196 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 03:19:11.197 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a
2024-10-30 03:19:11.197 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.198 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-10-30 03:19:11.198 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3 already exists. Removing it n
ow.
2024-10-30 03:19:11.217 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3
2024-10-30 03:19:11.218 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad
3a3
2024-10-30 03:19:11.219 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3
2024-10-30 03:19:11.219 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3
2024-10-30 03:19:11.220 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:19:11.220 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-30 03:20:16.180 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00 already exists. Removing it
 now.
2024-10-30 03:20:31.170 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00
2024-10-30 03:20:31.733 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7
abd00
2024-10-30 03:20:31.744 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00
2024-10-30 03:20:31.746 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00
2024-10-30 03:20:31.761 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:20:31.762 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-30 03:21:33.537 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37 already exists. Removing it now.
2024-10-30 03:22:29.183 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 03:22:29.812 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 03:22:29.826 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 03:22:29.828 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-30 03:22:29.850 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:22:29.850 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-30 03:23:27.463 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b already exists. Removing it now.
2024-10-30 03:23:44.077 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 03:23:44.607 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 03:23:44.619 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 03:23:44.621 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-30 03:23:44.637 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-30 03:23:44.637 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-10-30 03:23:48.885 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e already exists. Removing it now
.
2024-10-30 03:23:52.265 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e
2024-10-30 03:23:52.482 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856
e
2024-10-30 03:23:52.489 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e
2024-10-30 03:23:52.491 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e
2024-10-30 03:23:52.495 | INFO     | __main__:main:1567 - All GPUs
2024-10-30 03:23:52.497 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:23:52.497 | INFO     | __main__:main:1574 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 03:23:52.497 | INFO     | __main__:main:1580 - Inside train_test_fisher
2024-10-30 03:23:52.497 | INFO     | __main__:main:1581 - Starting training at epoch 19
[rank: 0] Seed set to 3407
2024-10-30 03:23:54.035 | INFO     | __main__:main:1605 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Rec
all@10_val=81.44.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python mainfull.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-30 03:23:54.157 | INFO     | __main__:main:1663 - right before barrier for data module
2024-10-30 03:23:54.158 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-10-30 03:23:54.158 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-10-30 03:23:54.158 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-10-30 03:23:54.158 | INFO     | __main__:main:1678 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19777/19777 [00:02<00:00, 9273.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19777/19777 [00:02<00:00, 9437.87it/s]
2024-10-30 03:24:01.917 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/ran
dom/cache_train/cached_data.pkl
Training dataset size: 28855
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 411/411 [00:00<00:00, 6790.59it/s]
2024-10-30 03:24:01.993 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/ran
dom/cache_val/cached_data.pkl
Validation dataset size: 450
  0%|                                                                                                                                                                                            | 0/411 [00:00<?, ?it/s]2024-10-30 03:24:02.032 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/cache_train/cached_data
.pkl
Training dataset size: 28855
2024-10-30 03:24:02.036 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 411/411 [00:00<00:00, 6480.43it/s]
2024-10-30 03:24:02.073 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 500
2024-10-30 03:24:02.073 | INFO     | __main__:main:1692 - Training dataset size after load: 28855
2024-10-30 03:24:02.073 | INFO     | __main__:main:1693 - Validation dataset size after load: 450
2024-10-30 03:24:02.073 | INFO     | __main__:main:1694 - Testing dataset size after load: 500
2024-10-30 03:24:02.073 | INFO     | __main__:main:1696 - Starting progressive training from epoch 19 to 20
2024-10-30 03:24:02.073 | INFO     | __main__:main:1699 - hit the barrier before training
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 411/411 [00:00<00:00, 8795.06it/s]
2024-10-30 03:24:02.095 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 500
2024-10-30 03:24:02.096 | INFO     | __main__:main:1692 - Training dataset size after load: 28855
2024-10-30 03:24:02.096 | INFO     | __main__:main:1693 - Validation dataset size after load: 450
2024-10-30 03:24:02.096 | INFO     | __main__:main:1694 - Testing dataset size after load: 500
2024-10-30 03:24:02.096 | INFO     | __main__:main:1696 - Starting progressive training from epoch 19 to 20
2024-10-30 03:24:02.096 | INFO     | __main__:main:1699 - hit the barrier before training
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19777/19777 [00:02<00:00, 9260.43it/s]
2024-10-30 03:24:02.373 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/ran
dom/cache_train/cached_data.pkl
Training dataset size: 28855
2024-10-30 03:24:02.376 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
2024-10-30 03:24:02.380 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_pred/cached_data.pkl
Testing dataset size: 500
2024-10-30 03:24:02.380 | INFO     | __main__:main:1692 - Training dataset size after load: 28855
2024-10-30 03:24:02.380 | INFO     | __main__:main:1693 - Validation dataset size after load: 450
2024-10-30 03:24:02.380 | INFO     | __main__:main:1694 - Testing dataset size after load: 500
2024-10-30 03:24:02.380 | INFO     | __main__:main:1696 - Starting progressive training from epoch 19 to 20
2024-10-30 03:24:02.380 | INFO     | __main__:main:1699 - hit the barrier before training
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19777/19777 [00:02<00:00, 9493.60it/s]
2024-10-30 03:24:05.781 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/ran
dom/cache_train/cached_data.pkl
Training dataset size: 28855
2024-10-30 03:24:05.785 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
2024-10-30 03:24:05.789 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_pred/cached_data.pkl
Testing dataset size: 500
2024-10-30 03:24:05.789 | INFO     | __main__:main:1692 - Training dataset size after load: 28855
2024-10-30 03:24:05.789 | INFO     | __main__:main:1693 - Validation dataset size after load: 450
2024-10-30 03:24:05.789 | INFO     | __main__:main:1694 - Testing dataset size after load: 500
2024-10-30 03:24:05.789 | INFO     | __main__:main:1696 - Starting progressive training from epoch 19 to 20
2024-10-30 03:24:05.789 | INFO     | __main__:main:1699 - hit the barrier before training
2024-10-30 03:24:05.986 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_train/cached_data.pkl
Training dataset size: 28855
2024-10-30 03:24:06.017 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
2024-10-30 03:24:06.024 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_pred/cached_data.pkl
Testing dataset size: 500
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full exists and is not empty.
2024-10-30 03:24:06.512 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_train/cached_data.pkl
2024-10-30 03:24:06.517 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_train/cached_data.pkl
Training dataset size: 28855
Training dataset size: 28855
2024-10-30 03:24:06.533 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
2024-10-30 03:24:06.538 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_pred/cached_data.pkl
Testing dataset size: 500
2024-10-30 03:24:06.538 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
2024-10-30 03:24:06.540 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_train/cached_data.pkl
2024-10-30 03:24:06.543 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_pred/cached_data.pkl
Testing dataset size: 500
Training dataset size: 28855
2024-10-30 03:24:06.561 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_val/cached_data.pkl
Validation dataset size: 450
2024-10-30 03:24:06.565 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/
cache_pred/cached_data.pkl
Testing dataset size: 500
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-30 03:24:07.645 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-30 03:24:07.646 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-30 03:24:07.647 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-30 03:24:07.647 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params | Mode
---------------------------------------------------
0 | encoder | T5EncoderModel | 217 M  | train
---------------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
235       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
`Trainer.fit` stopped: `max_epochs=20` reached.
2024-10-30 03:24:11.951 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 03:24:11.997 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 03:24:12.138 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 03:24:12.244 | INFO     | __main__:main:1702 - hit the barrier after training
2024-10-30 03:24:12.247 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 03:24:12.247 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 03:24:12.247 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 03:24:12.247 | INFO     | __main__:main:1708 - Finished progressive training at epoch 20
2024-10-30 03:24:12.248 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambd
a_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 03:24:12.248 | INFO     | __main__:main:1715 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall
@10_val=81.44.ckpt
2024-10-30 03:24:14.802 | INFO     | __main__:main:1725 - Testing...
2024-10-30 03:24:14.805 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
2024-10-30 03:24:15.013 | INFO     | __main__:main:1725 - Testing...
2024-10-30 03:24:15.014 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 0] Seed set to 3407
2024-10-30 03:24:15.216 | INFO     | __main__:main:1725 - Testing...
2024-10-30 03:24:15.217 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:24:15.231 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-30 03:24:15.231 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
[rank: 2] Seed set to 3407
2024-10-30 03:24:15.339 | INFO     | __main__:main:1725 - Testing...
2024-10-30 03:24:15.339 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
2024-10-30 03:24:15.392 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-30 03:24:15.392 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
[rank: 3] Seed set to 3407
2024-10-30 03:24:15.568 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-30 03:24:15.568 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
[rank: 1] Seed set to 3407
2024-10-30 03:24:15.676 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-30 03:24:15.676 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]


2024-10-30 03:24:16.366 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_train/cached_data.pkl
2024-10-30 03:24:16.366 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]

2024-10-30 03:24:16.367 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-30 03:24:16.367 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:24:16.370 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:24:16.371 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_pred/cached_data.pkl
2024-10-30 03:24:16.371 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:24:16.371 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/data.py:105: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.
2024-10-30 03:24:19.239 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:24:19.299 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-30 03:24:19.610 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 03:24:19.610 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-10-30 03:24:19.653 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 03:24:19.653 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-10-30 03:24:19.707 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:24:20.024 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 03:24:20.024 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-10-30 03:24:20.143 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:24:20.144 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/test.json
0it [00:00, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-10-30 03:24:20.148 | INFO     | __main__:main:1752 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-30 03:24:20.149 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:24:20.507 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-10-30 03:24:20.507 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-30 03:24:32.267 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 03:24:32.294 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 03:24:36.336 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 03:24:36.358 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 03:24:36.673 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 03:24:36.696 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
2024-10-30 03:24:36.793 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_train/cached_data.pkl
Training dataset size: 150559
2024-10-30 03:24:36.811 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2448
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:24:39.541 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:24:39.553 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1994 [00:00<?, ?it/s]2024-10-30 03:24:39.627 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:24:39.628 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1994 [00:00<?, ?it/s]2024-10-30 03:24:39.647 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:24:39.654 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-10-30 03:24:40.104 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:24:40.105 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:20<00:00,  3.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:23<00:00,  3.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:24<00:00,  3.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:26<00:00,  3.52it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:31<00:00,  0.32it/s]2024-10-30 03:34:34.520 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:34:34.691 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-30 03:34:34.691 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:34:35.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:34:35.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:34:35.347 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:34:35.518 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-30 03:34:35.518 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:34:35.537 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-30 03:34:35.537 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:34:35.572 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-30 03:34:35.572 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:34:35.573 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:32<00:00,  0.31it/s]
2024-10-30 03:34:36.711 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
2024-10-30 03:34:36.758 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
2024-10-30 03:34:36.816 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-30 03:34:37.118 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-30 03:34:37.118 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-30 03:34:37.151 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-30 03:34:37.151 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-30 03:34:37.195 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-30 03:34:37.195 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-30 03:34:42.473 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:34:42.513 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1425/1425 [00:00<00:00, 40355.17it/s]
2024-10-30 03:34:42.549 | INFO     | __main__:main:1752 - R@1 = 28.89500224086691 %, R@10 = 71.14053048733501 %, MRR = 0.6073733359052078
2024-10-30 03:34:42.551 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:34:42.900 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-30 03:34:42.901 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]

2024-10-30 03:34:43.733 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-30 03:34:43.734 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_train/cached_data.pkl
2024-10-30 03:34:43.734 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_train/cached_data.pkl
2024-10-30 03:34:43.734 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:34:43.736 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:43.737 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_pred/cached_data.pkl
2024-10-30 03:34:43.737 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_pred/cached_data.pkl
2024-10-30 03:34:43.737 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/ca
che_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-30 03:34:46.599 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:34:46.601 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-30 03:34:46.957 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-30 03:34:46.957 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-30 03:34:47.007 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-30 03:34:47.007 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-30 03:34:47.101 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:34:47.425 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-30 03:34:47.425 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-30 03:34:47.567 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:34:47.573 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
0it [00:00, ?it/s]
2024-10-30 03:34:47.573 | INFO     | __main__:main:1752 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-30 03:34:47.574 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:34:47.915 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-30 03:34:47.915 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]



2024-10-30 03:34:48.609 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_train/cached_data.pkl
2024-10-30 03:34:48.609 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:34:48.609 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_train/cached_data.pkl
2024-10-30 03:34:48.609 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:34:48.612 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:48.613 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:48.613 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_pred/cached_data.pkl
2024-10-30 03:34:48.613 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/ca
che_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-30 03:34:51.236 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:34:51.244 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-30 03:34:51.618 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
random
2024-10-30 03:34:51.618 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-10-30 03:34:51.625 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
random
2024-10-30 03:34:51.625 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-10-30 03:34:51.745 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:34:52.068 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
random
2024-10-30 03:34:52.068 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-10-30 03:34:52.199 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:34:52.200 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
0it [00:00, ?it/s]
2024-10-30 03:34:52.200 | INFO     | __main__:main:1752 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-30 03:34:52.201 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:34:52.515 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
random
2024-10-30 03:34:52.515 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]

2024-10-30 03:34:55.082 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-30 03:34:55.083 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_train/cached_data.pkl
2024-10-30 03:34:55.083 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_train/cached_data.pkl
2024-10-30 03:34:55.083 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:34:55.085 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:55.086 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:55.086 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_pred/cached_data.pkl
2024-10-30 03:34:55.086 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844118
53a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:34:57.790 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:34:57.814 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-30 03:34:58.186 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-30 03:34:58.187 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
2024-10-30 03:34:58.197 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-30 03:34:58.197 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
2024-10-30 03:34:58.198 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:34:58.540 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-30 03:34:58.540 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
2024-10-30 03:34:58.692 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:34:58.693 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/test.json
0it [00:00, ?it/s]
2024-10-30 03:34:58.693 | INFO     | __main__:main:1752 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-30 03:34:58.694 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:34:59.029 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-30 03:34:59.029 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corp
us.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]

0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:34:59.708 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-30 03:34:59.709 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_train/cached_data.pkl
2024-10-30 03:34:59.709 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-30 03:34:59.709 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-10-30 03:34:59.711 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:59.712 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:34:59.712 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_pred/cached_data.pkl
2024-10-30 03:34:59.712 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:35:02.187 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:35:02.192 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-30 03:35:02.540 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-30 03:35:02.540 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-10-30 03:35:02.540 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-30 03:35:02.540 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-10-30 03:35:02.596 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:35:02.910 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-30 03:35:02.910 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-10-30 03:35:03.052 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:35:03.053 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
0it [00:00, ?it/s]
2024-10-30 03:35:03.054 | INFO     | __main__:main:1752 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-30 03:35:03.055 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:35:03.392 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-30 03:35:03.393 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248 [00:10<00:00, 6355.35it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                          | 57796/68248 [00:08<00:01, 6739.98it/s]2024-10-30 03:35:35.562 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cache_train/cached_data.
pkl
Training dataset size: 140562
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421 [00:00<00:00, 7148.98it/s]
2024-10-30 03:35:35.812 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/rand
om/cache_pred/cached_data.pkl
Testing dataset size: 2121
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248 [00:10<00:00, 6787.58it/s]
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ | 67853/68248 [00:10<00:00, 6054.70it/s]2024-10-30 03:35:37.212 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cache_train/cached_data.
pkl
Training dataset size: 140562
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248 [00:10<00:00, 6548.53it/s]
2024-10-30 03:35:38.199 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/rand
om/cache_train/cached_data.pkl
Training dataset size: 140562
2024-10-30 03:35:38.216 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/c
ache_pred/cached_data.pkl
Testing dataset size: 2121
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248 [00:12<00:00, 5521.44it/s]
2024-10-30 03:35:39.039 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/c
ache_pred/cached_data.pkl
Testing dataset size: 2121
2024-10-30 03:35:39.654 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/rand
om/cache_train/cached_data.pkl
Training dataset size: 140562
2024-10-30 03:35:39.670 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/c
ache_pred/cached_data.pkl
Testing dataset size: 2121
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:35:42.578 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:35:42.578 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1711 [00:00<?, ?it/s]2024-10-30 03:35:42.596 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:35:42.597 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 1/1711 [00:00<03:11,  8.91it/s]2024-10-30 03:35:42.729 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:35:42.729 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-10-30 03:35:43.196 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-30 03:35:43.197 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:09<00:00,  3.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:12<00:00,  3.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:14<00:00,  3.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:15<00:00,  3.08it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:29<00:00,  0.30it/s]2024-10-30 03:45:25.559 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:45:25.714 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-30 03:45:25.715 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:45:28.598 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:45:28.598 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:45:28.598 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-30 03:45:28.728 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-30 03:45:28.728 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:45:28.730 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-30 03:45:28.730 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:45:28.737 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-30 03:45:28.737 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-30 03:45:28.738 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:32<00:00,  0.28it/s]
2024-10-30 03:45:30.219 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
2024-10-30 03:45:30.270 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
2024-10-30 03:45:30.354 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-30 03:45:30.659 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-30 03:45:30.659 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-30 03:45:30.686 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-30 03:45:30.687 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-30 03:45:30.718 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-30 03:45:30.719 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-30 03:45:31.000 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:45:31.031 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421 [00:00<00:00, 34396.01it/s]
2024-10-30 03:45:31.074 | INFO     | __main__:main:1752 - R@1 = 29.857029130639184 %, R@10 = 72.60570298365424 %, MRR = 0.6105509240224264
2024-10-30 03:45:31.075 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:45:31.435 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-30 03:45:31.435 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]


0it [00:00, ?it/s]
2024-10-30 03:45:32.188 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-30 03:45:32.189 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_train/cached_data.pkl
2024-10-30 03:45:32.189 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-30 03:45:32.189 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-10-30 03:45:32.191 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:45:32.193 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:45:32.193 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_pred/cached_data.pkl
2024-10-30 03:45:32.193 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/ran
dom/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:45:34.760 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
2024-10-30 03:45:34.785 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-30 03:45:35.106 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-30 03:45:35.106 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-30 03:45:35.136 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-30 03:45:35.137 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-30 03:45:35.189 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:45:35.509 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-30 03:45:35.509 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-30 03:45:35.655 | INFO     | __main__:main:1747 - Loaded the predictions pickle files
2024-10-30 03:45:35.663 | INFO     | __main__:main:1750 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
0it [00:00, ?it/s]
2024-10-30 03:45:35.664 | INFO     | __main__:main:1752 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-10-30 03:45:35.665 | INFO     | retrieval.main:run_cli:60 - PID: 1588295
[rank: 0] Seed set to 3407
2024-10-30 03:45:35.985 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-30 03:45:35.986 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]


0it [00:00, ?it/s]
2024-10-30 03:45:36.786 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-10-30 03:45:36.787 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
/cache_train/cached_data.pkl
2024-10-30 03:45:36.787 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
2024-10-30 03:45:36.787 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
/cache_train/cached_data.pkl
Training dataset size: 0
2024-10-30 03:45:36.789 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cac
he_pred/cached_data.pkl
Testing dataset size: 0
2024-10-30 03:45:36.789 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cac
he_pred/cached_data.pkl
2024-10-30 03:45:36.789 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cac
he_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
2024-10-30 03:45:36.789 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
/cache_pred/cached_data.pkl
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=81.44.ckpt
2024-10-30 03:45:39.268 | INFO     | retrieval.main:run_cli:60 - PID: 1597886
2024-10-30 03:45:39.270 | INFO     | retrieval.main:run_cli:60 - PID: 1597887
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-30 03:45:39.643 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-30 03:45:39.643 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-30 03:45:39.651 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-30 03:45:39.651 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-30 03:45:39.735 | INFO     | retrieval.main:run_cli:60 - PID: 1597885
[rank: 1] Seed set to 3407
2024-10-30 03:45:40.054 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-30 03:45:40.055 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-30 03:45:46.145 | INFO     | __main__:main:1861 - An error occurred: 'utf-8' codec can't decode byte 0x81 in position 179: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1744, in main
    preds = pickle.load(f)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 179: invalid start byte
(base) yingzi_ma@compute-permanent-node-352:~/lean_project/ReProver$
