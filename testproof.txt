behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 01:49:36.934 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 01:49:47.263 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 01:49:47.278 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 01:49:47.292 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 01:49:47.293 | INFO     | __main__:main:1389 - Training dataset size after load: 169441
2024-09-08 01:49:47.293 | INFO     | __main__:main:1390 - Validation dataset size after load: 2482
2024-09-08 01:49:47.293 | INFO     | __main__:main:1391 - Testing dataset size after load: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 01:49:47.382 | INFO     | __main__:main:1421 - Starting progressive training from epoch 0 to 1
2024-09-08 01:49:47.382 | INFO     | __main__:main:1428 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 01:49:53,169] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 01:49:53,173] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 01:49:53,173] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 01:49:57.349 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:49:57.349 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:49:57.349 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:49:57.349 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:49:57.349 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:49:57.349 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:49:57.352 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:49:57.352 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:49:57.352 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:49:57.352 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:49:57.352 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:49:57.352 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:49:57.352 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:49:57.352 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:49:57.352 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:49:57.352 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:49:57.352 | INFO     | __main__:main:1592 - An error occurred: list index out of range
2024-09-08 01:49:57.352 | INFO     | __main__:main:1592 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1264, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-08 01:49:57.352 | INFO     | __main__:main:1155 - Found 15 repositories
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1264, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-08 01:49:57.352 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:49:57.352 | INFO     | __main__:main:1592 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1264, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
^Z
[6]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 01:51:15,872] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 01:51:19.902 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:51:19.902 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:51:19.905 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:51:19.905 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:51:19.905 | INFO     | __main__:main:1138 - Starting the main process
2024-09-08 01:51:19.906 | INFO     | __main__:main:1146 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 01:51:29.111 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 01:51:29.111 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 01:51:29.229 | INFO     | __main__:main:1148 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 01:51:29.230 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:51:29.230 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:51:29.629 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 01:51:44.918 | INFO     | __main__:main:1264 - length of lean_git_repos: 2
2024-09-08 01:51:44.918 | INFO     | __main__:main:1265 - i: 0
2024-09-08 01:51:44.918 | INFO     | __main__:main:1270 - Main process
2024-09-08 01:51:44.918 | INFO     | __main__:main:1271 - Using lambda = 0.1
2024-09-08 01:51:44.918 | INFO     | __main__:main:1272 - Processing https://github.com/teorth/pfr
2024-09-08 01:51:44.918 | INFO     | __main__:main:1305 - All GPUs
2024-09-08 01:51:44.919 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 01:51:44.919 | INFO     | __main__:main:1312 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 01:51:44.919 | INFO     | __main__:main:1318 - Inside train_test_fisher
2024-09-08 01:51:44.919 | INFO     | __main__:main:1319 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 01:51:47.063 | INFO     | __main__:main:1343 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 01:51:47.158 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 01:51:57.935 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 01:51:57.951 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 01:51:57.967 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 01:51:57.967 | INFO     | __main__:main:1391 - Training dataset size after load: 169441
2024-09-08 01:51:57.968 | INFO     | __main__:main:1392 - Validation dataset size after load: 2482
2024-09-08 01:51:57.968 | INFO     | __main__:main:1393 - Testing dataset size after load: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 01:51:58.054 | INFO     | __main__:main:1423 - Starting progressive training from epoch 0 to 1
2024-09-08 01:51:58.055 | INFO     | __main__:main:1430 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 01:52:03,552] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 01:52:03,741] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 01:52:03,741] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 01:52:07.726 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:52:07.726 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:52:07.729 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:52:07.729 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:52:07.729 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:52:07.729 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:52:07.729 | INFO     | __main__:main:1264 - length of lean_git_repos: 0
2024-09-08 01:52:07.729 | INFO     | __main__:main:1265 - i: 0
2024-09-08 01:52:07.729 | INFO     | __main__:main:1594 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1266, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
2024-09-08 01:52:07.917 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:52:07.917 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:52:07.918 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:52:07.918 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:52:07.922 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:52:07.922 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:52:07.922 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:52:07.922 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:52:07.922 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:52:07.922 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:52:07.922 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:52:07.922 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:52:07.923 | INFO     | __main__:main:1264 - length of lean_git_repos: 0
2024-09-08 01:52:07.923 | INFO     | __main__:main:1264 - length of lean_git_repos: 0
2024-09-08 01:52:07.923 | INFO     | __main__:main:1265 - i: 0
2024-09-08 01:52:07.923 | INFO     | __main__:main:1265 - i: 0
2024-09-08 01:52:07.923 | INFO     | __main__:main:1594 - An error occurred: list index out of range
2024-09-08 01:52:07.923 | INFO     | __main__:main:1594 - An error occurred: list index out of range
Traceback (most recent call last):
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1266, in main
    repo = lean_git_repos[i]
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1266, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
IndexError: list index out of range
^Z
[7]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 01:58:02,751] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 01:58:06.755 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 01:58:06.755 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 01:58:06.758 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:58:06.758 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 01:58:06.758 | INFO     | __main__:main:1138 - Starting the main process
2024-09-08 01:58:06.758 | INFO     | __main__:main:1146 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 01:58:15.878 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 01:58:15.879 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 01:58:16.000 | INFO     | __main__:main:1148 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 01:58:16.000 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 01:58:16.000 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 01:58:16.343 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 01:58:31.651 | INFO     | __main__:main:1612 - An error occurred: local variable 'lean_git_repos' referenced before assignment
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1254, in main
    lean_git_repos.append(lean_git_repo)
UnboundLocalError: local variable 'lean_git_repos' referenced before assignment
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 01:58:58,210] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 01:59:02.232 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 01:59:02.232 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 01:59:02.235 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:59:02.235 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 01:59:02.236 | INFO     | __main__:main:1139 - Starting the main process
2024-09-08 01:59:02.236 | INFO     | __main__:main:1147 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 01:59:11.390 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 01:59:11.390 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 01:59:11.512 | INFO     | __main__:main:1149 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 01:59:11.512 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 01:59:11.512 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 01:59:11.717 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 01:59:26.838 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 01:59:26.838 | INFO     | __main__:main:1284 - i: 0
2024-09-08 01:59:26.838 | INFO     | __main__:main:1289 - Main process
2024-09-08 01:59:26.839 | INFO     | __main__:main:1290 - Using lambda = 0.1
2024-09-08 01:59:26.839 | INFO     | __main__:main:1291 - Processing https://github.com/teorth/pfr
2024-09-08 01:59:26.839 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 01:59:26.839 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 01:59:26.839 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 01:59:26.839 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 01:59:26.839 | INFO     | __main__:main:1338 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 01:59:29.071 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 01:59:29.171 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 01:59:39.898 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 01:59:39.914 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 01:59:39.929 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 01:59:39.930 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 01:59:39.930 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 01:59:39.930 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 01:59:40.026 | INFO     | __main__:main:1442 - Starting progressive training from epoch 0 to 1
2024-09-08 01:59:40.026 | INFO     | __main__:main:1449 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 01:59:45,663] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 01:59:45,667] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 01:59:45,667] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 01:59:49.713 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 01:59:49.713 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 01:59:49.716 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:59:49.716 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 01:59:49.716 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 01:59:49.716 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 01:59:49.716 | INFO     | __main__:main:1613 - An error occurred: local variable 'repo_info_file' referenced before assignment
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1271, in main
    with open(repo_info_file, 'r') as f:
UnboundLocalError: local variable 'repo_info_file' referenced before assignment
2024-09-08 01:59:49.861 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 01:59:49.862 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 01:59:49.864 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:59:49.865 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 01:59:49.865 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 01:59:49.865 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 01:59:49.865 | INFO     | __main__:main:1613 - An error occurred: local variable 'repo_info_file' referenced before assignment
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1271, in main
    with open(repo_info_file, 'r') as f:
UnboundLocalError: local variable 'repo_info_file' referenced before assignment
2024-09-08 01:59:49.895 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 01:59:49.895 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 01:59:49.899 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 01:59:49.899 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 01:59:49.899 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 01:59:49.899 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 01:59:49.899 | INFO     | __main__:main:1613 - An error occurred: local variable 'repo_info_file' referenced before assignment
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1271, in main
    with open(repo_info_file, 'r') as f:
UnboundLocalError: local variable 'repo_info_file' referenced before assignment
^C^Z
[8]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 02:00:15,861] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 02:00:21.180 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 02:00:21.180 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 02:00:21.183 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:00:21.183 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 02:00:21.183 | INFO     | __main__:main:1139 - Starting the main process
2024-09-08 02:00:21.183 | INFO     | __main__:main:1147 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 02:00:30.441 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 02:00:30.441 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 02:00:30.560 | INFO     | __main__:main:1149 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 02:00:30.560 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 02:00:30.560 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 02:00:30.766 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:00:46.152 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:00:46.152 | INFO     | __main__:main:1284 - i: 0
2024-09-08 02:00:46.152 | INFO     | __main__:main:1289 - Main process
2024-09-08 02:00:46.152 | INFO     | __main__:main:1290 - Using lambda = 0.1
2024-09-08 02:00:46.153 | INFO     | __main__:main:1291 - Processing https://github.com/teorth/pfr
2024-09-08 02:00:46.153 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:00:46.154 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:00:46.154 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:00:46.154 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:00:46.154 | INFO     | __main__:main:1338 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:00:48.776 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:00:48.878 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
^Z
[9]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 02:01:12,777] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 02:01:17.011 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 02:01:17.011 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 02:01:17.014 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:01:17.014 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 02:01:17.014 | INFO     | __main__:main:1139 - Starting the main process
2024-09-08 02:01:17.014 | INFO     | __main__:main:1147 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 02:01:26.150 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 02:01:26.150 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 02:01:26.268 | INFO     | __main__:main:1149 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 02:01:26.269 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 02:01:26.269 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 02:01:26.474 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:01:41.791 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:01:41.791 | INFO     | __main__:main:1284 - i: 0
2024-09-08 02:01:41.791 | INFO     | __main__:main:1289 - Main process
2024-09-08 02:01:41.791 | INFO     | __main__:main:1290 - Using lambda = 0.1
2024-09-08 02:01:41.791 | INFO     | __main__:main:1291 - Processing https://github.com/teorth/pfr
2024-09-08 02:01:41.791 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:01:41.792 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:01:41.792 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:01:41.792 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:01:41.792 | INFO     | __main__:main:1338 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:01:44.054 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:01:44.165 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:01:54.947 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:01:54.963 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:01:54.979 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:01:54.980 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:01:54.980 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:01:54.980 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 02:01:55.094 | INFO     | __main__:main:1442 - Starting progressive training from epoch 0 to 1
2024-09-08 02:01:55.094 | INFO     | __main__:main:1449 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 02:02:01,142] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 02:02:01,142] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 02:02:01,143] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 02:02:05.582 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 02:02:05.583 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 02:02:05.585 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:02:05.586 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 02:02:05.586 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 02:02:05.586 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 02:02:05.726 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 02:02:05.726 | INFO     | __main__:main:1126 - Running progressive training
2024-09-08 02:02:05.726 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 02:02:05.726 | INFO     | __main__:main:1132 - Configuring LeanDojo...
2024-09-08 02:02:05.730 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:02:05.730 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:02:05.731 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 02:02:05.731 | INFO     | __main__:main:1134 - LeanDojo configured
2024-09-08 02:02:05.731 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 02:02:05.731 | INFO     | __main__:main:1156 - Found 15 repositories
2024-09-08 02:02:05.731 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 02:02:05.731 | INFO     | __main__:main:1247 - Starting without curriculum learning
2024-09-08 02:02:05.773 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:02:05.943 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:02:05.945 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:02:21.122 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:02:21.122 | INFO     | __main__:main:1284 - i: 0
2024-09-08 02:02:21.123 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:02:21.123 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:02:21.124 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:02:21.124 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:02:21.124 | INFO     | __main__:main:1338 - Starting training at epoch 0
[rank: 2] Seed set to 3407
2024-09-08 02:02:21.172 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:02:21.173 | INFO     | __main__:main:1284 - i: 0
2024-09-08 02:02:21.173 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:02:21.173 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:02:21.173 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:02:21.173 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:02:21.173 | INFO     | __main__:main:1338 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:02:21.523 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:02:21.523 | INFO     | __main__:main:1284 - i: 0
2024-09-08 02:02:21.523 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:02:21.524 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:02:21.524 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:02:21.524 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:02:21.524 | INFO     | __main__:main:1338 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:02:23.744 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:02:23.838 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:02:24.212 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:02:24.317 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:02:24.388 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:02:24.488 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:02:34.463 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:02:34.478 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:34.492 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:02:34.493 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:02:34.493 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:02:34.493 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
2024-09-08 02:02:34.582 | INFO     | __main__:main:1442 - Starting progressive training from epoch 0 to 1
2024-09-08 02:02:34.582 | INFO     | __main__:main:1449 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-09-08 02:02:39.192 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:02:39.206 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:39.220 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:02:39.221 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:02:39.221 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:02:39.221 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
2024-09-08 02:02:39.311 | INFO     | __main__:main:1442 - Starting progressive training from epoch 0 to 1
2024-09-08 02:02:39.311 | INFO     | __main__:main:1449 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-08 02:02:39.708 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:02:39.724 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:39.739 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:02:39.739 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:02:39.739 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:02:39.740 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
2024-09-08 02:02:39.784 | INFO     | __main__:main:1442 - Starting progressive training from epoch 0 to 1
2024-09-08 02:02:39.784 | INFO     | __main__:main:1449 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 02:02:44.357 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:02:44.455 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:44.472 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr
 exists and is not empty.
2024-09-08 02:02:44.661 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:02:44.755 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:44.772 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:02:46.316 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
2024-09-08 02:02:46.381 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:02:46.445 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:46.475 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Training dataset size: 169441
2024-09-08 02:02:46.509 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:02:46.536 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.7
3.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 02:02:47.870 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 02:02:47.872 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 02:02:47.874 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 02:02:47.874 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.
ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-08 02:02:50.971 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-08 02:02:51.011 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-08 02:02:51.080 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-08 02:02:51.101 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-08 02:02:51.102 | INFO     | __main__:main:1458 - Finished progressive training at epoch 1
2024-09-08 02:02:51.102 | INFO     | __main__:main:1458 - Finished progressive training at epoch 1
2024-09-08 02:02:51.102 | INFO     | __main__:main:1458 - Finished progressive training at epoch 1
2024-09-08 02:02:51.102 | INFO     | __main__:main:1458 - Finished progressive training at epoch 1
2024-09-08 02:02:53.255 | INFO     | __main__:main:1477 - Testing...
2024-09-08 02:02:53.256 | INFO     | retrieval.main:run_cli:60 - PID: 638531
2024-09-08 02:02:53.369 | INFO     | __main__:main:1477 - Testing...
2024-09-08 02:02:53.370 | INFO     | retrieval.main:run_cli:60 - PID: 638533
[rank: 1] Seed set to 3407
2024-09-08 02:02:53.475 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:02:53.475 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
2024-09-08 02:02:53.478 | INFO     | __main__:main:1477 - Testing...
2024-09-08 02:02:53.482 | INFO     | retrieval.main:run_cli:60 - PID: 638532
2024-09-08 02:02:53.546 | INFO     | __main__:main:1477 - Testing...
2024-09-08 02:02:53.548 | INFO     | retrieval.main:run_cli:60 - PID: 638262
[rank: 3] Seed set to 3407
2024-09-08 02:02:53.592 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:02:53.592 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-08 02:02:53.688 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:02:53.688 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 02:02:53.750 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:02:53.750 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:02:54.081 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:02:54.083 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:02:54.183 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:02:54.249 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 02:03:05.500 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:03:05.518 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:03:06.563 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:03:06.579 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:03:06.650 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:03:06.664 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:03:06.863 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:03:06.878 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.7
3.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73
.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 02:03:09.332 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
2024-09-08 02:03:09.389 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting: |                                                                        | 0/? [00:00<?, ?it/s]2024-09-08 02:03:09.399 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start
: True
2024-09-08 02:03:09.498 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                      | 0/11 [00:00<?, ?it/s]/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.
py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 11/11 [00:26<00:00,  0.41it/s]2024-09-08 02:03:36.195 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions
 map
2024-09-08 02:03:36.208 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 02:03:36.208 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:03:36.590 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:03:36.590 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:03:36.590 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:03:36.602 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 02:03:36.603 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:03:36.603 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 02:03:36.603 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 02:03:36.603 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:03:36.603 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:03:36.603 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 11/11 [00:27<00:00,  0.41it/s]
2024-09-08 02:03:37.401 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:03:37.443 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:03:37.476 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
  0%|                                                                             | 0/1486 [00:00<?, ?it/s]2024-09-08 02:03:37.485 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:03:37.522 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:03:37.541 | INFO     | retrieval.main:run_cli:64 - Configuration:

100%|███████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 25433.72it/s]
2024-09-08 02:03:37.543 | INFO     | __main__:main:1503 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:03:37.544 | INFO     | retrieval.main:run_cli:60 - PID: 638262
2024-09-08 02:03:37.545 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:03:37.551 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
  0%|                                                                             | 0/1486 [00:00<?, ?it/s]2024-09-08 02:03:37.582 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:03:37.608 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:03:37.610 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
100%|███████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 23864.30it/s]
2024-09-08 02:03:37.614 | INFO     | __main__:main:1503 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:03:37.614 | INFO     | retrieval.main:run_cli:60 - PID: 638531
2024-09-08 02:03:37.657 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
100%|███████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 24442.20it/s]
2024-09-08 02:03:37.672 | INFO     | __main__:main:1503 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:03:37.672 | INFO     | retrieval.main:run_cli:60 - PID: 638533
100%|███████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 14718.80it/s]
2024-09-08 02:03:37.759 | INFO     | __main__:main:1503 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:03:37.760 | INFO     | retrieval.main:run_cli:60 - PID: 638532
[rank: 1] Seed set to 3407
2024-09-08 02:03:37.800 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:03:37.800 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 02:03:37.818 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:03:37.818 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-08 02:03:37.853 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:03:37.854 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-08 02:03:37.976 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:03:37.976 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
2024-09-08 02:03:38.352 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
2024-09-08 02:03:38.359 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
2024-09-08 02:03:38.360 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
2024-09-08 02:03:38.664 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
[rank: 3] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-08 02:03:55.620 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:03:55.637 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 02:03:57.265 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:03:59.922 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 02:04:00.044 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:04:00.068 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 02:04:00.167 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:04:03.670 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.7
3.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73
.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 02:04:09.878 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting: |                                                                        | 0/? [00:00<?, ?it/s]2024-09-08 02:04:09.996 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start
: True
2024-09-08 02:04:10.062 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
2024-09-08 02:04:10.068 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 11/11 [00:30<00:00,  0.36it/s]2024-09-08 02:04:40.817 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions
 map
2024-09-08 02:04:40.817 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:04:40.830 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 02:04:40.830 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:04:40.830 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 02:04:40.831 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:04:42.399 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:04:42.417 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 02:04:42.417 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:04:44.055 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:04:44.073 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 02:04:44.073 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:04:44.073 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████| 11/11 [00:33<00:00,  0.32it/s]
2024-09-08 02:04:44.972 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:04:44.973 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:04:45.013 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:04:45.028 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:04:45.034 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:04:45.063 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
  0%|                                                                             | 0/1582 [00:00<?, ?it/s]2024-09-08 02:04:45.070 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_
retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.json
2024-09-08 02:04:45.070 | INFO     | retrieval.main:run_cli:64 - Configuration:

  0%|                                                                             | 0/1582 [00:00<?, ?it/s]2024-09-08 02:04:45.084 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
2024-09-08 02:04:45.119 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
100%|███████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 26740.07it/s]
2024-09-08 02:04:45.130 | INFO     | __main__:main:1503 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:04:45.131 | INFO     | __main__:main:1516 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:04:45.132 | INFO     | __main__:main:1551 - Starting the prover
2024-09-08 02:04:45.132 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 02:04:45.132 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 02:04:45.132 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 02:04:45.133 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b
853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.152 | INFO     | __main__:main:1498 - Loaded the predictions pickle files
100%|███████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 15879.45it/s]
2024-09-08 02:04:45.163 | INFO     | __main__:main:1503 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:04:45.164 | INFO     | __main__:main:1516 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:04:45.164 | INFO     | __main__:main:1611 - current epoch: 1
2024-09-08 02:04:45.164 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:04:45.164 | INFO     | __main__:main:1284 - i: 1
2024-09-08 02:04:45.164 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:04:45.167 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.167 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.167 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:04:45.167 | INFO     | __main__:main:1338 - Starting training at epoch 1
[rank: 1] Seed set to 3407
100%|███████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 25326.69it/s]
2024-09-08 02:04:45.182 | INFO     | __main__:main:1503 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:04:45.182 | INFO     | __main__:main:1516 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:04:45.183 | INFO     | __main__:main:1611 - current epoch: 1
2024-09-08 02:04:45.183 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:04:45.183 | INFO     | __main__:main:1284 - i: 1
2024-09-08 02:04:45.183 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:04:45.185 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.185 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.186 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:04:45.186 | INFO     | __main__:main:1338 - Starting training at epoch 1
[rank: 3] Seed set to 3407
2024-09-08 02:04:45.209 | INFO     | __main__:main:1501 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
100%|███████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 14329.47it/s]
2024-09-08 02:04:45.322 | INFO     | __main__:main:1503 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:04:45.322 | INFO     | __main__:main:1516 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:04:45.322 | INFO     | __main__:main:1611 - current epoch: 1
2024-09-08 02:04:45.322 | INFO     | __main__:main:1283 - length of lean_git_repos: 2
2024-09-08 02:04:45.322 | INFO     | __main__:main:1284 - i: 1
2024-09-08 02:04:45.323 | INFO     | __main__:main:1324 - All GPUs
2024-09-08 02:04:45.327 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.327 | INFO     | __main__:main:1331 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.327 | INFO     | __main__:main:1337 - Inside train_test_fisher
2024-09-08 02:04:45.327 | INFO     | __main__:main:1338 - Starting training at epoch 1
[rank: 2] Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-ret
riever-tacgen-byt5-small/model_lightning.ckpt`
2024-09-08 02:04:45.618 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:45.618 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:04:47.261 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 02:04:47.291 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 02:04:47.396 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:04:47.483 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:04:47.566 | INFO     | __main__:main:1362 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 02:04:47.667 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:04:48.740 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'r
etriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encode
r.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.
layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtte
ntion.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', '
retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'ret
riever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer
.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.
layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.we
ight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.Den
seReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q
.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.en
coder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.bl
ock.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0
.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseRelu
Dense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight',
'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.en
coder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.laye
r.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense
.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight
', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encod
er.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.
layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.Se
lfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDens
e.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.enc
oder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_
step', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 02:04:49.506 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 02:04:49.507 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 02:04:49.508 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e5
0c6aee013a2687/corpus.jsonl
2024-09-08 02:04:49.508 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:04:55.466 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 02:04:55.466 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50
c6aee013a2687/corpus.jsonl
2024-09-08 02:04:55.466 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 02:05:00,588 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8266
2024-09-08 02:05:16.252 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:05:16.591 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:05:16.652 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:05:16.659 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:05:16.660 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:05:16.660 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
2024-09-08 02:05:16.859 | INFO     | __main__:main:1442 - Starting progressive training from epoch 1 to 2
2024-09-08 02:05:16.859 | INFO     | __main__:main:1449 - hit the barrier before training
2024-09-08 02:05:27.007 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:05:27.030 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:05:27.052 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:05:27.053 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:05:27.053 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:05:27.054 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
2024-09-08 02:05:27.147 | INFO     | __main__:main:1442 - Starting progressive training from epoch 1 to 2
2024-09-08 02:05:27.147 | INFO     | __main__:main:1449 - hit the barrier before training
2024-09-08 02:05:27.567 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:05:27.582 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:05:27.598 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:05:27.598 | INFO     | __main__:main:1410 - Training dataset size after load: 169441
2024-09-08 02:05:27.598 | INFO     | __main__:main:1411 - Validation dataset size after load: 2482
2024-09-08 02:05:27.598 | INFO     | __main__:main:1412 - Testing dataset size after load: 2685
2024-09-08 02:05:27.641 | INFO     | __main__:main:1442 - Starting progressive training from epoch 1 to 2
2024-09-08 02:05:27.641 | INFO     | __main__:main:1449 - hit the barrier before training
^Z
[10]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 02:15:57,658] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 02:16:01.431 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 02:16:01.432 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 02:16:01.434 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:16:01.434 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 02:16:01.435 | INFO     | __main__:main:1138 - Starting the main process
2024-09-08 02:16:01.435 | INFO     | __main__:main:1146 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 02:16:09.993 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 02:16:09.993 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 02:16:10.100 | INFO     | __main__:main:1148 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 02:16:10.100 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 02:16:10.100 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 02:16:10.421 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:16:25.717 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:16:25.717 | INFO     | __main__:main:1283 - i: 0
2024-09-08 02:16:25.717 | INFO     | __main__:main:1288 - Main process
2024-09-08 02:16:25.717 | INFO     | __main__:main:1289 - Using lambda = 0.1
2024-09-08 02:16:25.717 | INFO     | __main__:main:1290 - Processing https://github.com/teorth/pfr
2024-09-08 02:16:25.717 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:16:25.718 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:16:25.718 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:16:25.718 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:16:25.718 | INFO     | __main__:main:1337 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:16:27.851 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:16:27.945 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:16:37.803 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:16:37.818 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:16:37.832 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:16:37.833 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:16:37.833 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:16:37.833 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 02:16:37.919 | INFO     | __main__:main:1441 - Starting progressive training from epoch 0 to 1
2024-09-08 02:16:37.919 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 02:16:43,584] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 02:16:43,587] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 02:16:43,587] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 02:16:47.471 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 02:16:47.471 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 02:16:47.474 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:16:47.474 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 02:16:47.474 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 02:16:47.474 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 02:16:47.617 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 02:16:47.617 | INFO     | __main__:main:1125 - Running progressive training
2024-09-08 02:16:47.617 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 02:16:47.617 | INFO     | __main__:main:1131 - Configuring LeanDojo...
2024-09-08 02:16:47.622 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:16:47.622 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 02:16:47.622 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 02:16:47.622 | INFO     | __main__:main:1133 - LeanDojo configured
2024-09-08 02:16:47.622 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 02:16:47.622 | INFO     | __main__:main:1155 - Found 15 repositories
2024-09-08 02:16:47.622 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 02:16:47.622 | INFO     | __main__:main:1246 - Starting without curriculum learning
2024-09-08 02:16:47.669 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:16:47.792 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:16:47.844 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 02:17:02.901 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:17:02.901 | INFO     | __main__:main:1283 - i: 0
2024-09-08 02:17:02.901 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:17:02.902 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:17:02.902 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:17:02.902 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:17:02.902 | INFO     | __main__:main:1337 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:17:03.138 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:17:03.138 | INFO     | __main__:main:1283 - i: 0
2024-09-08 02:17:03.138 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:17:03.139 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:17:03.139 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:17:03.139 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:17:03.139 | INFO     | __main__:main:1337 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:17:03.532 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:17:03.532 | INFO     | __main__:main:1283 - i: 0
2024-09-08 02:17:03.532 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:17:03.532 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:17:03.532 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:17:03.533 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:17:03.533 | INFO     | __main__:main:1337 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 02:17:05.552 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:17:05.655 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:17:05.886 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:17:06.013 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:17:06.231 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 02:17:06.338 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:17:16.243 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:16.258 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:16.271 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:17:16.272 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:17:16.272 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:17:16.272 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
2024-09-08 02:17:16.361 | INFO     | __main__:main:1441 - Starting progressive training from epoch 0 to 1
2024-09-08 02:17:16.361 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-08 02:17:20.415 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:20.430 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:20.444 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:17:20.445 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:17:20.445 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:17:20.445 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
2024-09-08 02:17:20.534 | INFO     | __main__:main:1441 - Starting progressive training from epoch 0 to 1
2024-09-08 02:17:20.534 | INFO     | __main__:main:1448 - hit the barrier before training
2024-09-08 02:17:20.835 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:20.849 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:20.862 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:17:20.863 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:17:20.863 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:17:20.863 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-09-08 02:17:20.906 | INFO     | __main__:main:1441 - Starting progressive training from epoch 0 to 1
2024-09-08 02:17:20.906 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 02:17:26.374 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:26.470 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:26.489 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
2024-09-08 02:17:26.491 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Testing dataset size: 2685
Training dataset size: 169441
2024-09-08 02:17:26.582 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
2024-09-08 02:17:26.583 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:26.599 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Training dataset size: 169441
2024-09-08 02:17:26.711 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:26.735 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr
 exists and is not empty.
2024-09-08 02:17:27.190 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:27.311 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:17:27.335 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.7
3.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 02:17:28.603 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 02:17:28.609 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 02:17:28.610 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 02:17:28.613 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.
ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-08 02:17:31.218 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-08 02:17:31.250 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-08 02:17:31.610 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-08 02:17:31.642 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-08 02:17:31.646 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-08 02:17:31.648 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-08 02:17:31.648 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-08 02:17:31.650 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-08 02:17:33.853 | INFO     | __main__:main:1476 - Testing...
2024-09-08 02:17:33.860 | INFO     | retrieval.main:run_cli:60 - PID: 657095
2024-09-08 02:17:33.917 | INFO     | __main__:main:1476 - Testing...
2024-09-08 02:17:33.920 | INFO     | retrieval.main:run_cli:60 - PID: 656975
2024-09-08 02:17:34.017 | INFO     | __main__:main:1476 - Testing...
2024-09-08 02:17:34.017 | INFO     | retrieval.main:run_cli:60 - PID: 657094
[rank: 0] Seed set to 3407
2024-09-08 02:17:34.115 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:17:34.116 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-08 02:17:34.160 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:17:34.160 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
2024-09-08 02:17:34.177 | INFO     | __main__:main:1476 - Testing...
2024-09-08 02:17:34.178 | INFO     | retrieval.main:run_cli:60 - PID: 657096
[rank: 1] Seed set to 3407
2024-09-08 02:17:34.212 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:17:34.212 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
[rank: 3] Seed set to 3407
2024-09-08 02:17:34.377 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6ae
e013a2687/random
2024-09-08 02:17:34.377 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6
aee013a2687/corpus.jsonl
2024-09-08 02:17:34.639 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:17:34.660 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:17:34.722 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:17:35.024 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-08 02:17:48.950 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:48.967 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:17:50.148 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:50.163 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:17:53.141 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:53.165 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:17:53.255 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:17:53.277 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.7
3.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73
.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 02:17:56.417 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-08 02:17:56.487 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                                                                                                                                    | 0/11 [00:00<?, ?it/s]
2024-09-08 02:17:56.566 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
2024-09-08 02:17:56.613 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:26<00:00,  0.42it/s]
2024-09-08 02:18:22.938 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:18:22.950 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 02:18:22.951 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:18:27.740 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:18:27.753 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 02:18:27.753 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:18:30.318 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:18:30.318 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:18:30.332 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 02:18:30.332 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:18:30.333 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 02:18:30.333 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:18:30.333 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:33<00:00,  0.33it/s]
2024-09-08 02:18:31.024 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:18:31.099 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:18:31.165 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
  0%|                                                                                                                                                                                           | 0/1486 [00:00<?, ?it/s]
2024-09-08 02:18:31.214 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:18:31.230 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:18:31.248 | INFO     | retrieval.main:run_cli:64 - Configuration:

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 16188.97it/s]
2024-09-08 02:18:31.262 | INFO     | __main__:main:1502 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:18:31.262 | INFO     | retrieval.main:run_cli:60 - PID: 657094
2024-09-08 02:18:31.270 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:18:31.273 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:18:31.287 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:18:31.299 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
  0%|                                                                                                                                                                                           | 0/1486 [00:00<?, ?it/s]
2024-09-08 02:18:31.316 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
  0%|                                                                                                                                                                                           | 0/1486 [00:00<?, ?it/s]
2024-09-08 02:18:31.323 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.j
son
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 24586.83it/s]
2024-09-08 02:18:31.361 | INFO     | __main__:main:1502 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:18:31.361 | INFO     | retrieval.main:run_cli:60 - PID: 657095
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 25706.77it/s]
2024-09-08 02:18:31.375 | INFO     | __main__:main:1502 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:18:31.377 | INFO     | retrieval.main:run_cli:60 - PID: 656975
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 21387.54it/s]
2024-09-08 02:18:31.394 | INFO     | __main__:main:1502 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 02:18:31.394 | INFO     | retrieval.main:run_cli:60 - PID: 657096
[rank: 1] Seed set to 3407
2024-09-08 02:18:31.492 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:18:31.492 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-08 02:18:31.542 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:18:31.542 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 02:18:31.562 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:18:31.562 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-08 02:18:31.593 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/random
2024-09-08 02:18:31.593 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd6856
60b5fedd7bd67f9916ae24253d566/corpus.jsonl
2024-09-08 02:18:32.000 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
2024-09-08 02:18:32.029 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
2024-09-08 02:18:32.051 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
2024-09-08 02:18:32.107 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67
f9916ae24253d566/corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-08 02:18:49.769 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:18:49.787 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 02:18:52.286 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:18:53.118 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:18:54.845 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 02:18:56.979 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 02:18:57.623 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 02:18:57.648 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29b
addd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.7
3.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73
.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 02:19:00.470 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-08 02:19:00.505 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
2024-09-08 02:19:00.589 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
2024-09-08 02:19:00.602 | INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:27<00:00,  0.40it/s]
2024-09-08 02:19:28.304 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:19:33.034 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 02:19:33.034 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:19:38.752 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:19:38.754 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:19:38.767 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 02:19:38.768 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:19:38.770 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 02:19:38.770 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:19:38.770 | INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 02:19:38.787 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 02:19:38.787 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 02:19:38.788 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:38<00:00,  0.29it/s]
2024-09-08 02:19:39.588 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:19:39.607 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:19:39.628 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:19:39.629 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 02:19:39.656 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:19:39.666 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:19:39.694 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:19:39.699 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
  0%|                                                                                                                                                                                           | 0/1582 [00:00<?, ?it/s]
2024-09-08 02:19:39.711 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
  0%|                                                                                                                                                                                           | 0/1582 [00:00<?, ?it/s]
2024-09-08 02:19:39.713 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-08 02:19:39.729 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
  0%|                                                                                                                                                                                           | 0/1582 [00:00<?, ?it/s]
2024-09-08 02:19:39.752 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 26583.13it/s]
2024-09-08 02:19:39.760 | INFO     | __main__:main:1502 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:19:39.760 | INFO     | __main__:main:1515 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:19:39.760 | INFO     | __main__:main:1610 - current epoch: 1
2024-09-08 02:19:39.760 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:19:39.760 | INFO     | __main__:main:1283 - i: 1
2024-09-08 02:19:39.761 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:19:39.763 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:39.763 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:39.763 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:19:39.763 | INFO     | __main__:main:1337 - Starting training at epoch 1
[rank: 3] Seed set to 3407
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 23868.99it/s]
2024-09-08 02:19:39.779 | INFO     | __main__:main:1502 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:19:39.779 | INFO     | __main__:main:1515 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:19:39.779 | INFO     | __main__:main:1610 - current epoch: 1
2024-09-08 02:19:39.779 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:19:39.779 | INFO     | __main__:main:1283 - i: 1
2024-09-08 02:19:39.779 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:19:39.782 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:39.782 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:39.782 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:19:39.782 | INFO     | __main__:main:1337 - Starting training at epoch 1
[rank: 2] Seed set to 3407
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 25986.08it/s]
2024-09-08 02:19:39.791 | INFO     | __main__:main:1502 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:19:39.791 | INFO     | __main__:main:1515 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:19:39.791 | INFO     | __main__:main:1610 - current epoch: 1
2024-09-08 02:19:39.791 | INFO     | __main__:main:1282 - length of lean_git_repos: 2
2024-09-08 02:19:39.791 | INFO     | __main__:main:1283 - i: 1
2024-09-08 02:19:39.791 | INFO     | __main__:main:1323 - All GPUs
2024-09-08 02:19:39.794 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e32
94c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:39.794 | INFO     | __main__:main:1330 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687
_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:39.794 | INFO     | __main__:main:1336 - Inside train_test_fisher
2024-09-08 02:19:39.794 | INFO     | __main__:main:1337 - Starting training at epoch 1
[rank: 1] Seed set to 3407
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 25482.50it/s]
2024-09-08 02:19:39.815 | INFO     | __main__:main:1502 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 02:19:39.816 | INFO     | __main__:main:1515 - Average R@1 = 0.16236620618848246 %, R@10 = 0.27321969074860125 %, MRR = 0.007285145090178365
2024-09-08 02:19:39.817 | INFO     | __main__:main:1550 - Starting the prover
2024-09-08 02:19:39.818 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 02:19:39.818 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 02:19:39.818 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 02:19:39.818 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b
853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-ret
riever-tacgen-byt5-small/model_lightning.ckpt`
2024-09-08 02:19:40.347 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:40.347 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 02:19:41.859 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 02:19:41.958 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:19:41.971 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 02:19:42.063 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:19:42.124 | INFO     | __main__:main:1361 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 02:19:42.226 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:19:43.314 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'r
etriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encode
r.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.
layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtte
ntion.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', '
retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'ret
riever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer
.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.
layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.we
ight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.Den
seReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q
.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.en
coder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.bl
ock.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0
.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseRelu
Dense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight',
'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.en
coder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.laye
r.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense
.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight
', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encod
er.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.
layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.Se
lfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDens
e.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.enc
oder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_
step', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 02:19:44.010 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 02:19:44.011 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 02:19:44.012 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e5
0c6aee013a2687/corpus.jsonl
2024-09-08 02:19:44.012 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/c
orpus.jsonl
2024-09-08 02:19:50.095 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 02:19:50.095 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50
c6aee013a2687/corpus.jsonl
2024-09-08 02:19:50.095 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 02:19:55,116 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8267
2024-09-08 02:19:58.894 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:20:00.340 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:20:01.058 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:20:01.106 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:20:01.107 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:20:01.110 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
2024-09-08 02:20:02.711 | INFO     | __main__:main:1441 - Starting progressive training from epoch 1 to 2
2024-09-08 02:20:02.711 | INFO     | __main__:main:1448 - hit the barrier before training
2024-09-08 02:20:03.068 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:20:03.269 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:20:03.398 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:20:03.399 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:20:03.399 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:20:03.400 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
2024-09-08 02:20:04.108 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 02:20:04.122 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 02:20:04.137 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294
c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 02:20:04.137 | INFO     | __main__:main:1409 - Training dataset size after load: 169441
2024-09-08 02:20:04.137 | INFO     | __main__:main:1410 - Validation dataset size after load: 2482
2024-09-08 02:20:04.137 | INFO     | __main__:main:1411 - Testing dataset size after load: 2685
2024-09-08 02:20:05.823 | INFO     | __main__:main:1441 - Starting progressive training from epoch 1 to 2
2024-09-08 02:20:05.823 | INFO     | __main__:main:1448 - hit the barrier before training
2024-09-08 02:20:05.829 | INFO     | __main__:main:1441 - Starting progressive training from epoch 1 to 2
2024-09-08 02:20:05.829 | INFO     | __main__:main:1448 - hit the barrier before training
[2024-09-08 02:20:13,088 E 656975 656975] core_worker.cc:251: Failed to register worker to Raylet: IOError: [RayletClient] Unable to register worker with raylet. No such file or directory worker_id=01000000fffffffffff
fffffffffffffffffffffffffffffffffffff
(base) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$
