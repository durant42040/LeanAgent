2024-11-01 10:17:22.480 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 75.43859649122805
2024-11-01 10:17:22.481 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 75.43859649122805
2024-11-01 10:17:22.481 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 75.43859649122805
2024-11-01 10:17:22.482 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 75.43859649122805
2024-11-01 10:17:22.483 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 75.43859649122805
2024-11-01 10:17:22.484 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 75.43859649122805
2024-11-01 10:17:22.484 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 75.43859649122805
2024-11-01 10:17:22.485 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 75.43859649122805
2024-11-01 10:17:22.486 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 76.3157894736842
2024-11-01 10:17:22.487 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 76.3157894736842
2024-11-01 10:17:22.487 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 78.94736842105262
2024-11-01 10:17:22.488 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 78.94736842105262
2024-11-01 10:17:22.489 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 78.94736842105262
2024-11-01 10:17:22.490 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 78.94736842105262
2024-11-01 10:17:22.490 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 78.94736842105262
2024-11-01 10:17:22.491 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 78.94736842105262
2024-11-01 10:17:22.492 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 78.94736842105262
2024-11-01 10:17:22.493 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 78.94736842105262
2024-11-01 10:17:22.493 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 79.47368421052632
2024-11-01 10:17:22.494 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 79.47368421052632
2024-11-01 10:17:22.495 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 79.47368421052632
2024-11-01 10:17:22.496 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 79.47368421052632
2024-11-01 10:17:22.497 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 79.47368421052632
2024-11-01 10:17:22.497 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 80.78947368421052
2024-11-01 10:17:22.498 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 80.78947368421052
2024-11-01 10:17:22.499 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 80.78947368421052
2024-11-01 10:17:22.500 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 80.78947368421052
2024-11-01 10:17:22.500 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 80.78947368421052
2024-11-01 10:17:22.501 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 80.78947368421052
2024-11-01 10:17:22.502 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 80.78947368421052
2024-11-01 10:17:22.503 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 80.78947368421052
2024-11-01 10:17:22.503 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 80.78947368421052
2024-11-01 10:17:22.504 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 80.78947368421052
2024-11-01 10:17:22.505 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 80.78947368421052
2024-11-01 10:17:22.506 | INFO     | retrieval.model:validation_step:379 - MRR: 0.4270834897468343
2024-11-01 10:17:22.506 | INFO     | retrieval.model:validation_step:387 - End of validation_step
                                                                                                                                                                                                                        2024-11-01 10:17:22.524 | IN
FO     | retrieval.model:validation_step:316 - Inside validation_step█████████████████████████████████████████████████████████████████████████████████        | 37/39 [03:01<00:09,  0.20it/s]
2024-11-01 10:17:22.546 | INFO     | retrieval.model:validation_step:320 - Embeddings staled validation step: False
2024-11-01 10:17:27.735 | INFO     | retrieval.model:validation_step:370 - Recall@1_val: 20.27027027027027
2024-11-01 10:17:27.736 | INFO     | retrieval.model:validation_step:370 - Recall@2_val: 28.296703296703296
2024-11-01 10:17:27.737 | INFO     | retrieval.model:validation_step:370 - Recall@3_val: 35.91048591048591
2024-11-01 10:17:27.738 | INFO     | retrieval.model:validation_step:370 - Recall@4_val: 38.37063837063837
2024-11-01 10:17:27.739 | INFO     | retrieval.model:validation_step:370 - Recall@5_val: 40.62604062604062
2024-11-01 10:17:27.740 | INFO     | retrieval.model:validation_step:370 - Recall@6_val: 45.580995580995584
2024-11-01 10:17:27.740 | INFO     | retrieval.model:validation_step:370 - Recall@7_val: 46.93234693234694
2024-11-01 10:17:27.741 | INFO     | retrieval.model:validation_step:370 - Recall@8_val: 50.08550008550009
2024-11-01 10:17:27.742 | INFO     | retrieval.model:validation_step:370 - Recall@9_val: 51.64475164475164
2024-11-01 10:17:27.743 | INFO     | retrieval.model:validation_step:370 - Recall@10_val: 51.64475164475164
2024-11-01 10:17:27.743 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 53.24180324180324
2024-11-01 10:17:27.744 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 53.917478917478924
2024-11-01 10:17:27.745 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 54.12537912537911
2024-11-01 10:17:27.746 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 54.57897957897958
2024-11-01 10:17:27.746 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 54.82467982467982
2024-11-01 10:17:27.747 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 55.50035550035549
2024-11-01 10:17:27.748 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 55.50035550035549
2024-11-01 10:17:27.749 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 55.50035550035549
2024-11-01 10:17:27.749 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 55.70825570825571
2024-11-01 10:17:27.750 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 57.05960705960707
2024-11-01 10:17:27.751 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 57.305307305307295
2024-11-01 10:17:27.752 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 57.305307305307295
2024-11-01 10:17:27.753 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 59.33233433233433
2024-11-01 10:17:27.753 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 60.47893547893548
2024-11-01 10:17:27.754 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 61.154611154611146
2024-11-01 10:17:27.755 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 61.154611154611146
2024-11-01 10:17:27.756 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 61.4003114003114
2024-11-01 10:17:27.756 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 61.60821160821162
2024-11-01 10:17:27.757 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 62.28388728388728
2024-11-01 10:17:27.758 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 64.98658998658999
2024-11-01 10:17:27.759 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 64.98658998658999
2024-11-01 10:17:27.760 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 65.1944901944902
2024-11-01 10:17:27.761 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 65.1944901944902
2024-11-01 10:17:27.761 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 65.1944901944902
2024-11-01 10:17:27.762 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 65.1944901944902
2024-11-01 10:17:27.763 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 65.87016587016588
2024-11-01 10:17:27.764 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 68.57286857286857
2024-11-01 10:17:27.764 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 68.57286857286857
2024-11-01 10:17:27.765 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 68.57286857286857
2024-11-01 10:17:27.766 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 68.57286857286857
2024-11-01 10:17:27.767 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 69.47376947376948
2024-11-01 10:17:27.768 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 69.47376947376948
2024-11-01 10:17:27.768 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 69.47376947376948
2024-11-01 10:17:27.769 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 69.47376947376948
2024-11-01 10:17:27.770 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 69.47376947376948
2024-11-01 10:17:27.770 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 70.37467037467037
2024-11-01 10:17:27.771 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 70.37467037467037
2024-11-01 10:17:27.772 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 70.37467037467037
2024-11-01 10:17:27.773 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 70.37467037467037
2024-11-01 10:17:27.773 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 73.07737307737308
2024-11-01 10:17:27.774 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 73.07737307737308
2024-11-01 10:17:27.775 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 73.07737307737308
2024-11-01 10:17:27.776 | INFO     | retrieval.model:validation_step:370 - Recall@53_val: 73.07737307737308
2024-11-01 10:17:27.776 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 73.07737307737308
2024-11-01 10:17:27.777 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 73.32307332307333
2024-11-01 10:17:27.778 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 73.32307332307333
2024-11-01 10:17:27.779 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 73.32307332307333
2024-11-01 10:17:27.779 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 73.32307332307333
2024-11-01 10:17:27.780 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 73.32307332307333
2024-11-01 10:17:27.781 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 73.32307332307333
2024-11-01 10:17:27.782 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 73.32307332307333
2024-11-01 10:17:27.783 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 73.32307332307333
2024-11-01 10:17:27.783 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 73.32307332307333
2024-11-01 10:17:27.784 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 73.998748998749
2024-11-01 10:17:27.785 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 73.998748998749
2024-11-01 10:17:27.786 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 73.998748998749
2024-11-01 10:17:27.786 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 73.998748998749
2024-11-01 10:17:27.787 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 73.998748998749
2024-11-01 10:17:27.788 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 73.998748998749
2024-11-01 10:17:27.789 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 73.998748998749
2024-11-01 10:17:27.789 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 73.998748998749
2024-11-01 10:17:27.790 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 73.998748998749
2024-11-01 10:17:27.791 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 73.998748998749
2024-11-01 10:17:27.792 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 73.998748998749
2024-11-01 10:17:27.792 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 74.67442467442467
2024-11-01 10:17:27.793 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 74.67442467442467
2024-11-01 10:17:27.794 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 74.67442467442467
2024-11-01 10:17:27.795 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 75.26842526842526
2024-11-01 10:17:27.795 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 75.26842526842526
2024-11-01 10:17:27.796 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 75.26842526842526
2024-11-01 10:17:27.797 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 75.26842526842526
2024-11-01 10:17:27.798 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 75.26842526842526
2024-11-01 10:17:27.798 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 75.26842526842526
2024-11-01 10:17:27.799 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 75.26842526842526
2024-11-01 10:17:27.800 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 75.26842526842526
2024-11-01 10:17:27.801 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 75.26842526842526
2024-11-01 10:17:27.801 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 75.26842526842526
2024-11-01 10:17:27.802 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 75.26842526842526
2024-11-01 10:17:27.803 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 75.26842526842526
2024-11-01 10:17:27.804 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 75.26842526842526
2024-11-01 10:17:27.804 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 75.26842526842526
2024-11-01 10:17:27.805 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 75.26842526842526
2024-11-01 10:17:27.806 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 75.47632547632548
2024-11-01 10:17:27.807 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 75.47632547632548
2024-11-01 10:17:27.807 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 75.47632547632548
2024-11-01 10:17:27.808 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 76.82767682767683
2024-11-01 10:17:27.809 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 77.07337707337707
2024-11-01 10:17:27.810 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 77.07337707337707
2024-11-01 10:17:27.810 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 77.07337707337707
2024-11-01 10:17:27.811 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 77.07337707337707
2024-11-01 10:17:27.812 | INFO     | retrieval.model:validation_step:379 - MRR: 0.42439267830865945
2024-11-01 10:17:27.813 | INFO     | retrieval.model:validation_step:387 - End of validation_step
                                                                                                                                                                                                                        2024-11-01 10:17:27.822 | IN
FO     | retrieval.model:validation_step:316 - Inside validation_step█████████████████████████████████████████████████████████████████████████████████████    | 38/39 [03:06<00:04,  0.20it/s]
2024-11-01 10:17:27.844 | INFO     | retrieval.model:validation_step:320 - Embeddings staled validation step: False
2024-11-01 10:17:30.459 | INFO     | retrieval.model:validation_step:370 - Recall@1_val: 16.85185185185185
2024-11-01 10:17:30.460 | INFO     | retrieval.model:validation_step:370 - Recall@2_val: 27.222222222222225
2024-11-01 10:17:30.461 | INFO     | retrieval.model:validation_step:370 - Recall@3_val: 32.77777777777778
2024-11-01 10:17:30.462 | INFO     | retrieval.model:validation_step:370 - Recall@4_val: 43.888888888888886
2024-11-01 10:17:30.463 | INFO     | retrieval.model:validation_step:370 - Recall@5_val: 48.88888888888889
2024-11-01 10:17:30.464 | INFO     | retrieval.model:validation_step:370 - Recall@6_val: 50.0
2024-11-01 10:17:30.465 | INFO     | retrieval.model:validation_step:370 - Recall@7_val: 50.0
2024-11-01 10:17:30.466 | INFO     | retrieval.model:validation_step:370 - Recall@8_val: 55.55555555555556
2024-11-01 10:17:30.466 | INFO     | retrieval.model:validation_step:370 - Recall@9_val: 56.666666666666664
2024-11-01 10:17:30.467 | INFO     | retrieval.model:validation_step:370 - Recall@10_val: 58.51851851851851
2024-11-01 10:17:30.468 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 58.51851851851851
2024-11-01 10:17:30.469 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 58.51851851851851
2024-11-01 10:17:30.470 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 58.51851851851851
2024-11-01 10:17:30.470 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 59.62962962962962
2024-11-01 10:17:30.471 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 62.4074074074074
2024-11-01 10:17:30.472 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 62.4074074074074
2024-11-01 10:17:30.473 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 62.4074074074074
2024-11-01 10:17:30.474 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 64.25925925925927
2024-11-01 10:17:30.475 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 64.25925925925927
2024-11-01 10:17:30.475 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 64.25925925925927
2024-11-01 10:17:30.476 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 64.25925925925927
2024-11-01 10:17:30.477 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 64.25925925925927
2024-11-01 10:17:30.478 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 64.25925925925927
2024-11-01 10:17:30.479 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 69.81481481481482
2024-11-01 10:17:30.480 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 72.59259259259258
2024-11-01 10:17:30.480 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 78.14814814814814
2024-11-01 10:17:30.481 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 78.14814814814814
2024-11-01 10:17:30.482 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 78.14814814814814
2024-11-01 10:17:30.483 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 78.14814814814814
2024-11-01 10:17:30.484 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 78.14814814814814
2024-11-01 10:17:30.485 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 78.14814814814814
2024-11-01 10:17:30.485 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 78.14814814814814
2024-11-01 10:17:30.486 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 78.14814814814814
2024-11-01 10:17:30.487 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 78.14814814814814
2024-11-01 10:17:30.488 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 78.14814814814814
2024-11-01 10:17:30.489 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 78.14814814814814
2024-11-01 10:17:30.490 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 78.14814814814814
2024-11-01 10:17:30.490 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 78.14814814814814
2024-11-01 10:17:30.491 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 78.14814814814814
2024-11-01 10:17:30.492 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 78.14814814814814
2024-11-01 10:17:30.493 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 79.25925925925925
2024-11-01 10:17:30.494 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 79.25925925925925
2024-11-01 10:17:30.494 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 79.25925925925925
2024-11-01 10:17:30.495 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 79.25925925925925
2024-11-01 10:17:30.496 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 79.25925925925925
2024-11-01 10:17:30.497 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 79.25925925925925
2024-11-01 10:17:30.498 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 79.25925925925925
2024-11-01 10:17:30.498 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 79.25925925925925
2024-11-01 10:17:30.499 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 79.25925925925925
2024-11-01 10:17:30.500 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 79.25925925925925
2024-11-01 10:17:30.501 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 79.25925925925925
2024-11-01 10:17:30.501 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 79.25925925925925
2024-11-01 10:17:30.502 | INFO     | retrieval.model:validation_step:370 - Recall@53_val: 79.25925925925925
2024-11-01 10:17:30.503 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 79.25925925925925
2024-11-01 10:17:30.504 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 79.25925925925925
2024-11-01 10:17:30.505 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 79.25925925925925
2024-11-01 10:17:30.505 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 79.25925925925925
2024-11-01 10:17:30.506 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 79.25925925925925
2024-11-01 10:17:30.507 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 79.25925925925925
2024-11-01 10:17:30.508 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 79.25925925925925
2024-11-01 10:17:30.508 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 81.11111111111111
2024-11-01 10:17:30.509 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 81.11111111111111
2024-11-01 10:17:30.510 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 81.11111111111111
2024-11-01 10:17:30.511 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 81.11111111111111
2024-11-01 10:17:30.512 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 81.11111111111111
2024-11-01 10:17:30.512 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 81.11111111111111
2024-11-01 10:17:30.513 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 81.11111111111111
2024-11-01 10:17:30.514 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 81.11111111111111
2024-11-01 10:17:30.515 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 81.11111111111111
2024-11-01 10:17:30.515 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 81.11111111111111
2024-11-01 10:17:30.516 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 81.11111111111111
2024-11-01 10:17:30.517 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 81.11111111111111
2024-11-01 10:17:30.518 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 83.88888888888889
2024-11-01 10:17:30.519 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 83.88888888888889
2024-11-01 10:17:30.519 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 83.88888888888889
2024-11-01 10:17:30.520 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 83.88888888888889
2024-11-01 10:17:30.521 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 83.88888888888889
2024-11-01 10:17:30.522 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 83.88888888888889
2024-11-01 10:17:30.523 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 83.88888888888889
2024-11-01 10:17:30.523 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 83.88888888888889
2024-11-01 10:17:30.524 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 83.88888888888889
2024-11-01 10:17:30.525 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 83.88888888888889
2024-11-01 10:17:30.526 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 83.88888888888889
2024-11-01 10:17:30.526 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 83.88888888888889
2024-11-01 10:17:30.527 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 83.88888888888889
2024-11-01 10:17:30.528 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 83.88888888888889
2024-11-01 10:17:30.529 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 83.88888888888889
2024-11-01 10:17:30.529 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 83.88888888888889
2024-11-01 10:17:30.530 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 83.88888888888889
2024-11-01 10:17:30.531 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 83.88888888888889
2024-11-01 10:17:30.532 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 83.88888888888889
2024-11-01 10:17:30.533 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 83.88888888888889
2024-11-01 10:17:30.533 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 83.88888888888889
2024-11-01 10:17:30.534 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 83.88888888888889
2024-11-01 10:17:30.535 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 83.88888888888889
2024-11-01 10:17:30.536 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 83.88888888888889
2024-11-01 10:17:30.536 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 83.88888888888889
2024-11-01 10:17:30.537 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 83.88888888888889
2024-11-01 10:17:30.538 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 83.88888888888889
2024-11-01 10:17:30.539 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 83.88888888888889
2024-11-01 10:17:30.539 | INFO     | retrieval.model:validation_step:379 - MRR: 0.45250712250712255
2024-11-01 10:17:30.540 | INFO     | retrieval.model:validation_step:387 - End of validation_step
Epoch 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37418/37418 [4:49:46<00:00,  2.15it/s, v_num=10][rank: 3] Monitored metric
Recall@10_val did not improve in the last 16 records. Best score: 72.990. Signaling Trainer to stop.
[rank: 2] Monitored metric Recall@10_val did not improve in the last 16 records. Best score: 72.990. Signaling Trainer to stop.
[rank: 1] Monitored metric Recall@10_val did not improve in the last 16 records. Best score: 72.990. Signaling Trainer to stop.
[rank: 0] Monitored metric Recall@10_val did not improve in the last 16 records. Best score: 72.990. Signaling Trainer to stop.
Epoch 17, global step 86185: 'Recall@10_val' reached 56.49798 (best 72.99026), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch
=17-Recall@10_val=56.50.ckpt' as top 18
`Trainer.fit` stopped: `max_epochs=18` reached.
Epoch 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37418/37418 [4:50:22<00:00,  2.15it/s, v_num=10]
2024-11-01 10:18:09.857 | INFO     | __main__:main:1763 - hit the barrier after training
2024-11-01 10:18:10.028 | INFO     | __main__:main:1763 - hit the barrier after training
2024-11-01 10:18:10.125 | INFO     | __main__:main:1763 - hit the barrier after training
2024-11-01 10:18:10.483 | INFO     | __main__:main:1763 - hit the barrier after training
2024-11-01 10:18:10.484 | INFO     | __main__:main:1769 - Finished progressive training at epoch 18
2024-11-01 10:18:10.484 | INFO     | __main__:main:1769 - Finished progressive training at epoch 18
2024-11-01 10:18:10.484 | INFO     | __main__:main:1769 - Finished progressive training at epoch 18
2024-11-01 10:18:10.484 | INFO     | __main__:main:1769 - Finished progressive training at epoch 18
2024-11-01 10:18:10.485 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0
.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:main:1776 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10
_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0
.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0
.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:main:1776 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10
_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:main:1776 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10
_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0
.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 10:18:10.485 | INFO     | __main__:main:1776 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10
_val=56.50.ckpt
2024-11-01 10:18:16.864 | INFO     | __main__:main:1786 - Testing...
2024-11-01 10:18:16.867 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
2024-11-01 10:18:16.913 | INFO     | __main__:main:1786 - Testing...
2024-11-01 10:18:16.914 | INFO     | __main__:main:1786 - Testing...
2024-11-01 10:18:16.914 | INFO     | __main__:main:1786 - Testing...
2024-11-01 10:18:16.914 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 10:18:16.914 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 10:18:16.915 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-01 10:18:17.294 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-11-01 10:18:17.294 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-11-01 10:18:17.313 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-11-01 10:18:17.314 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-11-01 10:18:17.321 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-11-01 10:18:17.321 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
2024-11-01 10:18:17.323 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random
2024-11-01 10:18:17.323 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpu
s.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 148487/148487 [00:41<00:00, 3589.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 148487/148487 [00:48<00:00, 3084.68it/s]
 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 139695/148487 [00:47<00:01, 4507.63it/s]2024-11-01 10:19:58.792 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_train/c
ached_data.pkl
Training dataset size: 329522
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3093/3093 [00:00<00:00, 4200.54it/s]
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 144039/148487 [00:48<00:00, 4966.89it/s]2024-11-01 10:19:59.693 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/ca
ched_data.pkl
Testing dataset size: 6145
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 148487/148487 [00:49<00:00, 2992.08it/s]
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 145548/148487 [00:50<00:00, 4800.61it/s]2024-11-01 10:20:00.760 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_train/c
ached_data.pkl
Training dataset size: 329522
2024-11-01 10:20:00.809 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/random/cache_pred/cached_data.pkl
Testing dataset size: 6145
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 148487/148487 [00:51<00:00, 2885.91it/s]
2024-11-01 10:20:02.469 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_train/cached_data.pkl
Training dataset size: 329522
2024-11-01 10:20:02.509 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/random/cache_pred/cached_data.pkl
Testing dataset size: 6145
2024-11-01 10:20:03.475 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae242
53d566/random/cache_train/cached_data.pkl
Training dataset size: 329522
2024-11-01 10:20:03.516 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/random/cache_pred/cached_data.pkl
Testing dataset size: 6145
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 10:20:08.279 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:20:08.280 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2243 [00:00<?, ?it/s]2024-11-01 10:20:08.339 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:20:08.340 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2243 [00:00<?, ?it/s]2024-11-01 10:20:08.433 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:20:08.434 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 10:20:09.211 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:20:09.212 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2243/2243 [12:12<00:00,  3.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2243/2243 [12:15<00:00,  3.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 2239/2243 [12:16<00:01,  2.85it/s]/data/yingzi_ma/miniconda3/
envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2243/2243 [12:17<00:00,  3.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2243/2243 [12:18<00:00,  3.04it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [01:59<00:00,  0.21it/s]2024-11-01 10:34:21.382 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:34:21.382 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:34:21.382 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:34:21.383 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:34:21.713 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 10:34:21.713 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:34:21.760 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 10:34:21.761 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:34:21.774 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 10:34:21.774 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:34:21.779 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 10:34:21.780 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:34:21.780 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [02:00<00:00,  0.21it/s]
2024-11-01 10:34:23.641 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 10:34:23.734 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 10:34:23.767 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-01 10:34:24.007 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-11-01 10:34:24.007 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-01 10:34:24.091 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-11-01 10:34:24.091 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-11-01 10:34:24.141 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-11-01 10:34:24.141 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
2024-11-01 10:34:24.561 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 10:34:24.691 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3093/3093 [00:00<00:00, 21574.28it/s]
2024-11-01 10:34:24.837 | INFO     | __main__:main:1813 - R@1 = 22.441101359522317 %, R@10 = 60.60690323300959 %, MRR = 0.4868605711142022
2024-11-01 10:34:24.839 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 10:34:25.261 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random
2024-11-01 10:34:25.261 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-01 10:34:52.024 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-11-01 10:34:52.144 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
2024-11-01 10:35:02.147 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-11-01 10:35:02.196 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
2024-11-01 10:35:03.690 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-11-01 10:35:03.742 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
2024-11-01 10:35:03.963 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_train/cached_data.pkl
Training dataset size: 297322
2024-11-01 10:35:04.007 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 5232
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 10:35:08.016 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:35:08.017 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2130 [00:00<?, ?it/s]2024-11-01 10:35:08.155 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:35:08.155 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/2130 [00:00<02:35, 13.70it/s]2024-11-01 10:35:08.370 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:35:08.376 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 10:35:09.367 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:35:09.369 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:12<00:00,  3.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:14<00:00,  3.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:16<00:00,  3.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2130/2130 [11:17<00:00,  3.14it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:57<00:00,  0.36it/s]2024-11-01 10:47:19.354 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:47:19.570 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 10:47:19.570 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:47:26.883 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:47:27.117 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 10:47:27.117 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:47:27.433 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:47:27.433 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 10:47:27.650 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 10:47:27.650 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:47:27.694 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 10:47:27.694 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 10:47:27.695 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [01:06<00:00,  0.32it/s]
2024-11-01 10:47:29.180 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 10:47:29.395 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 10:47:29.523 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 3] Seed set to 3407
2024-11-01 10:47:29.662 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-11-01 10:47:29.663 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-01 10:47:29.792 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-11-01 10:47:29.792 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-01 10:47:29.882 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-11-01 10:47:29.883 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
2024-11-01 10:47:30.742 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 10:47:30.841 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3364/3364 [00:00<00:00, 32592.02it/s]
2024-11-01 10:47:30.947 | INFO     | __main__:main:1813 - R@1 = 22.581524427857147 %, R@10 = 59.50589527476501 %, MRR = 0.47293707025209636
2024-11-01 10:47:30.948 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 10:47:31.264 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random
2024-11-01 10:47:31.264 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 208868/208868 [00:45<00:00, 4616.52it/s]
 70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 145233/208868 [00:42<00:19, 3204.76it/s]2024-11-01 10:49:51.716 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/cache_train/cached_data.
pkl
Training dataset size: 514107
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4351/4351 [00:00<00:00, 4708.75it/s]
 77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 160195/208868 [00:43<00:15, 3126.55it/s]2024-11-01 10:50:02.751 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/cache_pred/cached_data.p
kl
Testing dataset size: 8935
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 208868/208868 [01:02<00:00, 3330.61it/s]
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 206154/208868 [00:57<00:00, 3539.71it/s]2024-11-01 10:50:16.309 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/cache_train/cached_data.
pkl
Training dataset size: 514107
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 200531/208868 [01:00<00:02, 4058.67it/s]2024-11-01 10:50:16.383 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/cache_pred/cached_data.pkl
Testing dataset size: 8935
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 208868/208868 [00:58<00:00, 3595.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 208868/208868 [01:02<00:00, 3347.55it/s]
2024-11-01 10:50:21.608 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_train/cached_data.pkl
Training dataset size: 514107
2024-11-01 10:50:21.688 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/c
ache_pred/cached_data.pkl
Testing dataset size: 8935
2024-11-01 10:50:21.845 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/rand
om/cache_train/cached_data.pkl
Training dataset size: 514107
2024-11-01 10:50:21.898 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/c
ache_pred/cached_data.pkl
Testing dataset size: 8935
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-01 10:50:26.163 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:50:26.216 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/3087 [00:00<?, ?it/s]2024-11-01 10:50:26.285 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:50:26.286 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 3/3087 [00:00<05:21,  9.60it/s]2024-11-01 10:50:26.661 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:50:26.662 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▍                                                                                                                                                                                  | 8/3087 [00:01<14:12,  3.61it/s]2024-11-01 10:50:27.874 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 10:50:27.875 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3087/3087 [18:04<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3087/3087 [18:08<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3087/3087 [18:10<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3087/3087 [18:13<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:34<00:00,  0.23it/s]2024-11-01 11:11:06.398 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:11:06.398 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:11:06.398 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:11:06.398 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:11:06.767 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 11:11:06.767 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:11:06.777 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 11:11:06.778 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:11:06.831 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 11:11:06.832 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:11:06.833 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 11:11:06.834 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:11:06.834 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:34<00:00,  0.23it/s]
2024-11-01 11:11:08.575 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 11:11:08.715 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 11:11:08.829 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
[rank: 2] Seed set to 3407
2024-11-01 11:11:09.041 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-11-01 11:11:09.041 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-01 11:11:09.130 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-11-01 11:11:09.130 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-01 11:11:09.248 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-11-01 11:11:09.248 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-11-01 11:11:10.656 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 11:11:10.864 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Foundation_d5fe5d057a90a0703a745cdc318a1b6621490c21/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4351/4351 [00:00<00:00, 22046.32it/s]
2024-11-01 11:11:11.072 | INFO     | __main__:main:1813 - R@1 = 22.768848257414852 %, R@10 = 58.72126576477535 %, MRR = 0.4853010373320398
2024-11-01 11:11:11.074 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 11:11:11.503 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-11-01 11:11:11.503 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-01 11:12:10.259 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_train/cached_data.pkl
Training dataset size: 598689
2024-11-01 11:12:10.329 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_pred/cached_data.pkl
Testing dataset size: 9478
2024-11-01 11:12:32.814 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_train/cached_data.pkl
Training dataset size: 598689
2024-11-01 11:12:32.876 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_pred/cached_data.pkl
Testing dataset size: 9478
2024-11-01 11:12:34.818 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_train/cached_data.pkl
Training dataset size: 598689
2024-11-01 11:12:34.895 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_pred/cached_data.pkl
Testing dataset size: 9478
2024-11-01 11:12:51.155 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_train/cached_data.pkl
Training dataset size: 598689
2024-11-01 11:12:51.247 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_pred/cached_data.pkl
Testing dataset size: 9478
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 11:12:55.719 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:12:55.720 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 2/3230 [00:00<03:46, 14.22it/s]2024-11-01 11:12:55.895 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:12:55.896 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3230 [00:00<05:19, 10.10it/s]2024-11-01 11:12:56.235 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:12:56.236 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 11:12:57.244 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:12:57.245 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [18:52<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [18:56<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [18:58<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [19:01<00:00,  2.83it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:43<00:00,  0.23it/s]2024-11-01 11:34:33.704 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:34:33.705 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:34:34.046 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 11:34:34.047 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:34:34.089 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 11:34:34.090 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:34:41.111 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:34:41.111 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:34:41.549 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 11:34:41.550 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:34:41.570 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 11:34:41.570 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:34:41.571 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:51<00:00,  0.22it/s]
2024-11-01 11:34:42.897 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 11:34:43.436 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-01 11:34:43.861 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-01 11:34:43.861 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-11-01 11:34:43.862 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 11:34:43.955 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-01 11:34:43.955 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
[rank: 2] Seed set to 3407
2024-11-01 11:34:44.194 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-01 11:34:44.194 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-11-01 11:34:45.605 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 11:34:45.852 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5015/5015 [00:00<00:00, 20697.87it/s]
2024-11-01 11:34:46.100 | INFO     | __main__:main:1813 - R@1 = 21.031737392786276 %, R@10 = 56.111568537670344 %, MRR = 0.45878231455164203
2024-11-01 11:34:46.101 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 11:34:46.463 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-01 11:34:46.463 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196224/196224 [00:45<00:00, 4295.65it/s]
 44%|██████████████████████████████████████████████████████████████████████████▉                                                                                                | 86006/196224 [00:31<00:24, 4457.63it/s]2024-11-01 11:37:09.037 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/ca
ched_data.pkl
Training dataset size: 493919
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4088/4088 [00:00<00:00, 4428.25it/s]
 47%|███████████████████████████████████████████████████████████████████████████████▉                                                                                           | 91793/196224 [00:33<00:21, 4908.89it/s]2024-11-01 11:37:10.207 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cac
hed_data.pkl
Testing dataset size: 8768
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196224/196224 [00:54<00:00, 3580.55it/s]
 27%|██████████████████████████████████████████████▎                                                                                                                            | 53091/196224 [00:15<00:31, 4488.14it/s]2024-11-01 11:37:35.645 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/ca
ched_data.pkl
Training dataset size: 493919
 28%|████████████████████████████████████████████████▏                                                                                                                          | 55245/196224 [00:16<00:39, 3578.79it/s]2024-11-01 11:37:35.705 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_
data.pkl
Testing dataset size: 8768
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196224/196224 [00:59<00:00, 3271.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196224/196224 [01:00<00:00, 3260.45it/s]
2024-11-01 11:38:23.477 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_train/cached_data.pkl
Training dataset size: 493919
2024-11-01 11:38:23.534 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 8768
2024-11-01 11:38:24.986 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f56
4669f/random/cache_train/cached_data.pkl
Training dataset size: 493919
2024-11-01 11:38:25.054 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 8768
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 11:38:28.897 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:38:28.898 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 2/3021 [00:00<03:33, 14.15it/s]2024-11-01 11:38:29.122 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:38:29.128 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3021 [00:00<04:46, 10.51it/s]2024-11-01 11:38:29.711 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:38:29.712 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 11:38:30.409 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 11:38:30.409 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [17:36<00:00,  2.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [17:39<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [17:41<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [18:02<00:00,  2.79it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:37<00:00,  0.22it/s]2024-11-01 11:59:10.750 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:59:10.751 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:59:10.751 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:59:10.751 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 11:59:11.070 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 11:59:11.070 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:59:11.119 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 11:59:11.119 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:59:11.129 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 11:59:11.130 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:59:11.143 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 11:59:11.143 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 11:59:11.144 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:38<00:00,  0.22it/s]
2024-11-01 11:59:13.412 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 11:59:13.435 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 11:59:13.627 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-01 11:59:13.780 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-01 11:59:13.780 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-11-01 11:59:13.802 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-01 11:59:13.803 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-01 11:59:13.976 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-01 11:59:13.977 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-11-01 11:59:15.503 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 11:59:15.719 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4088/4088 [00:00<00:00, 20841.08it/s]
2024-11-01 11:59:15.920 | INFO     | __main__:main:1813 - R@1 = 21.010908460132175 %, R@10 = 58.40145774914568 %, MRR = 0.46943198051863005
2024-11-01 11:59:15.922 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 11:59:16.297 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-01 11:59:16.297 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 69356/69356 [00:11<00:00, 6278.89it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 68526/69356 [00:19<00:00, 3566.00it/s]2024-11-01 12:00:01.029 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149237
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 69356/69356 [00:19<00:00, 3514.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1444/1444 [00:00<00:00, 6864.41it/s]
2024-11-01 12:00:01.296 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_pred/cached_data.pkl
Testing dataset size: 2062
 17%|██████████████████████████████                                                                                                                                              | 12121/69356 [00:02<00:11, 5090.68it/s]2024-11-01 12:00:02.522 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149237
2024-11-01 12:00:02.542 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 69356/69356 [00:10<00:00, 6442.22it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▏                                                                                      | 34361/69356 [00:07<00:07, 4631.38it/s]2024-11-01 12:00:07.504 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149237
2024-11-01 12:00:07.531 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 69356/69356 [00:25<00:00, 2667.72it/s]
2024-11-01 12:00:27.119 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/
cache_train/cached_data.pkl
Training dataset size: 149237
2024-11-01 12:00:27.146 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 12:00:31.104 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:00:31.105 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2027 [00:00<?, ?it/s]2024-11-01 12:00:31.154 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:00:31.155 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/2027 [00:00<02:15, 14.95it/s]2024-11-01 12:00:31.414 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:00:31.415 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 12:00:33.276 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:00:33.277 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:21<00:00,  3.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:19<00:00,  3.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:23<00:00,  3.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:24<00:00,  3.59it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:26<00:00,  0.34it/s]2024-11-01 12:10:19.825 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:10:19.950 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 12:10:19.951 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:10:20.142 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:10:20.142 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:10:20.142 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:10:20.258 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 12:10:20.258 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:10:20.291 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 12:10:20.291 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:10:20.296 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 12:10:20.296 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:10:20.297 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:27<00:00,  0.33it/s]
2024-11-01 12:10:22.454 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 12:10:22.537 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 12:10:22.545 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-01 12:10:22.848 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-01 12:10:22.849 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-11-01 12:10:22.895 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-01 12:10:22.895 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-11-01 12:10:22.939 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-01 12:10:22.939 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-11-01 12:10:23.885 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 12:10:23.971 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1444/1444 [00:00<00:00, 30577.33it/s]
2024-11-01 12:10:24.022 | INFO     | __main__:main:1813 - R@1 = 28.50457124959704 %, R@10 = 70.29727557604454 %, MRR = 0.6049722060290401
2024-11-01 12:10:24.024 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 12:10:24.452 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-01 12:10:24.453 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [00:43<00:00, 4500.46it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                  | 100409/195879 [01:22<00:19, 4984.51it/s]2024-11-01 12:12:39.638 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_tr
ain/cached_data.pkl
Training dataset size: 493772
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4080/4080 [00:00<00:00, 4829.63it/s]
 59%|███████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                      | 114950/195879 [00:42<00:20, 4008.18it/s]2024-11-01 12:12:40.708 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 8803
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [01:00<00:00, 3230.78it/s]
 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                           | 163910/195879 [00:55<00:09, 3458.07it/s]2024-11-01 12:12:54.067 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_tr
ain/cached_data.pkl
Training dataset size: 493772
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                        | 167412/195879 [01:36<00:06, 4323.24it/s]2024-11-01 12:12:54.133 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/c
ached_data.pkl
Testing dataset size: 8803
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [01:43<00:00, 1889.36it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [01:02<00:00, 3116.15it/s]
2024-11-01 12:13:04.945 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 493772
2024-11-01 12:13:05.019 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 8803
2024-11-01 12:13:05.060 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 493772
2024-11-01 12:13:05.121 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 8803
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-01 12:13:09.287 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:13:09.288 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3015 [00:00<04:49, 10.42it/s]2024-11-01 12:13:09.904 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:13:09.905 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/3015 [00:00<?, ?it/s]2024-11-01 12:13:10.011 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:13:10.012 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 12:13:11.487 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:13:11.487 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:31<00:00,  2.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:35<00:00,  2.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:37<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:39<00:00,  2.84it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:40<00:00,  0.22it/s]2024-11-01 12:33:23.496 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:33:23.497 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:33:23.497 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:33:23.497 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:33:23.793 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 12:33:23.793 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:33:23.875 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 12:33:23.875 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:33:23.914 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 12:33:23.914 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:33:23.934 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 12:33:23.934 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:33:23.935 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:41<00:00,  0.22it/s]
2024-11-01 12:33:25.908 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 12:33:25.980 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 12:33:26.130 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-01 12:33:26.374 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 12:33:26.374 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-01 12:33:26.390 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 12:33:26.390 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-01 12:33:26.494 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 12:33:26.495 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-01 12:33:27.975 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 12:33:28.171 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4080/4080 [00:00<00:00, 18997.54it/s]
2024-11-01 12:33:28.397 | INFO     | __main__:main:1813 - R@1 = 21.450946178092327 %, R@10 = 59.06443803260121 %, MRR = 0.47192135388216333
2024-11-01 12:33:28.398 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 12:33:28.866 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 12:33:28.866 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 193248/193248 [00:48<00:00, 4007.68it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                           | 71653/193248 [00:18<00:30, 3950.47it/s]2024-11-01 12:35:15.100 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache_train/cached_data.pkl
Training dataset size: 487873
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4025/4025 [00:01<00:00, 3305.78it/s]
 42%|███████████████████████████████████████████████████████████████████████▍                                                                                                   | 80710/193248 [00:22<00:22, 4948.10it/s]2024-11-01 12:35:16.613 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache_pred/cached_data.pkl
Testing dataset size: 8622
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 193248/193248 [00:54<00:00, 3577.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 193248/193248 [00:43<00:00, 4425.32it/s]
 82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 158659/193248 [00:42<00:07, 4362.29it/s]2024-11-01 12:35:38.897 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache_train/cached_data.pkl
Training dataset size: 487873
2024-11-01 12:35:38.966 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 160051/193248 [00:42<00:07, 4402.27it/s]2024-11-01 12:35:41.619 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache_train/cached_data.pkl
Training dataset size: 487873
2024-11-01 12:35:41.678 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 193248/193248 [01:01<00:00, 3118.84it/s]
2024-11-01 12:36:01.569 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/c
ache_train/cached_data.pkl
Training dataset size: 487873
2024-11-01 12:36:01.627 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 12:36:05.098 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:36:05.101 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3010 [00:00<04:38, 10.78it/s]2024-11-01 12:36:05.609 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:36:05.610 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 2/3010 [00:00<03:28, 14.42it/s]2024-11-01 12:36:05.783 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:36:05.784 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 12:36:06.896 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:36:06.897 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:30<00:00,  2.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:33<00:00,  2.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:35<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:38<00:00,  2.84it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:28<00:00,  0.23it/s]2024-11-01 12:56:05.079 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:56:05.079 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:56:05.079 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:56:05.079 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 12:56:05.397 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 12:56:05.397 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:56:05.427 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 12:56:05.427 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:56:05.465 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 12:56:05.466 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:56:05.474 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 12:56:05.474 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 12:56:05.475 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:28<00:00,  0.23it/s]
2024-11-01 12:56:07.515 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 12:56:07.819 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
[rank: 1] Seed set to 3407
2024-11-01 12:56:07.861 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 12:56:07.933 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-01 12:56:07.933 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-01 12:56:08.163 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-01 12:56:08.163 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-11-01 12:56:08.217 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-01 12:56:08.218 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-11-01 12:56:10.632 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 12:56:10.866 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4025/4025 [00:00<00:00, 17856.43it/s]
2024-11-01 12:56:11.105 | INFO     | __main__:main:1813 - R@1 = 21.60044930507529 %, R@10 = 59.03317542618737 %, MRR = 0.4737171060478097
2024-11-01 12:56:11.106 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 12:56:11.539 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-01 12:56:11.539 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 192953/192953 [00:41<00:00, 4688.98it/s]
2024-11-01 12:57:42.247 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_train/cached_data.pkl
Training dataset size: 485344
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4019/4019 [00:00<00:00, 4443.42it/s]
2024-11-01 12:57:43.380 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_pred/cached_data.pkl
Testing dataset size: 8627
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 192953/192953 [00:51<00:00, 3745.83it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 172490/192953 [00:50<00:06, 3181.93it/s]2024-11-01 12:58:39.289 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.p
kl
Training dataset size: 485344
 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 172885/192953 [00:50<00:06, 3311.95it/s]2024-11-01 12:58:39.350 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 8627
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 192953/192953 [00:56<00:00, 3431.07it/s]
 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                          | 162876/192953 [00:59<00:05, 5189.62it/s]2024-11-01 12:58:49.049 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.p
kl
Training dataset size: 485344
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                          | 163451/192953 [00:59<00:05, 5329.96it/s]2024-11-01 12:58:49.112 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 8627
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 192953/192953 [01:05<00:00, 2961.19it/s]
2024-11-01 12:58:57.963 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/rando
m/cache_train/cached_data.pkl
Training dataset size: 485344
2024-11-01 12:58:58.036 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 8627
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-01 12:59:01.940 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:59:01.940 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 3/3005 [00:00<05:05,  9.83it/s]2024-11-01 12:59:02.312 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:59:02.315 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3005 [00:00<05:27,  9.17it/s]2024-11-01 12:59:02.425 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:59:02.426 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 12:59:02.920 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 12:59:02.921 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:27<00:00,  2.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:29<00:00,  2.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:32<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:34<00:00,  2.85it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:19<00:00,  0.24it/s]2024-11-01 13:18:49.213 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:18:49.214 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:18:49.214 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:18:49.214 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:18:49.496 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 13:18:49.496 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:18:49.527 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 13:18:49.527 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:18:49.602 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 13:18:49.602 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:18:49.612 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 13:18:49.612 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:18:49.613 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:19<00:00,  0.24it/s]
2024-11-01 13:18:51.879 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 13:18:52.038 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 13:18:52.100 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
[rank: 2] Seed set to 3407
2024-11-01 13:18:52.276 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-01 13:18:52.277 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-01 13:18:52.466 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-01 13:18:52.466 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-11-01 13:18:52.508 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-01 13:18:52.508 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-11-01 13:18:54.232 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 13:18:54.418 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4019/4019 [00:00<00:00, 21892.74it/s]
2024-11-01 13:18:54.605 | INFO     | __main__:main:1813 - R@1 = 21.44871894750415 %, R@10 = 58.53511373903364 %, MRR = 0.47032144370792567
2024-11-01 13:18:54.607 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 13:18:54.935 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-01 13:18:54.936 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214124/214124 [01:03<00:00, 3364.12it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                        | 122844/214124 [00:34<00:21, 4223.67it/s]2024-11-01 13:21:29.090 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache_train/cached_data.pkl
Training dataset size: 534976
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4460/4460 [00:01<00:00, 4412.40it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                   | 128644/214124 [00:36<00:19, 4494.77it/s]2024-11-01 13:21:30.350 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache_pred/cached_data.pkl
Testing dataset size: 9238
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214124/214124 [00:57<00:00, 3723.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214124/214124 [00:53<00:00, 4027.08it/s]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                | 193585/214124 [00:53<00:05, 3814.32it/s]2024-11-01 13:21:56.191 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache_train/cached_data.pkl
Training dataset size: 534976
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 195782/214124 [00:54<00:04, 4167.77it/s]2024-11-01 13:21:56.615 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache_train/cached_data.pkl
Training dataset size: 534976
2024-11-01 13:21:56.680 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214124/214124 [01:00<00:00, 3556.73it/s]
2024-11-01 13:22:07.359 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/c
ache_train/cached_data.pkl
Training dataset size: 534976
2024-11-01 13:22:07.427 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
2024-11-01 13:22:07.868 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-01 13:22:12.184 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:22:12.188 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 2/3146 [00:00<04:10, 12.53it/s]2024-11-01 13:22:12.507 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:22:12.509 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/3146 [00:00<?, ?it/s]2024-11-01 13:22:12.555 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
  0%|▏                                                                                                                                                                                  | 4/3146 [00:00<05:06, 10.25it/s]2024-11-01 13:22:12.572 | I
NFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 13:22:13.520 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:22:13.521 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:24<00:00,  2.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:28<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:31<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:33<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [02:01<00:00,  0.30it/s]2024-11-01 13:42:40.308 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:42:40.704 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 13:42:40.705 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:43:01.490 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:43:01.490 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:43:01.490 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 13:43:01.810 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 13:43:01.810 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:43:01.870 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 13:43:01.870 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:43:01.875 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 13:43:01.875 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 13:43:01.875 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [02:23<00:00,  0.26it/s]
2024-11-01 13:43:04.235 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 13:43:04.265 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 13:43:04.365 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-01 13:43:04.611 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-01 13:43:04.611 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-01 13:43:04.657 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-01 13:43:04.657 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-11-01 13:43:04.734 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-01 13:43:04.734 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-11-01 13:43:06.271 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 13:43:06.451 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4460/4460 [00:00<00:00, 22285.14it/s]
2024-11-01 13:43:06.658 | INFO     | __main__:main:1813 - R@1 = 21.75938502333854 %, R@10 = 56.484013099295424 %, MRR = 0.4667657414382886
2024-11-01 13:43:06.659 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 13:43:06.996 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-01 13:43:06.996 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210554/210554 [00:40<00:00, 5190.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210554/210554 [00:40<00:00, 5258.58it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                | 170957/210554 [00:36<00:08, 4870.33it/s]2024-11-01 13:45:11.902 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/cache_train/cached_data.p
kl
Training dataset size: 518001
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                            | 175558/210554 [00:37<00:09, 3526.49it/s]2024-11-01 13:45:13.060 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/cache_train/cached_data.p
kl
Training dataset size: 518001
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4386/4386 [00:01<00:00, 3695.04it/s]
 22%|█████████████████████████████████████▋                                                                                                                                         | 945/4386 [00:00<00:00, 4614.34it/s]2024-11-01 13:45:13.387 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/cache_pred/cached_data.pk
l
Testing dataset size: 9080
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4386/4386 [00:00<00:00, 4803.45it/s]
 45%|████████████████████████████████████████████████████████████████████████████▊                                                                                              | 94632/210554 [00:34<00:21, 5354.64it/s]2024-11-01 13:45:14.219 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/cache_pred/cached_data.pk
l
Testing dataset size: 9080
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210554/210554 [00:45<00:00, 4641.50it/s]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                  | 148301/210554 [00:44<00:10, 5993.02it/s]2024-11-01 13:45:24.334 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/cache_train/cached_data.p
kl
Training dataset size: 518001
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 148903/210554 [00:44<00:10, 5751.88it/s]2024-11-01 13:45:24.410 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/cache_pred/cached_data.pkl
Testing dataset size: 9080
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210554/210554 [00:55<00:00, 3763.24it/s]
2024-11-01 13:45:39.118 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/rando
m/cache_train/cached_data.pkl
Training dataset size: 518001
2024-11-01 13:45:39.183 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9080
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-01 13:45:43.226 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:45:43.227 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 2/3100 [00:00<03:56, 13.10it/s]2024-11-01 13:45:43.457 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:45:43.458 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3100 [00:00<05:03, 10.21it/s]2024-11-01 13:45:43.617 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:45:43.618 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 13:45:44.274 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 13:45:44.275 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:12<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:16<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:19<00:00,  2.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:21<00:00,  2.81it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:16<00:00,  0.26it/s]2024-11-01 14:06:14.129 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:06:14.129 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:06:14.414 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 14:06:14.415 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:06:14.575 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 14:06:14.576 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:06:19.109 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:06:19.110 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:06:19.416 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 14:06:19.416 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:06:19.475 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 14:06:19.476 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:06:19.476 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:22<00:00,  0.25it/s]
2024-11-01 14:06:21.828 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 14:06:21.857 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 14:06:22.068 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-01 14:06:22.184 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-01 14:06:22.184 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-11-01 14:06:22.240 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-01 14:06:22.240 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-01 14:06:22.406 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-01 14:06:22.407 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-11-01 14:06:24.188 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 14:06:24.462 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4386/4386 [00:00<00:00, 15689.16it/s]
2024-11-01 14:06:24.768 | INFO     | __main__:main:1813 - R@1 = 22.847023064567086 %, R@10 = 60.13591366274955 %, MRR = 0.4890391903542749
2024-11-01 14:06:24.770 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 14:06:25.256 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-01 14:06:25.257 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 112303/112303 [00:23<00:00, 4727.05it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 90175/112303 [00:18<00:03, 6564.06it/s]2024-11-01 14:07:35.922 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_train/cached_data.pkl
Training dataset size: 212887
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2339/2339 [00:00<00:00, 6715.08it/s]
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 92871/112303 [00:18<00:02, 6605.52it/s]2024-11-01 14:07:36.355 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pred/cached_data.pkl
Testing dataset size: 3484
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 112303/112303 [00:21<00:00, 5198.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 112303/112303 [00:21<00:00, 5343.32it/s]
2024-11-01 14:07:40.959 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_train/cached_data.pkl
Training dataset size: 212887
2024-11-01 14:07:40.992 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
 19%|█████████████████████████████████▏                                                                                                                                         | 21828/112303 [00:05<00:20, 4506.11it/s]2024-11-01 14:07:42.735 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_train/cached_data.pkl
Training dataset size: 212887
2024-11-01 14:07:42.773 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 112303/112303 [00:25<00:00, 4446.42it/s]
2024-11-01 14:08:04.742 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cach
e_train/cached_data.pkl
Training dataset size: 212887
2024-11-01 14:08:04.785 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 14:08:09.415 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:08:09.415 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/2077 [00:00<02:21, 14.63it/s]2024-11-01 14:08:09.638 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:08:09.639 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/2077 [00:00<02:28, 14.01it/s]2024-11-01 14:08:09.922 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:08:09.922 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 14:08:11.309 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:08:11.310 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [10:55<00:00,  3.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [10:57<00:00,  3.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [10:59<00:00,  3.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [11:00<00:00,  3.14it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:44<00:00,  0.31it/s]2024-11-01 14:19:51.179 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:19:51.179 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:19:51.179 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:19:51.332 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 14:19:51.332 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:19:51.349 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 14:19:51.350 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:19:51.395 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 14:19:51.396 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:19:54.711 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:19:54.908 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 14:19:54.908 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:19:54.909 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:48<00:00,  0.29it/s]
2024-11-01 14:19:57.425 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 14:19:57.424 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 14:19:57.521 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-01 14:19:57.784 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-01 14:19:57.784 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-11-01 14:19:57.821 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-01 14:19:57.821 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-11-01 14:19:57.865 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-01 14:19:57.865 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-11-01 14:19:59.267 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 14:19:59.380 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2339/2339 [00:00<00:00, 27350.47it/s]
2024-11-01 14:19:59.486 | INFO     | __main__:main:1813 - R@1 = 27.92291416749248 %, R@10 = 66.69934757344394 %, MRR = 0.552329199375495
2024-11-01 14:19:59.488 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 14:19:59.871 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-01 14:19:59.872 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214179/214179 [00:57<00:00, 3698.00it/s]
 52%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                 | 111836/214179 [00:36<00:20, 5010.00it/s]2024-11-01 14:22:01.810 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 535645
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4462/4462 [00:01<00:00, 3376.06it/s]
 56%|██████████████████████████████████████████████████████████████████████████████████████████████▊                                                                           | 119464/214179 [00:38<00:19, 4763.72it/s]2024-11-01 14:22:03.402 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache_pred/cached_data.pkl
Testing dataset size: 8251
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214179/214179 [00:56<00:00, 3759.21it/s]
 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                | 153774/214179 [00:38<00:16, 3607.30it/s]2024-11-01 14:22:25.274 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache_train/cached_data.pkl
Training dataset size: 535645
2024-11-01 14:22:25.328 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214179/214179 [00:57<00:00, 3707.73it/s]
2024-11-01 14:22:48.847 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_train/cached_data.pkl
Training dataset size: 535645
2024-11-01 14:22:48.916 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 214179/214179 [01:09<00:00, 3102.52it/s]
2024-11-01 14:23:00.094 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/c
ache_train/cached_data.pkl
Training dataset size: 535645
2024-11-01 14:23:00.161 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 14:23:04.471 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:23:04.472 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/3149 [00:00<?, ?it/s]2024-11-01 14:23:04.578 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:23:04.579 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 4/3149 [00:00<05:14, 10.01it/s]2024-11-01 14:23:05.104 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:23:05.105 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 14:23:05.983 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:23:05.983 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:31<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:34<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:37<00:00,  2.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:39<00:00,  2.81it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [01:46<00:00,  0.31it/s]2024-11-01 14:43:23.392 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:43:23.392 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:43:23.392 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:43:23.759 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 14:43:23.759 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:43:23.798 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 14:43:23.799 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:43:23.837 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 14:43:23.837 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:43:24.218 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:43:24.689 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 14:43:24.689 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:43:24.690 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [01:47<00:00,  0.31it/s]
2024-11-01 14:43:26.877 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 14:43:27.213 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 14:43:27.216 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
[rank: 2] Seed set to 3407
2024-11-01 14:43:27.343 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-01 14:43:27.343 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-01 14:43:27.571 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-01 14:43:27.572 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-11-01 14:43:27.574 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-01 14:43:27.574 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-11-01 14:44:05.025 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 14:44:05.161 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4462/4462 [00:00<00:00, 27874.40it/s]
2024-11-01 14:44:05.326 | INFO     | __main__:main:1813 - R@1 = 22.76818069158768 %, R@10 = 59.59586573680339 %, MRR = 0.4870458077730157
2024-11-01 14:44:05.328 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 14:44:05.646 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-01 14:44:05.647 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125700/125700 [00:26<00:00, 4784.21it/s]
 30%|██████████████████████████████████████████████████▋                                                                                                                        | 37270/125700 [00:06<00:13, 6357.05it/s]2024-11-01 14:44:51.502 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 260181
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2618/2618 [00:00<00:00, 5474.89it/s]
 33%|███████████████████████████████████████████████████████▉                                                                                                                   | 41084/125700 [00:06<00:15, 5575.22it/s]2024-11-01 14:44:52.096 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 4144
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125700/125700 [00:20<00:00, 6003.77it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                             | 92380/125700 [00:15<00:05, 5837.08it/s]2024-11-01 14:45:00.762 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 260181
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                              | 79743/125700 [00:22<00:07, 5778.51it/s]2024-11-01 14:45:00.797 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 4144
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125700/125700 [00:20<00:00, 6066.37it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 123685/125700 [00:28<00:00, 6159.29it/s]2024-11-01 14:45:07.725 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 260181
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 124375/125700 [00:28<00:00, 6370.89it/s]2024-11-01 14:45:07.757 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 4144
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125700/125700 [00:29<00:00, 4309.80it/s]
2024-11-01 14:45:09.675 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cach
e_train/cached_data.pkl
Training dataset size: 260181
2024-11-01 14:45:09.704 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4144
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 14:45:14.043 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:45:14.060 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2145 [00:00<?, ?it/s]2024-11-01 14:45:14.073 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:45:14.074 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                  | 3/2145 [00:00<03:32, 10.06it/s]2024-11-01 14:45:14.415 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:45:14.416 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 14:45:15.374 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 14:45:15.376 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:27<00:00,  3.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:29<00:00,  3.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:30<00:00,  3.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [12:00<00:00,  2.98it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:54<00:00,  0.31it/s]2024-11-01 14:58:10.412 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:58:10.413 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:58:10.413 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:58:10.413 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 14:58:10.660 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 14:58:10.660 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:58:10.681 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 14:58:10.681 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:58:10.706 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 14:58:10.706 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:58:10.724 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 14:58:10.725 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 14:58:10.725 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:54<00:00,  0.31it/s]
2024-11-01 14:58:13.198 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 14:58:13.263 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 14:58:13.268 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-01 14:58:13.601 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-01 14:58:13.601 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-11-01 14:58:13.605 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-01 14:58:13.605 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-11-01 14:58:13.667 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-01 14:58:13.667 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-11-01 14:58:14.971 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 14:58:15.074 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2618/2618 [00:00<00:00, 27609.72it/s]
2024-11-01 14:58:15.189 | INFO     | __main__:main:1813 - R@1 = 27.48126736826889 %, R@10 = 66.53919179807964 %, MRR = 0.54807767983308
2024-11-01 14:58:15.190 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 14:58:15.528 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-01 14:58:15.529 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210672/210672 [00:52<00:00, 3990.02it/s]
 35%|████████████████████████████████████████████████████████████▋                                                                                                              | 74717/210672 [00:19<00:32, 4175.58it/s]2024-11-01 15:00:12.973 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cach
ed_data.pkl
Training dataset size: 522744
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4389/4389 [00:01<00:00, 2858.63it/s]
 31%|█████████████████████████████████████████████████████▍                                                                                                                     | 65768/210672 [00:13<00:31, 4528.36it/s]2024-11-01 15:00:14.847 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_pred/cache
d_data.pkl
Testing dataset size: 8966
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210672/210672 [00:49<00:00, 4267.56it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                     | 144305/210672 [00:36<00:13, 5047.68it/s]2024-11-01 15:00:30.477 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cach
ed_data.pkl
Training dataset size: 522744
2024-11-01 15:00:30.533 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 8966
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210672/210672 [00:49<00:00, 4265.23it/s]
 73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                             | 154657/210672 [00:46<00:12, 4453.80it/s]2024-11-01 15:00:47.534 | I
NFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cach
ed_data.pkl
Training dataset size: 522744
 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                            | 155104/210672 [00:46<00:13, 4200.82it/s]2024-11-01 15:00:47.606 | I
NFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_da
ta.pkl
Testing dataset size: 8966
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 210672/210672 [00:57<00:00, 3693.15it/s]
2024-11-01 15:01:01.817 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf2614
45d/random/cache_train/cached_data.pkl
Training dataset size: 522744
2024-11-01 15:01:01.888 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 8966
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 15:01:05.702 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:01:05.704 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/3106 [00:00<?, ?it/s]2024-11-01 15:01:05.787 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:01:05.788 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 2/3106 [00:00<04:28, 11.55it/s]2024-11-01 15:01:05.904 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:01:05.905 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 15:01:07.165 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:01:07.166 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:14<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:18<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:21<00:00,  2.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:23<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [01:58<00:00,  0.30it/s]2024-11-01 15:21:20.776 | I
NFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:21:21.224 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 15:21:21.225 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:21:26.938 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:21:26.938 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:21:26.938 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:21:27.401 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 15:21:27.401 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:21:27.410 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 15:21:27.411 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:21:27.434 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 15:21:27.434 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:21:27.435 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:05<00:00,  0.29it/s]
2024-11-01 15:21:29.054 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
[rank: 3] Seed set to 3407
2024-11-01 15:21:29.947 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 15:21:29.947 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-01 15:21:30.148 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 15:21:30.151 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-01 15:21:30.505 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 15:21:30.505 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-01 15:21:30.531 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 15:21:30.531 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-01 15:21:59.190 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 15:21:59.342 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4389/4389 [00:00<00:00, 22468.96it/s]
2024-11-01 15:21:59.543 | INFO     | __main__:main:1813 - R@1 = 20.930288414982172 %, R@10 = 57.238021049319066 %, MRR = 0.4654841906519001
2024-11-01 15:21:59.545 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 15:21:59.946 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-01 15:21:59.947 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-11-01 15:22:00.807 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_train/cached_data.pkl
Training dataset size: 0
2024-11-01 15:22:00.807 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_train/cached_data.pkl
2024-11-01 15:22:00.807 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_train/cached_data.pkl
Training dataset size: 0
2024-11-01 15:22:00.807 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
0it [00:00, ?it/s]
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-11-01 15:22:00.811 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
2024-11-01 15:22:00.812 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
2024-11-01 15:22:00.812 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
2024-11-01 15:22:00.812 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/
cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/data.py:105: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.
2024-11-01 15:22:03.869 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 15:22:03.892 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
2024-11-01 15:22:03.892 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-01 15:22:04.207 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-01 15:22:04.207 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-11-01 15:22:04.248 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-01 15:22:04.248 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-11-01 15:22:04.254 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-01 15:22:04.254 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-11-01 15:22:05.685 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 15:22:05.725 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_4de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/test.json
0it [00:00, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-11-01 15:22:05.739 | INFO     | __main__:main:1813 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-11-01 15:22:05.740 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 15:22:06.175 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-01 15:22:06.176 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-01 15:22:30.093 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-01 15:22:30.139 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-11-01 15:22:37.516 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-01 15:22:37.560 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-11-01 15:22:41.858 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-01 15:22:41.894 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-11-01 15:22:43.347 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-01 15:22:43.388 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b_lambda_0.1_epoch=17-Recall@10_val=56.50.ckpt
2024-11-01 15:22:47.351 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:22:47.352 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2318 [00:00<?, ?it/s]2024-11-01 15:22:47.419 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:22:47.419 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2318 [00:00<?, ?it/s]2024-11-01 15:22:47.477 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:22:47.478 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2024-11-01 15:22:48.544 | I
NFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-01 15:22:48.544 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:05<00:00,  3.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:08<00:00,  3.47it/s]    | 0/16 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:09<00:00,  3.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:11<00:00,  3.45it/s]16 [00:03<00:49,  0.30it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:45<00:00,  0.35it/s]
2024-11-01 15:34:40.304 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:34:40.533 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-01 15:34:40.533 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:34:45.549 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:34:45.803 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-01 15:34:45.803 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:34:46.909 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:34:46.909 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-01 15:34:47.130 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-01 15:34:47.131 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:34:47.164 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-01 15:34:47.164 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-01 15:34:47.164 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:52<00:00,  0.30it/s]
2024-11-01 15:34:49.461 | INFO     | retrieval.main:run_cli:60 - PID: 3419896
2024-11-01 15:34:49.649 | INFO     | retrieval.main:run_cli:60 - PID: 3419894
2024-11-01 15:34:49.746 | INFO     | retrieval.main:run_cli:60 - PID: 3419895
[rank: 3] Seed set to 3407
2024-11-01 15:34:49.899 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-01 15:34:49.899 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-01 15:34:50.042 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-01 15:34:50.042 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-11-01 15:34:50.095 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-01 15:34:50.095 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-11-01 15:34:50.965 | INFO     | __main__:main:1808 - Loaded the predictions pickle files
2024-11-01 15:34:51.051 | INFO     | __main__:main:1811 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2462/2462 [00:00<00:00, 21388.61it/s]
2024-11-01 15:34:51.168 | INFO     | __main__:main:1813 - R@1 = 23.742439855116956 %, R@10 = 58.3173459744189 %, MRR = 0.48730154489775873
2024-11-01 15:34:51.170 | INFO     | retrieval.main:run_cli:60 - PID: 3288144
[rank: 0] Seed set to 3407
2024-11-01 15:34:51.586 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-01 15:34:51.586 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
  3%|█████                                                                                                                                                                                                  | 5258/208875 [00:01<01:15, 2691.20it/s]
