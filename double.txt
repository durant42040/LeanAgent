--> 714     theorem_map = {ldj_thm: thm for thm, ldj_thm in theorem_batch}
    715

ipdb>
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(716)process_theorem_batch()
    715
--> 716     for result in results:
    717         theorem = theorem_map[result.theorem]

ipdb> theorem_map
{Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='iter_multiDist_chainRule'): Theorem(full_name='iter_multiDist
_chainRule', file_path=PosixPath('PFR/MoreRuzsaDist.lean'), start=(973, 1), end=(980, 711), url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687', theorem_statement='lemma iter_multiDist_chainRule {m:ℕ
} (G : Fin (m+1) → Type*) (hG: ∀ i, MeasurableSpace (G i)) (hGs: ∀ i, MeasurableSingletonClass (G i)) (hGa: ∀ i, AddCommGroup (G i)) (hGsub: ∀ i, MeasurableSub₂ (G i)) (hGadd: ∀ i, MeasurableAdd₂ (G i)) (hGcount: ∀ i, Fintype (G i)) (
φ: ∀ i, G (i+1) →+ G i) (π: ∀ d, G m →+ G d) (hcomp: ∀ i, i < m → π i = (φ i) ∘ (π (i+1))) {Ω : Type*} (hΩ : MeasureSpace Ω) (X : Fin m → Ω → (G m)) (hindep : iIndepFun (fun _ ↦ (hG m)) X ) : D[X; fun _ ↦ hΩ] = ∑ d ∈ Finset.Iio m, D[
fun i ↦ (π (d+1)) ∘ (X i) | fun i ↦ (π d) ∘ (X i); fun _ ↦ hΩ] + ∑ d ∈ Finset.Iio m, I[ ∑ i, X i : fun ω ↦ (fun i ↦ (π (d+1)) (X i ω)) | ⟨ (π (d+1)) ∘ ∑ i, X i, fun ω ↦ (fun i ↦ (π d) (X i ω))⟩ ] :=', traced_tactics=[AnnotatedTactic(t
actic='sorry', annotated_tactic=('sorry', []), state_before="S : Type ?u.1085271\nΩ✝ : Type u_1\nΩ' : Type u_2\nΩ'' : Type u_3\nΩ''' : Type u_4\nG✝ : Type u_5\nT : Type u_6\nmΩ : MeasurableSpace Ω✝\nμ : Measure Ω✝\nmΩ' : MeasurableSpa
ce Ω'\nμ' : Measure Ω'\nmΩ'' : MeasurableSpace Ω''\nμ'' : Measure Ω''\nmΩ''' : MeasurableSpace Ω'''\nμ''' : Measure Ω'''\nhG✝ : MeasurableSpace G✝\ninst✝¹³ : MeasurableSingletonClass G✝\ninst✝¹² : AddCommGroup G✝\ninst✝¹¹ : Measurable
Sub₂ G✝\ninst✝¹⁰ : MeasurableAdd₂ G✝\ninst✝⁹ : Countable G✝\ninst✝⁸ : Countable S\ninst✝⁷ : Nonempty S\ninst✝⁶ : MeasurableSpace S\ninst✝⁵ : Countable T\ninst✝⁴ : Nonempty T\ninst✝³ : MeasurableSpace T\nX✝ : Ω✝ → G✝\nY : Ω' → G✝\nZ :
Ω'' → G✝\ninst✝² : FiniteRange X✝\ninst✝¹ : FiniteRange Y\ninst✝ : FiniteRange Z\nm : ℕ\nG : Fin (m + 1) → Type u_7\nhG : (i : Fin (m + 1)) → MeasurableSpace (G i)\nhGs : ∀ (i : Fin (m + 1)), MeasurableSingletonClass (G i)\nhGa : (i :
 Fin (m + 1)) → AddCommGroup (G i)\nhGsub : ∀ (i : Fin (m + 1)), MeasurableSub₂ (G i)\nhGadd : ∀ (i : Fin (m + 1)), MeasurableAdd₂ (G i)\nhGcount : (i : Fin (m + 1)) → Fintype (G i)\nφ : (i : Fin (m + 1)) → G (i + 1) →+ G i\nπ : (d :
Fin (m + 1)) → G ↑m →+ G d\nhcomp : ∀ i < m, ⇑(π ↑i) = ⇑(φ ↑i) ∘ ⇑(π (↑i + 1))\nΩ : Type u_8\nhΩ : MeasureSpace Ω\nX : Fin m → Ω → G ↑m\nhindep : iIndepFun (fun x => hG ↑m) X ℙ\n⊢ D[X ; fun x => hΩ] =\n    ∑ d ∈ Finset.Iio m, D[fun i
=> ⇑(π (↑d + 1)) ∘ X i | fun i => ⇑(π ↑d) ∘ X i ; fun x => hΩ] +\n      ∑ d ∈ Finset.Iio m,\n        I[∑ i : Fin m, X i : fun ω i =>\n          (π (↑d + 1)) (X i ω)|⟨⇑(π (↑d + 1)) ∘ ∑ i : Fin m, X i, fun ω i => (π ↑d) (X i ω)⟩]", stat
e_after='no goals')], difficulty_rating=None), Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_minus_l
e'): Theorem(full_name='condRho_minus_le', file_path=PosixPath('PFR/RhoFunctional.lean'), start=(95, 1), end=(96, 185), url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687', theorem_statement='lemma c
ondRho_minus_le {Ω S : Type*} [MeasureSpace Ω] [MeasurableSpace S] (X : Ω → G) (Z : Ω → S) (A : Finset G) : condRho_minus X Z A ≤ rho_minus X A + H[ X ] - H[ X | Z ] :=', traced_tactics=[AnnotatedTactic(tactic='sorry', annotated_tacti
c=('sorry', []), state_before='G : Type uG\ninst✝³ : AddCommGroup G\ninst✝² : Fintype G\nhGm : MeasurableSpace G\nΩ : Type u_1\nS : Type u_2\ninst✝¹ : MeasureSpace Ω\ninst✝ : MeasurableSpace S\nX : Ω → G\nZ : Ω → S\nA : Finset G\n⊢ co
ndRho_minus X Z A ≤ rho_minus X A + H[X] - H[X | Z]', state_after='no goals')], difficulty_rating=None), Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=Posix
Path('PFR/RhoFunctional.lean'), full_name='phi_min_exists'): Theorem(full_name='phi_min_exists', file_path=PosixPath('PFR/RhoFunctional.lean'), start=(128, 1), end=(129, 105), url='https://github.com/teorth/pfr', commit='fa398a5b853c7
e94e3294c45e50c6aee013a2687', theorem_statement='lemma phi_min_exists : ∃ (Ω: Type uG) (_:MeasureSpace Ω) (X Y : Ω → G), phiMinimizes X Y η A :=', traced_tactics=[AnnotatedTactic(tactic='sorry', annotated_tactic=('sorry', []), state_b
efore='G : Type uG\ninst✝² : AddCommGroup G\ninst✝¹ : Fintype G\nhGm : MeasurableSpace G\ninst✝ : ElementaryAddCommGroup G 2\nη : ℝ\nhη : η > 0\nA : Finset G\n⊢ ∃ Ω x X Y, phiMinimizes X Y η A', state_after='no goals')], difficulty_ra
ting=None), Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_of_translate'): Theorem(full_name='condRho
_of_translate', file_path=PosixPath('PFR/RhoFunctional.lean'), start=(89, 1), end=(90, 163), url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687', theorem_statement='lemma condRho_of_translate {Ω S :
Type*} [MeasureSpace Ω] (X : Ω → G) (Y : Ω → S) (A : Finset G) (s:G) : condRho (fun ω ↦ X ω + s) Y A = condRho X Y A :=', traced_tactics=[AnnotatedTactic(tactic='sorry', annotated_tactic=('sorry', []), state_before='G : Type uG\ninst✝
² : AddCommGroup G\ninst✝¹ : Fintype G\nhGm : MeasurableSpace G\nΩ : Type u_1\nS : Type u_2\ninst✝ : MeasureSpace Ω\nX : Ω → G\nY : Ω → S\nA : Finset G\ns : G\n⊢ condRho (fun ω => X ω + s) Y A = condRho X Y A', state_after='no goals')
], difficulty_rating=None)}
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(717)process_theorem_batch()
    716     for result in results:
--> 717         theorem = theorem_map[result.theorem]
    718         if isinstance(result, SearchResult) and result.status == Status.PROVED:

ipdb> result.theorem
Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_minus_le')
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(718)process_theorem_batch()
    717         theorem = theorem_map[result.theorem]
--> 718         if isinstance(result, SearchResult) and result.status == Status.PROVED:
    719             logger.info(f"Proof found for {theorem.full_name}")

ipdb> theorem
Theorem(full_name='condRho_minus_le', file_path=PosixPath('PFR/RhoFunctional.lean'), start=(95, 1), end=(96, 185), url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687', theorem_statement='lemma condRh
o_minus_le {Ω S : Type*} [MeasureSpace Ω] [MeasurableSpace S] (X : Ω → G) (Z : Ω → S) (A : Finset G) : condRho_minus X Z A ≤ rho_minus X A + H[ X ] - H[ X | Z ] :=', traced_tactics=[AnnotatedTactic(tactic='sorry', annotated_tactic=('s
orry', []), state_before='G : Type uG\ninst✝³ : AddCommGroup G\ninst✝² : Fintype G\nhGm : MeasurableSpace G\nΩ : Type u_1\nS : Type u_2\ninst✝¹ : MeasureSpace Ω\ninst✝ : MeasurableSpace S\nX : Ω → G\nZ : Ω → S\nA : Finset G\n⊢ condRho
_minus X Z A ≤ rho_minus X A + H[X] - H[X | Z]', state_after='no goals')], difficulty_rating=None)
ipdb> n
> /data/yingzi_ma/lean_project/ReProver/main.py(734)process_theorem_batch()
    733         else:
--> 734             logger.info(f"No proof found for {theorem.full_name}")
    735

ipdb>
2024-09-08 05:09:04.372 | INFO     | __main__:process_theorem_batch:734 - No proof found for condRho_minus_le
> /data/yingzi_ma/lean_project/ReProver/main.py(716)process_theorem_batch()
    715
--> 716     for result in results:
    717         theorem = theorem_map[result.theorem]

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(717)process_theorem_batch()
    716     for result in results:
--> 717         theorem = theorem_map[result.theorem]
    718         if isinstance(result, SearchResult) and result.status == Status.PROVED:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(718)process_theorem_batch()
    717         theorem = theorem_map[result.theorem]
--> 718         if isinstance(result, SearchResult) and result.status == Status.PROVED:
    719             logger.info(f"Proof found for {theorem.full_name}")

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(734)process_theorem_batch()
    733         else:
--> 734             logger.info(f"No proof found for {theorem.full_name}")
    735

ipdb>
2024-09-08 05:09:05.980 | INFO     | __main__:process_theorem_batch:734 - No proof found for phi_min_exists
> /data/yingzi_ma/lean_project/ReProver/main.py(716)process_theorem_batch()
    715
--> 716     for result in results:
    717         theorem = theorem_map[result.theorem]

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(717)process_theorem_batch()
    716     for result in results:
--> 717         theorem = theorem_map[result.theorem]
    718         if isinstance(result, SearchResult) and result.status == Status.PROVED:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(718)process_theorem_batch()
    717         theorem = theorem_map[result.theorem]
--> 718         if isinstance(result, SearchResult) and result.status == Status.PROVED:
    719             logger.info(f"Proof found for {theorem.full_name}")

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(734)process_theorem_batch()
    733         else:
--> 734             logger.info(f"No proof found for {theorem.full_name}")
    735

ipdb>
2024-09-08 05:09:08.584 | INFO     | __main__:process_theorem_batch:734 - No proof found for condRho_of_translate
> /data/yingzi_ma/lean_project/ReProver/main.py(716)process_theorem_batch()
    715
--> 716     for result in results:
    717         theorem = theorem_map[result.theorem]

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(717)process_theorem_batch()
    716     for result in results:
--> 717         theorem = theorem_map[result.theorem]
    718         if isinstance(result, SearchResult) and result.status == Status.PROVED:

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(718)process_theorem_batch()
    717         theorem = theorem_map[result.theorem]
--> 718         if isinstance(result, SearchResult) and result.status == Status.PROVED:
    719             logger.info(f"Proof found for {theorem.full_name}")

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(734)process_theorem_batch()
    733         else:
--> 734             logger.info(f"No proof found for {theorem.full_name}")
    735

ipdb>
2024-09-08 05:09:10.308 | INFO     | __main__:process_theorem_batch:734 - No proof found for iter_multiDist_chainRule
> /data/yingzi_ma/lean_project/ReProver/main.py(716)process_theorem_batch()
    715
--> 716     for result in results:
    717         theorem = theorem_map[result.theorem]

ipdb>
--Return--
None
> /data/yingzi_ma/lean_project/ReProver/main.py(716)process_theorem_batch()
    715
--> 716     for result in results:
    717         theorem = theorem_map[result.theorem]

ipdb>
> /data/yingzi_ma/lean_project/ReProver/main.py(822)prove_sorry_theorems()
    821                 process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
--> 822                 theorem_batch = []
    823                 positions_batch = []

ipdb> exit()
Processing theorems from teorth/pfr:   8%|██████████▌                                                                                                                        | 3/37 [05:07<58:04, 102.49s/theorem]
2024-09-08 05:09:23.755 | INFO     | __main__:main:1634 - An error occurred:
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1603, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_merged_dataset)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 822, in prove_sorry_theorems
    theorem_batch = []
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 822, in prove_sorry_theorems
    theorem_batch = []
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
^C^Z
[22]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 05:09:59,305] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 05:10:03.195 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 05:10:03.195 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 05:10:03.198 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 05:10:03.198 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 05:10:03.198 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 05:10:03.199 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 05:10:12.334 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 05:10:12.334 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 05:10:12.455 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 05:10:12.455 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 05:10:12.455 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 05:10:12.909 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 05:10:28.022 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 05:10:28.022 | INFO     | __main__:main:1300 - i: 0
2024-09-08 05:10:28.023 | INFO     | __main__:main:1305 - Main process
2024-09-08 05:10:28.023 | INFO     | __main__:main:1306 - Using lambda = 0.1
2024-09-08 05:10:28.023 | INFO     | __main__:main:1307 - Processing https://github.com/teorth/pfr
2024-09-08 05:10:28.023 | INFO     | __main__:main:1329 - Adding repo to repos_for_merged_dataset
2024-09-08 05:10:28.023 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 05:10:28.023 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a
2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:10:28.023 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=70.73.ckpt
2024-09-08 05:10:28.024 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 05:10:28.024 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module im
plicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowli
sted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues relat
ed to this experimental feature.
2024-09-08 05:10:30.263 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_ep
och=0-Recall@10_val=70.73.ckpt and reset epoch count
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on S
LURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 05:10:30.357 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be
depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 05:10:30.452 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 05:10:40.838 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:10:40.853 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 05:10:40.868 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 05:10:40.868 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 05:10:40.868 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 05:10:40.868 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 05:10:40.868 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 05:10:40.868 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 05:10:44.296 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:10:44.387 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 05:10:44.407 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is no
t empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module im
plicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowli
sted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues relat
ed to this experimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 05:10:45.275 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-08 05:10:47.166 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 05:10:47.167 | INFO     | __main__:main:1476 - Finished progressive training at epoch 1
2024-09-08 05:10:48.944 | INFO     | __main__:main:1495 - Testing...
2024-09-08 05:10:48.946 | INFO     | retrieval.main:run_cli:60 - PID: 769266
[rank: 0] Seed set to 3407
2024-09-08 05:10:49.141 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 05:10:49.141 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpu
s.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be
depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 05:10:49.667 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on S
LURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 05:10:59.820 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:10:59.835 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]2024-09-08 05:11:02.105
| INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                                                                                                                             | 0/11 [00:00<?, ?it/s]^[[B^[[B^[[B^[[B^[[B^[[B
^[[B^[[B^[[B^[[B/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:22<00:00,  0.50it/s]2024-09-08 05:11:24.368
| INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 05:11:24.380 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 05:11:24.380 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 05:11:24.381 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:22<00:00,  0.50it/s]
2024-09-08 05:11:25.008 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 05:11:25.048 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 05:11:25.078 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 97748.47it/s]
2024-09-08 05:11:25.094 | INFO     | __main__:main:1521 - R@1 = 0.0 %, R@10 = 0.2777777777777778 %, MRR = 0.003908386690693454
2024-09-08 05:11:25.095 | INFO     | retrieval.main:run_cli:60 - PID: 769266
[rank: 0] Seed set to 3407
2024-09-08 05:11:25.281 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random
2024-09-08 05:11:25.282 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f991
6ae24253d566/corpus.jsonl
2024-09-08 05:11:25.778 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/
corpus.jsonl
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[
[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[A^[[A^[[A
^[[Aq
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 05:11:38.122 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7
bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 05:11:38.140 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7
bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]2024-09-08 05:11:40.250
| INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:25<00:00,  0.43it/s]2024-09-08 05:12:05.716
| INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 05:12:05.728 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 05:12:05.728 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 05:12:05.729 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:25<00:00,  0.43it/s]
2024-09-08 05:12:06.348 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 05:12:06.398 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 05:12:06.434 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.
json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 27042.49it/s]
2024-09-08 05:12:06.494 | INFO     | __main__:main:1521 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 05:12:06.495 | INFO     | __main__:main:1534 - Average R@1 = 0.147703449590242 %, R@10 = 0.33265040340512037 %, MRR = 0.007377897649023361
2024-09-08 05:12:06.495 | INFO     | __main__:main:1569 - Starting the prover
2024-09-08 05:12:06.495 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 05:12:06.496 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 05:12:06.496 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 05:12:06.496 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e
50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt
5-small/model_lightning.ckpt`
2024-09-08 05:12:06.886 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lamb
da_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:12:06.886 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lamb
da_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:12:09.413 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.
encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight',
'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.en
coder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight',
'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.w
eight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseR
eluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.enc
oder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.l
ayer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weig
ht', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.b
lock.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.en
coder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'ret
riever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weigh
t', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_no
rm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseR
eluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retrieve
r.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.
layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.w
o.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.en
coder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseRelu
Dense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', '
state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 05:12:10.098 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 05:12:10.099 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 05:12:10.099 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/co
rpus.jsonl
2024-09-08 05:12:10.099 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 05:12:15.938 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 05:12:15.938 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/cor
pus.jsonl
2024-09-08 05:12:15.938 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 05:12:19,536 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8266
^Z
[23]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ ray stop
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=283579, name='python3')
Stopped only 0 out of 344 Ray processes within the grace period 16 seconds. Set `-v` to see more details. Remaining processes [psutil.Process(pid=736076, name='raylet', status='zombie', started='05:02:09'), psutil.Process(pid=770019,
name='raylet', status='zombie', started='05:12:18'), psutil.Process(pid=736236, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736345, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.
Process(pid=736324, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770199, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736296, name='ray::IDLE', status='terminated', s
tarted='05:02:10'), psutil.Process(pid=770196, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736289, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736268, name='ray::ID
LE', status='terminated', started='05:02:10'), psutil.Process(pid=736422, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736905, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Proces
s(pid=736334, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770206, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=770178, name='ray::IDLE', status='terminated', started
='05:12:18'), psutil.Process(pid=770494, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736376, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736473, name='ray::IDLE', s
tatus='terminated', started='05:02:14'), psutil.Process(pid=736303, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736282, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=
736261, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770255, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=770487, name='ray::IDLE', status='terminated', started='05:1
2:25'), psutil.Process(pid=767502, name='ray::ProverActor', status='terminated', started='05:02:57'), psutil.Process(pid=770185, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736738, name='ray::IDLE',
status='terminated', started='05:02:18'), psutil.Process(pid=735977, name='python', status='zombie', started='05:02:08'), psutil.Process(pid=736308, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=737064
, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736702, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=736355, name='ray::IDLE', status='terminated', started='05:02:10')
, psutil.Process(pid=770481, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736741, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=770243, name='ray::IDLE', status='termi
nated', started='05:12:19'), psutil.Process(pid=737060, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736250, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770424, name
='ray::IDLE', status='terminated', started='05:12:23'), psutil.Process(pid=736357, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=735976, name='python', status='zombie', started='05:02:07'), psutil.Proc
ess(pid=736642, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=767679, name='ray::ProverActor', status='terminated', started='05:03:05'), psutil.Process(pid=770338, name='ray::IDLE', status='terminated'
, started='05:12:20'), psutil.Process(pid=736611, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=736467, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736239, name='ray:
:IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736547, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=736348, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Pro
cess(pid=770242, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=770483, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736317, name='ray::IDLE', status='terminated', star
ted='05:02:10'), psutil.Process(pid=736328, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736963, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736243, name='ray::IDLE'
, status='terminated', started='05:02:10'), psutil.Process(pid=736705, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=736466, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(p
id=736232, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736341, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770213, name='ray::IDLE', status='terminated', started='0
5:12:19'), psutil.Process(pid=736373, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736363, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736463, name='ray::IDLE', stat
us='terminated', started='05:02:14'), psutil.Process(pid=736311, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736246, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770
501, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736292, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736383, name='ray::IDLE', status='terminated', started='05:02:1
1'), psutil.Process(pid=736271, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770416, name='ray::IDLE', status='terminated', started='05:12:22'), psutil.Process(pid=736151, name='python', status='termi
nated', started='05:02:09'), psutil.Process(pid=736393, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736314, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736374, name
='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736756, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=736673, name='ray::IDLE', status='terminated', started='05:02:17'), psut
il.Process(pid=736706, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=769932, name='python', status='zombie', started='05:12:17'), psutil.Process(pid=770504, name='ray::IDLE', status='terminated', start
ed='05:12:25'), psutil.Process(pid=736326, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770192, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736342, name='ray::IDLE',
 status='terminated', started='05:02:10'), psutil.Process(pid=736285, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736417, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pi
d=736264, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736330, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770202, name='ray::IDLE', status='terminated', started='05
:12:19'), psutil.Process(pid=770367, name='ray::IDLE', status='terminated', started='05:12:21'), psutil.Process(pid=736911, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=770174, name='ray::IDLE', statu
s='terminated', started='05:12:18'), psutil.Process(pid=736320, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736299, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=7362
67, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736257, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736607, name='ray::IDLE', status='terminated', started='05:02:16
'), psutil.Process(pid=770252, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=770181, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736260, name='ray::IDLE', status='ter
minated', started='05:02:10'), psutil.Process(pid=736351, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736321, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736869, na
me='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=736387, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736486, name='ray::IDLE', status='terminated', started='05:02:15'), ps
util.Process(pid=736369, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736737, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=736732, name='ray::IDLE', status='terminate
d', started='05:02:17'), psutil.Process(pid=736460, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736253, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=737063, name='ra
y::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736459, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736278, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.P
rocess(pid=736235, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736344, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770216, name='ray::IDLE', status='terminated', st
arted='05:12:19'), psutil.Process(pid=736366, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736484, name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=736474, name='ray::IDL
E', status='terminated', started='05:02:14'), psutil.Process(pid=736281, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736337, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process
(pid=736242, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736288, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736274, name='ray::IDLE', status='terminated', started=
'05:02:10'), psutil.Process(pid=736361, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736733, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=770303, name='ray::IDLE', st
atus='terminated', started='05:12:19'), psutil.Process(pid=736323, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770188, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=7
36475, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736477, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736456, name='ray::IDLE', status='terminated', started='05:02
:14'), psutil.Process(pid=736916, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736425, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736263, name='ray::IDLE', status='
terminated', started='05:02:10'), psutil.Process(pid=736962, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=770268, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736307,
 name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736910, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=770096, name='python', status='zombie', started='05:12:18'), psutil
.Process(pid=736372, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736469, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736310, name='ray::IDLE', status='terminated',
started='05:02:10'), psutil.Process(pid=736256, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736411, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=770381, name='ray::I
DLE', status='terminated', started='05:12:22'), psutil.Process(pid=736302, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736313, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Proce
ss(pid=736907, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=736406, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736249, name='ray::IDLE', status='terminated', starte
d='05:02:10'), psutil.Process(pid=770230, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736432, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=770340, name='ray::IDLE',
status='terminated', started='05:12:20'), psutil.Process(pid=736284, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736352, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid
=736295, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736340, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736386, name='ray::IDLE', status='terminated', started='05:
02:12'), psutil.Process(pid=736485, name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=736740, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=736298, name='ray::IDLE', status
='terminated', started='05:02:10'), psutil.Process(pid=736277, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736343, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=73633
3, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770205, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736913, name='ray::IDLE', status='terminated', started='05:02:19'
), psutil.Process(pid=736359, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736238, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770191, name='ray::IDLE', status='term
inated', started='05:12:18'), psutil.Process(pid=736291, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736270, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736464, nam
e='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736424, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736336, name='ray::IDLE', status='terminated', started='05:02:10'), psu
til.Process(pid=770208, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736415, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=770278, name='ray::IDLE', status='terminated
', started='05:12:19'), psutil.Process(pid=770222, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736867, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=770184, name='ray
::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=770201, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736319, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Pr
ocess(pid=736735, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=736322, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770187, name='ray::IDLE', status='terminated', sta
rted='05:12:18'), psutil.Process(pid=736259, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736480, name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=736375, name='ray::IDLE
', status='terminated', started='05:02:11'), psutil.Process(pid=736365, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736868, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(
pid=736378, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=770251, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736368, name='ray::IDLE', status='terminated', started='
05:02:11'), psutil.Process(pid=736468, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736316, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736731, name='ray::IDLE', sta
tus='terminated', started='05:02:17'), psutil.Process(pid=770180, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=737062, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=73
6961, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736252, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770194, name='ray::IDLE', status='terminated', started='05:12:
18'), psutil.Process(pid=736382, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736416, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736255, name='ray::IDLE', status='t
erminated', started='05:02:10'), psutil.Process(pid=736385, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=737065, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736245,
name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736354, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736410, name='ray::IDLE', status='terminated', started='05:02:13'),
psutil.Process(pid=736301, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736390, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736280, name='ray::IDLE', status='termina
ted', started='05:02:10'), psutil.Process(pid=770264, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736325, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736153, name='
python', status='zombie', started='05:02:09'), psutil.Process(pid=736461, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736294, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Proces
s(pid=736273, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736306, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770211, name='ray::IDLE', status='terminated', started
='05:12:19'), psutil.Process(pid=770256, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736409, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736360, name='ray::IDLE', s
tatus='terminated', started='05:02:11'), psutil.Process(pid=736241, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736350, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=
736699, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=736419, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736266, name='ray::IDLE', status='terminated', started='05:0
2:10'), psutil.Process(pid=770510, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736332, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736346, name='ray::IDLE', status=
'terminated', started='05:02:10'), psutil.Process(pid=736915, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=736362, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736908
, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=770094, name='python', status='terminated', started='05:12:18'), psutil.Process(pid=736431, name='ray::IDLE', status='terminated', started='05:02:14'), p
sutil.Process(pid=770456, name='ray::IDLE', status='terminated', started='05:12:24'), psutil.Process(pid=770407, name='ray::IDLE', status='terminated', started='05:12:22'), psutil.Process(pid=736339, name='ray::IDLE', status='terminat
ed', started='05:02:10'), psutil.Process(pid=736483, name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=770183, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736309, name='r
ay::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736478, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736457, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.
Process(pid=736458, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736287, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=769931, name='python', status='zombie', started=
'05:12:16'), psutil.Process(pid=770176, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=770274, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736643, name='ray::IDLE', st
atus='terminated', started='05:02:16'), psutil.Process(pid=770190, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736364, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=7
36482, name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=770422, name='ray::IDLE', status='terminated', started='05:12:23'), psutil.Process(pid=736312, name='ray::IDLE', status='terminated', started='05:02
:10'), psutil.Process(pid=736377, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=770414, name='ray::IDLE', status='terminated', started='05:12:22'), psutil.Process(pid=736414, name='ray::IDLE', status='
terminated', started='05:02:13'), psutil.Process(pid=736600, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=736251, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=737061,
 name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=770254, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=770428, name='ray::IDLE', status='terminated', started='05:12:23'),
 psutil.Process(pid=736407, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736297, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736276, name='ray::IDLE', status='termin
ated', started='05:02:10'), psutil.Process(pid=736903, name='ray::IDLE', status='terminated', started='05:02:18'), psutil.Process(pid=736329, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736244, name=
'ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736353, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736300, name='ray::IDLE', status='terminated', started='05:02:10'), psuti
l.Process(pid=736149, name='python', status='terminated', started='05:02:09'), psutil.Process(pid=736347, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736269, name='ray::IDLE', status='terminated', st
arted='05:02:10'), psutil.Process(pid=770513, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=770207, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=770346, name='ray::IDL
E', status='terminated', started='05:12:20'), psutil.Process(pid=736476, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736237, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process
(pid=736315, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736304, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736305, name='ray::IDLE', status='terminated', started=
'05:02:10'), psutil.Process(pid=736272, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736262, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736491, name='ray::IDLE', st
atus='terminated', started='05:02:16'), psutil.Process(pid=736593, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=770214, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=7
36388, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736381, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736384, name='ray::IDLE', status='terminated', started='05:02
:11'), psutil.Process(pid=736265, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770509, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736290, name='ray::IDLE', status='
terminated', started='05:02:10'), psutil.Process(pid=736423, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736391, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=736479,
 name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=736335, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770179, name='ray::IDLE', status='terminated', started='05:12:18'),
 psutil.Process(pid=736471, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=770473, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=736367, name='ray::IDLE', status='termin
ated', started='05:02:11'), psutil.Process(pid=736293, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736358, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736283, name=
'ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736338, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736327, name='ray::IDLE', status='terminated', started='05:02:10'), psuti
l.Process(pid=770092, name='python', status='terminated', started='05:12:18'), psutil.Process(pid=736318, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770475, name='ray::IDLE', status='terminated', st
arted='05:12:25'), psutil.Process(pid=770498, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=770186, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736389, name='ray::IDL
E', status='terminated', started='05:02:12'), psutil.Process(pid=736392, name='ray::IDLE', status='terminated', started='05:02:12'), psutil.Process(pid=767171, name='ray::ProverActor', status='terminated', started='05:02:38'), psutil.
Process(pid=736286, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736472, name='ray::IDLE', status='terminated', started='05:02:14'), psutil.Process(pid=736331, name='ray::IDLE', status='terminated', s
tarted='05:02:10'), psutil.Process(pid=736519, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=736912, name='ray::IDLE', status='terminated', started='05:02:19'), psutil.Process(pid=770273, name='ray::ID
LE', status='terminated', started='05:12:19'), psutil.Process(pid=736488, name='ray::IDLE', status='terminated', started='05:02:16'), psutil.Process(pid=736247, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Proces
s(pid=736356, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770491, name='ray::IDLE', status='terminated', started='05:12:25'), psutil.Process(pid=770175, name='ray::IDLE', status='terminated', started
='05:12:18'), psutil.Process(pid=770189, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736734, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=736394, name='ray::IDLE', s
tatus='terminated', started='05:02:12'), psutil.Process(pid=736279, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736258, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=
736674, name='ray::IDLE', status='terminated', started='05:02:17'), psutil.Process(pid=736240, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770221, name='ray::IDLE', status='terminated', started='05:1
2:19'), psutil.Process(pid=736349, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=770182, name='ray::IDLE', status='terminated', started='05:12:18'), psutil.Process(pid=736275, name='ray::IDLE', status=
'terminated', started='05:02:10'), psutil.Process(pid=736254, name='ray::IDLE', status='terminated', started='05:02:10'), psutil.Process(pid=736418, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=736370
, name='ray::IDLE', status='terminated', started='05:02:11'), psutil.Process(pid=736428, name='ray::IDLE', status='terminated', started='05:02:13'), psutil.Process(pid=770512, name='ray::IDLE', status='terminated', started='05:12:25')
, psutil.Process(pid=770262, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=736481, name='ray::IDLE', status='terminated', started='05:02:15'), psutil.Process(pid=767328, name='ray::ProverActor', status
='terminated', started='05:02:47'), psutil.Process(pid=770210, name='ray::IDLE', status='terminated', started='05:12:19'), psutil.Process(pid=769675, name='gcs_server', status='zombie', started='05:12:15'), psutil.Process(pid=735720,
name='gcs_server', status='zombie', started='05:02:06')] will be forcefully terminated.
You can also use `--force` to forcefully terminate processes or set higher `--grace-period` to wait longer time for proper termination.
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  734933  yingzi_ma  pt_main_thread                     6006            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  769266  yingzi_ma  pt_main_thread                     6006            0  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ kill -9 572274 734933 769266
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 05:17:19,054] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 05:17:22.879 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 05:17:22.879 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 05:17:22.882 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 05:17:22.882 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 05:17:22.882 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 05:17:22.882 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 05:17:31.317 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 05:17:31.317 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 05:17:31.424 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 05:17:31.425 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 05:17:31.425 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 05:17:31.779 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 05:17:46.878 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 05:17:46.878 | INFO     | __main__:main:1300 - i: 0
2024-09-08 05:17:46.878 | INFO     | __main__:main:1305 - Main process
2024-09-08 05:17:46.878 | INFO     | __main__:main:1306 - Using lambda = 0.1
2024-09-08 05:17:46.878 | INFO     | __main__:main:1307 - Processing https://github.com/teorth/pfr
2024-09-08 05:17:46.878 | INFO     | __main__:main:1329 - Adding repo to repos_for_merged_dataset
2024-09-08 05:17:46.878 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 05:17:46.879 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a
2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:17:46.879 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=70.73.ckpt
2024-09-08 05:17:46.879 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 05:17:46.879 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module im
plicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowli
sted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues relat
ed to this experimental feature.
2024-09-08 05:17:48.978 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_ep
och=0-Recall@10_val=70.73.ckpt and reset epoch count
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on S
LURM, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 05:17:49.070 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be
depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 05:17:49.168 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 05:17:59.058 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:17:59.073 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 05:17:59.087 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 05:17:59.087 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 05:17:59.087 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 05:17:59.087 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 05:17:59.087 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 05:17:59.088 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 05:18:02.304 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:18:02.383 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 05:18:02.399 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is no
t empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module im
plicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowli
sted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues relat
ed to this experimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 05:18:03.264 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-08 05:18:04.980 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 05:18:04.981 | INFO     | __main__:main:1476 - Finished progressive training at epoch 1
2024-09-08 05:18:06.734 | INFO     | __main__:main:1495 - Testing...
2024-09-08 05:18:06.736 | INFO     | retrieval.main:run_cli:60 - PID: 789002
[rank: 0] Seed set to 3407
2024-09-08 05:18:06.929 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 05:18:06.929 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpu
s.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be
depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 05:18:08.113 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on S
LURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 05:18:18.221 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:18:18.236 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]2024-09-08 05:18:20.498
| INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                                                                                                                             | 0/11 [00:00<?, ?it/s]/data/yingzi_ma/minicond
a3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:22<00:00,  0.48it/s]2024-09-08 05:18:43.329
| INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 05:18:43.341 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 05:18:43.341 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 05:18:43.342 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:22<00:00,  0.48it/s]
2024-09-08 05:18:44.035 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 05:18:44.075 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 05:18:44.104 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 91446.74it/s]
2024-09-08 05:18:44.122 | INFO     | __main__:main:1521 - R@1 = 0.0 %, R@10 = 0.2777777777777778 %, MRR = 0.003908386690693454
2024-09-08 05:18:44.123 | INFO     | retrieval.main:run_cli:60 - PID: 789002
[rank: 0] Seed set to 3407
2024-09-08 05:18:44.308 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random
2024-09-08 05:18:44.308 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f991
6ae24253d566/corpus.jsonl
2024-09-08 05:18:44.797 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 05:18:56.898 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7
bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 05:18:56.914 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7
bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]2024-09-08 05:18:59.151
| INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:25<00:00,  0.43it/s]2024-09-08 05:19:24.740
| INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 05:19:24.751 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 05:19:24.752 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 05:19:24.752 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:25<00:00,  0.43it/s]
2024-09-08 05:19:25.403 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 05:19:25.454 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 05:19:25.489 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.
json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 26577.49it/s]
2024-09-08 05:19:25.549 | INFO     | __main__:main:1521 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 05:19:25.550 | INFO     | __main__:main:1534 - Average R@1 = 0.147703449590242 %, R@10 = 0.33265040340512037 %, MRR = 0.007377897649023361
2024-09-08 05:19:25.551 | INFO     | __main__:main:1569 - Starting the prover
2024-09-08 05:19:25.551 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 05:19:25.551 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 05:19:25.551 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 05:19:25.552 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e
50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt
5-small/model_lightning.ckpt`
2024-09-08 05:19:25.953 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lamb
da_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:19:25.953 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lamb
da_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:19:28.564 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.
encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight',
'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.en
coder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight',
'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.w
eight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseR
eluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.enc
oder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.l
ayer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weig
ht', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.b
lock.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.en
coder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'ret
riever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weigh
t', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_no
rm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseR
eluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retrieve
r.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.
layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.w
o.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.en
coder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseRelu
Dense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', '
state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 05:19:29.291 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 05:19:29.292 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 05:19:29.292 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/co
rpus.jsonl
2024-09-08 05:19:29.292 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 05:19:35.139 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 05:19:35.139 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/cor
pus.jsonl
2024-09-08 05:19:35.139 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 05:19:39,150 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=821015) [2024-09-08 05:20:16,019] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=821015) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defau
lt pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a
future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are
 explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub f
or any issues related to this experimental feature.
(ProverActor pid=821015)   return torch.load(io.BytesIO(b))
(pid=821206) [2024-09-08 05:20:27,177] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=821206) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defau
lt pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a
future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are
 explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub f
or any issues related to this experimental feature.
(ProverActor pid=821206)   return torch.load(io.BytesIO(b))
(pid=821406) [2024-09-08 05:20:37,913] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 05:20:40.015 | WARNING  | __main__:load_encountered_theorems:749 - The file encountered_theorems_retrieval_single_repo_no_ewc_pfr.pkl is empty. Starting with an empty set.
2024-09-08 05:20:40.015 | INFO     | __main__:prove_sorry_theorems:781 - Found 37 sorry theorems to prove
Processing theorems from teorth/pfr:   0%|                                                                                                                                            | 0/37 [00:00<?, ?theorem/s]2024-09-08 05:20:40.015
| INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for iter_multiDist_chainRule
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:805 - Position: (973, 1)
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_minus_le
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:805 - Position: (95, 1)
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for phi_min_exists
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:805 - Position: (128, 1)
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_of_translate
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:805 - Position: (89, 1)
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_sum_le
2024-09-08 05:20:40.016 | INFO     | __main__:prove_sorry_theorems:805 - Position: (156, 1)
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multiDist_nonneg
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:805 - Position: (765, 1)
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for I_one_le
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:805 - Position: (137, 1)
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for dist_add_dist_eq
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:805 - Position: (140, 1)
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_of_translate
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:805 - Position: (58, 1)
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_continuous
2024-09-08 05:20:40.017 | INFO     | __main__:prove_sorry_theorems:805 - Position: (62, 1)
2024-09-08 05:20:40.018 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(ProverActor pid=821015) 2024-09-08 05:20:40.029 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_of_translate')
(ProverActor pid=821206) 2024-09-08 05:20:40.026 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='phi_min_exists')
(ProverActor pid=821406) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defau
lt pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a
future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are
 explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub f
or any issues related to this experimental feature.
(ProverActor pid=821406)   return torch.load(io.BytesIO(b))
(pid=821633) [2024-09-08 05:20:47,914] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=821406) 2024-09-08 05:20:50.352 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_minus_le')
(ProverActor pid=821633) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defau
lt pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a
future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are
 explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub f
or any issues related to this experimental feature.
(ProverActor pid=821633)   return torch.load(io.BytesIO(b))
(ProverActor pid=821633) 2024-09-08 05:21:01.074 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='iter_multiDist_chainRule')
(ProverActor pid=821206) 2024-09-08 05:21:26.018 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821015) 2024-09-08 05:21:26.632 | INFO     | prover.proof_search:_best_first_search:149 - 196955.023466456
(ProverActor pid=821015) 2024-09-08 05:21:26.801 | INFO     | prover.proof_search:_best_first_search:150 - 196945.027675749
(ProverActor pid=821015) 2024-09-08 05:21:26.801 | INFO     | prover.proof_search:_best_first_search:151 - 10.164824934996432
(ProverActor pid=821015) 2024-09-08 05:21:26.801 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:21:38.435 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions). [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DED
UP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ProverActor pid=821406) 2024-09-08 05:21:38.435 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821206) 2024-09-08 05:21:38.595 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='phi_min_exists'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.136834638018627, environment_time=2.175071387173375, total_time=10.314997134002624, num_total_nodes=101, nu
m_searched_nodes=2)
(ProverActor pid=821206) 2024-09-08 05:21:38.601 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_sum_le')
(ProverActor pid=821406) 2024-09-08 05:21:48.649 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_minus_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.821457665995695, environment_time=1.394625892949989, total_time=10.996909569978015, num_total_nodes=95, n
um_searched_nodes=2)
(ProverActor pid=821406) 2024-09-08 05:21:48.654 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multiDist_nonneg')
(ProverActor pid=821015) 2024-09-08 05:22:13.639 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_of_translate'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.199875496997265, environment_time=0.8526213341101538, total_time=11.165109331981512, num_total_nodes=
79, num_searched_nodes=2)
(ProverActor pid=821015) 2024-09-08 05:22:13.644 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='I_one_le')
(ProverActor pid=821206) 2024-09-08 05:22:41.097 | INFO     | prover.proof_search:_best_first_search:149 - 197029.488860681
(ProverActor pid=821206) 2024-09-08 05:22:41.098 | INFO     | prover.proof_search:_best_first_search:150 - 197019.49234082
(ProverActor pid=821206) 2024-09-08 05:22:41.098 | INFO     | prover.proof_search:_best_first_search:151 - 9.997032704006415
(ProverActor pid=821206) 2024-09-08 05:22:41.098 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821206) 2024-09-08 05:22:41.098 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:22:46.986 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821633) 2024-09-08 05:22:46.986 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:22:56.529 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_sum_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.814963862008881, environment_time=3.1778758160071447, total_time=10.997294210013933, num_total_nodes=57, nu
m_searched_nodes=1)
(ProverActor pid=821206) 2024-09-08 05:22:56.534 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='dist_add_dist_eq')
(ProverActor pid=821633) 2024-09-08 05:23:10.109 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='iter_multiDist_chainRule'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=4.306418769003358, environment_time=5.64682299506967, total_time=10.976070388016524, num_total_node
s=36, num_searched_nodes=0)
(ProverActor pid=821633) 2024-09-08 05:23:10.115 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_of_translate')
(ProverActor pid=821015) 2024-09-08 05:23:15.801 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821015) 2024-09-08 05:23:28.140 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='I_one_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=8.05159620998893, environment_time=1.596439030196052, total_time=10.651711168990005, num_total_nodes=96, num_search
ed_nodes=2)
(ProverActor pid=821015) 2024-09-08 05:23:28.146 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_continuous')
(ProverActor pid=821406) 2024-09-08 05:23:36.200 | INFO     | prover.proof_search:_best_first_search:149 - 197084.591197727
(ProverActor pid=821406) 2024-09-08 05:23:36.200 | INFO     | prover.proof_search:_best_first_search:150 - 197074.614321576
(ProverActor pid=821406) 2024-09-08 05:23:36.200 | INFO     | prover.proof_search:_best_first_search:151 - 9.977324242005125
(ProverActor pid=821406) 2024-09-08 05:23:36.200 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:23:36.200 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:23:56.899 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821206) 2024-09-08 05:23:56.899 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:24:06.660 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_nonneg'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.984256718977122, environment_time=2.963882249983726, total_time=10.97756416699849, num_total_nodes=62, nu
m_searched_nodes=1)
(ProverActor pid=821633) 2024-09-08 05:24:07.955 | INFO     | prover.proof_search:_best_first_search:149 - 197116.346334987
(ProverActor pid=821633) 2024-09-08 05:24:07.955 | INFO     | prover.proof_search:_best_first_search:150 - 197106.349883729
(ProverActor pid=821633) 2024-09-08 05:24:07.955 | INFO     | prover.proof_search:_best_first_search:151 - 9.996971489978023
(ProverActor pid=821633) 2024-09-08 05:24:07.955 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821633) 2024-09-08 05:24:07.956 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:24:11.109 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='dist_add_dist_eq'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.332245113997487, environment_time=4.2488984782248735, total_time=11.100574584997958, num_total_nodes=44,
num_searched_nodes=1)
(ProverActor pid=821633) 2024-09-08 05:24:16.479 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_of_translate'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=3.783617998997215, environment_time=0.4237034329562448, total_time=10.99729585798923, num_total_nodes=56, n
um_searched_nodes=1)
(ProverActor pid=821015) 2024-09-08 05:24:27.469 | INFO     | prover.proof_search:_best_first_search:149 - 197135.860706488
(ProverActor pid=821015) 2024-09-08 05:24:27.469 | INFO     | prover.proof_search:_best_first_search:150 - 197125.864836645
(ProverActor pid=821015) 2024-09-08 05:24:27.469 | INFO     | prover.proof_search:_best_first_search:151 - 9.99624550199951
(ProverActor pid=821015) 2024-09-08 05:24:27.470 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821015) 2024-09-08 05:24:27.470 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-09-08 05:24:45.545 | INFO     | __main__:process_theorem_batch:733 - No proof found for phi_min_exists
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_minus_le
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_of_translate
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_sum_le
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for iter_multiDist_chainRule
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for I_one_le
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for multiDist_nonneg
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for dist_add_dist_eq
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_of_translate
2024-09-08 05:24:45.546 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_continuous
Processing theorems from teorth/pfr:  27%|███████████████████████████████████▍                                                                                               | 10/37 [04:05<11:02, 24.55s/theorem]2024-09-08 05:24:45.547
| INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multiDist_chainRule
2024-09-08 05:24:45.547 | INFO     | __main__:prove_sorry_theorems:805 - Position: (958, 1)
2024-09-08 05:24:45.547 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multidist_eq_zero
2024-09-08 05:24:45.547 | INFO     | __main__:prove_sorry_theorems:805 - Position: (849, 1)
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for cond_multiDist_chainRule
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:805 - Position: (965, 1)
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_plus_of_sum
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:805 - Position: (71, 1)
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_of_sum_le
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:805 - Position: (111, 1)
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multidist_ruzsa_III
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:805 - Position: (838, 1)
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_of_sum_le
2024-09-08 05:24:45.548 | INFO     | __main__:prove_sorry_theorems:805 - Position: (106, 1)
2024-09-08 05:24:45.549 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_plus_le
2024-09-08 05:24:45.549 | INFO     | __main__:prove_sorry_theorems:805 - Position: (98, 1)
2024-09-08 05:24:45.549 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for dist_le_of_sum_zero
2024-09-08 05:24:45.549 | INFO     | __main__:prove_sorry_theorems:805 - Position: (146, 1)
2024-09-08 05:24:45.549 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for iter_multiDist_chainRule'
2024-09-08 05:24:45.549 | INFO     | __main__:prove_sorry_theorems:805 - Position: (982, 1)
2024-09-08 05:24:45.549 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(ProverActor pid=821015) 2024-09-08 05:24:45.543 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_continuous'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.652898455009563, environment_time=3.7928369878500234, total_time=10.996467927005142, num_total_nodes=102, n
um_searched_nodes=2)
(ProverActor pid=821015) 2024-09-08 05:24:45.552 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multiDist_chainRule')
(ProverActor pid=821206) 2024-09-08 05:24:45.555 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='cond_multiDist_chainRule')
(ProverActor pid=821406) 2024-09-08 05:24:45.557 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_plus_of_sum')
(ProverActor pid=821633) 2024-09-08 05:24:45.554 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multidist_eq_zero')
(ProverActor pid=821406) 2024-09-08 05:26:04.793 | INFO     | prover.proof_search:_best_first_search:149 - 197233.184411843
(ProverActor pid=821406) 2024-09-08 05:26:04.793 | INFO     | prover.proof_search:_best_first_search:150 - 197223.188070982
(ProverActor pid=821406) 2024-09-08 05:26:04.793 | INFO     | prover.proof_search:_best_first_search:151 - 9.996728480997263
(ProverActor pid=821406) 2024-09-08 05:26:04.793 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:26:04.795 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:26:24.557 | INFO     | prover.proof_search:_best_first_search:143 - Ran out of nodes to search.
(ProverActor pid=821406) 2024-09-08 05:26:25.039 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_plus_of_sum'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.1984900389797986, environment_time=1.640885042026639, total_time=10.998300358012784, num_total_nodes=79, n
um_searched_nodes=2)
(ProverActor pid=821406) 2024-09-08 05:26:25.046 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_of_sum_le')
(ProverActor pid=821633) 2024-09-08 05:26:27.424 | INFO     | prover.proof_search:_best_first_search:149 - 197255.815216562
(ProverActor pid=821633) 2024-09-08 05:26:27.424 | INFO     | prover.proof_search:_best_first_search:150 - 197245.842728417
(ProverActor pid=821633) 2024-09-08 05:26:27.424 | INFO     | prover.proof_search:_best_first_search:151 - 9.972906845010584
(ProverActor pid=821633) 2024-09-08 05:26:27.424 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821633) 2024-09-08 05:26:27.426 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:26:35.415 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='cond_multiDist_chainRule'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=3.0666110180027317, environment_time=3.671584068040829, total_time=7.739848245983012, num_total_nod
es=40, num_searched_nodes=1)
(ProverActor pid=821206) 2024-09-08 05:26:35.421 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_III')
(ProverActor pid=821015) 2024-09-08 05:26:32.182 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:26:42.816 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_eq_zero'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=4.2730480290192645, environment_time=3.8434474320383742, total_time=10.975252741016448, num_total_nodes=44
, num_searched_nodes=1)
(ProverActor pid=821633) 2024-09-08 05:26:42.821 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_of_sum_le')
(ProverActor pid=821015) 2024-09-08 05:27:18.640 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_chainRule'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.2746731379884295, environment_time=2.257429195335135, total_time=10.53554595800233, num_total_nodes=90
, num_searched_nodes=2)
(ProverActor pid=821015) 2024-09-08 05:27:18.645 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_plus_le')
(ProverActor pid=821406) 2024-09-08 05:27:25.293 | INFO     | prover.proof_search:_best_first_search:149 - 197313.684621711
(ProverActor pid=821406) 2024-09-08 05:27:25.293 | INFO     | prover.proof_search:_best_first_search:150 - 197303.688344648
(ProverActor pid=821406) 2024-09-08 05:27:25.293 | INFO     | prover.proof_search:_best_first_search:151 - 9.996673262008699
(ProverActor pid=821406) 2024-09-08 05:27:25.294 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:27:25.295 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:27:44.249 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821633) 2024-09-08 05:27:44.250 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:27:54.731 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_of_sum_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.432515979977325, environment_time=0.9920633312431164, total_time=10.997736329998588, num_total_nodes=99, num
_searched_nodes=2)
(ProverActor pid=821633) 2024-09-08 05:27:54.736 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='dist_le_of_sum_zero')
(ProverActor pid=821406) 2024-09-08 05:28:16.054 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_of_sum_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.655568921996746, environment_time=1.0356618429650553, total_time=10.998544677015161, num_total_nodes=99,
 num_searched_nodes=2)
(ProverActor pid=821406) 2024-09-08 05:28:16.060 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name="iter_multiDist_chainRule'")
(ProverActor pid=821015) 2024-09-08 05:28:16.346 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821015) --- Logging error in Loguru Handler #1 ---
(ProverActor pid=821015) Record was: {'elapsed': datetime.timedelta(seconds=485, microseconds=66866), 'exception': None, 'extra': {}, 'file': (name='proof_search.py', path='/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py'
), 'function': '_best_first_search', 'level': (name='INFO', no=20, icon='ℹ️'), 'line': 163, 'message': 'Hit the resource limit (timeout or max_expansions).', 'module': 'proof_search', 'name': 'prover.proof_search', 'process': (id=82101
5, name='MainProcess'), 'thread': (id=132626339390528, name='MainThread'), 'time': datetime(2024, 9, 8, 5, 28, 16, 346062, tzinfo=datetime.timezone(datetime.timedelta(0), 'UTC'))}
(ProverActor pid=821015) Traceback (most recent call last):
(ProverActor pid=821015)   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_handler.py", line 206, in emit
(ProverActor pid=821015)     self._sink.write(str_record)
(ProverActor pid=821015)   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_simple_sinks.py", line 16, in write
(ProverActor pid=821015)     self._stream.write(message)
(ProverActor pid=821015)   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/utils.py", line 412, in write
(ProverActor pid=821015)     self.stream.write(data)
(ProverActor pid=821015)   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 274, in _handle_hard_timeout
(ProverActor pid=821015)     raise DojoHardTimeoutError()
(ProverActor pid=821015) lean_dojo.interaction.dojo.DojoHardTimeoutError
(ProverActor pid=821015) --- End of logging error ---
(ProverActor pid=821206) 2024-09-08 05:28:20.195 | INFO     | prover.proof_search:_best_first_search:149 - 197368.586443602
(ProverActor pid=821206) 2024-09-08 05:28:20.195 | INFO     | prover.proof_search:_best_first_search:150 - 197358.606558665
(ProverActor pid=821206) 2024-09-08 05:28:20.195 | INFO     | prover.proof_search:_best_first_search:151 - 9.980341147020226
(ProverActor pid=821206) 2024-09-08 05:28:20.195 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821015) 2024-09-08 05:28:27.763 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_plus_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.860013026045635, environment_time=3.085126393241808, total_time=10.949912687996402, num_total_nodes=139, n
um_searched_nodes=3)
(ProverActor pid=821206) 2024-09-08 05:28:20.196 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:28:51.767 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:29:06.075 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='dist_le_of_sum_zero'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.585808026982704, environment_time=4.068585806933697, total_time=10.657814581005368, num_total_nodes=70
, num_searched_nodes=2)
(ProverActor pid=821206) 2024-09-08 05:29:08.907 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_III'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.877662644983502, environment_time=2.2557581999571994, total_time=10.98059966301662, num_total_nodes=55
, num_searched_nodes=1)
(ProverActor pid=821406) 2024-09-08 05:29:57.253 | INFO     | prover.proof_search:_best_first_search:149 - 197465.644918644
(ProverActor pid=821406) 2024-09-08 05:29:57.254 | INFO     | prover.proof_search:_best_first_search:150 - 197455.662725978
(ProverActor pid=821406) 2024-09-08 05:29:57.254 | INFO     | prover.proof_search:_best_first_search:151 - 9.982557615003316
(ProverActor pid=821406) 2024-09-08 05:29:57.254 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:29:57.255 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-09-08 05:30:08.398 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_plus_of_sum
2024-09-08 05:30:08.398 | INFO     | __main__:process_theorem_batch:733 - No proof found for cond_multiDist_chainRule
2024-09-08 05:30:08.398 | INFO     | __main__:process_theorem_batch:733 - No proof found for multidist_eq_zero
2024-09-08 05:30:08.398 | INFO     | __main__:process_theorem_batch:733 - No proof found for multiDist_chainRule
2024-09-08 05:30:08.398 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_of_sum_le
2024-09-08 05:30:08.398 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_of_sum_le
2024-09-08 05:30:08.399 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_plus_le
2024-09-08 05:30:08.399 | INFO     | __main__:process_theorem_batch:733 - No proof found for dist_le_of_sum_zero
2024-09-08 05:30:08.399 | INFO     | __main__:process_theorem_batch:733 - No proof found for multidist_ruzsa_III
2024-09-08 05:30:08.399 | INFO     | __main__:process_theorem_batch:733 - No proof found for iter_multiDist_chainRule'
Processing theorems from teorth/pfr:  54%|██████████████████████████████████████████████████████████████████████▊                                                            | 20/37 [09:28<08:14, 29.10s/theorem]2024-09-08 05:30:08.400
| INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_of_subgroup
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:805 - Position: (55, 1)
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for cor_multiDist_chainRule
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:805 - Position: (986, 1)
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multidist_ruzsa_I
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:805 - Position: (828, 1)
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for dist_of_min_eq_zero
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:805 - Position: (174, 1)
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for I_two_le
2024-09-08 05:30:08.400 | INFO     | __main__:prove_sorry_theorems:805 - Position: (143, 1)
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_sum_le'
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:805 - Position: (165, 1)
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_of_injective
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:805 - Position: (92, 1)
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multidist_ruzsa_IV
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:805 - Position: (844, 1)
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multiTau_continuous
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:805 - Position: (52, 1)
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for ent_of_sum_le_ent_of_sum
2024-09-08 05:30:08.401 | INFO     | __main__:prove_sorry_theorems:805 - Position: (546, 1)
2024-09-08 05:30:08.401 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(ProverActor pid=821015) 2024-09-08 05:30:08.408 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='dist_of_min_eq_zero')
(ProverActor pid=821206) 2024-09-08 05:30:08.406 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='cor_multiDist_chainRule')
(ProverActor pid=821406) 2024-09-08 05:30:08.395 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name="iter_multiDist_chainRule'"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.115886928018881, environment_time=2.7488760789565276, total_time=10.983702712983359, num_total_n
odes=84, num_searched_nodes=2)
(ProverActor pid=821406) 2024-09-08 05:30:08.404 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_of_subgroup')
(ProverActor pid=821633) 2024-09-08 05:30:08.407 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_I')
(ProverActor pid=821406) 2024-09-08 05:31:00.627 | INFO     | prover.proof_search:_best_first_search:149 - 197529.018448548
(ProverActor pid=821406) 2024-09-08 05:31:00.627 | INFO     | prover.proof_search:_best_first_search:150 - 197519.023271057
(ProverActor pid=821406) 2024-09-08 05:31:00.627 | INFO     | prover.proof_search:_best_first_search:151 - 9.995587660989258
(ProverActor pid=821406) 2024-09-08 05:31:00.627 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:31:00.628 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:31:11.330 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_of_subgroup'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=2.5161139060219284, environment_time=4.601673960190965, total_time=10.996114473004127, num_total_nodes=49, n
um_searched_nodes=1)
(ProverActor pid=821406) 2024-09-08 05:31:11.336 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='I_two_le')
(ProverActor pid=821015) 2024-09-08 05:31:02.185 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821015) 2024-09-08 05:31:02.185 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821015) 2024-09-08 05:31:12.512 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='dist_of_min_eq_zero'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.9304169730166905, environment_time=3.05459577369038, total_time=11.000207177974517, num_total_nodes=13
5, num_searched_nodes=2)
(ProverActor pid=821015) 2024-09-08 05:31:12.517 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name="condRho_sum_le'")
(ProverActor pid=821206) 2024-09-08 05:31:58.975 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:31:58.975 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821406) 2024-09-08 05:32:07.855 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:32:07.854 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821015) 2024-09-08 05:32:12.248 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:32:17.816 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 8x across cluster]
(ProverActor pid=821633) 2024-09-08 05:32:17.818 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:32:18.613 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='I_two_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=3.19614575401647, environment_time=5.204797490994679, total_time=10.997521606012015, num_total_nodes=52, num_search
ed_nodes=1)
(ProverActor pid=821406) 2024-09-08 05:32:18.621 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_of_injective')
(ProverActor pid=821206) 2024-09-08 05:32:19.635 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='cor_multiDist_chainRule'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.362018247018568, environment_time=4.280513059842633, total_time=11.235088134009857, num_total_node
s=59, num_searched_nodes=1)
(ProverActor pid=821206) 2024-09-08 05:32:19.640 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_IV')
(ProverActor pid=821015) 2024-09-08 05:32:24.210 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name="condRho_sum_le'"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.895398747001309, environment_time=3.090158825973049, total_time=11.227752648002934, num_total_nodes=54, nu
m_searched_nodes=1)
(ProverActor pid=821015) 2024-09-08 05:32:24.216 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MultiTauFunctional.lean'), full_name='multiTau_continuous')
(ProverActor pid=821633) 2024-09-08 05:32:39.676 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_I'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=3.436442125996109, environment_time=5.043317086965544, total_time=11.072076611977536, num_total_nodes=44,
num_searched_nodes=1)
(ProverActor pid=821633) 2024-09-08 05:32:39.681 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='ent_of_sum_le_ent_of_sum')
(ProverActor pid=821406) 2024-09-08 05:33:09.626 | INFO     | prover.proof_search:_best_first_search:149 - 197658.017267768
(ProverActor pid=821406) 2024-09-08 05:33:09.626 | INFO     | prover.proof_search:_best_first_search:150 - 197648.021519003
(ProverActor pid=821406) 2024-09-08 05:33:09.626 | INFO     | prover.proof_search:_best_first_search:151 - 9.996091612993041
(ProverActor pid=821406) 2024-09-08 05:33:09.626 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:33:09.628 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821015) 2024-09-08 05:33:23.459 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MultiTauFunctional.lean'), full_name='multiTau_continuous'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.593455947993789, environment_time=3.753854810958728, total_time=10.996432027983246, num_total_nod
es=48, num_searched_nodes=1)
(ProverActor pid=821015) 2024-09-08 05:33:13.859 | INFO     | prover.proof_search:_best_first_search:152 - 10 [repeated 4x across cluster]
(ProverActor pid=821015) 2024-09-08 05:33:13.859 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:33:46.569 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_of_injective'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.984334249049425, environment_time=0.8583190612844191, total_time=10.99761342900456, num_total_nodes=9
6, num_searched_nodes=3)
(ProverActor pid=821206) 2024-09-08 05:33:53.330 | INFO     | prover.proof_search:_best_first_search:149 - 197701.72197155
(ProverActor pid=821206) 2024-09-08 05:33:53.331 | INFO     | prover.proof_search:_best_first_search:150 - 197691.747228365
(ProverActor pid=821206) 2024-09-08 05:33:53.331 | INFO     | prover.proof_search:_best_first_search:151 - 9.97529795797891
(ProverActor pid=821206) 2024-09-08 05:33:53.331 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821206) 2024-09-08 05:33:53.331 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:34:00.614 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:34:09.086 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='ent_of_sum_le_ent_of_sum'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=5.495908081007656, environment_time=3.8813014609913807, total_time=10.380199745006394, num_total_no
des=78, num_searched_nodes=2)
2024-09-08 05:34:23.301 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_of_subgroup
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for dist_of_min_eq_zero
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for I_two_le
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for cor_multiDist_chainRule
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_sum_le'
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for multidist_ruzsa_I
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for multiTau_continuous
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_of_injective
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for ent_of_sum_le_ent_of_sum
2024-09-08 05:34:23.302 | INFO     | __main__:process_theorem_batch:733 - No proof found for multidist_ruzsa_IV
Processing theorems from teorth/pfr:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 30/37 [13:43<03:12, 27.45s/theorem]2024-09-08 05:34:23.303
| INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condRho_le
2024-09-08 05:34:23.303 | INFO     | __main__:prove_sorry_theorems:805 - Position: (101, 1)
2024-09-08 05:34:23.303 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multiTau_min_exists
2024-09-08 05:34:23.303 | INFO     | __main__:prove_sorry_theorems:805 - Position: (56, 1)
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_minus_of_sum
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:805 - Position: (66, 1)
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multidist_ruzsa_II
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:805 - Position: (833, 1)
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for rho_of_sum
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:805 - Position: (75, 1)
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for multiDist_indep
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:805 - Position: (760, 1)
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for condMultiDist_eq
2024-09-08 05:34:23.304 | INFO     | __main__:prove_sorry_theorems:805 - Position: (865, 1)
Processing theorems from teorth/pfr: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [13:43<00:00, 22.25s/theorem]
2024-09-08 05:34:23.305 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(ProverActor pid=821015) 2024-09-08 05:34:23.312 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_II')
(ProverActor pid=821206) 2024-09-08 05:34:23.299 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_IV'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.861993720987812, environment_time=2.258371534058824, total_time=10.975633625988849, num_total_nodes=54,
 num_searched_nodes=1)
(ProverActor pid=821206) 2024-09-08 05:34:23.308 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='condRho_le')
(ProverActor pid=821406) 2024-09-08 05:34:23.311 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_minus_of_sum')
(ProverActor pid=821633) 2024-09-08 05:34:23.309 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MultiTauFunctional.lean'), full_name='multiTau_min_exists')
(ProverActor pid=821406) 2024-09-08 05:35:15.274 | INFO     | prover.proof_search:_best_first_search:149 - 197783.665377496
(ProverActor pid=821406) 2024-09-08 05:35:15.274 | INFO     | prover.proof_search:_best_first_search:150 - 197773.669820307
(ProverActor pid=821406) 2024-09-08 05:35:15.274 | INFO     | prover.proof_search:_best_first_search:151 - 9.99607453099452
(ProverActor pid=821406) 2024-09-08 05:35:15.274 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:35:15.275 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:35:26.460 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_minus_of_sum'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=4.088222234975547, environment_time=0.6610990350309294, total_time=10.996579803002533, num_total_nodes=56,
num_searched_nodes=1)
(ProverActor pid=821406) 2024-09-08 05:35:26.465 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/RhoFunctional.lean'), full_name='rho_of_sum')
(ProverActor pid=821633) 2024-09-08 05:35:15.572 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:35:27.292 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MultiTauFunctional.lean'), full_name='multiTau_min_exists'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=7.4359971600351855, environment_time=2.3384613152011298, total_time=10.777930575015489, num_total_n
odes=103, num_searched_nodes=2)
(ProverActor pid=821633) 2024-09-08 05:35:27.297 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='multiDist_indep')
(ProverActor pid=821206) 2024-09-08 05:35:32.554 | INFO     | prover.proof_search:_best_first_search:149 - 197800.945244744
(ProverActor pid=821206) 2024-09-08 05:35:32.554 | INFO     | prover.proof_search:_best_first_search:150 - 197790.949337827
(ProverActor pid=821206) 2024-09-08 05:35:32.554 | INFO     | prover.proof_search:_best_first_search:151 - 9.996264916000655
(ProverActor pid=821206) 2024-09-08 05:35:32.554 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821206) 2024-09-08 05:35:32.556 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821206) 2024-09-08 05:36:01.417 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='condRho_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.385137445991859, environment_time=1.7450832829927094, total_time=10.997801441990305, num_total_nodes=106, num_s
earched_nodes=2)
(ProverActor pid=821206) 2024-09-08 05:36:01.424 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file_path=PosixPat
h('PFR/MoreRuzsaDist.lean'), full_name='condMultiDist_eq')
(ProverActor pid=821015) 2024-09-08 05:36:04.091 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:36:21.710 | INFO     | prover.proof_search:_best_first_search:149 - 197850.101960793
(ProverActor pid=821406) 2024-09-08 05:36:21.711 | INFO     | prover.proof_search:_best_first_search:150 - 197840.106082803
(ProverActor pid=821406) 2024-09-08 05:36:21.711 | INFO     | prover.proof_search:_best_first_search:151 - 9.996288300026208
(ProverActor pid=821406) 2024-09-08 05:36:21.711 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821406) 2024-09-08 05:36:21.711 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821406) 2024-09-08 05:36:34.274 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/RhoFunctional.lean'), full_name='rho_of_sum'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.102977912989445, environment_time=1.4714468480378855, total_time=10.996748461009702, num_total_nodes=75, num_se
arched_nodes=2)
(ProverActor pid=821015) 2024-09-08 05:36:44.646 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multidist_ruzsa_II'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=6.317623259004904, environment_time=3.4394145791593473, total_time=10.760045095026726, num_total_nodes=65
, num_searched_nodes=2)
(ProverActor pid=821633) 2024-09-08 05:37:04.679 | INFO     | prover.proof_search:_best_first_search:149 - 197893.070601609
(ProverActor pid=821633) 2024-09-08 05:37:04.679 | INFO     | prover.proof_search:_best_first_search:150 - 197883.093296212
(ProverActor pid=821633) 2024-09-08 05:37:04.679 | INFO     | prover.proof_search:_best_first_search:151 - 9.97774432701408
(ProverActor pid=821633) 2024-09-08 05:37:04.680 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821633) 2024-09-08 05:37:04.680 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=821633) 2024-09-08 05:37:32.904 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='multiDist_indep'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=3.723208587995032, environment_time=0.6025061779655516, total_time=10.977979863004293, num_total_nodes=6, nu
m_searched_nodes=0)
(ProverActor pid=821206) 2024-09-08 05:37:42.510 | INFO     | prover.proof_search:_best_first_search:149 - 197930.901222373
(ProverActor pid=821206) 2024-09-08 05:37:42.510 | INFO     | prover.proof_search:_best_first_search:150 - 197920.92087738
(ProverActor pid=821206) 2024-09-08 05:37:42.510 | INFO     | prover.proof_search:_best_first_search:151 - 9.9806940209819
(ProverActor pid=821206) 2024-09-08 05:37:42.510 | INFO     | prover.proof_search:_best_first_search:152 - 10
(ProverActor pid=821206) 2024-09-08 05:37:42.512 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-09-08 05:38:21.941 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_minus_of_sum
2024-09-08 05:38:21.941 | INFO     | __main__:process_theorem_batch:733 - No proof found for multiTau_min_exists
2024-09-08 05:38:21.942 | INFO     | __main__:process_theorem_batch:733 - No proof found for condRho_le
2024-09-08 05:38:21.942 | INFO     | __main__:process_theorem_batch:733 - No proof found for rho_of_sum
2024-09-08 05:38:21.942 | INFO     | __main__:process_theorem_batch:733 - No proof found for multidist_ruzsa_II
2024-09-08 05:38:21.942 | INFO     | __main__:process_theorem_batch:733 - No proof found for multiDist_indep
2024-09-08 05:38:21.942 | INFO     | __main__:process_theorem_batch:733 - No proof found for condMultiDist_eq
2024-09-08 05:38:21.942 | INFO     | __main__:save_progress:736 - Saving encountered theorems...
2024-09-08 05:38:21.944 | INFO     | __main__:prove_sorry_theorems:832 - Finished attempting to prove sorry theorems
(ProverActor pid=821206) 2024-09-08 05:38:21.939 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/teorth/pfr', commit='fa398a5b853c7e94e3294c45e50c6aee013a2687'), file
_path=PosixPath('PFR/MoreRuzsaDist.lean'), full_name='condMultiDist_eq'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=3.227002360014012, environment_time=4.683920311916154, total_time=10.982377740991069, num_total_nodes=49, n
um_searched_nodes=1)
2024-09-08 05:38:35.160 | INFO     | __main__:main:1603 - Finished searching for proofs of sorry theorems
2024-09-08 05:38:35.160 | INFO     | __main__:main:1629 - current epoch: 1
2024-09-08 05:38:35.160 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 05:38:35.160 | INFO     | __main__:main:1300 - i: 1
2024-09-08 05:38:35.160 | INFO     | __main__:main:1305 - Main process
2024-09-08 05:38:35.160 | INFO     | __main__:main:1306 - Using lambda = 0.1
2024-09-08 05:38:35.161 | INFO     | __main__:main:1307 - Processing https://github.com/teorth/pfr
2024-09-08 05:38:35.161 | INFO     | __main__:main:1329 - Adding repo to repos_for_merged_dataset
2024-09-08 05:38:35.161 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 05:38:35.163 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a
2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:38:35.163 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=70.73.ckpt
2024-09-08 05:38:35.163 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 05:38:35.163 | INFO     | __main__:main:1354 - Starting training at epoch 1
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module im
plicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
 default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowli
sted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues relat
ed to this experimental feature.
2024-09-08 05:38:36.612 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_ep
och=0-Recall@10_val=70.73.ckpt and reset epoch count
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on S
LURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 05:38:36.706 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be
depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 05:38:36.817 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 05:38:49.365 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:38:49.383 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 05:38:49.398 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 05:38:49.399 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 05:38:49.399 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 05:38:49.399 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 05:38:49.399 | INFO     | __main__:main:1460 - Starting progressive training from epoch 1 to 2
2024-09-08 05:38:49.399 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 0] Seed set to 3407
2024-09-08 05:38:49.876 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:38:49.983 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 05:38:52.459 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is no
t empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 05:38:53.055 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  0.98it/s, v_num=171012024-09-08 05:38:56.652 |
 INFO     | retrieval.model:validation_step:325 - Inside validation_step                                                                                            | 0/1 [00:00<?, ?it/s]
2024-09-08 05:38:56.652 | INFO     | retrieval.model:validation_step:326 - All training loss for epoch
2024-09-08 05:38:56.683 | INFO     | retrieval.model:validation_step:330 - Embeddings staled validation step: False
2024-09-08 05:38:59.194 | INFO     | retrieval.model:validation_step:380 - Recall@1_val: 0.0
2024-09-08 05:38:59.198 | INFO     | retrieval.model:validation_step:380 - Recall@2_val: 0.0
2024-09-08 05:38:59.199 | INFO     | retrieval.model:validation_step:380 - Recall@3_val: 0.0
2024-09-08 05:38:59.200 | INFO     | retrieval.model:validation_step:380 - Recall@4_val: 0.0
2024-09-08 05:38:59.201 | INFO     | retrieval.model:validation_step:380 - Recall@5_val: 0.0
2024-09-08 05:38:59.202 | INFO     | retrieval.model:validation_step:380 - Recall@6_val: 0.0
2024-09-08 05:38:59.203 | INFO     | retrieval.model:validation_step:380 - Recall@7_val: 0.0
2024-09-08 05:38:59.204 | INFO     | retrieval.model:validation_step:380 - Recall@8_val: 0.0
2024-09-08 05:38:59.205 | INFO     | retrieval.model:validation_step:380 - Recall@9_val: 0.0
2024-09-08 05:38:59.206 | INFO     | retrieval.model:validation_step:380 - Recall@10_val: 0.0
2024-09-08 05:38:59.207 | INFO     | retrieval.model:validation_step:380 - Recall@11_val: 0.0
2024-09-08 05:38:59.208 | INFO     | retrieval.model:validation_step:380 - Recall@12_val: 0.0
2024-09-08 05:38:59.209 | INFO     | retrieval.model:validation_step:380 - Recall@13_val: 0.0
2024-09-08 05:38:59.210 | INFO     | retrieval.model:validation_step:380 - Recall@14_val: 0.0
2024-09-08 05:38:59.211 | INFO     | retrieval.model:validation_step:380 - Recall@15_val: 0.0
2024-09-08 05:38:59.212 | INFO     | retrieval.model:validation_step:380 - Recall@16_val: 0.0
2024-09-08 05:38:59.213 | INFO     | retrieval.model:validation_step:380 - Recall@17_val: 0.0
2024-09-08 05:38:59.214 | INFO     | retrieval.model:validation_step:380 - Recall@18_val: 0.0
2024-09-08 05:38:59.215 | INFO     | retrieval.model:validation_step:380 - Recall@19_val: 0.0
2024-09-08 05:38:59.216 | INFO     | retrieval.model:validation_step:380 - Recall@20_val: 0.0
2024-09-08 05:38:59.218 | INFO     | retrieval.model:validation_step:380 - Recall@21_val: 0.0
2024-09-08 05:38:59.219 | INFO     | retrieval.model:validation_step:380 - Recall@22_val: 0.0
2024-09-08 05:38:59.220 | INFO     | retrieval.model:validation_step:380 - Recall@23_val: 1.0638297872340425
2024-09-08 05:38:59.221 | INFO     | retrieval.model:validation_step:380 - Recall@24_val: 1.0638297872340425
2024-09-08 05:38:59.222 | INFO     | retrieval.model:validation_step:380 - Recall@25_val: 1.0638297872340425
2024-09-08 05:38:59.223 | INFO     | retrieval.model:validation_step:380 - Recall@26_val: 1.0638297872340425
2024-09-08 05:38:59.224 | INFO     | retrieval.model:validation_step:380 - Recall@27_val: 1.0638297872340425
2024-09-08 05:38:59.225 | INFO     | retrieval.model:validation_step:380 - Recall@28_val: 1.0638297872340425
2024-09-08 05:38:59.226 | INFO     | retrieval.model:validation_step:380 - Recall@29_val: 1.0638297872340425
2024-09-08 05:38:59.227 | INFO     | retrieval.model:validation_step:380 - Recall@30_val: 1.0638297872340425
2024-09-08 05:38:59.228 | INFO     | retrieval.model:validation_step:380 - Recall@31_val: 1.0638297872340425
2024-09-08 05:38:59.229 | INFO     | retrieval.model:validation_step:380 - Recall@32_val: 1.0638297872340425
2024-09-08 05:38:59.230 | INFO     | retrieval.model:validation_step:380 - Recall@33_val: 1.0638297872340425
2024-09-08 05:38:59.231 | INFO     | retrieval.model:validation_step:380 - Recall@34_val: 1.0638297872340425
2024-09-08 05:38:59.232 | INFO     | retrieval.model:validation_step:380 - Recall@35_val: 1.0638297872340425
2024-09-08 05:38:59.233 | INFO     | retrieval.model:validation_step:380 - Recall@36_val: 1.0638297872340425
2024-09-08 05:38:59.234 | INFO     | retrieval.model:validation_step:380 - Recall@37_val: 1.0638297872340425
2024-09-08 05:38:59.235 | INFO     | retrieval.model:validation_step:380 - Recall@38_val: 1.0638297872340425
2024-09-08 05:38:59.236 | INFO     | retrieval.model:validation_step:380 - Recall@39_val: 1.0638297872340425
2024-09-08 05:38:59.237 | INFO     | retrieval.model:validation_step:380 - Recall@40_val: 1.0638297872340425
2024-09-08 05:38:59.238 | INFO     | retrieval.model:validation_step:380 - Recall@41_val: 1.0638297872340425
2024-09-08 05:38:59.239 | INFO     | retrieval.model:validation_step:380 - Recall@42_val: 1.0638297872340425
2024-09-08 05:38:59.240 | INFO     | retrieval.model:validation_step:380 - Recall@43_val: 1.0638297872340425
2024-09-08 05:38:59.241 | INFO     | retrieval.model:validation_step:380 - Recall@44_val: 1.0638297872340425
2024-09-08 05:38:59.242 | INFO     | retrieval.model:validation_step:380 - Recall@45_val: 1.0638297872340425
2024-09-08 05:38:59.243 | INFO     | retrieval.model:validation_step:380 - Recall@46_val: 1.0638297872340425
2024-09-08 05:38:59.244 | INFO     | retrieval.model:validation_step:380 - Recall@47_val: 1.0638297872340425
2024-09-08 05:38:59.245 | INFO     | retrieval.model:validation_step:380 - Recall@48_val: 1.0638297872340425
2024-09-08 05:38:59.246 | INFO     | retrieval.model:validation_step:380 - Recall@49_val: 1.0638297872340425
2024-09-08 05:38:59.247 | INFO     | retrieval.model:validation_step:380 - Recall@50_val: 1.0638297872340425
2024-09-08 05:38:59.248 | INFO     | retrieval.model:validation_step:380 - Recall@51_val: 1.0638297872340425
2024-09-08 05:38:59.249 | INFO     | retrieval.model:validation_step:380 - Recall@52_val: 1.0638297872340425
2024-09-08 05:38:59.250 | INFO     | retrieval.model:validation_step:380 - Recall@53_val: 1.0638297872340425
2024-09-08 05:38:59.251 | INFO     | retrieval.model:validation_step:380 - Recall@54_val: 1.0638297872340425
2024-09-08 05:38:59.252 | INFO     | retrieval.model:validation_step:380 - Recall@55_val: 1.0638297872340425
2024-09-08 05:38:59.253 | INFO     | retrieval.model:validation_step:380 - Recall@56_val: 1.0638297872340425
2024-09-08 05:38:59.254 | INFO     | retrieval.model:validation_step:380 - Recall@57_val: 1.0638297872340425
2024-09-08 05:38:59.255 | INFO     | retrieval.model:validation_step:380 - Recall@58_val: 1.0638297872340425
2024-09-08 05:38:59.256 | INFO     | retrieval.model:validation_step:380 - Recall@59_val: 1.0638297872340425
2024-09-08 05:38:59.257 | INFO     | retrieval.model:validation_step:380 - Recall@60_val: 1.0638297872340425
2024-09-08 05:38:59.258 | INFO     | retrieval.model:validation_step:380 - Recall@61_val: 1.0638297872340425
2024-09-08 05:38:59.259 | INFO     | retrieval.model:validation_step:380 - Recall@62_val: 1.0638297872340425
2024-09-08 05:38:59.260 | INFO     | retrieval.model:validation_step:380 - Recall@63_val: 1.0638297872340425
2024-09-08 05:38:59.261 | INFO     | retrieval.model:validation_step:380 - Recall@64_val: 1.0638297872340425
2024-09-08 05:38:59.262 | INFO     | retrieval.model:validation_step:380 - Recall@65_val: 1.0638297872340425
2024-09-08 05:38:59.263 | INFO     | retrieval.model:validation_step:380 - Recall@66_val: 1.0638297872340425
2024-09-08 05:38:59.264 | INFO     | retrieval.model:validation_step:380 - Recall@67_val: 1.0638297872340425
2024-09-08 05:38:59.265 | INFO     | retrieval.model:validation_step:380 - Recall@68_val: 1.0638297872340425
2024-09-08 05:38:59.266 | INFO     | retrieval.model:validation_step:380 - Recall@69_val: 1.0638297872340425
2024-09-08 05:38:59.267 | INFO     | retrieval.model:validation_step:380 - Recall@70_val: 1.0638297872340425
2024-09-08 05:38:59.268 | INFO     | retrieval.model:validation_step:380 - Recall@71_val: 1.0638297872340425
2024-09-08 05:38:59.269 | INFO     | retrieval.model:validation_step:380 - Recall@72_val: 1.0638297872340425
2024-09-08 05:38:59.270 | INFO     | retrieval.model:validation_step:380 - Recall@73_val: 1.0638297872340425
2024-09-08 05:38:59.271 | INFO     | retrieval.model:validation_step:380 - Recall@74_val: 1.0638297872340425
2024-09-08 05:38:59.273 | INFO     | retrieval.model:validation_step:380 - Recall@75_val: 1.0638297872340425
2024-09-08 05:38:59.274 | INFO     | retrieval.model:validation_step:380 - Recall@76_val: 1.0638297872340425
2024-09-08 05:38:59.275 | INFO     | retrieval.model:validation_step:380 - Recall@77_val: 1.0638297872340425
2024-09-08 05:38:59.276 | INFO     | retrieval.model:validation_step:380 - Recall@78_val: 1.0638297872340425
2024-09-08 05:38:59.277 | INFO     | retrieval.model:validation_step:380 - Recall@79_val: 1.0638297872340425
2024-09-08 05:38:59.278 | INFO     | retrieval.model:validation_step:380 - Recall@80_val: 1.0638297872340425
2024-09-08 05:38:59.279 | INFO     | retrieval.model:validation_step:380 - Recall@81_val: 1.0638297872340425
2024-09-08 05:38:59.280 | INFO     | retrieval.model:validation_step:380 - Recall@82_val: 1.0638297872340425
2024-09-08 05:38:59.281 | INFO     | retrieval.model:validation_step:380 - Recall@83_val: 1.0638297872340425
2024-09-08 05:38:59.282 | INFO     | retrieval.model:validation_step:380 - Recall@84_val: 1.0638297872340425
2024-09-08 05:38:59.283 | INFO     | retrieval.model:validation_step:380 - Recall@85_val: 1.0638297872340425
2024-09-08 05:38:59.284 | INFO     | retrieval.model:validation_step:380 - Recall@86_val: 1.0638297872340425
2024-09-08 05:38:59.285 | INFO     | retrieval.model:validation_step:380 - Recall@87_val: 1.0638297872340425
2024-09-08 05:38:59.286 | INFO     | retrieval.model:validation_step:380 - Recall@88_val: 1.0638297872340425
2024-09-08 05:38:59.287 | INFO     | retrieval.model:validation_step:380 - Recall@89_val: 1.0638297872340425
2024-09-08 05:38:59.288 | INFO     | retrieval.model:validation_step:380 - Recall@90_val: 1.0638297872340425
2024-09-08 05:38:59.289 | INFO     | retrieval.model:validation_step:380 - Recall@91_val: 1.0638297872340425
2024-09-08 05:38:59.290 | INFO     | retrieval.model:validation_step:380 - Recall@92_val: 1.0638297872340425
2024-09-08 05:38:59.291 | INFO     | retrieval.model:validation_step:380 - Recall@93_val: 1.0638297872340425
2024-09-08 05:38:59.292 | INFO     | retrieval.model:validation_step:380 - Recall@94_val: 1.0638297872340425
2024-09-08 05:38:59.293 | INFO     | retrieval.model:validation_step:380 - Recall@95_val: 1.0638297872340425
2024-09-08 05:38:59.294 | INFO     | retrieval.model:validation_step:380 - Recall@96_val: 1.0638297872340425
2024-09-08 05:38:59.295 | INFO     | retrieval.model:validation_step:380 - Recall@97_val: 1.0638297872340425
2024-09-08 05:38:59.296 | INFO     | retrieval.model:validation_step:380 - Recall@98_val: 1.0638297872340425
2024-09-08 05:38:59.297 | INFO     | retrieval.model:validation_step:380 - Recall@99_val: 1.0638297872340425
2024-09-08 05:38:59.298 | INFO     | retrieval.model:validation_step:380 - Recall@100_val: 1.0638297872340425
2024-09-08 05:38:59.299 | INFO     | retrieval.model:validation_step:389 - MRR: 0.0009250693802035152
2024-09-08 05:38:59.301 | INFO     | retrieval.model:validation_step:397 - End of validation_step
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  0.36it/s, v_num=17101]Epoch 1, global step 3:
'Recall@10_val' was not in top 1
`Trainer.fit` stopped: `max_epochs=2` reached.
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  0.36it/s, v_num=17101]
2024-09-08 05:39:01.626 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 05:39:01.627 | INFO     | __main__:main:1476 - Finished progressive training at epoch 2
2024-09-08 05:39:03.110 | INFO     | __main__:main:1495 - Testing...
2024-09-08 05:39:03.112 | INFO     | retrieval.main:run_cli:60 - PID: 789002
[rank: 0] Seed set to 3407
2024-09-08 05:39:03.337 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 05:39:03.337 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpu
s.jsonl
2024-09-08 05:39:03.871 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 05:39:16.243 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 05:39:16.262 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a26
87/random/cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]2024-09-08 05:39:18.902
| INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                                                                                                                             | 0/11 [00:00<?, ?it/s]/data/yingzi_ma/minicond
a3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:27<00:00,  0.40it/s]2024-09-08 05:39:46.687
| INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 05:39:46.701 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 05:39:46.701 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 05:39:46.701 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:27<00:00,  0.40it/s]
2024-09-08 05:39:47.463 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 05:39:47.530 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 05:39:47.574 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 78526.61it/s]
2024-09-08 05:39:47.594 | INFO     | __main__:main:1521 - R@1 = 0.0 %, R@10 = 0.2777777777777778 %, MRR = 0.003908386690693454
2024-09-08 05:39:47.596 | INFO     | retrieval.main:run_cli:60 - PID: 789002
[rank: 0] Seed set to 3407
2024-09-08 05:39:47.823 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random
2024-09-08 05:39:47.824 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f991
6ae24253d566/corpus.jsonl
2024-09-08 05:39:48.380 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 05:40:03.382 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7
bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 05:40:03.402 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7
bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]2024-09-08 05:40:05.977
| INFO     | retrieval.model:on_predict_start:408 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:26<00:00,  0.42it/s]2024-09-08 05:40:32.086
| INFO     | retrieval.model:on_predict_epoch_end:518 - About to construct predictions map
2024-09-08 05:40:32.099 | INFO     | retrieval.model:on_predict_epoch_end:538 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 05:40:32.099 | INFO     | retrieval.model:on_predict_epoch_end:577 - About to call barrier
2024-09-08 05:40:32.099 | INFO     | retrieval.model:on_predict_epoch_end:581 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:26<00:00,  0.42it/s]
2024-09-08 05:40:32.836 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 05:40:32.903 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 05:40:32.947 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.
json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 20789.84it/s]
2024-09-08 05:40:33.025 | INFO     | __main__:main:1521 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 05:40:33.026 | INFO     | __main__:main:1534 - Average R@1 = 0.147703449590242 %, R@10 = 0.33265040340512037 %, MRR = 0.007377897649023361
2024-09-08 05:40:33.027 | INFO     | __main__:main:1569 - Starting the prover
2024-09-08 05:40:33.027 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 05:40:33.027 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 05:40:33.027 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 05:40:33.027 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e
50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=70.73.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt
5-small/model_lightning.ckpt`
2024-09-08 05:40:33.451 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lamb
da_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:40:33.451 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lamb
da_0.1_epoch=0-Recall@10_val=70.73.ckpt
2024-09-08 05:40:40.186 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.
encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight',
'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.en
coder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight',
'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.w
eight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseR
eluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.enc
oder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.l
ayer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weig
ht', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.b
lock.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.enco
der.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.en
coder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'ret
riever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weigh
t', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_no
rm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseR
eluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retrieve
r.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.
layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.w
o.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.en
coder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseRelu
Dense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', '
state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 05:40:40.983 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 05:40:40.984 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 05:40:40.985 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/co
rpus.jsonl
2024-09-08 05:40:40.985 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 05:40:48.173 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 05:40:48.173 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/cor
pus.jsonl
2024-09-08 05:40:48.173 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
(autoscaler +23m55s) Tip: use `ray status` to view detailed cluster status. To disable these messages, set RAY_SCHEDULER_EVENTS=0.
(autoscaler +23m55s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more n
odes to this Ray cluster.
2024-09-08 05:41:37.025 | INFO     | __main__:prove_sorry_theorems:781 - Found 37 sorry theorems to prove
Processing theorems from teorth/pfr:   0%|                                                                                                                                            | 0/37 [00:00<?, ?theorem/s]2024-09-08 05:41:37.028
| INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: iter_multiDist_chainRule
2024-09-08 05:41:37.028 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_minus_le
2024-09-08 05:41:37.028 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: phi_min_exists
2024-09-08 05:41:37.028 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_of_translate
2024-09-08 05:41:37.028 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_sum_le
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multiDist_nonneg
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: I_one_le
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: dist_add_dist_eq
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_of_translate
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_continuous
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multiDist_chainRule
2024-09-08 05:41:37.029 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multidist_eq_zero
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: cond_multiDist_chainRule
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_plus_of_sum
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_of_sum_le
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multidist_ruzsa_III
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_of_sum_le
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_plus_le
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: dist_le_of_sum_zero
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: iter_multiDist_chainRule'
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_of_subgroup
2024-09-08 05:41:37.030 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: cor_multiDist_chainRule
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multidist_ruzsa_I
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: dist_of_min_eq_zero
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: I_two_le
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_sum_le'
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_of_injective
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multidist_ruzsa_IV
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multiTau_continuous
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: ent_of_sum_le_ent_of_sum
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condRho_le
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multiTau_min_exists
2024-09-08 05:41:37.031 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_minus_of_sum
2024-09-08 05:41:37.032 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multidist_ruzsa_II
2024-09-08 05:41:37.032 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: rho_of_sum
2024-09-08 05:41:37.032 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: multiDist_indep
2024-09-08 05:41:37.032 | INFO     | __main__:prove_sorry_theorems:794 - Skipping already encountered theorem: condMultiDist_eq
Processing theorems from teorth/pfr: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [00:00<00:00, 9125.02theorem/s]
2024-09-08 05:41:37.032 | INFO     | __main__:save_progress:736 - Saving encountered theorems...
2024-09-08 05:41:37.034 | INFO     | __main__:prove_sorry_theorems:832 - Finished attempting to prove sorry theorems
(pid=829295) [2024-09-08 05:41:45,786] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=829298) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defau
lt pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a
future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are
 explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub f
or any issues related to this experimental feature.
(ProverActor pid=829298)   return torch.load(io.BytesIO(b))
2024-09-08 05:42:10.426 | INFO     | __main__:main:1603 - Finished searching for proofs of sorry theorems
2024-09-08 05:42:10.426 | INFO     | __main__:main:1629 - current epoch: 2
2024-09-08 05:42:10.426 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 05:42:10.426 | INFO     | __main__:main:1300 - i: 2
2024-09-08 05:42:10.427 | INFO     | __main__:main:1631 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1301, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
(pid=829298) [2024-09-08 05:41:45,788] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect) [repeated 3x across cluster]
(ProverActor pid=829296) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defau
lt pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a
future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are
 explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub f
or any issues related to this experimental feature. [repeated 3x across cluster]
(ProverActor pid=829296)   return torch.load(io.BytesIO(b)) [repeated 3x across cluster]
[rank0]:[W908 05:42:16.754225697 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensur
e that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this
warning has only been added since PyTorch 2.4 (function operator())
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$
