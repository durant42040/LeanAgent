53 - Recall@25_val: 37.38095238095237
2024-08-10 11:25:45.092 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 37.38095238095237
2024-08-10 11:25:45.092 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 37.38095238095237
2024-08-10 11:25:45.093 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 37.38095238095237
2024-08-10 11:25:45.093 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 37.38095238095237
2024-08-10 11:25:45.094 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 38.09523809523809
5
2024-08-10 11:25:45.094 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 39.28571428571428
5
2024-08-10 11:25:45.095 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 39.28571428571428
5
2024-08-10 11:25:45.095 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 39.28571428571428
5
2024-08-10 11:25:45.096 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 41.78571428571428
5
2024-08-10 11:25:45.096 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 42.67857142857142
2024-08-10 11:25:45.097 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 42.67857142857142
2024-08-10 11:25:45.097 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 43.57142857142857
2024-08-10 11:25:45.098 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 43.57142857142857
2024-08-10 11:25:45.099 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 43.57142857142857
2024-08-10 11:25:45.099 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 45.95238095238094
2024-08-10 11:25:45.100 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 49.52380952380951
2024-08-10 11:25:45.100 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 49.52380952380951
2024-08-10 11:25:45.101 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 49.52380952380951
2024-08-10 11:25:45.101 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 49.52380952380951
2024-08-10 11:25:45.102 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 49.52380952380951
2024-08-10 11:25:45.102 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 49.52380952380951
2024-08-10 11:25:45.103 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 49.52380952380951
2024-08-10 11:25:45.103 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 49.52380952380951
2024-08-10 11:25:45.104 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 49.52380952380951
2024-08-10 11:25:45.104 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 53.09523809523809
2024-08-10 11:25:45.105 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 53.09523809523809
2024-08-10 11:25:45.105 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 53.09523809523809
2024-08-10 11:25:45.106 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 53.09523809523809
2024-08-10 11:25:45.107 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 57.85714285714284
2024-08-10 11:25:45.107 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 57.85714285714284
2024-08-10 11:25:45.108 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 57.85714285714284
2024-08-10 11:25:45.108 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 57.85714285714284
2024-08-10 11:25:45.109 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 58.57142857142856
2024-08-10 11:25:45.109 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 58.57142857142856
2024-08-10 11:25:45.110 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 58.57142857142856
2024-08-10 11:25:45.110 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 58.57142857142856
2024-08-10 11:25:45.111 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 63.03571428571428
5
2024-08-10 11:25:45.111 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 63.03571428571428
5
2024-08-10 11:25:45.112 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 63.03571428571428
5
2024-08-10 11:25:45.112 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 63.03571428571428
5
2024-08-10 11:25:45.113 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 63.03571428571428
5
2024-08-10 11:25:45.113 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 63.03571428571428
5
2024-08-10 11:25:45.114 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 66.60714285714285
2024-08-10 11:25:45.114 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 66.60714285714285
2024-08-10 11:25:45.115 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 66.60714285714285
2024-08-10 11:25:45.116 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 66.60714285714285
2024-08-10 11:25:45.116 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 66.60714285714285
2024-08-10 11:25:45.117 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 67.5
2024-08-10 11:25:45.117 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 67.5
2024-08-10 11:25:45.118 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 67.5
2024-08-10 11:25:45.118 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 67.5
2024-08-10 11:25:45.119 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 67.5
2024-08-10 11:25:45.119 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 68.69047619047619
2024-08-10 11:25:45.120 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 68.69047619047619
2024-08-10 11:25:45.120 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 68.69047619047619
2024-08-10 11:25:45.121 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 68.69047619047619
2024-08-10 11:25:45.121 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 68.69047619047619
2024-08-10 11:25:45.122 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 72.70833333333334
2024-08-10 11:25:45.122 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 72.70833333333334
2024-08-10 11:25:45.123 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 72.70833333333334
2024-08-10 11:25:45.123 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 72.70833333333334
2024-08-10 11:25:45.124 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 72.70833333333334
2024-08-10 11:25:45.125 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 72.70833333333334
2024-08-10 11:25:45.125 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 72.70833333333334
2024-08-10 11:25:45.126 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 72.70833333333334
2024-08-10 11:25:45.126 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 72.70833333333334
2024-08-10 11:25:45.127 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 72.70833333333334
2024-08-10 11:25:45.127 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 72.70833333333334
2024-08-10 11:25:45.128 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 72.70833333333334
2024-08-10 11:25:45.128 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 72.70833333333334
2024-08-10 11:25:45.129 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 72.70833333333334
2024-08-10 11:25:45.129 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 72.70833333333334
2024-08-10 11:25:45.130 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 72.70833333333334
2024-08-10 11:25:45.130 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 72.70833333333334
2024-08-10 11:25:45.131 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 72.7083333333333
4
2024-08-10 11:25:45.131 | INFO     | retrieval.model:validation_step:362 - MRR: 0.2697387736530384
2024-08-10 11:25:45.132 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        202
4-08-10 11:25:45.138 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:45.138 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:46.519 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 25.833333333333336
2024-08-10 11:25:46.521 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 37.083333333333336
2024-08-10 11:25:46.521 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 47.63888888888889
2024-08-10 11:25:46.522 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 64.30555555555556
2024-08-10 11:25:46.522 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 64.30555555555556
2024-08-10 11:25:46.523 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 65.69444444444444
2024-08-10 11:25:46.523 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 69.86111111111111
2024-08-10 11:25:46.524 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 69.86111111111111
2024-08-10 11:25:46.524 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 71.25
2024-08-10 11:25:46.525 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 72.08333333333333
2024-08-10 11:25:46.525 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 72.08333333333333
2024-08-10 11:25:46.526 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 76.25
2024-08-10 11:25:46.526 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 76.25
2024-08-10 11:25:46.527 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 76.25
2024-08-10 11:25:46.528 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 79.16666666666666
2024-08-10 11:25:46.528 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 79.16666666666666
2024-08-10 11:25:46.529 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 79.16666666666666
2024-08-10 11:25:46.529 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 81.25
2024-08-10 11:25:46.530 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 81.25
2024-08-10 11:25:46.530 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 81.25
2024-08-10 11:25:46.531 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 81.25
2024-08-10 11:25:46.531 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 81.25
2024-08-10 11:25:46.532 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 81.25
2024-08-10 11:25:46.532 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 81.25
2024-08-10 11:25:46.533 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 81.25
2024-08-10 11:25:46.533 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 81.25
2024-08-10 11:25:46.534 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 81.25
2024-08-10 11:25:46.534 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 81.25
2024-08-10 11:25:46.535 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 82.08333333333333
2024-08-10 11:25:46.536 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 82.08333333333333
2024-08-10 11:25:46.536 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 82.08333333333333
2024-08-10 11:25:46.537 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 82.08333333333333
2024-08-10 11:25:46.537 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 82.08333333333333
2024-08-10 11:25:46.538 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 82.08333333333333
2024-08-10 11:25:46.538 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 82.08333333333333
2024-08-10 11:25:46.539 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 82.08333333333333
2024-08-10 11:25:46.539 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 82.08333333333333
2024-08-10 11:25:46.540 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 82.08333333333333
2024-08-10 11:25:46.540 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 84.16666666666667
2024-08-10 11:25:46.541 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 84.16666666666667
2024-08-10 11:25:46.541 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 84.16666666666667
2024-08-10 11:25:46.542 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 84.16666666666667
2024-08-10 11:25:46.543 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 84.16666666666667
2024-08-10 11:25:46.543 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 88.33333333333333
2024-08-10 11:25:46.544 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 88.33333333333333
2024-08-10 11:25:46.544 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 88.33333333333333
2024-08-10 11:25:46.545 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 88.33333333333333
2024-08-10 11:25:46.545 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 88.33333333333333
2024-08-10 11:25:46.546 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 88.33333333333333
2024-08-10 11:25:46.546 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 88.33333333333333
2024-08-10 11:25:46.547 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 88.33333333333333
2024-08-10 11:25:46.547 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 88.33333333333333
2024-08-10 11:25:46.548 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 88.33333333333333
2024-08-10 11:25:46.548 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 88.33333333333333
2024-08-10 11:25:46.549 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 88.33333333333333
2024-08-10 11:25:46.549 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 88.33333333333333
2024-08-10 11:25:46.550 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 88.33333333333333
2024-08-10 11:25:46.551 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 88.33333333333333
2024-08-10 11:25:46.551 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 88.33333333333333
2024-08-10 11:25:46.552 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 88.33333333333333
2024-08-10 11:25:46.552 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 88.33333333333333
2024-08-10 11:25:46.553 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 88.33333333333333
2024-08-10 11:25:46.553 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 88.33333333333333
2024-08-10 11:25:46.554 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 88.33333333333333
2024-08-10 11:25:46.554 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 88.33333333333333
2024-08-10 11:25:46.555 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 88.33333333333333
2024-08-10 11:25:46.555 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 88.33333333333333
2024-08-10 11:25:46.556 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 88.33333333333333
2024-08-10 11:25:46.556 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 88.33333333333333
2024-08-10 11:25:46.557 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 88.33333333333333
2024-08-10 11:25:46.558 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 88.33333333333333
2024-08-10 11:25:46.558 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 88.33333333333333
2024-08-10 11:25:46.559 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 88.33333333333333
2024-08-10 11:25:46.559 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 88.33333333333333
2024-08-10 11:25:46.560 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 88.33333333333333
2024-08-10 11:25:46.560 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 88.33333333333333
2024-08-10 11:25:46.561 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 88.33333333333333
2024-08-10 11:25:46.561 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 88.33333333333333
2024-08-10 11:25:46.562 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 88.33333333333333
2024-08-10 11:25:46.562 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 88.33333333333333
2024-08-10 11:25:46.563 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 88.33333333333333
2024-08-10 11:25:46.563 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 88.33333333333333
2024-08-10 11:25:46.564 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 88.33333333333333
2024-08-10 11:25:46.565 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 88.33333333333333
2024-08-10 11:25:46.565 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 88.33333333333333
2024-08-10 11:25:46.566 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 88.33333333333333
2024-08-10 11:25:46.566 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 88.33333333333333
2024-08-10 11:25:46.567 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 88.33333333333333
2024-08-10 11:25:46.567 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 88.33333333333333
2024-08-10 11:25:46.568 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 88.33333333333333
2024-08-10 11:25:46.568 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 88.33333333333333
2024-08-10 11:25:46.569 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 88.33333333333333
2024-08-10 11:25:46.569 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 88.33333333333333
2024-08-10 11:25:46.570 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 88.33333333333333
2024-08-10 11:25:46.570 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 88.33333333333333
2024-08-10 11:25:46.571 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 88.33333333333333
2024-08-10 11:25:46.571 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 88.33333333333333
2024-08-10 11:25:46.572 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 88.33333333333333
2024-08-10 11:25:46.572 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 88.33333333333333
2024-08-10 11:25:46.573 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 88.3333333333333
3
2024-08-10 11:25:46.574 | INFO     | retrieval.model:validation_step:362 - MRR: 0.48537157287157284
2024-08-10 11:25:46.574 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        202
4-08-10 11:25:46.581 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:46.581 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:47.612 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 20.207570207570203
2024-08-10 11:25:47.613 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 27.35042735042735
2024-08-10 11:25:47.613 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 30.097680097680097
2024-08-10 11:25:47.614 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 31.68498168498169
2024-08-10 11:25:47.615 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 32.05128205128205
2024-08-10 11:25:47.615 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 32.05128205128205
2024-08-10 11:25:47.616 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 33.608058608058606
2024-08-10 11:25:47.616 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 43.498168498168496
2024-08-10 11:25:47.617 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 45.08547008547008
2024-08-10 11:25:47.617 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 47.83272283272283
2024-08-10 11:25:47.618 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 47.83272283272283
2024-08-10 11:25:47.618 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 50.21367521367522
2024-08-10 11:25:47.619 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 50.21367521367522
2024-08-10 11:25:47.619 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 52.16727716727716
2024-08-10 11:25:47.620 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 52.16727716727716
2024-08-10 11:25:47.621 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 53.75457875457875
2024-08-10 11:25:47.621 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 53.75457875457875
2024-08-10 11:25:47.622 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 53.75457875457875
2024-08-10 11:25:47.622 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 55.34188034188033
4
2024-08-10 11:25:47.623 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 55.34188034188033
4
2024-08-10 11:25:47.623 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 55.34188034188033
4
2024-08-10 11:25:47.624 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 60.1037851037851
2024-08-10 11:25:47.624 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 60.1037851037851
2024-08-10 11:25:47.625 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 60.1037851037851
2024-08-10 11:25:47.625 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 61.69108669108668
2024-08-10 11:25:47.626 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 61.69108669108668
2024-08-10 11:25:47.626 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 61.69108669108668
2024-08-10 11:25:47.627 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 61.69108669108668
2024-08-10 11:25:47.628 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 61.69108669108668
2024-08-10 11:25:47.628 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 61.69108669108668
2024-08-10 11:25:47.629 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 61.69108669108668
2024-08-10 11:25:47.629 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 61.69108669108668
2024-08-10 11:25:47.630 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 61.69108669108668
2024-08-10 11:25:47.630 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 61.69108669108668
2024-08-10 11:25:47.631 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 62.05738705738705
2024-08-10 11:25:47.631 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 62.05738705738705
2024-08-10 11:25:47.632 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 62.05738705738705
2024-08-10 11:25:47.632 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 64.43833943833943
2024-08-10 11:25:47.633 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 64.80463980463979
2024-08-10 11:25:47.633 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 65.995115995116
2024-08-10 11:25:47.634 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 65.995115995116
2024-08-10 11:25:47.634 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 65.995115995116
2024-08-10 11:25:47.635 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 65.995115995116
2024-08-10 11:25:47.636 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 65.995115995116
2024-08-10 11:25:47.636 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 65.995115995116
2024-08-10 11:25:47.637 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 65.995115995116
2024-08-10 11:25:47.637 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 66.36141636141636
2024-08-10 11:25:47.638 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 68.74236874236874
2024-08-10 11:25:47.638 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 68.74236874236874
2024-08-10 11:25:47.639 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 68.74236874236874
2024-08-10 11:25:47.639 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 68.74236874236874
2024-08-10 11:25:47.640 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 68.74236874236874
2024-08-10 11:25:47.640 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 68.74236874236874
2024-08-10 11:25:47.641 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 68.74236874236874
2024-08-10 11:25:47.641 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 68.74236874236874
2024-08-10 11:25:47.642 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 68.74236874236874
2024-08-10 11:25:47.642 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 68.74236874236874
2024-08-10 11:25:47.643 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 68.74236874236874
2024-08-10 11:25:47.643 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 68.74236874236874
2024-08-10 11:25:47.644 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 68.74236874236874
2024-08-10 11:25:47.645 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 68.74236874236874
2024-08-10 11:25:47.645 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 71.12332112332112
2024-08-10 11:25:47.646 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 71.12332112332112
2024-08-10 11:25:47.646 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 71.12332112332112
2024-08-10 11:25:47.647 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 71.12332112332112
2024-08-10 11:25:47.647 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 71.12332112332112
2024-08-10 11:25:47.648 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 71.12332112332112
2024-08-10 11:25:47.648 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 71.12332112332112
2024-08-10 11:25:47.649 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 71.12332112332112
2024-08-10 11:25:47.649 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 71.12332112332112
2024-08-10 11:25:47.650 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 71.12332112332112
2024-08-10 11:25:47.651 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 71.12332112332112
2024-08-10 11:25:47.651 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 71.12332112332112
2024-08-10 11:25:47.652 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 71.12332112332112
2024-08-10 11:25:47.652 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 71.12332112332112
2024-08-10 11:25:47.653 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 71.12332112332112
2024-08-10 11:25:47.653 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 71.48962148962148
2024-08-10 11:25:47.654 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 71.48962148962148
2024-08-10 11:25:47.654 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 71.48962148962148
2024-08-10 11:25:47.655 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 71.48962148962148
2024-08-10 11:25:47.655 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 71.48962148962148
2024-08-10 11:25:47.656 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 71.48962148962148
2024-08-10 11:25:47.656 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 71.48962148962148
2024-08-10 11:25:47.657 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 71.48962148962148
2024-08-10 11:25:47.658 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 71.48962148962148
2024-08-10 11:25:47.658 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 71.48962148962148
2024-08-10 11:25:47.659 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 71.48962148962148
2024-08-10 11:25:47.659 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 71.48962148962148
2024-08-10 11:25:47.660 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 71.48962148962148
2024-08-10 11:25:47.660 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 71.48962148962148
2024-08-10 11:25:47.661 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 71.48962148962148
2024-08-10 11:25:47.661 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 71.48962148962148
2024-08-10 11:25:47.662 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 71.48962148962148
2024-08-10 11:25:47.662 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 71.48962148962148
2024-08-10 11:25:47.663 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 71.48962148962148
2024-08-10 11:25:47.663 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 71.48962148962148
2024-08-10 11:25:47.664 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 71.48962148962148
2024-08-10 11:25:47.664 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 71.48962148962148
2024-08-10 11:25:47.665 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 73.07692307692308
2024-08-10 11:25:47.665 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 73.0769230769230
8
2024-08-10 11:25:47.666 | INFO     | retrieval.model:validation_step:362 - MRR: 0.4168527107812822
2024-08-10 11:25:47.667 | INFO     | retrieval.model:validation_step:370 - End of validation_step
Epoch 0: 100%|███████████████████████████████████████| 176750/176750 [11:58:03<00:00,  4.10it/s, v_num=1]Me
tric Recall@10_val improved. New best score: 46.043
Epoch 0, global step 176750: 'Recall@10_val' reached 46.04282 (best 46.04282), saving model to '/raid/adars
h/checkpoints_test/_epoch=0-Recall@10_val=46.04.ckpt' as top 1
`Trainer.fit` stopped: `max_epochs=1` reached.
Epoch 0: 100%|███████████████████████████████████████| 176750/176750 [11:58:11<00:00,  4.10it/s, v_num=1]
2024-08-10 11:26:35.800 | INFO     | __main__:train:547 - Finished progressive training
2024-08-10 11:26:35.800 | INFO     | __main__:train:551 - New best model saved at: /raid/adarsh/checkpoints
_test/_epoch=0-Recall@10_val=46.04.ckpt
2024-08-10 11:26:35.801 | INFO     | __main__:cleanup_old_checkpoint:447 - Removed old checkpoint: /home/ad
arsh/.cache/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912
f2d86f/model.ckpt
2024-08-10 11:26:35.801 | INFO     | __main__:train:556 - Removing merged dataset
2024-08-10 11:26:35.801 | INFO     | __main__:cleanup_merged_dataset:456 - Cleaning up merged dataset at /r
aid/adarsh/datasets_test/merged
2024-08-10 11:26:35.868 | INFO     | __main__:cleanup_merged_dataset:458 - Merged dataset deleted successfu
lly
2024-08-10 11:26:35.868 | INFO     | __main__:train:558 - Finished removing merged dataset
2024-08-10 11:26:35.868 | INFO     | __main__:train:560 - Converting and uploading models
2024-08-10 11:26:35.868 | INFO     | __main__:convert_and_upload_models:405 - Best model path: /raid/adarsh
/checkpoints_test/_epoch=0-Recall@10_val=46.04.ckpt
2024-08-10 11:26:35.868 | INFO     | __main__:convert_and_upload_models:407 - Converting best model to Hugg
ingFace format
^C[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 651, in <module>
[rank0]:     main()
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 641, in main
[rank0]:     train(model_checkpoint_path, merged_data_path, next_suffix)
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 561, in train
[rank0]:     convert_and_upload_models(best_model_path, new_data_path, next_suffix)
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 409, in convert_and_upload_models
[rank0]:     convert_to_hf(best_model_path, hf_path)
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 332, in convert_to_hf
[rank0]:     model = PremiseRetriever.load(best_model_path, device, freeze=True, config=config)
[rank0]:   File "/home/adarsh/ReProver/retrieval/model.py", line 113, in load
[rank0]:     return load_checkpoint(cls, ckpt_path, device, freeze, config)
[rank0]:   File "/home/adarsh/ReProver/common.py", line 469, in load_checkpoint
[rank0]:     model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_li
ghtning/utilities/model_helpers.py", line 125, in wrapper
[rank0]:     return self.method(cls, *args, **kwargs)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_li
ghtning/core/module.py", line 1582, in load_from_checkpoint
[rank0]:     loaded = _load_from_checkpoint(
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_li
ghtning/core/saving.py", line 99, in _load_from_checkpoint
[rank0]:     return model.to(device)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/lightning_
fabric/utilities/device_dtype_mixin.py", line 55, in to
[rank0]:     return super().to(*args, **kwargs)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn/m
odules/module.py", line 1174, in to
[rank0]:     return self._apply(convert)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn/m
odules/module.py", line 780, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn/m
odules/module.py", line 780, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn/m
odules/module.py", line 780, in _apply
[rank0]:     module._apply(fn)
[rank0]:   [Previous line repeated 5 more times]
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn/m
odules/module.py", line 805, in _apply
[rank0]:     param_applied = fn(param)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn/m
odules/module.py", line 1160, in convert
[rank0]:     return t.to(
[rank0]: KeyboardInterrupt
^C
^C

^Z
[3]+  Stopped                 bash run_compute_server.sh
(base) adarsh@tensorlab-DGX-Station-A100-920-23487-2531-000:~/ReProver$ bash run_compute_server.sh
Script executed from: /home/adarsh/ReProver
[2024-08-10 11:28:48,468] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (
auto detect)
 [WARNING]  async_io requires the dev libaio .so object and headers but these were not found.
 [WARNING]  async_io: please install the libaio-dev package with apt
 [WARNING]  If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS enviro
nment variables to where it can be found.
 [WARNING]  Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
 [WARNING]  sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.4
 [WARNING]  using untested triton version (3.0.0), only 1.0.0 is known to be compatible
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/deepspeed/runtime/zero/line
ar.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_f
wd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/deepspeed/runtime/zero/line
ar.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_b
wd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
2024-08-10 11:28:54.786 | INFO     | __main__:check_progress_file:586 - Checking contents of /home/adarsh/m
iniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_lightning/loops/progress.py
2024-08-10 11:28:54.787 | INFO     | __main__:check_progress_file:590 - Contents of progress.py:
2024-08-10 11:28:54.787 | INFO     | __main__:check_progress_file:591 - # Copyright The Lightning AI team.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
from dataclasses import asdict, dataclass, field
from typing import Type

from typing_extensions import override


@dataclass
class _BaseProgress:
    """Mixin that implements state-loading utilities for dataclasses."""

    def state_dict(self) -> dict:
        return asdict(self)

    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["completed"] == None:
            state_dict["completed"] = 0
        self.__dict__.update(state_dict)

    @classmethod
    def from_state_dict(cls, state_dict: dict) -> "_BaseProgress":
        obj = cls()
        obj.load_state_dict(state_dict)
        return obj

    def reset(self) -> None:
        """Reset the object's state."""
        raise NotImplementedError


@dataclass
class _ReadyCompletedTracker(_BaseProgress):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` last.

    """

    ready: int = 0
    completed: int = 0

    @override
    def reset(self) -> None:
        """Reset the state."""
        self.ready = 0
        self.completed = 0

    def reset_on_restart(self) -> None:
        """Reset the progress on restart.

        If there is a failure before all attributes are increased, restore the attributes to the last fully
 completed
        value.

        """
        self.ready = self.completed


@dataclass
class _StartedTracker(_ReadyCompletedTracker):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        started: Intended to be incremented after the event is started (e.g. after ``on_*_start`` runs).
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` last.

    """

    started: int = 0

    @override
    def reset(self) -> None:
        super().reset()
        self.started = 0

    @override
    def reset_on_restart(self) -> None:
        super().reset_on_restart()
        self.started = self.completed


@dataclass
class _ProcessedTracker(_StartedTracker):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        started: Intended to be incremented after the event is started (e.g. after ``on_*_start`` runs).
        processed: Intended to be incremented after the event is processed.
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` last.

    """

    processed: int = 0

    @override
    def reset(self) -> None:
        super().reset()
        self.processed = 0

    @override
    def reset_on_restart(self) -> None:
        super().reset_on_restart()
        self.processed = self.completed


@dataclass
class _Progress(_BaseProgress):
    """Track aggregated and current progress.

    Args:
        total: Intended to track the total progress of an event.
        current: Intended to track the current progress of an event.

    """

    total: _ReadyCompletedTracker = field(default_factory=_ProcessedTracker)
    current: _ReadyCompletedTracker = field(default_factory=_ProcessedTracker)

    def __post_init__(self) -> None:
        if self.total.__class__ is not self.current.__class__:
            raise ValueError("The `total` and `current` instances should be of the same class")

    def increment_ready(self) -> None:
        self.total.ready += 1
        self.current.ready += 1

    def increment_started(self) -> None:
        if not isinstance(self.total, _StartedTracker):
            raise TypeError(f"`{self.total.__class__.__name__}` doesn't have a `started` attribute")
        self.total.started += 1
        self.current.started += 1

    def increment_processed(self) -> None:
        if not isinstance(self.total, _ProcessedTracker):
            raise TypeError(f"`{self.total.__class__.__name__}` doesn't have a `processed` attribute")
        self.total.processed += 1
        self.current.processed += 1

    def increment_completed(self) -> None:
        self.total.completed += 1
        self.current.completed += 1

    @classmethod
    def from_defaults(cls, tracker_cls: Type[_ReadyCompletedTracker], **kwargs: int) -> "_Progress":
        """Utility function to easily create an instance from keyword arguments to both ``Tracker``s."""
        return cls(total=tracker_cls(**kwargs), current=tracker_cls(**kwargs))

    @override
    def reset(self) -> None:
        self.total.reset()
        self.current.reset()

    def reset_on_run(self) -> None:
        self.current.reset()

    def reset_on_restart(self) -> None:
        self.current.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["total"]["completed"] == None:
            state_dict["total"]["completed"] = 0
        self.total.load_state_dict(state_dict["total"])
        self.current.load_state_dict(state_dict["current"])


@dataclass
class _BatchProgress(_Progress):
    """Tracks batch progress.

    These counters are local to a trainer rank. By default, they are not globally synced across all ranks.

    Args:
        total: Tracks the total batch progress.
        current: Tracks the current batch progress.
        is_last_batch: Whether the batch is the last one. This is useful for iterable datasets.

    """

    is_last_batch: bool = False

    @override
    def reset(self) -> None:
        super().reset()
        self.is_last_batch = False

    @override
    def reset_on_run(self) -> None:
        super().reset_on_run()
        self.is_last_batch = False

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["total"]["completed"] == None:
            state_dict["total"]["completed"] = 0
        super().load_state_dict(state_dict)
        self.is_last_batch = state_dict["is_last_batch"]


@dataclass
class _SchedulerProgress(_Progress):
    """Tracks scheduler progress.

    These counters are local to a trainer rank. By default, they are not globally synced across all ranks.

    Args:
        total: Tracks the total scheduler progress.
        current: Tracks the current scheduler progress.

    """

    total: _ReadyCompletedTracker = field(default_factory=_ReadyCompletedTracker)
    current: _ReadyCompletedTracker = field(default_factory=_ReadyCompletedTracker)


@dataclass
class _OptimizerProgress(_BaseProgress):
    """Track optimizer progress.

    Args:
        step: Tracks ``optimizer.step`` calls.
        zero_grad: Tracks ``optimizer.zero_grad`` calls.

    """

    step: _Progress = field(default_factory=lambda: _Progress.from_defaults(_ReadyCompletedTracker))
    zero_grad: _Progress = field(default_factory=lambda: _Progress.from_defaults(_StartedTracker))

    @override
    def reset(self) -> None:
        self.step.reset()
        self.zero_grad.reset()

    def reset_on_run(self) -> None:
        self.step.reset_on_run()
        self.zero_grad.reset_on_run()

    def reset_on_restart(self) -> None:
        self.step.reset_on_restart()
        self.zero_grad.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["step"]["total"]["completed"] == None:
            state_dict["step"]["total"]["completed"] = 0
        self.step.load_state_dict(state_dict["step"])
        self.zero_grad.load_state_dict(state_dict["zero_grad"])


@dataclass
class _OptimizationProgress(_BaseProgress):
    """Track optimization progress.

    Args:
        optimizer: Tracks optimizer progress.

    """

    optimizer: _OptimizerProgress = field(default_factory=_OptimizerProgress)

    @property
    def optimizer_steps(self) -> int:
        return self.optimizer.step.total.completed

    @override
    def reset(self) -> None:
        self.optimizer.reset()

    def reset_on_run(self) -> None:
        self.optimizer.reset_on_run()

    def reset_on_restart(self) -> None:
        self.optimizer.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["optimizer"]["step"]["total"]["completed"] == None:
            state_dict["optimizer"]["step"]["total"]["completed"] = 0
        self.optimizer.load_state_dict(state_dict["optimizer"])

2024-08-10 11:28:54.787 | INFO     | __main__:main:608 - Starting compute server...
2024-08-10 11:28:54.787 | INFO     | __main__:main:609 - Current working directory: /home/adarsh/ReProver
2024-08-10 11:28:54.787 | INFO     | __main__:main:613 - ROOT_DIR: /raid/adarsh
2024-08-10 11:28:54.787 | INFO     | __main__:main:614 - DATA_DIR: datasets_test
2024-08-10 11:28:54.787 | INFO     | __main__:main:618 - Configuring LeanDojo...
2024-08-10 11:28:54.790 | INFO     | generate_benchmark_lean4:configure_leandojo:294 - Current working dire
ctory: /home/adarsh/ReProver
2024-08-10 11:28:54.790 | INFO     | __main__:main:620 - LeanDojo configured
2024-08-10 11:28:54.791 | INFO     | __main__:main:628 - Unique URLs: {'https://github.com/teorth/pfr.git'}
2024-08-10 11:28:54.791 | INFO     | __main__:main:629 - About to generate datasets...
2024-08-10 11:28:54.791 | INFO     | __main__:generate_dataset:226 - Generating 1 datasets
2024-08-10 11:28:54.791 | INFO     | __main__:generate_dataset:231 - Processing https://github.com/teorth/p
fr.git
2024-08-10 11:28:55.010 | INFO     | __main__:get_compatible_commit:166 - Latest commit: 6a5082ee465f9e44ce
a479c7b741b3163162bb7e
2024-08-10 11:28:55.011 | INFO     | __main__:get_compatible_commit:169 - Creating LeanGitRepo for https://
github.com/teorth/pfr
2024-08-10 11:28:55.425 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.8.0-rc1
2024-08-10 11:28:56.005 | INFO     | __main__:get_compatible_commit:171 - Getting config for https://github
.com/teorth/pfr.git
2024-08-10 11:28:56.005 | INFO     | __main__:get_compatible_commit:175 - Latest commit compatible for url
https://github.com/teorth/pfr.git
2024-08-10 11:28:56.005 | INFO     | __main__:generate_dataset:236 - Found compatible commit 6a5082ee465f9e
44cea479c7b741b3163162bb7e for https://github.com/teorth/pfr.git
2024-08-10 11:28:56.005 | INFO     | __main__:generate_dataset:237 - Lean version: v4.8.0-rc1
2024-08-10 11:28:56.005 | INFO     | __main__:generate_dataset:240 - Creating LeanGitRepo for https://githu
b.com/teorth/pfr
2024-08-10 11:28:56.006 | INFO     | __main__:generate_dataset:244 - Generating benchmark at /raid/adarsh/d
atasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:301 - Generating dataset to go into /rai
d/adarsh/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:308 - lean toolchain version: {'content'
: 'leanprover/lean4:v4.8.0-rc1\n'}
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:310 - lean version v: v4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:311 - is supported: True
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:321 - lean path1 /home/adarsh/.elan/tool
chains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:322 - lean path2 /.elan/toolchains/leanp
rover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:323 - lean path3 ~/.elan/toolchains/lean
prover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:327 - Lean toolchain path 2 does not exi
st: /.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:329 - Lean toolchain path 3 does not exi
st: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:332 - Switched to Lean toolchain at: /ho
me/adarsh/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.039 | INFO     | generate_benchmark_lean4:main:334 - lean --version: Lean (version 4.8.
0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-08-10 11:28:56.040 | INFO     | generate_benchmark_lean4:main:335 - repo: LeanGitRepo(url='https://git
hub.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162bb7e')
2024-08-10 11:28:56.040 | INFO     | generate_benchmark_lean4:main:337 - Configuring LeanDojo again...
2024-08-10 11:28:56.043 | INFO     | generate_benchmark_lean4:configure_leandojo:294 - Current working dire
ctory: /home/adarsh/ReProver
2024-08-10 11:28:56.043 | INFO     | generate_benchmark_lean4:main:339 - LeanDojo configured
2024-08-10 11:28:56.043 | INFO     | generate_benchmark_lean4:main:342 - Tracing the repo...
2024-08-10 11:28:56.043 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:217 - The traced
repo is available in the cache.
2024-08-10 11:28:56.043 | INFO     | lean_dojo.data_extraction.trace:trace:246 - Loading the traced repo fr
om /raid/adarsh/.cache/lean_dojo/teorth-pfr-6a5082ee465f9e44cea479c7b741b3163162bb7e/pfr
2024-08-10 11:28:56.046 | DEBUG    | lean_dojo.utils:execute:110 - git remote get-url origin
2024-08-10 11:28:56.049 | DEBUG    | lean_dojo.utils:execute:110 - git log -n 1
2024-08-10 11:28:56.240 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1169 - Loading 28
90 traced XML files from /raid/adarsh/.cache/lean_dojo/teorth-pfr-6a5082ee465f9e44cea479c7b741b3163162bb7e/
pfr with 31 workers
2024-08-10 11:28:57,561 INFO worker.py:1772 -- Started a local Ray instance. View the dashboard at 127.0.0.
1:8267
  4%|██▊                                                              | 123/2890 [00:06<01:19, 35.01it/s](r
aylet) [2024-08-10 11:29:07,455 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648814080; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 13%|████████▌                                                        | 380/2890 [00:15<00:50, 49.60it/s](r
aylet) [2024-08-10 11:29:17,463 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648764928; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 20%|█████████████                                                    | 582/2890 [00:23<00:40, 56.33it/s](r
aylet) [2024-08-10 11:29:27,469 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648736256; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 31%|████████████████████                                             | 891/2890 [00:36<00:28, 69.42it/s](r
aylet) [2024-08-10 11:29:37,476 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648625664; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 34%|██████████████████████▍                                          | 997/2890 [00:45<00:45, 41.38it/s](r
aylet) [2024-08-10 11:29:47,480 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648609280; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 38%|████████████████████████                                        | 1089/2890 [01:07<22:27,  1.34it/s](r
aylet) [2024-08-10 11:30:07,491 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93647622144; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 2x across cluster] (Ray deduplicates logs by de
fault. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observab
ility/user-guides/configure-logging.html#log-deduplication for more options.)
 42%|██████████████████████████▋                                     | 1203/2890 [01:23<00:42, 39.26it/s](r
aylet) [2024-08-10 11:30:17,496 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93647593472; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 46%|█████████████████████████████▋                                  | 1338/2890 [01:43<00:36, 42.83it/s](r
aylet) [2024-08-10 11:30:27,502 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93647556608; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 51%|████████████████████████████████▍                               | 1463/2890 [01:56<02:59,  7.96it/s](r
aylet) [2024-08-10 11:30:57,556 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93644828672; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 3x across cluster]
 54%|█████████████████████████████████▍                            | 1559/2890 [03:10<2:50:35,  7.69s/it](r
aylet) [2024-08-10 11:31:07,573 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93643739136; capacity: 1887507697664. O
bject creation will fail if spilling is required.
(raylet) [2024-08-10 11:31:17,589 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_
2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93643730944; capacity: 1887507697664.
 Object creation will fail if spilling is required.
 56%|███████████████████████████████████▉                            | 1625/2890 [03:16<02:32,  8.30it/s](r
aylet) [2024-08-10 11:32:17,795 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93642104832; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 6x across cluster]
 58%|█████████████████████████████████████▍                          | 1690/2890 [03:26<02:42,  7.38it/s](r
aylet) [2024-08-10 11:32:27,818 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93642076160; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 60%|█████████████████████████████████████▎                        | 1741/2890 [04:09<1:44:02,  5.43s/it](r
aylet) [2024-08-10 11:32:37,853 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93642047488; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 71%|█████████████████████████████████████████████▍                  | 2052/2890 [04:46<26:23,  1.89s/it](r
aylet) [2024-08-10 11:33:17,969 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93639749632; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 4x across cluster]
 80%|███████████████████████████████████████████████████             | 2307/2890 [05:31<23:26,  2.41s/it](r
aylet) [2024-08-10 11:33:57,989 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93639602176; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 4x across cluster]
 85%|██████████████████████████████████████████████████████▎         | 2450/2890 [05:37<00:11, 39.26it/s](r
aylet) [2024-08-10 11:34:38,028 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93638209536; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 4x across cluster]
 89%|████████████████████████████████████████████████████████▊       | 2567/2890 [06:27<16:18,  3.03s/it](r
aylet) [2024-08-10 11:34:48,034 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93638189056; capacity: 1887507697664. O
bject creation will fail if spilling is required.
(raylet) [2024-08-10 11:34:58,040 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_
2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93638135808; capacity: 1887507697664.
 Object creation will fail if spilling is required.
100%|████████████████████████████████████████████████████████████████| 2890/2890 [06:31<00:00,  7.38it/s]
(raylet) [2024-08-10 11:35:28,057 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/session_
2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93637283840; capacity: 1887507697664.
 Object creation will fail if spilling is required. [repeated 3x across cluster]
2024-08-10 11:35:34.043 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162b
b7e')
2024-08-10 11:35:35.488 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.6.0-rc1
2024-08-10 11:35:37.749 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.7.0
2024-08-10 11:35:38.710 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-10 11:35:39.833 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-10 11:35:43.077 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.10.0
2024-08-10 11:35:44.255 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for doc-gen4 main
2024-08-10 11:35:44.880 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.11.0-rc1
2024-08-10 11:35:45.552 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/YaelDillies/LeanAPAP', commit='f47447e44d8e82ab214ed8c1b19
9329141fc5b1f')
2024-08-10 11:35:46.263 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.9.0-rc1
2024-08-10 11:35:47.307 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.10.0-rc1
2024-08-10 11:35:48.036 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.9.0
2024-08-10 11:35:49.648 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/mathlib4.git") failed. Retrying...
2024-08-10 11:35:50.777 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/mathlib4.git") failed. Retrying...
2024-08-10 11:35:53.981 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='ac1484f2267e5d4757
bcc02e57c0d84d0cfee51e')
2024-08-10 11:35:55.182 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='6d8e3118ab526f8dfcabcbdf9f05
dc34e5c423a8')
2024-08-10 11:35:56.199 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.10.0-rc2
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-08-10 11:35:58.040 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 nightly-2024-06-05
2024-08-10 11:35:59.291 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for md4lean main
2024-08-10 11:35:59.494 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for BibtexQuery master
2024-08-10 11:35:59.910 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4-unicode-basic main
2024-08-10 11:36:00.571 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4-cli nightly
2024-08-10 11:36:00.814 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 nightly-2024-06-05
2024-08-10 11:36:02.093 | INFO     | generate_benchmark_lean4:main:346 - Failed to trace repo LeanGitRepo(u
rl='https://github.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162bb7e') because of Invalid t
ag or branch: `nightly-2024-06-05` for Repository(full_name="leanprover/lean4")
2024-08-10 11:36:12.414 | INFO     | __main__:generate_dataset:246 - Finished generating benchmark at /raid
/adarsh/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 11:36:12.418 | INFO     | __main__:generate_dataset:247 - Merging datasets
2024-08-10 11:36:12.418 | INFO     | __main__:merge_datasets:74 - Merging datasets for random
2024-08-10 11:36:12.418 | INFO     | __main__:merge_datasets:80 - Processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing val split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing val split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing test split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing test split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:105 - Finished merging datasets for random
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:74 - Merging datasets for novel_premises
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing val split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:104 - Finished processing val split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:80 - Processing test split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:104 - Finished processing test split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:105 - Finished merging datasets for novel_prem
ises
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:107 - Merging corpus
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:130 - Finished merging corpus
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:132 - Adding metadata
2024-08-10 11:36:12.420 | WARNING  | __main__:merge_datasets:152 - No metadata file found
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:154 - Deleting individual datasets
2024-08-10 11:36:12.420 | INFO     | __main__:generate_dataset:249 - Finished merging datasets
2024-08-10 11:36:12.514 | INFO     | __main__:main:635 - Latest PL checkpoint found: AK123321/pl-leancopilo
t-2
2024-08-10 11:36:12.662 | INFO     | __main__:download_pl_checkpoint:274 - Checkpoint downloaded to: /home/
adarsh/.cache/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d039
12f2d86f/model.ckpt
2024-08-10 11:36:12.662 | INFO     | __main__:main:638 - Checkpoint path: /home/adarsh/.cache/huggingface/h
ub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.ckpt
2024-08-10 11:36:12.662 | INFO     | __main__:train:464 - Training model with checkpoint: /home/adarsh/.cac
he/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/mo
del.ckpt
Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your
 files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../.cache/huggingface/hub
/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.ckpt`
2024-08-10 11:36:25.012 | INFO     | __main__:train:486 - Loaded premise retriever at /home/adarsh/.cache/h
uggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.
ckpt
2024-08-10 11:36:25.012 | INFO     | __main__:train:490 - Data path: /raid/adarsh/datasets_test/merged/rand
om
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/transformers/tokenization_u
tils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by d
efault. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default.
For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-08-10 11:36:25.118 | INFO     | common:__init__:199 - Building the corpus from /raid/adarsh/datasets_t
est/merged/corpus.jsonl
2024-08-10 11:36:25.120 | INFO     | __main__:main:647 - An error occurred: [Errno 2] No such file or direc
tory: '/raid/adarsh/datasets_test/merged/random/../metadata.json'
Traceback (most recent call last):
  File "/home/adarsh/ReProver/compute_server.py", line 641, in main
    train(model_checkpoint_path, merged_data_path, next_suffix)
  File "/home/adarsh/ReProver/compute_server.py", line 491, in train
    data_module = RetrievalDataModule(
  File "/home/adarsh/ReProver/retrieval/datamodule.py", line 246, in __init__
    metadata = json.load(open(os.path.join(data_path, "../metadata.json")))
FileNotFoundError: [Errno 2] No such file or directory: '/raid/adarsh/datasets_test/merged/random/../metada
ta.json'
(base) adarsh@tensorlab-DGX-Station-A100-920-23487-2531-000:~/ReProver$ bash run_compute_server.sh
Script executed from: /home/adarsh/ReProver
[2024-08-10 12:14:19,706] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (
auto detect)
 [WARNING]  async_io requires the dev libaio .so object and headers but these were not found.
 [WARNING]  async_io: please install the libaio-dev package with apt
 [WARNING]  If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS enviro
nment variables to where it can be found.
 [WARNING]  Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
 [WARNING]  sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.4
 [WARNING]  using untested triton version (3.0.0), only 1.0.0 is known to be compatible
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/deepspeed/runtime/zero/line
ar.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_f
wd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/deepspeed/runtime/zero/line
ar.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_b
wd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
2024-08-10 12:14:26.545 | INFO     | __main__:check_progress_file:586 - Checking contents of /home/adarsh/m
iniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_lightning/loops/progress.py
2024-08-10 12:14:26.545 | INFO     | __main__:check_progress_file:590 - Contents of progress.py:
2024-08-10 12:14:26.545 | INFO     | __main__:check_progress_file:591 - # Copyright The Lightning AI team.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
from dataclasses import asdict, dataclass, field
from typing import Type

from typing_extensions import override


@dataclass
class _BaseProgress:
    """Mixin that implements state-loading utilities for dataclasses."""

    def state_dict(self) -> dict:
        return asdict(self)

    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["completed"] == None:
            state_dict["completed"] = 0
        self.__dict__.update(state_dict)

    @classmethod
    def from_state_dict(cls, state_dict: dict) -> "_BaseProgress":
        obj = cls()
        obj.load_state_dict(state_dict)
        return obj

    def reset(self) -> None:
        """Reset the object's state."""
        raise NotImplementedError


@dataclass
class _ReadyCompletedTracker(_BaseProgress):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` last.

    """

    ready: int = 0
    completed: int = 0

    @override
    def reset(self) -> None:
        """Reset the state."""
        self.ready = 0
        self.completed = 0

    def reset_on_restart(self) -> None:
        """Reset the progress on restart.

        If there is a failure before all attributes are increased, restore the attributes to the last fully
 completed
        value.

        """
        self.ready = self.completed


@dataclass
class _StartedTracker(_ReadyCompletedTracker):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        started: Intended to be incremented after the event is started (e.g. after ``on_*_start`` runs).
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` last.

    """

    started: int = 0

    @override
    def reset(self) -> None:
        super().reset()
        self.started = 0

    @override
    def reset_on_restart(self) -> None:
        super().reset_on_restart()
        self.started = self.completed


@dataclass
class _ProcessedTracker(_StartedTracker):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        started: Intended to be incremented after the event is started (e.g. after ``on_*_start`` runs).
        processed: Intended to be incremented after the event is processed.
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` last.

    """

    processed: int = 0

    @override
    def reset(self) -> None:
        super().reset()
        self.processed = 0

    @override
    def reset_on_restart(self) -> None:
        super().reset_on_restart()
        self.processed = self.completed


@dataclass
class _Progress(_BaseProgress):
    """Track aggregated and current progress.

    Args:
        total: Intended to track the total progress of an event.
        current: Intended to track the current progress of an event.

    """

    total: _ReadyCompletedTracker = field(default_factory=_ProcessedTracker)
    current: _ReadyCompletedTracker = field(default_factory=_ProcessedTracker)

    def __post_init__(self) -> None:
        if self.total.__class__ is not self.current.__class__:
            raise ValueError("The `total` and `current` instances should be of the same class")

    def increment_ready(self) -> None:
        self.total.ready += 1
        self.current.ready += 1

    def increment_started(self) -> None:
        if not isinstance(self.total, _StartedTracker):
            raise TypeError(f"`{self.total.__class__.__name__}` doesn't have a `started` attribute")
        self.total.started += 1
        self.current.started += 1

    def increment_processed(self) -> None:
        if not isinstance(self.total, _ProcessedTracker):
            raise TypeError(f"`{self.total.__class__.__name__}` doesn't have a `processed` attribute")
        self.total.processed += 1
        self.current.processed += 1

    def increment_completed(self) -> None:
        self.total.completed += 1
        self.current.completed += 1

    @classmethod
    def from_defaults(cls, tracker_cls: Type[_ReadyCompletedTracker], **kwargs: int) -> "_Progress":
        """Utility function to easily create an instance from keyword arguments to both ``Tracker``s."""
        return cls(total=tracker_cls(**kwargs), current=tracker_cls(**kwargs))

    @override
    def reset(self) -> None:
        self.total.reset()
        self.current.reset()

    def reset_on_run(self) -> None:
        self.current.reset()

    def reset_on_restart(self) -> None:
        self.current.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["total"]["completed"] == None:
            state_dict["total"]["completed"] = 0
        self.total.load_state_dict(state_dict["total"])
        self.current.load_state_dict(state_dict["current"])


@dataclass
class _BatchProgress(_Progress):
    """Tracks batch progress.

    These counters are local to a trainer rank. By default, they are not globally synced across all ranks.

    Args:
        total: Tracks the total batch progress.
        current: Tracks the current batch progress.
        is_last_batch: Whether the batch is the last one. This is useful for iterable datasets.

    """

    is_last_batch: bool = False

    @override
    def reset(self) -> None:
        super().reset()
        self.is_last_batch = False

    @override
    def reset_on_run(self) -> None:
        super().reset_on_run()
        self.is_last_batch = False

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["total"]["completed"] == None:
            state_dict["total"]["completed"] = 0
        super().load_state_dict(state_dict)
        self.is_last_batch = state_dict["is_last_batch"]


@dataclass
class _SchedulerProgress(_Progress):
    """Tracks scheduler progress.

    These counters are local to a trainer rank. By default, they are not globally synced across all ranks.

    Args:
        total: Tracks the total scheduler progress.
        current: Tracks the current scheduler progress.

    """

    total: _ReadyCompletedTracker = field(default_factory=_ReadyCompletedTracker)
    current: _ReadyCompletedTracker = field(default_factory=_ReadyCompletedTracker)


@dataclass
class _OptimizerProgress(_BaseProgress):
    """Track optimizer progress.

    Args:
        step: Tracks ``optimizer.step`` calls.
        zero_grad: Tracks ``optimizer.zero_grad`` calls.

    """

    step: _Progress = field(default_factory=lambda: _Progress.from_defaults(_ReadyCompletedTracker))
    zero_grad: _Progress = field(default_factory=lambda: _Progress.from_defaults(_StartedTracker))

    @override
    def reset(self) -> None:
        self.step.reset()
        self.zero_grad.reset()

    def reset_on_run(self) -> None:
        self.step.reset_on_run()
        self.zero_grad.reset_on_run()

    def reset_on_restart(self) -> None:
        self.step.reset_on_restart()
        self.zero_grad.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["step"]["total"]["completed"] == None:
            state_dict["step"]["total"]["completed"] = 0
        self.step.load_state_dict(state_dict["step"])
        self.zero_grad.load_state_dict(state_dict["zero_grad"])


@dataclass
class _OptimizationProgress(_BaseProgress):
    """Track optimization progress.

    Args:
        optimizer: Tracks optimizer progress.

    """

    optimizer: _OptimizerProgress = field(default_factory=_OptimizerProgress)

    @property
    def optimizer_steps(self) -> int:
        return self.optimizer.step.total.completed

    @override
    def reset(self) -> None:
        self.optimizer.reset()

    def reset_on_run(self) -> None:
        self.optimizer.reset_on_run()

    def reset_on_restart(self) -> None:
        self.optimizer.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["optimizer"]["step"]["total"]["completed"] == None:
            state_dict["optimizer"]["step"]["total"]["completed"] = 0
        self.optimizer.load_state_dict(state_dict["optimizer"])

2024-08-10 12:14:26.545 | INFO     | __main__:main:608 - Starting compute server...
2024-08-10 12:14:26.545 | INFO     | __main__:main:609 - Current working directory: /home/adarsh/ReProver
2024-08-10 12:14:26.546 | INFO     | __main__:main:613 - ROOT_DIR: /raid/adarsh
2024-08-10 12:14:26.546 | INFO     | __main__:main:614 - DATA_DIR: datasets_test
2024-08-10 12:14:26.546 | INFO     | __main__:main:618 - Configuring LeanDojo...
2024-08-10 12:14:26.549 | INFO     | generate_benchmark_lean4:configure_leandojo:294 - Current working dire
ctory: /home/adarsh/ReProver
2024-08-10 12:14:26.549 | INFO     | __main__:main:620 - LeanDojo configured
2024-08-10 12:14:26.549 | INFO     | __main__:main:628 - Unique URLs: {'https://github.com/teorth/pfr.git'}
2024-08-10 12:14:26.549 | INFO     | __main__:main:629 - About to generate datasets...
2024-08-10 12:14:26.549 | INFO     | __main__:generate_dataset:226 - Generating 1 datasets
2024-08-10 12:14:26.549 | INFO     | __main__:generate_dataset:231 - Processing https://github.com/teorth/p
fr.git
2024-08-10 12:14:26.774 | INFO     | __main__:get_compatible_commit:166 - Latest commit: 6a5082ee465f9e44ce
a479c7b741b3163162bb7e
2024-08-10 12:14:26.774 | INFO     | __main__:get_compatible_commit:169 - Creating LeanGitRepo for https://
github.com/teorth/pfr
2024-08-10 12:14:27.139 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.8.0-rc1
2024-08-10 12:14:27.771 | INFO     | __main__:get_compatible_commit:171 - Getting config for https://github
.com/teorth/pfr.git
2024-08-10 12:14:27.771 | INFO     | __main__:get_compatible_commit:175 - Latest commit compatible for url
https://github.com/teorth/pfr.git
2024-08-10 12:14:27.771 | INFO     | __main__:generate_dataset:236 - Found compatible commit 6a5082ee465f9e
44cea479c7b741b3163162bb7e for https://github.com/teorth/pfr.git
2024-08-10 12:14:27.771 | INFO     | __main__:generate_dataset:237 - Lean version: v4.8.0-rc1
2024-08-10 12:14:27.772 | INFO     | __main__:generate_dataset:240 - Creating LeanGitRepo for https://githu
b.com/teorth/pfr
2024-08-10 12:14:27.772 | INFO     | __main__:generate_dataset:244 - Generating benchmark at /raid/adarsh/d
atasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:301 - Generating dataset to go into /rai
d/adarsh/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:308 - lean toolchain version: {'content'
: 'leanprover/lean4:v4.8.0-rc1\n'}
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:310 - lean version v: v4.8.0-rc1
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:311 - is supported: True
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:321 - lean path1 /home/adarsh/.elan/tool
chains/leanprover--lean4---4.8.0-rc1
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:322 - lean path2 /.elan/toolchains/leanp
rover--lean4---4.8.0-rc1
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:323 - lean path3 ~/.elan/toolchains/lean
prover--lean4---4.8.0-rc1
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:327 - Lean toolchain path 2 does not exi
st: /.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 12:14:27.772 | INFO     | generate_benchmark_lean4:main:329 - Lean toolchain path 3 does not exi
st: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 12:14:27.773 | INFO     | generate_benchmark_lean4:main:332 - Switched to Lean toolchain at: /ho
me/adarsh/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 12:14:27.884 | INFO     | generate_benchmark_lean4:main:334 - lean --version: Lean (version 4.8.
0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-08-10 12:14:27.884 | INFO     | generate_benchmark_lean4:main:335 - repo: LeanGitRepo(url='https://git
hub.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162bb7e')
2024-08-10 12:14:27.884 | INFO     | generate_benchmark_lean4:main:337 - Configuring LeanDojo again...
2024-08-10 12:14:27.887 | INFO     | generate_benchmark_lean4:configure_leandojo:294 - Current working dire
ctory: /home/adarsh/ReProver
2024-08-10 12:14:27.887 | INFO     | generate_benchmark_lean4:main:339 - LeanDojo configured
2024-08-10 12:14:27.887 | INFO     | generate_benchmark_lean4:main:342 - Tracing the repo...
2024-08-10 12:14:27.888 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:217 - The traced
repo is available in the cache.
2024-08-10 12:14:27.888 | INFO     | lean_dojo.data_extraction.trace:trace:246 - Loading the traced repo fr
om /raid/adarsh/.cache/lean_dojo/teorth-pfr-6a5082ee465f9e44cea479c7b741b3163162bb7e/pfr
2024-08-10 12:14:27.890 | DEBUG    | lean_dojo.utils:execute:110 - git remote get-url origin
2024-08-10 12:14:27.892 | DEBUG    | lean_dojo.utils:execute:110 - git log -n 1
2024-08-10 12:14:28.015 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1169 - Loading 28
90 traced XML files from /raid/adarsh/.cache/lean_dojo/teorth-pfr-6a5082ee465f9e44cea479c7b741b3163162bb7e/
pfr with 31 workers
2024-08-10 12:14:29,431 INFO worker.py:1772 -- Started a local Ray instance. View the dashboard at 127.0.0.
1:8267
  2%|█▍                                                                | 63/2890 [00:05<03:27, 13.61it/s](r
aylet) [2024-08-10 12:14:39,326 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93623263232; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 12%|███████▉                                                         | 355/2890 [00:16<01:55, 21.87it/s](r
aylet) [2024-08-10 12:14:49,331 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93623222272; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 20%|█████████████▏                                                   | 589/2890 [00:25<00:24, 93.55it/s](r
aylet) [2024-08-10 12:14:59,336 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93623193600; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 28%|██████████████████▍                                              | 820/2890 [00:36<00:51, 40.20it/s](r
aylet) [2024-08-10 12:15:09,342 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93623164928; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 33%|█████████████████████▌                                           | 959/2890 [00:46<01:04, 29.89it/s](r
aylet) [2024-08-10 12:15:19,348 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93623144448; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 35%|██████████████████████▍                                         | 1014/2890 [00:56<11:22,  2.75it/s](r
aylet) [2024-08-10 12:15:29,355 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93623087104; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 38%|████████████████████████▎                                       | 1099/2890 [01:08<13:18,  2.24it/s](r
aylet) [2024-08-10 12:15:39,360 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93622226944; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 42%|██████████████████████████▊                                     | 1210/2890 [01:24<19:23,  1.44it/s](r
aylet) [2024-08-10 12:15:49,365 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93622206464; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 44%|████████████████████████████▏                                   | 1274/2890 [01:26<01:20, 20.20it/s](r
aylet) [2024-08-10 12:15:59,371 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93622177792; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 47%|█████████████████████████████▊                                  | 1348/2890 [01:45<00:36, 42.05it/s](r
aylet) [2024-08-10 12:16:09,377 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93622145024; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 48%|██████████████████████████████▍                                 | 1373/2890 [01:46<05:08,  4.92it/s](r
aylet) [2024-08-10 12:16:19,384 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93622116352; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 54%|██████████████████████████████████▋                             | 1569/2890 [02:13<00:24, 53.16it/s](r
aylet) [2024-08-10 12:16:29,390 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93622050816; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 54%|██████████████████████████████████▊                             | 1570/2890 [02:13<29:02,  1.32s/it](r
aylet) [2024-08-10 12:16:39,395 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93620973568; capacity: 1887507697664. O
bject creation will fail if spilling is required.
 60%|██████████████████████████████████████▏                         | 1725/2890 [02:45<00:32, 36.35it/s](r
aylet) [2024-08-10 12:16:59,407 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93620920320; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 2x across cluster] (Ray deduplicates logs by de
fault. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observab
ility/user-guides/configure-logging.html#log-deduplication for more options.)
 71%|█████████████████████████████████████████████▋                  | 2065/2890 [03:23<30:23,  2.21s/it](r
aylet) [2024-08-10 12:17:29,425 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93620772864; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 3x across cluster]
 80%|███████████████████████████████████████████████████▏            | 2314/2890 [04:10<33:06,  3.45s/it](r
aylet) [2024-08-10 12:18:09,446 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93619138560; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 4x across cluster]
 85%|██████████████████████████████████████████████████████▏         | 2448/2890 [04:16<00:14, 31.05it/s](r
aylet) [2024-08-10 12:18:49,483 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93618212864; capacity: 1887507697664. O
bject creation will fail if spilling is required. [repeated 4x across cluster]
 89%|█████████████████████████████████████████████████████████       | 2575/2890 [05:08<16:54,  3.22s/it](r
aylet) [2024-08-10 12:18:59,489 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_20
24-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93618188288; capacity: 1887507697664. O
bject creation will fail if spilling is required.
(raylet) [2024-08-10 12:19:09,495 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_
2024-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93618159616; capacity: 1887507697664.
 Object creation will fail if spilling is required.
100%|████████████████████████████████████████████████████████████████| 2890/2890 [05:11<00:00,  9.27it/s]
(raylet) [2024-08-10 12:19:39,510 E 3764278 3764308] (raylet) file_system_monitor.cc:111: /tmp/ray/session_
2024-08-10_12-14-28_152038_3763083 is over 95% full, available space: 93616762880; capacity: 1887507697664.
 Object creation will fail if spilling is required. [repeated 3x across cluster]
2024-08-10 12:19:46.579 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162b
b7e')
2024-08-10 12:19:47.936 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.6.0-rc1
2024-08-10 12:19:50.190 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.7.0
2024-08-10 12:19:51.117 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-10 12:19:52.237 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-10 12:19:55.468 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.10.0
2024-08-10 12:19:56.496 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for doc-gen4 main
2024-08-10 12:19:57.110 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.11.0-rc1
2024-08-10 12:19:57.748 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/YaelDillies/LeanAPAP', commit='f47447e44d8e82ab214ed8c1b19
9329141fc5b1f')
2024-08-10 12:19:58.514 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.9.0-rc1
2024-08-10 12:19:59.550 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.10.0-rc1
2024-08-10 12:20:00.300 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.9.0
2024-08-10 12:20:01.788 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/mathlib4.git") failed. Retrying...
2024-08-10 12:20:02.906 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https://g
ithub.com/leanprover-community/mathlib4.git") failed. Retrying...
2024-08-10 12:20:06.158 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3dd071bc2260b3cf9a
71863d0dee1242fec41522')
2024-08-10 12:20:07.392 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the dep
endencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='6d8e3118ab526f8dfcabcbdf9f05
dc34e5c423a8')
2024-08-10 12:20:08.444 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 v4.10.0-rc2
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-08-10 12:20:10.306 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 nightly-2024-06-05
2024-08-10 12:20:11.583 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for md4lean main
2024-08-10 12:20:11.781 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for BibtexQuery master
2024-08-10 12:20:12.177 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4-unicode-basic main
2024-08-10 12:20:12.897 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4-cli nightly
2024-08-10 12:20:13.077 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the commi
t hash for lean4 nightly-2024-06-05
2024-08-10 12:20:14.314 | INFO     | generate_benchmark_lean4:main:346 - Failed to trace repo LeanGitRepo(u
rl='https://github.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162bb7e') because of Invalid t
ag or branch: `nightly-2024-06-05` for Repository(full_name="leanprover/lean4")
2024-08-10 12:20:25.498 | INFO     | __main__:generate_dataset:246 - Finished generating benchmark at /raid
/adarsh/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 12:20:25.501 | INFO     | __main__:generate_dataset:247 - Merging datasets
2024-08-10 12:20:25.502 | INFO     | __main__:merge_datasets:74 - Merging datasets for random
2024-08-10 12:20:25.502 | INFO     | __main__:merge_datasets:80 - Processing train split
2024-08-10 12:20:25.502 | INFO     | __main__:merge_datasets:104 - Finished processing train split
2024-08-10 12:20:25.502 | INFO     | __main__:merge_datasets:80 - Processing val split
2024-08-10 12:20:25.502 | INFO     | __main__:merge_datasets:104 - Finished processing val split
2024-08-10 12:20:25.502 | INFO     | __main__:merge_datasets:80 - Processing test split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:104 - Finished processing test split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:105 - Finished merging datasets for random
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:74 - Merging datasets for novel_premises
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:80 - Processing train split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:104 - Finished processing train split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:80 - Processing val split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:104 - Finished processing val split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:80 - Processing test split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:104 - Finished processing test split
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:105 - Finished merging datasets for novel_prem
ises
2024-08-10 12:20:25.503 | INFO     | __main__:merge_datasets:107 - Merging corpus
2024-08-10 12:20:25.504 | INFO     | __main__:merge_datasets:130 - Finished merging corpus
2024-08-10 12:20:25.504 | INFO     | __main__:merge_datasets:132 - Adding metadata
2024-08-10 12:20:25.504 | WARNING  | __main__:merge_datasets:152 - No metadata file found
2024-08-10 12:20:25.504 | INFO     | __main__:merge_datasets:154 - Deleting individual datasets
2024-08-10 12:20:25.504 | INFO     | __main__:generate_dataset:249 - Finished merging datasets
2024-08-10 12:20:25.735 | INFO     | __main__:main:635 - Latest PL checkpoint found: AK123321/pl-leancopilo
t-2
2024-08-10 12:20:25.842 | INFO     | __main__:download_pl_checkpoint:274 - Checkpoint downloaded to: /home/
adarsh/.cache/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d039
12f2d86f/model.ckpt
2024-08-10 12:20:25.843 | INFO     | __main__:main:638 - Checkpoint path: /home/adarsh/.cache/huggingface/h
ub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.ckpt
2024-08-10 12:20:25.843 | INFO     | __main__:train:464 - Training model with checkpoint: /home/adarsh/.cac
he/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/mo
del.ckpt
Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your
 files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../.cache/huggingface/hub
/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.ckpt`
2024-08-10 12:20:36.995 | INFO     | __main__:train:486 - Loaded premise retriever at /home/adarsh/.cache/h
uggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.
ckpt
2024-08-10 12:20:36.995 | INFO     | __main__:train:490 - Data path: /raid/adarsh/datasets_test/merged/rand
om
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/transformers/tokenization_u
tils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by d
efault. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default.
For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-08-10 12:20:37.092 | INFO     | common:__init__:199 - Building the corpus from /raid/adarsh/datasets_t
est/merged/corpus.jsonl
2024-08-10 12:20:37.093 | INFO     | __main__:main:647 - An error occurred: [Errno 2] No such file or direc
tory: '/raid/adarsh/datasets_test/merged/random/../metadata.json'
Traceback (most recent call last):
  File "/home/adarsh/ReProver/compute_server.py", line 641, in main
    train(model_checkpoint_path, merged_data_path, next_suffix)
  File "/home/adarsh/ReProver/compute_server.py", line 491, in train
    data_module = RetrievalDataModule(
  File "/home/adarsh/ReProver/retrieval/datamodule.py", line 246, in __init__
    metadata = json.load(open(os.path.join(data_path, "../metadata.json")))
FileNotFoundError: [Errno 2] No such file or directory: '/raid/adarsh/datasets_test/merged/random/../metada
ta.json'
(base) adarsh@tensorlab-DGX-Station-A100-920-23487-2531-000:~/ReProver(base) adarsh@tensorlab-DGX-Station-A
(base) adarsh@tensorlab-DGX-Station-A100-920-23487-2531-000:~/ReProver$
