2024-09-08 19:24:47.381 | INFO     | __main__:main:1223 - Found 15 repositories
2024-09-08 19:24:47.381 | INFO     | __main__:main:1314 - Starting without curriculum learning
2024-09-08 19:24:47.697 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 19:25:03.397 | INFO     | __main__:main:1343 - Finding compatible repositories...
2024-09-08 19:25:03.397 | INFO     | __main__:main:1347 - Finished finding compatible repositories
2024-09-08 19:25:03.628 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:25:19.586 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:25:35.740 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:25:35.740 | INFO     | __main__:main:1366 - i: 0
2024-09-08 19:25:35.740 | INFO     | __main__:main:1372 - Main process
2024-09-08 19:25:35.740 | INFO     | __main__:main:1373 - Using lambda = 0.1
2024-09-08 19:25:35.740 | INFO     | __main__:main:1374 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 19:25:35.740 | INFO     | __main__:add_repo_to_database:890 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:25:35.743 | INFO     | __main__:main:1390 - Writing skip file for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 19:25:35.743 | INFO     | __main__:main:1397 - Adding repo to repos_for_merged_dataset
2024-09-08 19:25:35.743 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:25:35.743 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:25:35.744 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:25:35.744 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:25:35.744 | INFO     | __main__:main:1422 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:25:38.837 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:25:38.948 | INFO     | __main__:main:1505 - right before barrier for data module
2024-09-08 19:25:38.949 | INFO     | __main__:main:1509 - Skipping repository https://github.com/avigad/mathematics_in_lean_source due to preprocessing issues
2024-09-08 19:25:38.949 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:25:38.950 | INFO     | __main__:main:1366 - i: 1
2024-09-08 19:25:38.950 | INFO     | __main__:main:1372 - Main process
2024-09-08 19:25:38.950 | INFO     | __main__:main:1373 - Using lambda = 0.1
2024-09-08 19:25:38.950 | INFO     | __main__:main:1374 - Processing https://github.com/teorth/pfr
2024-09-08 19:25:38.950 | INFO     | __main__:add_repo_to_database:890 - Processing https://github.com/teorth/pfr.git
2024-09-08 19:25:38.950 | INFO     | __main__:main:1390 - Writing skip file for https://github.com/teorth/pfr
2024-09-08 19:25:38.951 | INFO     | __main__:main:1397 - Adding repo to repos_for_merged_dataset
2024-09-08 19:25:38.951 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:25:38.951 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:25:38.951 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:25:38.951 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:25:38.951 | INFO     | __main__:main:1422 - Starting training at epoch 0
[rank: 0] Seed set to 3407
2024-09-08 19:25:40.379 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:25:40.484 | INFO     | __main__:main:1505 - right before barrier for data module
2024-09-08 19:25:40.485 | INFO     | __main__:main:1509 - Skipping repository https://github.com/teorth/pfr due to preprocessing issues
2024-09-08 19:25:40.485 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:25:40.485 | INFO     | __main__:main:1366 - i: 2
2024-09-08 19:25:40.485 | INFO     | __main__:main:1697 - An error occurred: list index out of range
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1367, in main
    repo = lean_git_repos[i]
IndexError: list index out of range
(base) yingzi_ma@compute-permanent-node-345:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Did not find any active Ray processes.
[2024-09-08 19:27:50,102] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 19:27:54.121 | INFO     | __main__:main:1193 - Running progressive training
2024-09-08 19:27:54.121 | INFO     | __main__:main:1199 - Configuring LeanDojo...
2024-09-08 19:27:54.124 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:27:54.124 | INFO     | __main__:main:1201 - LeanDojo configured
2024-09-08 19:27:54.124 | INFO     | __main__:main:1206 - Starting the main process
2024-09-08 19:27:54.124 | INFO     | __main__:main:1214 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 19:27:54.125 | INFO     | __main__:main:1216 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 19:27:54.125 | INFO     | __main__:main:1223 - Found 15 repositories
2024-09-08 19:27:54.125 | INFO     | __main__:main:1314 - Starting without curriculum learning
2024-09-08 19:27:54.332 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 19:28:10.119 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:28:25.337 | INFO     | __main__:main:1343 - Finding compatible repositories...
2024-09-08 19:28:25.337 | INFO     | __main__:main:1347 - Finished finding compatible repositories
2024-09-08 19:28:25.362 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:28:40.669 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:28:40.669 | INFO     | __main__:main:1366 - i: 0
2024-09-08 19:28:40.669 | INFO     | __main__:main:1372 - Main process
2024-09-08 19:28:40.669 | INFO     | __main__:main:1373 - Using lambda = 0.1
2024-09-08 19:28:40.669 | INFO     | __main__:main:1374 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 19:28:40.670 | INFO     | __main__:add_repo_to_database:889 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:41.006 | INFO     | __main__:get_compatible_commit:322 - Latest commit: cfe61bc71b5ea501f89df36c945949a1febf5e75
2024-09-08 19:28:41.006 | INFO     | __main__:get_compatible_commit:325 - Creating LeanGitRepo for https://github.com/avigad/mathematics_in_lean_source
2024-09-08 19:28:41.006 | INFO     | __main__:get_compatible_commit:327 - Getting config for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:41.007 | INFO     | __main__:get_compatible_commit:334 - Searching for compatible commit for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:41.010 | INFO     | __main__:get_compatible_commit:340 - Already in a Git repository
2024-09-08 19:28:41.011 | INFO     | __main__:get_compatible_commit:350 - Fetching commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:44.993 | INFO     | __main__:get_compatible_commit:354 - Fetched commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:44.998 | INFO     | __main__:get_compatible_commit:360 - Getting list of commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:45.006 | INFO     | __main__:get_compatible_commit:365 - Found 526 commits for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:28:45.414 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-08 19:29:01.791 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0-rc2
2024-09-08 19:29:20.006 | INFO     | __main__:get_compatible_commit:372 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:29:20.007 | INFO     | __main__:add_repo_to_database:911 - Found compatible commit 5297e0fb051367c48c0a084411853a576389ecf5 for https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:29:20.007 | INFO     | __main__:add_repo_to_database:912 - Lean version: v4.8.0-rc2
2024-09-08 19:29:20.007 | INFO     | __main__:add_repo_to_database:917 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389
ecf5
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.007 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.008 | INFO     | generate_benchmark_lean4:main:377 - Lean toolchain path 1 does not exist: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.008 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.008 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.008 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/lean_project/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-09-08 19:29:20.075 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-09-08 19:29:20.076 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389ecf5')
2024-09-08 19:29:20.076 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-09-08 19:29:20.081 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:29:20.081 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-09-08 19:29:20.082 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-09-08 19:29:20.084 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-08 19:29:20.084 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a084411853a576389ecf5/mathem
atics_in_lean_source
2024-09-08 19:29:22.029 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 3143 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a08441
1853a576389ecf5/mathematics_in_lean_source with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3143/3143 [06:07<00:00,  8.56it/s]
2024-09-08 19:35:29.388 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084411853a576389e
cf5')
2024-09-08 19:35:30.723 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-08 19:35:47.576 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-08 19:36:03.329 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-08 19:36:04.452 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-08 19:36:07.625 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0-rc1
2024-09-08 19:36:22.958 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3fecb249afcf5ba40efe0a3f92f69e2460f142c7'
)
2024-09-08 19:36:24.065 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-08 19:36:53.303 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/avigad/mathematics_in_lean_source', commit='5297e0fb051367c48c0a084
411853a576389ecf5'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='e9e858a4484905a0bfe97c4f05c3924ead02eed8'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', comm
it='8feac540abb781cb1349688c816dc02fae66b49c'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='2c8ae451ce9ffc83554322b14437159c1a9703f9'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community
/aesop', commit='e291aa4de57079b3d2199b9eb7b4b00922b85a7c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='eb08eee94098fe530ccd6d8751a86fe405473d4c'), 'Cli': LeanGitRepo(url='https://git
hub.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='3fecb249afcf5ba40efe0a3f92f69e2460f142c7'), 'importGraph': LeanGitR
epo(url='https://github.com/leanprover-community/import-graph', commit='fb7841a6f4fb389ec0e47dd4677844d49906af3c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/avigad-mathematics_in_lean_source-5297e0fb051367c48c0a
084411853a576389ecf5/mathematics_in_lean_source'))
2024-09-08 19:37:04.923 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-09-08 19:37:04.924 | WARNING  | generate_benchmark_lean4:safe_remove_dir:281 - /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5 already exists
. Removing it now.
2024-09-08 19:37:11.312 | INFO     | generate_benchmark_lean4:split_data:133 - 78886 theorems in total
2024-09-08 19:37:11.312 | INFO     | generate_benchmark_lean4:split_data:138 - 78886 theorems in total, with 1577 for validation and 1577 for testing
2024-09-08 19:37:11.312 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-09-08 19:37:11.339 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-09-08 19:37:16.578 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-09-08 19:37:30.251 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 126314 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/train.json
2024-09-08 19:37:30.665 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2921 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48
c0a084411853a576389ecf5/random/val.json
2024-09-08 19:37:30.947 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 2555 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48
c0a084411853a576389ecf5/random/test.json
2024-09-08 19:37:43.830 | INFO     | generate_benchmark_lean4:export_proofs:202 - 75732 theorems and 123871 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/novel_premises/train.json
2024-09-08 19:37:44.321 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 3904 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48
c0a084411853a576389ecf5/novel_premises/val.json
2024-09-08 19:37:44.695 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1577 theorems and 4015 tactics saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48
c0a084411853a576389ecf5/novel_premises/test.json
2024-09-08 19:37:44.695 | INFO     | generate_benchmark_lean4:export_proofs:206 - 157772 theorems saved in total
2024-09-08 19:37:44.697 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-09-08 19:38:00.672 | INFO     | generate_benchmark_lean4:export_premises:229 - 117699 theorems/definitions from 3143 files saved to /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_52
97e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-08 19:38:00.684 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-09-08 19:38:00.686 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-09-08 19:38:00.686 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-09-08 19:38:00.740 | INFO     | __main__:add_repo_to_database:925 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 66162.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 61470.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 75732/75732 [00:51<00:00, 1479.98it/s]
2024-09-08 19:38:53.826 | INFO     | __main__:add_repo_to_database:950 - Before adding new repo:
2024-09-08 19:38:53.826 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-08 19:38:53.826 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:38:53.826 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:38:53.826 | INFO     | __main__:add_repo_to_database:953 - After adding new repo:
2024-09-08 19:38:53.826 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-09-08 19:38:53.826 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:39:20.493 | INFO     | __main__:main:1397 - Adding repo to repos_for_merged_dataset
2024-09-08 19:39:20.493 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:39:20.494 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:39:20.494 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:39:20.494 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:39:20.494 | INFO     | __main__:main:1422 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:39:22.522 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:39:22.629 | INFO     | __main__:main:1505 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:39:22.744 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 75732/75732 [00:08<00:00, 8737.10it/s]
2024-09-08 19:39:40.766 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 9089.51it/s]
2024-09-08 19:39:40.985 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 8011.93it/s]
2024-09-08 19:39:41.236 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367
c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:39:41.236 | INFO     | __main__:main:1529 - Training dataset size after load: 178959
2024-09-08 19:39:41.236 | INFO     | __main__:main:1530 - Validation dataset size after load: 2509
2024-09-08 19:39:41.236 | INFO     | __main__:main:1531 - Testing dataset size after load: 2723
2024-09-08 19:39:41.236 | INFO     | __main__:main:1533 - Starting progressive training from epoch 0 to 1
2024-09-08 19:39:41.236 | INFO     | __main__:main:1536 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 19:39:46,941] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 19:39:46,942] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 19:39:46,942] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 19:39:50.993 | INFO     | __main__:main:1193 - Running progressive training
2024-09-08 19:39:50.993 | INFO     | __main__:main:1193 - Running progressive training
2024-09-08 19:39:50.993 | INFO     | __main__:main:1193 - Running progressive training
2024-09-08 19:39:50.993 | INFO     | __main__:main:1199 - Configuring LeanDojo...
2024-09-08 19:39:50.993 | INFO     | __main__:main:1199 - Configuring LeanDojo...
2024-09-08 19:39:50.993 | INFO     | __main__:main:1199 - Configuring LeanDojo...
2024-09-08 19:39:50.996 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:39:50.996 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:39:50.996 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:39:50.996 | INFO     | __main__:main:1201 - LeanDojo configured
2024-09-08 19:39:50.996 | INFO     | __main__:main:1201 - LeanDojo configured
2024-09-08 19:39:50.996 | INFO     | __main__:main:1201 - LeanDojo configured
2024-09-08 19:39:50.996 | INFO     | __main__:main:1223 - Found 15 repositories
2024-09-08 19:39:50.996 | INFO     | __main__:main:1223 - Found 15 repositories
2024-09-08 19:39:50.996 | INFO     | __main__:main:1223 - Found 15 repositories
2024-09-08 19:39:50.996 | INFO     | __main__:main:1314 - Starting without curriculum learning
2024-09-08 19:39:50.996 | INFO     | __main__:main:1314 - Starting without curriculum learning
2024-09-08 19:39:50.996 | INFO     | __main__:main:1314 - Starting without curriculum learning
2024-09-08 19:39:51.405 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:39:51.405 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:39:51.405 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:40:07.231 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:40:07.231 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:40:07.397 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:40:22.555 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:40:22.555 | INFO     | __main__:main:1366 - i: 0
2024-09-08 19:40:22.555 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:40:22.556 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:40:22.556 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:40:22.556 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:40:22.557 | INFO     | __main__:main:1422 - Starting training at epoch 0
[rank: 3] Seed set to 3407
2024-09-08 19:40:22.557 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:40:22.557 | INFO     | __main__:main:1366 - i: 0
2024-09-08 19:40:22.557 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:40:22.557 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:40:22.557 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:40:22.557 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:40:22.557 | INFO     | __main__:main:1422 - Starting training at epoch 0
[rank: 1] Seed set to 3407
2024-09-08 19:40:22.678 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:40:22.678 | INFO     | __main__:main:1366 - i: 0
2024-09-08 19:40:22.679 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:40:22.679 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:40:22.679 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:40:22.679 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:40:22.679 | INFO     | __main__:main:1422 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:40:25.133 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:40:25.241 | INFO     | __main__:main:1505 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-08 19:40:25.308 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:40:25.322 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:40:25.339 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:40:25.353 | INFO     | __main__:main:1505 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-08 19:40:25.363 | INFO     | __main__:main:1505 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:40:25.447 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:40:25.459 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:40:35.920 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:40:35.933 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:35.947 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:40:35.947 | INFO     | __main__:main:1529 - Training dataset size after load: 178959
2024-09-08 19:40:35.947 | INFO     | __main__:main:1530 - Validation dataset size after load: 2509
2024-09-08 19:40:35.947 | INFO     | __main__:main:1531 - Testing dataset size after load: 2723
2024-09-08 19:40:35.947 | INFO     | __main__:main:1533 - Starting progressive training from epoch 0 to 1
2024-09-08 19:40:35.947 | INFO     | __main__:main:1536 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5_False_lambda_0.1/lightning_logs
2024-09-08 19:40:36.492 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:40:36.504 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:36.518 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:40:36.518 | INFO     | __main__:main:1529 - Training dataset size after load: 178959
2024-09-08 19:40:36.518 | INFO     | __main__:main:1530 - Validation dataset size after load: 2509
2024-09-08 19:40:36.518 | INFO     | __main__:main:1531 - Testing dataset size after load: 2723
2024-09-08 19:40:36.519 | INFO     | __main__:main:1533 - Starting progressive training from epoch 0 to 1
2024-09-08 19:40:36.519 | INFO     | __main__:main:1536 - hit the barrier before training
2024-09-08 19:40:36.681 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:40:36.694 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:36.708 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:40:36.708 | INFO     | __main__:main:1529 - Training dataset size after load: 178959
2024-09-08 19:40:36.708 | INFO     | __main__:main:1530 - Validation dataset size after load: 2509
2024-09-08 19:40:36.708 | INFO     | __main__:main:1531 - Testing dataset size after load: 2723
2024-09-08 19:40:36.708 | INFO     | __main__:main:1533 - Starting progressive training from epoch 0 to 1
2024-09-08 19:40:36.708 | INFO     | __main__:main:1536 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5_False_lambda_0.1/lightning_logs
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5_False_lambda_0.1/lightning_logs
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5_False_lambda_0.1/lightning_logs
NCCL version 2.20.5+cuda12.4
2024-09-08 19:40:38.587 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:40:38.686 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:38.703 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is not e
mpty.
2024-09-08 19:40:41.720 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:40:41.806 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
2024-09-08 19:40:41.815 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
2024-09-08 19:40:41.815 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:41.832 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Training dataset size: 178959
Training dataset size: 178959
2024-09-08 19:40:41.895 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:41.906 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:40:41.912 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:40:41.923 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 19:40:43.101 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 19:40:43.101 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 19:40:43.101 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 19:40:43.101 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-08 19:40:45.471 | INFO     | __main__:main:1539 - hit the barrier after training
2024-09-08 19:40:45.863 | INFO     | __main__:main:1539 - hit the barrier after training
2024-09-08 19:40:46.001 | INFO     | __main__:main:1539 - hit the barrier after training
2024-09-08 19:40:46.045 | INFO     | __main__:main:1539 - hit the barrier after training
2024-09-08 19:40:46.046 | INFO     | __main__:main:1545 - Finished progressive training at epoch 1
2024-09-08 19:40:46.046 | INFO     | __main__:main:1545 - Finished progressive training at epoch 1
2024-09-08 19:40:46.046 | INFO     | __main__:main:1545 - Finished progressive training at epoch 1
2024-09-08 19:40:46.046 | INFO     | __main__:main:1545 - Finished progressive training at epoch 1
2024-09-08 19:40:48.153 | INFO     | __main__:main:1564 - Testing...
2024-09-08 19:40:48.154 | INFO     | retrieval.main:run_cli:60 - PID: 1552528
[rank: 1] Seed set to 3407
2024-09-08 19:40:48.366 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 19:40:48.366 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
2024-09-08 19:40:48.634 | INFO     | __main__:main:1564 - Testing...
2024-09-08 19:40:48.639 | INFO     | retrieval.main:run_cli:60 - PID: 1551485
2024-09-08 19:40:48.650 | INFO     | __main__:main:1564 - Testing...
2024-09-08 19:40:48.653 | INFO     | retrieval.main:run_cli:60 - PID: 1552530
2024-09-08 19:40:48.654 | INFO     | __main__:main:1564 - Testing...
2024-09-08 19:40:48.657 | INFO     | retrieval.main:run_cli:60 - PID: 1552529
[rank: 0] Seed set to 3407
2024-09-08 19:40:48.833 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 19:40:48.833 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
[rank: 3] Seed set to 3407
2024-09-08 19:40:48.843 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 19:40:48.843 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
[rank: 2] Seed set to 3407
2024-09-08 19:40:48.850 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 19:40:48.850 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.j
sonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:40:49.089 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 19:40:49.334 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 19:40:49.373 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 19:40:49.514 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
[rank: 1] Seed set to 3407
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71334/71334 [00:09<00:00, 7587.86it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                         | 44036/71334 [00:05<00:03, 8645.82it/s]
2024-09-08 19:41:08.978 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687/random/cache_train/cached_data.pkl
Training dataset size: 168558
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 6484.04it/s]
 58%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                 | 41148/71334 [00:04<00:03, 9230.71it/s]
2024-09-08 19:41:09.274 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687/random/cache_pred/cached_data.pkl
Testing dataset size: 2983
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71334/71334 [00:08<00:00, 8604.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71334/71334 [00:08<00:00, 8506.47it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 70587/71334 [00:08<00:00, 8634.85it/s]
2024-09-08 19:41:12.795 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687/random/cache_train/cached_data.pkl
Training dataset size: 168558
2024-09-08 19:41:12.811 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2983
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71334/71334 [00:08<00:00, 8348.15it/s]
2024-09-08 19:41:13.412 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687/random/cache_train/cached_data.pkl
Training dataset size: 168558
2024-09-08 19:41:13.431 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2983
2024-09-08 19:41:13.552 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2
687/random/cache_train/cached_data.pkl
Training dataset size: 168558
2024-09-08 19:41:13.568 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/
random/cache_pred/cached_data.pkl
Testing dataset size: 2983
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:41:16.505 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 19:41:16.546 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 19:41:16.564 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                                          | 0/? [00:00<?, ?it/s]
2024-09-08 19:41:16.997 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                                                                                                                                                        | 0/12 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:28<00:00,  0.43it/s]
2024-09-08 19:41:45.134 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:41:45.147 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 19:41:45.147 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:41:47.688 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:41:47.688 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:41:47.688 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:41:47.701 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 19:41:47.701 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:41:47.702 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 19:41:47.702 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 19:41:47.702 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:41:47.702 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:41:47.702 | INFO     | retrieval.model:on_predict_epoch_end:580 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:30<00:00,  0.39it/s]
2024-09-08 19:41:48.450 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:48.487 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
  0%|                                                                                                                                                                                                               | 0/1486 [00:00<?, ?it/s]
2024-09-08 19:41:48.514 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:48.542 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:48.547 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 22151.94it/s]
2024-09-08 19:41:48.556 | INFO     | __main__:main:1590 - R@1 = 0.1542126379137412 %, R@10 = 0.3686655203706357 %, MRR = 0.008229240033604347
2024-09-08 19:41:48.556 | INFO     | retrieval.main:run_cli:60 - PID: 1552529
2024-09-08 19:41:48.576 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 22567.09it/s]
2024-09-08 19:41:48.614 | INFO     | __main__:main:1590 - R@1 = 0.1542126379137412 %, R@10 = 0.3686655203706357 %, MRR = 0.008229240033604347
2024-09-08 19:41:48.615 | INFO     | retrieval.main:run_cli:60 - PID: 1552530
2024-09-08 19:41:48.629 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 22392.20it/s]
2024-09-08 19:41:48.644 | INFO     | __main__:main:1590 - R@1 = 0.1542126379137412 %, R@10 = 0.3686655203706357 %, MRR = 0.008229240033604347
2024-09-08 19:41:48.644 | INFO     | retrieval.main:run_cli:60 - PID: 1552528
2024-09-08 19:41:48.662 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 22997.41it/s]
2024-09-08 19:41:48.727 | INFO     | __main__:main:1590 - R@1 = 0.1542126379137412 %, R@10 = 0.3686655203706357 %, MRR = 0.008229240033604347
2024-09-08 19:41:48.729 | INFO     | retrieval.main:run_cli:60 - PID: 1551485
[rank: 2] Seed set to 3407
2024-09-08 19:41:48.744 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c9459
49a1febf5e75/random
2024-09-08 19:41:48.745 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c94
5949a1febf5e75/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-08 19:41:48.801 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c9459
49a1febf5e75/random
2024-09-08 19:41:48.801 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c94
5949a1febf5e75/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-08 19:41:48.824 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c9459
49a1febf5e75/random
2024-09-08 19:41:48.825 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c94
5949a1febf5e75/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 19:41:48.912 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c9459
49a1febf5e75/random
2024-09-08 19:41:48.913 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c94
5949a1febf5e75/corpus.jsonl
2024-09-08 19:41:49.255 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e7
5/corpus.jsonl
2024-09-08 19:41:49.328 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e7
5/corpus.jsonl
2024-09-08 19:41:49.336 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e7
5/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-08 19:41:49.404 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e7
5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
0it [00:00, ?it/s]

0it [00:00, ?it/s]
0it [00:00, ?it/s]
2024-09-08 19:41:49.454 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]
2024-09-08 19:41:49.455 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_train/cached_data.pkl
2024-09-08 19:41:49.455 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_train/cached_data.pkl
Training dataset size: 0
Training dataset size: 0
2024-09-08 19:41:49.455 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_train/cached_data.pkl
Training dataset size: 0
0it [00:00, ?it/s]

0it [00:00, ?it/s]
2024-09-08 19:41:49.459 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_pred/cached_data.pkl
Testing dataset size: 0
2024-09-08 19:41:49.460 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_pred/cached_data.pkl
2024-09-08 19:41:49.460 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_pred/cached_data.pkl
2024-09-08 19:41:49.460 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea5
01f89df36c945949a1febf5e75/random/cache_pred/cached_data.pkl
Testing dataset size: 0
Testing dataset size: 0
Testing dataset size: 0
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/data.py:104: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.
2024-09-08 19:41:51.723 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:51.731 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e75/random/tes
t.json
0it [00:00, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-09-08 19:41:51.736 | INFO     | __main__:main:1590 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:41:51.737 | INFO     | retrieval.main:run_cli:60 - PID: 1552530
2024-09-08 19:41:51.808 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:51.810 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:51.810 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:41:51.812 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e75/random/tes
t.json
0it [00:00, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-09-08 19:41:51.814 | INFO     | __main__:main:1590 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:41:51.814 | INFO     | retrieval.main:run_cli:60 - PID: 1552528
2024-09-08 19:41:51.814 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e75/random/tes
t.json
2024-09-08 19:41:51.815 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_cfe61bc71b5ea501f89df36c945949a1febf5e75/random/tes
t.json
0it [00:00, ?it/s]
0it [00:00, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
2024-09-08 19:41:51.816 | INFO     | __main__:main:1590 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:41:51.816 | INFO     | __main__:main:1590 - R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:41:51.816 | INFO     | retrieval.main:run_cli:60 - PID: 1552529
2024-09-08 19:41:51.817 | INFO     | retrieval.main:run_cli:60 - PID: 1551485
[rank: 3] Seed set to 3407
2024-09-08 19:41:51.932 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/random
2024-09-08 19:41:51.932 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae
24253d566/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-08 19:41:51.998 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/random
2024-09-08 19:41:51.998 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae
24253d566/corpus.jsonl
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-08 19:41:52.001 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/random
2024-09-08 19:41:52.001 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae
24253d566/corpus.jsonl
2024-09-08 19:41:52.001 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24
253d566/random
2024-09-08 19:41:52.001 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae
24253d566/corpus.jsonl
2024-09-08 19:41:52.472 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/cor
pus.jsonl
2024-09-08 19:41:52.489 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/cor
pus.jsonl
2024-09-08 19:41:52.496 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/cor
pus.jsonl
2024-09-08 19:41:52.580 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/cor
pus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-08 19:42:04.405 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 19:42:04.422 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:42:06.291 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 19:42:06.308 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:42:06.391 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 19:42:06.406 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:42:06.692 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 19:42:06.706 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd6
7f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:42:09.052 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 19:42:09.057 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 19:42:09.112 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                                          | 0/? [00:00<?, ?it/s]
2024-09-08 19:42:09.488 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:23<00:00,  0.46it/s]
2024-09-08 19:42:33.255 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:42:33.256 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:42:33.256 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:42:33.256 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:42:33.267 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 19:42:33.267 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:42:33.269 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 19:42:33.269 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 19:42:33.269 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:42:33.269 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:42:33.270 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 19:42:33.270 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:42:33.271 | INFO     | retrieval.model:on_predict_epoch_end:580 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:23<00:00,  0.46it/s]
2024-09-08 19:42:33.928 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:42:34.131 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:42:34.154 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:42:34.166 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.jso
n
  0%|                                                                                                                                                                                                               | 0/1582 [00:00<?, ?it/s]
2024-09-08 19:42:34.187 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.jso
n
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 25484.66it/s]
2024-09-08 19:42:34.229 | INFO     | __main__:main:1590 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 19:42:34.230 | INFO     | retrieval.main:run_cli:60 - PID: 1552530
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 26446.03it/s]
2024-09-08 19:42:34.248 | INFO     | __main__:main:1590 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 19:42:34.248 | INFO     | retrieval.main:run_cli:60 - PID: 1552529
2024-09-08 19:42:34.285 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:42:34.313 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.jso
n
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 27485.97it/s]
2024-09-08 19:42:34.371 | INFO     | __main__:main:1590 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 19:42:34.372 | INFO     | retrieval.main:run_cli:60 - PID: 1551485
[rank: 3] Seed set to 3407
2024-09-08 19:42:34.421 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/random
2024-09-08 19:42:34.421 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411
853a576389ecf5/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-08 19:42:34.431 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/random
2024-09-08 19:42:34.431 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411
853a576389ecf5/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 19:42:34.556 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/random
2024-09-08 19:42:34.556 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411
853a576389ecf5/corpus.jsonl
2024-09-08 19:42:34.922 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:42:34.982 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:42:35.078 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:42:37.093 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/random/test.jso
n
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 27356.22it/s]
2024-09-08 19:42:37.152 | INFO     | __main__:main:1590 - R@1 = 0.295406899180484 %, R@10 = 0.38752302903246294 %, MRR = 0.010847408607353268
2024-09-08 19:42:37.152 | INFO     | retrieval.main:run_cli:60 - PID: 1552528
[rank: 1] Seed set to 3407
2024-09-08 19:42:37.345 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a08441185
3a576389ecf5/random
2024-09-08 19:42:37.346 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411
853a576389ecf5/corpus.jsonl
2024-09-08 19:42:37.884 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-08 19:42:48.716 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:42:48.734 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:42:50.457 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:42:50.473 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:42:51.197 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:42:51.211 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:42:51.286 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:42:51.302 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:42:53.686 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 19:42:53.720 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 19:42:53.744 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                                          | 0/? [00:00<?, ?it/s]
2024-09-08 19:42:54.225 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:24<00:00,  0.45it/s]
2024-09-08 19:43:18.919 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:43:18.920 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:43:18.932 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 19:43:18.932 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:43:18.933 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 19:43:18.934 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:43:19.626 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:43:19.626 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 19:43:19.639 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 19:43:19.639 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:43:19.642 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 19:43:19.642 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 19:43:19.643 | INFO     | retrieval.model:on_predict_epoch_end:580 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:25<00:00,  0.43it/s]
2024-09-08 19:43:20.299 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:43:20.337 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/tes
t.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 24907.24it/s]
2024-09-08 19:43:20.402 | INFO     | __main__:main:1590 - R@1 = 0.13015873015873014 %, R@10 = 0.1983265191598525 %, MRR = 0.005119695584789352
2024-09-08 19:43:20.402 | INFO     | __main__:main:1603 - Average R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:43:20.402 | INFO     | __main__:main:1695 - current epoch: 1
2024-09-08 19:43:20.403 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:43:20.403 | INFO     | __main__:main:1366 - i: 1
2024-09-08 19:43:20.403 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:43:20.405 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:20.405 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:43:20.405 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:43:20.405 | INFO     | __main__:main:1422 - Starting training at epoch 1
[rank: 1] Seed set to 3407
2024-09-08 19:43:20.546 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:43:20.560 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:43:20.597 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/tes
t.json
  0%|                                                                                                                                                                                                               | 0/1577 [00:00<?, ?it/s]
2024-09-08 19:43:20.607 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/tes
t.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 23450.72it/s]
2024-09-08 19:43:20.666 | INFO     | __main__:main:1590 - R@1 = 0.13015873015873014 %, R@10 = 0.1983265191598525 %, MRR = 0.005119695584789352
2024-09-08 19:43:20.666 | INFO     | __main__:main:1603 - Average R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:43:20.666 | INFO     | __main__:main:1695 - current epoch: 1
2024-09-08 19:43:20.667 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:43:20.667 | INFO     | __main__:main:1366 - i: 1
2024-09-08 19:43:20.667 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:43:20.668 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:20.669 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:43:20.669 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:43:20.669 | INFO     | __main__:main:1422 - Starting training at epoch 1
[rank: 3] Seed set to 3407
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 24177.80it/s]
2024-09-08 19:43:20.673 | INFO     | __main__:main:1590 - R@1 = 0.13015873015873014 %, R@10 = 0.1983265191598525 %, MRR = 0.005119695584789352
2024-09-08 19:43:20.674 | INFO     | __main__:main:1603 - Average R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:43:20.674 | INFO     | __main__:main:1695 - current epoch: 1
2024-09-08 19:43:20.674 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:43:20.674 | INFO     | __main__:main:1366 - i: 1
2024-09-08 19:43:20.674 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:43:20.676 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:20.676 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:43:20.676 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:43:20.676 | INFO     | __main__:main:1422 - Starting training at epoch 1
[rank: 2] Seed set to 3407
2024-09-08 19:43:20.790 | INFO     | __main__:main:1585 - Loaded the predictions pickle files
2024-09-08 19:43:20.847 | INFO     | __main__:main:1588 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/tes
t.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 21557.69it/s]
2024-09-08 19:43:20.922 | INFO     | __main__:main:1590 - R@1 = 0.13015873015873014 %, R@10 = 0.1983265191598525 %, MRR = 0.005119695584789352
2024-09-08 19:43:20.923 | INFO     | __main__:main:1603 - Average R@1 = nan %, R@10 = nan %, MRR = nan
2024-09-08 19:43:20.924 | INFO     | __main__:main:1641 - Starting the prover
2024-09-08 19:43:20.924 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 19:43:20.924 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 19:43:20.924 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 19:43:20.924 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-s
mall/model_lightning.ckpt`
2024-09-08 19:43:21.478 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_
0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:21.478 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_
0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:22.782 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:22.782 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:22.888 | INFO     | __main__:main:1505 - right before barrier for data module
2024-09-08 19:43:22.888 | INFO     | __main__:main:1505 - right before barrier for data module
2024-09-08 19:43:23.008 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:43:23.048 | INFO     | __main__:main:1505 - right before barrier for data module
2024-09-08 19:43:24.054 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.enc
oder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retri
ever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.enc
oder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.la
yer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.enco
der.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseR
eluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.en
coder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.lay
er_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retri
ever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.S
elfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever
.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.la
yer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retr
iever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 're
triever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.l
ayer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight'
, 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7
.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'ret
riever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.
block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight
', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weig
ht', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.b
lock.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.
wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encod
er.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.
wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.enco
der.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.S
elfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'sta
te_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 19:43:24.654 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 19:43:24.655 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 19:43:24.655 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084
411853a576389ecf5/corpus.jsonl
2024-09-08 19:43:24.655 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:43:31.466 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 19:43:31.466 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/corpus.jsonl
2024-09-08 19:43:31.466 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 19:43:35,494 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=1585335) [2024-09-08 19:44:10,334] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1585335) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1585335)   return torch.load(io.BytesIO(b))
(pid=1585472) [2024-09-08 19:44:22,669] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1585472) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1585472)   return torch.load(io.BytesIO(b))
(pid=1585633) [2024-09-08 19:44:29,519] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1585633) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1585633)   return torch.load(io.BytesIO(b))
(pid=1585799) [2024-09-08 19:44:38,006] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1585799) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1585799)   return torch.load(io.BytesIO(b))
2024-09-08 19:44:53.388 | INFO     | __main__:main:1675 - Finished searching for proofs of sorry theorems
2024-09-08 19:44:53.389 | INFO     | __main__:main:1695 - current epoch: 1
2024-09-08 19:44:53.389 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:44:53.389 | INFO     | __main__:main:1366 - i: 1
2024-09-08 19:44:53.389 | INFO     | __main__:main:1372 - Main process
2024-09-08 19:44:53.389 | INFO     | __main__:main:1373 - Using lambda = 0.1
2024-09-08 19:44:53.389 | INFO     | __main__:main:1374 - Processing https://github.com/teorth/pfr
2024-09-08 19:44:53.389 | INFO     | __main__:add_repo_to_database:889 - Processing https://github.com/teorth/pfr.git
2024-09-08 19:44:53.391 | INFO     | __main__:main:1390 - Writing skip file for https://github.com/teorth/pfr
2024-09-08 19:44:53.391 | INFO     | __main__:main:1397 - Adding repo to repos_for_merged_dataset
2024-09-08 19:44:53.391 | INFO     | __main__:main:1408 - All GPUs
2024-09-08 19:44:53.393 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:44:53.393 | INFO     | __main__:main:1415 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:44:53.394 | INFO     | __main__:main:1421 - Inside train_test_fisher
2024-09-08 19:44:53.394 | INFO     | __main__:main:1422 - Starting training at epoch 1
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:44:54.773 | INFO     | __main__:main:1446 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:44:54.899 | INFO     | __main__:main:1505 - right before barrier for data module
2024-09-08 19:44:54.901 | INFO     | __main__:main:1509 - Skipping repository https://github.com/teorth/pfr due to preprocessing issues
2024-09-08 19:44:54.901 | INFO     | __main__:main:1365 - length of lean_git_repos: 2
2024-09-08 19:44:54.901 | INFO     | __main__:main:1697 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
2024-09-08 19:44:54.901 | INFO     | __main__:main:1366 - i: 2
2024-09-08 19:44:54.901 | INFO     | __main__:main:1697 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
2024-09-08 19:44:54.901 | INFO     | __main__:main:1697 - An error occurred: list index out of range
2024-09-08 19:44:54.901 | INFO     | __main__:main:1697 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1507, in main
    should_skip, skip_repo_url = should_skip_repo()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1367, in main
    repo = lean_git_repos[i]
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1165, in should_skip_repo
    os.remove(skip_file_path)  # Remove the file after reading
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1507, in main
    should_skip, skip_repo_url = should_skip_repo()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1165, in should_skip_repo
    os.remove(skip_file_path)  # Remove the file after reading
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
IndexError: list index out of range
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1507, in main
    should_skip, skip_repo_url = should_skip_repo()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1165, in should_skip_repo
    os.remove(skip_file_path)  # Remove the file after reading
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
[rank0]:[W908 19:46:48.676431910 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure t
hat any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warnin
g has only been added since PyTorch 2.4 (function operator())
(base) yingzi_ma@compute-permanent-node-345:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Did not find any active Ray processes.
[2024-09-08 19:51:31,052] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 19:51:34.939 | INFO     | __main__:main:1195 - Running progressive training
2024-09-08 19:51:34.939 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-08 19:51:34.942 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:51:34.942 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-08 19:51:34.942 | INFO     | __main__:main:1208 - Starting the main process
2024-09-08 19:51:34.942 | INFO     | __main__:main:1216 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
^Z
[2]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-345:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Did not find any active Ray processes.
[2024-09-08 19:51:53,125] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 19:51:57.074 | INFO     | __main__:main:1195 - Running progressive training
2024-09-08 19:51:57.075 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-08 19:51:57.077 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:51:57.077 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-08 19:51:57.078 | INFO     | __main__:main:1208 - Starting the main process
2024-09-08 19:51:57.078 | INFO     | __main__:main:1216 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 19:52:05.614 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:52:05.614 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:52:05.727 | INFO     | __main__:main:1218 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 19:52:05.727 | INFO     | __main__:main:1225 - Found 15 repositories
2024-09-08 19:52:05.727 | INFO     | __main__:main:1316 - Starting without curriculum learning
2024-09-08 19:52:06.103 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 19:52:22.634 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:52:38.108 | INFO     | __main__:main:1345 - Finding compatible repositories...
2024-09-08 19:52:38.108 | INFO     | __main__:main:1349 - Finished finding compatible repositories
2024-09-08 19:52:38.318 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:52:53.527 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:52:53.527 | INFO     | __main__:main:1368 - i: 0
2024-09-08 19:52:53.527 | INFO     | __main__:main:1374 - Main process
2024-09-08 19:52:53.527 | INFO     | __main__:main:1375 - Using lambda = 0.1
2024-09-08 19:52:53.527 | INFO     | __main__:main:1376 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 19:52:53.527 | INFO     | __main__:add_repo_to_database:889 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:52:53.527 | INFO     | __main__:main:1399 - Adding repo to repos_for_merged_dataset
2024-09-08 19:52:53.527 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:52:53.528 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:52:53.529 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:52:53.529 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:52:53.529 | INFO     | __main__:main:1424 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:52:55.705 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:52:55.814 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-08 19:52:55.814 | INFO     | __main__:main:1647 - Starting the prover
2024-09-08 19:52:55.814 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 19:52:55.815 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 19:52:55.815 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 19:52:55.815 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-s
mall/model_lightning.ckpt`
2024-09-08 19:52:56.012 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_
0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:52:56.013 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_
0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:52:58.072 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.enc
oder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retri
ever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.enc
oder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.la
yer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.enco
der.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseR
eluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.en
coder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.lay
er_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retri
ever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.S
elfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever
.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.la
yer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retr
iever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 're
triever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.l
ayer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight'
, 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7
.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'ret
riever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.
block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight
', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weig
ht', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.b
lock.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.
wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encod
er.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.
wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.enco
der.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.S
elfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'sta
te_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 19:52:58.449 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 19:52:58.450 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 19:52:58.451 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084
411853a576389ecf5/corpus.jsonl
2024-09-08 19:52:58.451 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:53:05.027 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 19:53:05.027 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/corpus.jsonl
2024-09-08 19:53:05.027 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 19:53:07,408 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
^Z
[3]+  Stopped                 bash run_code.sh
(base) yingzi_ma@compute-permanent-node-345:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Stopped only 0 out of 262 Ray processes within the grace period 16 seconds. Set `-v` to see more details. Remaining processes [psutil.Process(pid=1587255, name='raylet', status='zombie', started='19:53:06'), psutil.Process(pid=1587538, n
ame='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587606, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587643, name='python', status='terminated', started='19:53:11'), psutil.P
rocess(pid=1587482, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587571, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587454, name='ray::IDLE', status='terminated', start
ed='19:53:07'), psutil.Process(pid=1587531, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587431, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587599, name='python', statu
s='terminated', started='19:53:09'), psutil.Process(pid=1587636, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587583, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587595, na
me='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587773, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587564, name='python', status='terminated', started='19:53:08'), psutil.Proce
ss(pid=1587414, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587472, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587623, name='python', status='terminated', started='
19:53:10'), psutil.Process(pid=1587573, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587576, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587515, name='ray::IDLE', status='t
erminated', started='19:53:07'), psutil.Process(pid=1587567, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587485, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587695, nam
e='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587579, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587700, name='python', status='terminated', started='19:53:12'), psutil.Proces
s(pid=1587478, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587468, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587631, name='python', status='terminated', started='1
9:53:10'), psutil.Process(pid=1587456, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587620, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587525, name='ray::IDLE', status=
'terminated', started='19:53:07'), psutil.Process(pid=1587632, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587428, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587710, n
ame='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587776, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587594, name='python', status='terminated', started='19:53:09'), psutil.Proc
ess(pid=1587703, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587332, name='python', status='zombie', started='19:53:07'), psutil.Process(pid=1587696, name='python', status='terminated', started='19:53:12'
), psutil.Process(pid=1587556, name='ray::IDLE', status='terminated', started='19:53:08'), psutil.Process(pid=1587747, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587586, name='python', status='terminated
', started='19:53:09'), psutil.Process(pid=1587443, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587633, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587560, name='python
', status='terminated', started='19:53:08'), psutil.Process(pid=1587704, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587661, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=158
7511, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587552, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587423, name='ray::IDLE', status='terminated', started='19:53:07')
, psutil.Process(pid=1587654, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587537, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587450, name='ray::IDLE', status='terminated'
, started='19:53:07'), psutil.Process(pid=1587711, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587605, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587168, name='python', s
tatus='zombie', started='19:53:06'), psutil.Process(pid=1587609, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587570, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587547, na
me='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587430, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587487, name='ray::IDLE', status='terminated', started='19:53:07'), psutil
.Process(pid=1587598, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587410, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587424, name='ray::IDLE', status='terminated', sta
rted='19:53:07'), psutil.Process(pid=1587602, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587639, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587640, name='python', status
='terminated', started='19:53:11'), psutil.Process(pid=1587492, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587471, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=158732
8, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587582, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587691, name='python', status='terminated', started='19:53:12'), psutil.
Process(pid=1587702, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587575, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587484, name='python', status='terminated', started='1
9:53:07'), psutil.Process(pid=1587569, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587464, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587618, name='python', status='te
rminated', started='19:53:10'), psutil.Process(pid=1587692, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587477, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587457, name='r
ay::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587642, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587709, name='python', status='terminated', started='19:53:13'), psutil.Process
(pid=1587413, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587481, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587622, name='python', status='terminated', started='19
:53:10'), psutil.Process(pid=1587593, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587495, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587453, name='ray::IDLE', status='
terminated', started='19:53:07'), psutil.Process(pid=1587544, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587555, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587442, name=
'ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587498, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587420, name='ray::IDLE', status='terminated', started='19:53:07'), psutil
.Process(pid=1587772, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587590, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587167, name='python', status='zombie', started='19:5
3:05'), psutil.Process(pid=1587572, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587660, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587551, name='python', status='terminat
ed', started='19:53:08'), psutil.Process(pid=1587652, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587545, name='ray::IDLE', status='terminated', started='19:53:08'), psutil.Process(pid=1587449, name='ray:
:IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587514, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587426, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Proc
ess(pid=1587626, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587608, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587546, name='python', status='terminated', started='19:53
:08'), psutil.Process(pid=1587467, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587601, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587524, name='ray::IDLE', status='ter
minated', started='19:53:07'), psutil.Process(pid=1587549, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587638, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587649, name='py
thon', status='terminated', started='19:53:11'), psutil.Process(pid=1587510, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587490, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Proce
ss(pid=1587501, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587470, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587438, name='ray::IDLE', status='terminated', starte
d='19:53:07'), psutil.Process(pid=1587460, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587474, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587568, name='python', status
='terminated', started='19:53:08'), psutil.Process(pid=1587463, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587550, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587559,
name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587617, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587628, name='python', status='terminated', started='19:53:10'), psutil.Pro
cess(pid=1587717, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587444, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587480, name='ray::IDLE', status='terminated', started
='19:53:07'), psutil.Process(pid=1587504, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587634, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587746, name='python', status=
'terminated', started='19:53:13'), psutil.Process(pid=1587585, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587597, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587697, name
='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587624, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587421, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Proc
ess(pid=1587451, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587445, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587578, name='python', status='terminated', started=
'19:53:09'), psutil.Process(pid=1587589, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587491, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587581, name='python', status='
terminated', started='19:53:09'), psutil.Process(pid=1587651, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587707, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587663, name=
'python', status='terminated', started='19:53:11'), psutil.Process(pid=1587513, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587427, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Pr
ocess(pid=1587425, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587614, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587625, name='python', status='terminated', started='
19:53:10'), psutil.Process(pid=1587713, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587440, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587434, name='ray::IDLE', status
='terminated', started='19:53:07'), psutil.Process(pid=1587600, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587699, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587708, nam
e='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587548, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587592, name='python', status='terminated', started='19:53:09'), psutil.Proces
s(pid=1587648, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587604, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587489, name='ray::IDLE', status='terminated', started='19:5
3:07'), psutil.Process(pid=1587465, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587535, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587543, name='python', status='termi
nated', started='19:53:08'), psutil.Process(pid=1587554, name='ray::IDLE', status='terminated', started='19:53:08'), psutil.Process(pid=1587536, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587417, name='r
ay::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587459, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587483, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.P
rocess(pid=1587441, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587494, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587558, name='python', status='terminated', start
ed='19:53:08'), psutil.Process(pid=1587452, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587562, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587497, name='ray::IDLE', st
atus='terminated', started='19:53:07'), psutil.Process(pid=1587659, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587627, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587466,
 name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587781, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587476, name='ray::IDLE', status='terminated', started='19:53:07'), psu
til.Process(pid=1587611, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587540, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587437, name='ray::IDLE', status='terminated', sta
rted='19:53:07'), psutil.Process(pid=1587635, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587584, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587461, name='ray::IDLE', sta
tus='terminated', started='19:53:07'), psutil.Process(pid=1587637, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587577, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587580,
name='ray::IDLE', status='terminated', started='19:53:09'), psutil.Process(pid=1587532, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587432, name='ray::IDLE', status='terminated', started='19:53:07'), psut
il.Process(pid=1587662, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587641, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587436, name='ray::IDLE', status='terminated', star
ted='19:53:07'), psutil.Process(pid=1587462, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587712, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587596, name='python', stat
us='terminated', started='19:53:09'), psutil.Process(pid=1587565, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587644, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=1587473, n
ame='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587330, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587439, name='ray::IDLE', status='terminated', started='19:53:07'), psuti
l.Process(pid=1587574, name='ray::IDLE', status='terminated', started='19:53:09'), psutil.Process(pid=1587615, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587486, name='ray::IDLE', status='terminated', st
arted='19:53:07'), psutil.Process(pid=1587419, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587433, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587630, name='python',
 status='terminated', started='19:53:10'), psutil.Process(pid=1587479, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587591, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=15
87566, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587542, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587458, name='ray::IDLE', status='terminated', started='19:53:07'),
psutil.Process(pid=1587534, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587448, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587416, name='ray::IDLE', status='termina
ted', started='19:53:07'), psutil.Process(pid=1587446, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587616, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587694, name='pyt
hon', status='terminated', started='19:53:12'), psutil.Process(pid=1587607, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587588, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=
1587745, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587475, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587780, name='python', status='terminated', started='19:53:13')
, psutil.Process(pid=1587422, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587455, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587706, name='python', status='terminat
ed', started='19:53:13'), psutil.Process(pid=1587512, name='python', status='terminated', started='19:53:07'), psutil.Process(pid=1587698, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587539, name='ray::ID
LE', status='terminated', started='19:53:08'), psutil.Process(pid=1587774, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587415, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pi
d=1587705, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587553, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587655, name='python', status='terminated', started='19:53:11'),
 psutil.Process(pid=1587488, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587716, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587610, name='python', status='terminated',
 started='19:53:09'), psutil.Process(pid=1587701, name='python', status='terminated', started='19:53:12'), psutil.Process(pid=1587411, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587619, name='python',
 status='terminated', started='19:53:10'), psutil.Process(pid=1587469, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587435, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid
=1587603, name='python', status='terminated', started='19:53:09'), psutil.Process(pid=1587526, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587429, name='ray::IDLE', status='terminated', started='19:53:
07'), psutil.Process(pid=1587777, name='python', status='terminated', started='19:53:13'), psutil.Process(pid=1587557, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587418, name='ray::IDLE', status='termina
ted', started='19:53:07'), psutil.Process(pid=1587629, name='python', status='terminated', started='19:53:10'), psutil.Process(pid=1587412, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1587621, name='pyt
hon', status='terminated', started='19:53:10'), psutil.Process(pid=1587561, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587650, name='python', status='terminated', started='19:53:11'), psutil.Process(pid=
1587541, name='ray::IDLE', status='terminated', started='19:53:08'), psutil.Process(pid=1587563, name='python', status='terminated', started='19:53:08'), psutil.Process(pid=1587447, name='ray::IDLE', status='terminated', started='19:53:0
7'), psutil.Process(pid=1587493, name='ray::IDLE', status='terminated', started='19:53:07'), psutil.Process(pid=1586911, name='gcs_server', status='zombie', started='19:53:04')] will be forcefully terminated.
You can also use `--force` to forcefully terminate processes or set higher `--grace-period` to wait longer time for proper termination.
[2024-09-08 19:54:05,592] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 19:54:09.477 | INFO     | __main__:main:1195 - Running progressive training
2024-09-08 19:54:09.478 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-08 19:54:09.481 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:54:09.481 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-08 19:54:09.481 | INFO     | __main__:main:1208 - Starting the main process
2024-09-08 19:54:09.481 | INFO     | __main__:main:1216 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 19:54:17.994 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:54:17.994 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-08 19:54:18.106 | INFO     | __main__:main:1218 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 19:54:18.106 | INFO     | __main__:main:1225 - Found 15 repositories
2024-09-08 19:54:18.106 | INFO     | __main__:main:1316 - Starting without curriculum learning
2024-09-08 19:54:18.308 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-08 19:54:35.163 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:54:50.572 | INFO     | __main__:main:1345 - Finding compatible repositories...
2024-09-08 19:54:50.572 | INFO     | __main__:main:1349 - Finished finding compatible repositories
2024-09-08 19:54:50.601 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:55:05.927 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:55:05.927 | INFO     | __main__:main:1368 - i: 0
2024-09-08 19:55:05.927 | INFO     | __main__:main:1374 - Main process
2024-09-08 19:55:05.927 | INFO     | __main__:main:1375 - Using lambda = 0.1
2024-09-08 19:55:05.927 | INFO     | __main__:main:1376 - Processing https://github.com/avigad/mathematics_in_lean_source
2024-09-08 19:55:05.927 | INFO     | __main__:add_repo_to_database:889 - Processing https://github.com/avigad/mathematics_in_lean_source.git
2024-09-08 19:55:05.927 | INFO     | __main__:main:1399 - Adding repo to repos_for_merged_dataset
2024-09-08 19:55:05.927 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:55:05.928 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:55:05.928 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:55:05.928 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:55:05.928 | INFO     | __main__:main:1424 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:55:07.928 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:55:08.030 | INFO     | __main__:main:1507 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:55:08.128 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:55:17.887 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:55:17.902 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:55:17.916 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:55:17.916 | INFO     | __main__:main:1535 - Training dataset size after load: 178959
2024-09-08 19:55:17.916 | INFO     | __main__:main:1536 - Validation dataset size after load: 2509
2024-09-08 19:55:17.916 | INFO     | __main__:main:1537 - Testing dataset size after load: 2723
2024-09-08 19:55:17.916 | INFO     | __main__:main:1539 - Starting progressive training from epoch 0 to 1
2024-09-08 19:55:17.916 | INFO     | __main__:main:1542 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 19:55:23,427] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 19:55:23,428] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 19:55:23,428] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 19:55:27.505 | INFO     | __main__:main:1195 - Running progressive training
2024-09-08 19:55:27.505 | INFO     | __main__:main:1195 - Running progressive training
2024-09-08 19:55:27.505 | INFO     | __main__:main:1195 - Running progressive training
2024-09-08 19:55:27.505 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-08 19:55:27.505 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-08 19:55:27.505 | INFO     | __main__:main:1201 - Configuring LeanDojo...
2024-09-08 19:55:27.508 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:55:27.508 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:55:27.508 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 19:55:27.508 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-08 19:55:27.508 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-08 19:55:27.508 | INFO     | __main__:main:1203 - LeanDojo configured
2024-09-08 19:55:27.508 | INFO     | __main__:main:1225 - Found 15 repositories
2024-09-08 19:55:27.508 | INFO     | __main__:main:1225 - Found 15 repositories
2024-09-08 19:55:27.508 | INFO     | __main__:main:1225 - Found 15 repositories
2024-09-08 19:55:27.508 | INFO     | __main__:main:1316 - Starting without curriculum learning
2024-09-08 19:55:27.509 | INFO     | __main__:main:1316 - Starting without curriculum learning
2024-09-08 19:55:27.509 | INFO     | __main__:main:1316 - Starting without curriculum learning
2024-09-08 19:55:27.695 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:55:27.710 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:55:27.716 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 19:55:43.371 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:55:43.414 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:55:43.789 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 19:55:58.485 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:55:58.486 | INFO     | __main__:main:1368 - i: 0
2024-09-08 19:55:58.486 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:55:58.487 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:55:58.487 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:55:58.487 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:55:58.487 | INFO     | __main__:main:1424 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:55:58.813 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:55:58.813 | INFO     | __main__:main:1368 - i: 0
2024-09-08 19:55:58.813 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:55:58.814 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:55:58.814 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:55:58.814 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:55:58.814 | INFO     | __main__:main:1424 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:55:59.344 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:55:59.344 | INFO     | __main__:main:1368 - i: 0
2024-09-08 19:55:59.345 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:55:59.345 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:55:59.346 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:55:59.346 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:55:59.346 | INFO     | __main__:main:1424 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:56:01.060 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:01.167 | INFO     | __main__:main:1507 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-08 19:56:01.203 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:01.247 | INFO     | __main__:main:1507 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:56:01.265 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:56:01.345 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:56:01.511 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:01.557 | INFO     | __main__:main:1507 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be dep
racted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 19:56:01.656 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:56:12.171 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:56:12.185 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:12.199 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:56:12.199 | INFO     | __main__:main:1535 - Training dataset size after load: 178959
2024-09-08 19:56:12.199 | INFO     | __main__:main:1536 - Validation dataset size after load: 2509
2024-09-08 19:56:12.199 | INFO     | __main__:main:1537 - Testing dataset size after load: 2723
2024-09-08 19:56:12.199 | INFO     | __main__:main:1539 - Starting progressive training from epoch 0 to 1
2024-09-08 19:56:12.200 | INFO     | __main__:main:1542 - hit the barrier before training
2024-09-08 19:56:12.420 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-08 19:56:12.432 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:12.446 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:56:12.447 | INFO     | __main__:main:1535 - Training dataset size after load: 178959
2024-09-08 19:56:12.447 | INFO     | __main__:main:1536 - Validation dataset size after load: 2509
2024-09-08 19:56:12.447 | INFO     | __main__:main:1537 - Testing dataset size after load: 2723
2024-09-08 19:56:12.447 | INFO     | __main__:main:1539 - Starting progressive training from epoch 0 to 1
2024-09-08 19:56:12.447 | INFO     | __main__:main:1542 - hit the barrier before training
2024-09-08 19:56:12.678 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:56:12.691 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:12.705 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:56:12.705 | INFO     | __main__:main:1535 - Training dataset size after load: 178959
2024-09-08 19:56:12.705 | INFO     | __main__:main:1536 - Validation dataset size after load: 2509
2024-09-08 19:56:12.705 | INFO     | __main__:main:1537 - Testing dataset size after load: 2723
2024-09-08 19:56:12.705 | INFO     | __main__:main:1539 - Starting progressive training from epoch 0 to 1
2024-09-08 19:56:12.705 | INFO     | __main__:main:1542 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 19:56:17.091 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:56:17.186 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:17.204 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is not e
mpty.
2024-09-08 19:56:17.229 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:56:17.318 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:17.334 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 19:56:17.568 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
2024-09-08 19:56:17.635 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178959
2024-09-08 19:56:17.658 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:17.675 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Training dataset size: 178959
2024-09-08 19:56:17.723 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_val/cached_data.pkl
Validation dataset size: 2509
2024-09-08 19:56:17.739 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c
0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 19:56:18.990 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 19:56:18.991 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 19:56:18.992 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 19:56:18.992 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-08 19:56:21.120 | INFO     | __main__:main:1545 - hit the barrier after training
2024-09-08 19:56:21.296 | INFO     | __main__:main:1545 - hit the barrier after training
2024-09-08 19:56:21.555 | INFO     | __main__:main:1545 - hit the barrier after training
2024-09-08 19:56:21.606 | INFO     | __main__:main:1545 - hit the barrier after training
2024-09-08 19:56:21.607 | INFO     | __main__:main:1551 - Finished progressive training at epoch 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1551 - Finished progressive training at epoch 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1701 - current epoch: 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1551 - Finished progressive training at epoch 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1551 - Finished progressive training at epoch 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:56:21.607 | INFO     | __main__:main:1701 - current epoch: 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1701 - current epoch: 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1368 - i: 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1647 - Starting the prover
2024-09-08 19:56:21.607 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:56:21.607 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:56:21.607 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:56:21.607 | INFO     | __main__:main:1368 - i: 1
2024-09-08 19:56:21.607 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 19:56:21.607 | INFO     | __main__:main:1368 - i: 1
2024-09-08 19:56:21.607 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:56:21.607 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 19:56:21.607 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:56:21.607 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-08 19:56:21.608 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c
6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:56:21.608 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:56:21.608 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:56:21.608 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:56:21.608 | INFO     | __main__:main:1424 - Starting training at epoch 1
2024-09-08 19:56:21.608 | INFO     | __main__:main:1424 - Starting training at epoch 1
2024-09-08 19:56:21.608 | INFO     | __main__:main:1424 - Starting training at epoch 1
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-s
mall/model_lightning.ckpt`
2024-09-08 19:56:22.267 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_
0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:22.267 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_
0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:23.546 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:23.650 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-08 19:56:24.042 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:24.042 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
2024-09-08 19:56:24.083 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-08 19:56:24.083 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-08 19:56:24.910 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.enc
oder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retri
ever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.enc
oder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.la
yer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.enco
der.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseR
eluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.en
coder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.lay
er_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retri
ever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.S
elfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever
.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.la
yer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retr
iever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 're
triever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.l
ayer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight'
, 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7
.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'ret
riever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.
block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight
', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weig
ht', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.b
lock.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.
wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encod
er.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.
wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.enco
der.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.S
elfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'sta
te_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 19:56:25.546 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 19:56:25.547 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 19:56:25.547 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084
411853a576389ecf5/corpus.jsonl
2024-09-08 19:56:25.548 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf
5/corpus.jsonl
2024-09-08 19:56:34.668 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 19:56:34.669 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/corpus.jsonl
2024-09-08 19:56:34.669 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 19:56:37,312 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=1625701) [2024-09-08 19:57:11,972] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1625701) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1625701)   return torch.load(io.BytesIO(b))
(pid=1625845) [2024-09-08 19:57:23,348] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1625845) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1625845)   return torch.load(io.BytesIO(b))
(pid=1626030) [2024-09-08 19:57:33,077] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1626030) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1626030)   return torch.load(io.BytesIO(b))
(pid=1626207) [2024-09-08 19:57:41,315] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1626207) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a futur
e release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explici
tly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issu
es related to this experimental feature.
(ProverActor pid=1626207)   return torch.load(io.BytesIO(b))
2024-09-08 19:57:54.473 | INFO     | __main__:main:1681 - Finished searching for proofs of sorry theorems
2024-09-08 19:57:54.473 | INFO     | __main__:main:1701 - current epoch: 1
2024-09-08 19:57:54.473 | INFO     | __main__:main:1367 - length of lean_git_repos: 2
2024-09-08 19:57:54.473 | INFO     | __main__:main:1368 - i: 1
2024-09-08 19:57:54.473 | INFO     | __main__:main:1374 - Main process
2024-09-08 19:57:54.473 | INFO     | __main__:main:1375 - Using lambda = 0.1
2024-09-08 19:57:54.474 | INFO     | __main__:main:1376 - Processing https://github.com/teorth/pfr
2024-09-08 19:57:54.474 | INFO     | __main__:add_repo_to_database:889 - Processing https://github.com/teorth/pfr.git
2024-09-08 19:57:54.475 | INFO     | __main__:main:1392 - Writing skip file for https://github.com/teorth/pfr
2024-09-08 19:57:54.475 | INFO     | __main__:main:1399 - Adding repo to repos_for_merged_dataset
2024-09-08 19:57:54.475 | INFO     | __main__:main:1410 - All GPUs
2024-09-08 19:57:54.476 | INFO     | __main__:find_latest_checkpoint:515 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a268
7_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 19:57:54.476 | INFO     | __main__:main:1417 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-
Recall@10_val=0.00.ckpt
2024-09-08 19:57:54.476 | INFO     | __main__:main:1423 - Inside train_test_fisher
2024-09-08 19:57:54.476 | INFO     | __main__:main:1424 - Starting training at epoch 1
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impli
citly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the defau
lt value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by t
he user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this e
xperimental feature.
2024-09-08 19:57:55.977 | INFO     | __main__:main:1448 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch
=0-Recall@10_val=0.00.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLUR
M, prepend your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 19:57:56.098 | INFO     | __main__:main:1507 - right before barrier for data module
2024-09-08 19:57:56.099 | INFO     | __main__:main:1511 - Skipping repository https://github.com/teorth/pfr due to preprocessing issues
2024-09-08 19:57:56.099 | INFO     | __main__:main:1703 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
2024-09-08 19:57:56.099 | INFO     | __main__:main:1703 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
2024-09-08 19:57:56.100 | INFO     | __main__:main:1703 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1509, in main
    should_skip, skip_repo_url = should_skip_repo()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1167, in should_skip_repo
    os.remove(skip_file_path)  # Remove the file after reading
Traceback (most recent call last):
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1509, in main
    should_skip, skip_repo_url = should_skip_repo()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1167, in should_skip_repo
    os.remove(skip_file_path)  # Remove the file after reading
Traceback (most recent call last):
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1509, in main
    should_skip, skip_repo_url = should_skip_repo()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1167, in should_skip_repo
    os.remove(skip_file_path)  # Remove the file after reading
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/skip_repo.txt'

