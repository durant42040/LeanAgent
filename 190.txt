2024-10-27 13:50:33.500 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 92.68518518518518
2024-10-27 13:50:33.501 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 92.68518518518518
2024-10-27 13:50:33.501 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 92.68518518518518
2024-10-27 13:50:33.502 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 92.68518518518518
2024-10-27 13:50:33.503 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 92.68518518518518
2024-10-27 13:50:33.504 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 92.68518518518518
2024-10-27 13:50:33.504 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 92.68518518518518
2024-10-27 13:50:33.505 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 92.68518518518518
2024-10-27 13:50:33.506 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 92.68518518518518
2024-10-27 13:50:33.506 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 92.68518518518518
2024-10-27 13:50:33.507 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 92.68518518518518
2024-10-27 13:50:33.508 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 94.07407407407408
2024-10-27 13:50:33.508 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 94.07407407407408
2024-10-27 13:50:33.509 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 94.07407407407408
2024-10-27 13:50:33.510 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 94.07407407407408
2024-10-27 13:50:33.510 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 94.07407407407408
2024-10-27 13:50:33.511 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 94.07407407407408
2024-10-27 13:50:33.512 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 94.07407407407408
2024-10-27 13:50:33.512 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 94.07407407407408
2024-10-27 13:50:33.513 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 94.07407407407408
2024-10-27 13:50:33.513 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 94.07407407407408
2024-10-27 13:50:33.514 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 94.07407407407408
2024-10-27 13:50:33.515 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 94.07407407407408
2024-10-27 13:50:33.515 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 94.07407407407408
2024-10-27 13:50:33.516 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 94.76851851851852
2024-10-27 13:50:33.517 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 94.76851851851852
2024-10-27 13:50:33.517 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 94.76851851851852
2024-10-27 13:50:33.518 | INFO     | retrieval.model:validation_step:379 - MRR: 0.632692778432721
2024-10-27 13:50:33.519 | INFO     | retrieval.model:validation_step:387 - End of validation_step
Epoch 16: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10305/10305 [1:18:37<00:00,  2.18it/s, v_num=4][
rank: 1] Monitored metric Recall@10_val did not improve in the last 7 records. Best score: 78.269. Signaling Trainer to stop.
[rank: 3] Monitored metric Recall@10_val did not improve in the last 7 records. Best score: 78.269. Signaling Trainer to stop.
[rank: 2] Monitored metric Recall@10_val did not improve in the last 7 records. Best score: 78.269. Signaling Trainer to stop.
[rank: 0] Monitored metric Recall@10_val did not improve in the last 7 records. Best score: 78.269. Signaling Trainer to stop.
Epoch 16, global step 35045: 'Recall@10_val' reached 68.00508 (best 78.26855), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749
af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt' as top 17
`Trainer.fit` stopped: `max_epochs=17` reached.
Epoch 16: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10305/10305 [1:19:10<00:00,  2.17it/s, v_num=4]
2024-10-27 13:51:10.226 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 13:51:10.419 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 13:51:10.506 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 13:51:10.536 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 13:51:10.537 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 13:51:10.537 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 13:51:10.537 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 13:51:10.537 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 13:51:10.538 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:10.538 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 13:51:20.395 | INFO     | __main__:main:1707 - Testing...
2024-10-27 13:51:20.398 | INFO     | retrieval.main:run_cli:60 - PID: 1708145
2024-10-27 13:51:20.432 | INFO     | __main__:main:1707 - Testing...
2024-10-27 13:51:20.433 | INFO     | retrieval.main:run_cli:60 - PID: 1715276
2024-10-27 13:51:20.434 | INFO     | __main__:main:1707 - Testing...
2024-10-27 13:51:20.434 | INFO     | retrieval.main:run_cli:60 - PID: 1715275
2024-10-27 13:51:20.437 | INFO     | __main__:main:1707 - Testing...
2024-10-27 13:51:20.437 | INFO     | retrieval.main:run_cli:60 - PID: 1715274
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-27 13:51:20.823 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af29
7c6cf37/random
2024-10-27 13:51:20.823 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af
297c6cf37/corpus.jsonl
2024-10-27 13:51:20.838 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af29
7c6cf37/random
2024-10-27 13:51:20.838 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af
297c6cf37/corpus.jsonl
2024-10-27 13:51:20.839 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af29
7c6cf37/random
2024-10-27 13:51:20.839 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af
297c6cf37/corpus.jsonl
2024-10-27 13:51:20.840 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af29
7c6cf37/random
2024-10-27 13:51:20.840 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af
297c6cf37/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to ru
n Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-27 13:51:37.442 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 13:51:39.112 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 13:51:39.947 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 13:51:39.973 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 13:51:40.129 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 13:51:41.876 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 13:51:41.903 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 13:51:42.469 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01
.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.
ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-27 13:51:46.003 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 13:51:46.004 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1709 [00:00<?, ?it/s]2
024-10-27 13:51:46.096 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 13:51:46.097 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/1709 [00:00<01:59, 14.30it/s]2
024-10-27 13:51:46.162 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 13:51:46.163 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2
024-10-27 13:51:46.559 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 13:51:46.560 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:00<00:00,  3.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:02<00:00,  3.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:03<00:00,  3.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 1705/1709 [09:04<00:01,  2.24it/s]/
data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:06<00:00,  3.13it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:28<00:00,  0.36it/s]2
024-10-27 14:01:15.602 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:01:15.603 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:01:15.773 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-27 14:01:15.773 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:01:15.780 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-27 14:01:15.780 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:01:23.971 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:01:23.971 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:01:24.137 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-27 14:01:24.137 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:01:24.143 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-27 14:01:24.143 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:01:24.144 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:36<00:00,  0.27it/s]
2024-10-27 14:01:24.929 | INFO     | retrieval.main:run_cli:60 - PID: 1715274
2024-10-27 14:01:25.029 | INFO     | retrieval.main:run_cli:60 - PID: 1715275
2024-10-27 14:01:25.069 | INFO     | retrieval.main:run_cli:60 - PID: 1715276
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-27 14:01:25.342 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a9843
6d50dd7abd00/random
2024-10-27 14:01:25.342 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98
436d50dd7abd00/corpus.jsonl
[rank: 2] Seed set to 3407
2024-10-27 14:01:25.401 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a9843
6d50dd7abd00/random
2024-10-27 14:01:25.401 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98
436d50dd7abd00/corpus.jsonl
2024-10-27 14:01:25.443 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a9843
6d50dd7abd00/random
2024-10-27 14:01:25.443 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98
436d50dd7abd00/corpus.jsonl
2024-10-27 14:01:25.648 | INFO     | __main__:main:1729 - Loaded the predictions pickle files
2024-10-27 14:01:25.686 | INFO     | __main__:main:1732 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/test.jso
n
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1477/1477 [00:00<00:00, 45197.77it/s]
2024-10-27 14:01:25.719 | INFO     | __main__:main:1734 - R@1 = 25.069099892664486 %, R@10 = 63.68486599447781 %, MRR = 0.5325384690631922
2024-10-27 14:01:25.721 | INFO     | retrieval.main:run_cli:60 - PID: 1708145
[rank: 0] Seed set to 3407
2024-10-27 14:01:26.066 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a9843
6d50dd7abd00/random
2024-10-27 14:01:26.066 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98
436d50dd7abd00/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-27 14:01:41.094 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146488
2024-10-27 14:01:41.116 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2165
2024-10-27 14:01:41.157 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146488
2024-10-27 14:01:41.171 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2165
2024-10-27 14:01:41.866 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146488
2024-10-27 14:01:41.881 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2165
2024-10-27 14:01:45.320 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_train/cached_data.pkl
Training dataset size: 146488
2024-10-27 14:01:45.338 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b
88b44a98436d50dd7abd00/random/cache_pred/cached_data.pkl
Testing dataset size: 2165
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01
.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.
ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-27 14:01:48.489 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 14:01:48.490 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1988 [00:00<?, ?it/s]2
024-10-27 14:01:48.548 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 14:01:48.556 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/1988 [00:00<02:38, 12.50it/s]2
024-10-27 14:01:48.736 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 14:01:48.738 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]2
024-10-27 14:01:49.183 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-27 14:01:49.184 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1988/1988 [09:19<00:00,  3.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1988/1988 [09:21<00:00,  3.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1988/1988 [09:22<00:00,  3.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1988/1988 [09:25<00:00,  3.52it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:24<00:00,  0.37it/s]2
024-10-27 14:11:33.659 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:11:33.660 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:11:33.843 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-27 14:11:33.843 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:11:33.853 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-27 14:11:33.853 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:11:34.473 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:11:34.623 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-27 14:11:34.623 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:11:35.078 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-27 14:11:35.244 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-27 14:11:35.245 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-27 14:11:35.245 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:26<00:00,  0.34it/s]
2024-10-27 14:11:36.168 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 14:11:36.169 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 14:11:36.169 | INFO     | __main__:main:1507 - length of lean_git_repos: 8
2024-10-27 14:11:36.169 | INFO     | __main__:main:1508 - i: 2
2024-10-27 14:11:36.169 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 14:11:36.172 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:36.172 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:36.172 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 14:11:36.172 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 3] Seed set to 3407
2024-10-27 14:11:36.248 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 14:11:36.248 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 14:11:36.248 | INFO     | __main__:main:1507 - length of lean_git_repos: 8
2024-10-27 14:11:36.249 | INFO     | __main__:main:1508 - i: 2
2024-10-27 14:11:36.249 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 14:11:36.251 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:36.251 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:36.251 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 14:11:36.251 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 2] Seed set to 3407
2024-10-27 14:11:36.268 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 14:11:36.268 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 14:11:36.268 | INFO     | __main__:main:1507 - length of lean_git_repos: 8
2024-10-27 14:11:36.269 | INFO     | __main__:main:1508 - i: 2
2024-10-27 14:11:36.269 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 14:11:36.271 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:36.271 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:36.271 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 14:11:36.271 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 1] Seed set to 3407
2024-10-27 14:11:37.049 | INFO     | __main__:main:1729 - Loaded the predictions pickle files
2024-10-27 14:11:37.103 | INFO     | __main__:main:1732 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_miniF2F-lean4_9e445f5435407f014b88b44a98436d50dd7abd00/random/tes
t.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1426/1426 [00:00<00:00, 35394.13it/s]
2024-10-27 14:11:37.146 | INFO     | __main__:main:1734 - R@1 = 26.798953549129976 %, R@10 = 68.32783261329486 %, MRR = 0.5951998766872729
2024-10-27 14:11:37.147 | INFO     | __main__:main:1749 - Average R@1 = 25.93402672089723 %, R@10 = 66.00634930388634 %, MRR = 0.5638691728752325
2024-10-27 14:11:37.148 | INFO     | __main__:main:1786 - Starting the prover
2024-10-27 14:11:37.148 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-10-27 14:11:37.148 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-10-27 14:11:37.148 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-10-27 14:11:37.149 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b90
7190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-10-27 14:11:38.230 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749a
f297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:38.230 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749a
f297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:38.487 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:38.601 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 14:11:38.949 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:38.995 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 14:11:41.948 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
2024-10-27 14:11:42.032 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 14:11:42.155 | INFO     | __main__:main:1645 - right before barrier for data module
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 're
triever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.l
ayer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.b
lock.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.laye
r.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention
.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retrie
ver.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.
encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.blo
ck.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm
.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'ret
riever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.
encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_
1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retri
ever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.e
ncoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfA
ttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight',
 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 're
triever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.
1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.la
yer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weigh
t', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.
encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encod
er.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluD
ense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriev
er.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encod
er.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.blo
ck.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer
.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.Dense
ReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_s
tep', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-10-27 14:11:42.993 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-10-27 14:11:42.995 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-10-27 14:11:42.995 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce74
9af297c6cf37/corpus.jsonl
2024-10-27 14:11:52.136 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749
af297c6cf37/corpus.jsonl
2024-10-27 14:11:52.136 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3417/3417 [05:15<00:00, 10.85it/s]
2024-10-27 14:17:07.146 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-10-27 14:17:07.146 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
(autoscaler +8h28m23s) Tip: use `ray status` to view detailed cluster status. To disable these messages, set RAY_SCHEDULER_EVENTS=0.
(autoscaler +8h28m23s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +8h28m50s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
2024-10-27 14:18:39.655 | INFO     | __main__:prove_sorry_theorems:882 - Found 24 sorry theorems to prove
Processing theorems from fpvandoorn/carleson:   0%|                                                                                                                                          | 0/24 [00:00<?, ?theorem/s]2
024-10-27 14:18:39.655 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for card_le_of_le_dist
2024-10-27 14:18:39.655 | INFO     | __main__:prove_sorry_theorems:906 - Position: (116, 1)
2024-10-27 14:18:39.655 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for prop2_2
2024-10-27 14:18:39.655 | INFO     | __main__:prove_sorry_theorems:906 - Position: (36, 1)
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for partialFourierSum_eq_conv_dirichletKernel'
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:906 - Position: (198, 1)
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for dirichletKernel'_periodic
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:906 - Position: (22, 1)
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for dirichletKernel_periodic
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:906 - Position: (19, 1)
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for theorem1_2C'
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:906 - Position: (203, 1)
2024-10-27 14:18:39.656 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for volume_ball_le_same
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:906 - Position: (53, 1)
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for fourier_uniformContinuous
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:906 - Position: (99, 1)
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for Hilbert_kernel_regularity
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:906 - Position: (277, 1)
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for prop2_3
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:906 - Position: (35, 1)
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for partialFourierSum_uniformContinuous
2024-10-27 14:18:39.657 | INFO     | __main__:prove_sorry_theorems:906 - Position: (105, 1)
2024-10-27 14:18:39.658 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for theorem1_2C
2024-10-27 14:18:39.658 | INFO     | __main__:prove_sorry_theorems:906 - Position: (191, 1)
2024-10-27 14:18:39.658 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(pid=1720746) [2024-10-27 14:18:50,823] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=1720746) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untruste
d-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be a
llowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have
full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=1720746)   return torch.load(io.BytesIO(b))
(ProverActor pid=1720748) 2024-10-27 14:19:08.786 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='card_le_of_le_dist')
(ProverActor pid=1720772) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untruste
d-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be a
llowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have
full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature. [repeated 3x across cluster]
(ProverActor pid=1720772)   return torch.load(io.BytesIO(b)) [repeated 3x across cluster]
(ProverActor pid=1720772) 2024-10-27 14:19:09.078 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="partialFourierSum_eq_conv_dirichletKernel'")
(ProverActor pid=1720746) 2024-10-27 14:19:09.782 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Proposition2.lean'), full_name='prop2_2')
(ProverActor pid=1720764) 2024-10-27 14:19:10.028 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="dirichletKernel'_periodic")
(ProverActor pid=1720746) 2024-10-27 14:19:44.915 | INFO     | lean_dojo.utils:execute:88 -
(ProverActor pid=1720746) 2024-10-27 14:19:44.915 | ERROR    | lean_dojo.utils:execute:89 - error: ./.lake/packages/mathlib/lakefile.lean:79:2: error: unknown attribute [test_runner]
(ProverActor pid=1720746) error: ./.lake/packages/mathlib/lakefile.lean: package configuration has errors
(ProverActor pid=1720746)
(ProverActor pid=1720772)
(ProverActor pid=1720764)
(ProverActor pid=1720748)
Processing theorems from fpvandoorn/carleson:  46%|███████████████████████████████████████████████████████████▏                                                                     | 11/24 [01:09<01:22,  6.34s/theorem]
2024-10-27 14:19:49.450 | INFO     | __main__:main:1843 - An error occurred: ray::ProverActor.search() (pid=1720772, ip=10.0.5.69, actor_id=8ac7596b83f80bbbfd0c0fd401000000, repr=<prover.proof_search.ProverActor object
 at 0x72f5ead00700>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1817, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_merged_dataset)
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 919, in prove_sorry_theorems
    process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 804, in process_theorem_batch
    results = prover.search_unordered(LeanGitRepo(repo.url, repo.commit), lean_dojo_theorems, positions_batch)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 514, in search_unordered
    results = list(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 170, in get_generator
    yield self.get_next_unordered()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 370, in get_next_unordered
    return ray.get(future)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 2691, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 871, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(CalledProcessError): ray::ProverActor.search() (pid=1720772, ip=10.0.5.69, actor_id=8ac7596b83f80bbbfd0c0fd401000000, repr=<prover.proof_search.ProverActor object at 0x72f5ead00700>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(ProverActor pid=1720772) 2024-10-27 14:19:49.452 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name='dirichletKernel_periodic')
(ProverActor pid=1720748) 2024-10-27 14:19:44.916 | INFO     | lean_dojo.utils:execute:88 -  [repeated 3x across cluster]
(ProverActor pid=1720748) 2024-10-27 14:19:44.916 | ERROR    | lean_dojo.utils:execute:89 - error: ./.lake/packages/mathlib/lakefile.lean:79:2: error: unknown attribute [test_runner] [repeated 3x across cluster]
(ProverActor pid=1720748) error: ./.lake/packages/mathlib/lakefile.lean: package configuration has errors [repeated 3x across cluster]
2024-10-27 14:19:50,410 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=1720746, ip=10.0.5.69, actor_id=ed9d5bd5dacf22097dee532101000000, repr=<pro
ver.proof_search.ProverActor object at 0x744b6074a200>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
2024-10-27 14:19:50,411 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=1720764, ip=10.0.5.69, actor_id=8b6446b3f33d3b9600ffc29201000000, repr=<pro
ver.proof_search.ProverActor object at 0x7e8656d8aec0>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
2024-10-27 14:19:50,580 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=1720748, ip=10.0.5.69, actor_id=3ac3b6e0d69ce4cf9a978e6c01000000, repr=<pro
ver.proof_search.ProverActor object at 0x78a401c4c700>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(pid=1720748) [2024-10-27 14:18:50,824] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect) [repeated 3x across cluster]
(base) yingzi_ma@compute-permanent-node-326:~/lean_project/ReProver$ bash run_codefull.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
kill: (6982): Operation not permitted
kill: (8964): Operation not permitted
kill: (9312): Operation not permitted
kill: (10483): Operation not permitted
kill: (11676): Operation not permitted
kill: (11677): Operation not permitted
kill: (11678): Operation not permitted
kill: (11687): Operation not permitted
kill: (11955): Operation not permitted
kill: (12125): Operation not permitted
kill: (12126): Operation not permitted
kill: (12127): Operation not permitted
kill: (12134): Operation not permitted
kill: (12686): Operation not permitted
kill: (12703): Operation not permitted
kill: (12704): Operation not permitted
kill: (12705): Operation not permitted
kill: (12712): Operation not permitted
kill: (2083655): No such process
Sun Oct 27 15:24:51 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   40C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   38C    P0             85W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:8C:00.0 Off |                    0 |
| N/A   38C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:91:00.0 Off |                    0 |
| N/A   37C    P0             85W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running mainfull.py
[2024-10-27 15:24:59,732] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-27 15:25:03.870 | INFO     | __main__:main:1317 - Running progressive training
2024-10-27 15:25:03.870 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-27 15:25:03.873 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-27 15:25:03.873 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-27 15:25:03.873 | INFO     | __main__:main:1330 - Starting the main process
2024-10-27 15:25:03.874 | INFO     | __main__:main:1338 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_full.json
2024-10-27 15:25:16.741 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-27 15:25:16.741 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-27 15:25:21.557 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 15:25:21.557 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 15:25:21.751 | INFO     | __main__:main:1340 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_full.json
2024-10-27 15:25:21.752 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-27 15:25:21.752 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-27 15:25:21.753 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-27 15:25:22.146 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-27 15:25:41.620 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-10-27 15:26:01.085 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-27 15:26:20.711 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-27 15:26:40.862 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:26:40.862 | INFO     | __main__:main:1508 - i: 0
2024-10-27 15:26:40.862 | INFO     | __main__:main:1514 - Main process
2024-10-27 15:26:40.862 | INFO     | __main__:main:1515 - Using lambda = 0.1
2024-10-27 15:26:40.862 | INFO     | __main__:main:1516 - Processing https://github.com/fpvandoorn/carleson
2024-10-27 15:26:40.863 | INFO     | __main__:add_repo_to_database:956 - Processing https://github.com/fpvandoorn/carleson.git
2024-10-27 15:26:40.863 | INFO     | __main__:add_repo_to_database:1036 - Found compatible commit bec7808b907190882fa1fa54ce749af297c6cf37 for https://github.com/fpvandoorn/carleson.git
2024-10-27 15:26:40.863 | INFO     | __main__:add_repo_to_database:1037 - Lean version: v4.8.0-rc1
2024-10-27 15:26:40.863 | INFO     | __main__:add_repo_to_database:1042 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa54ce749af297c6cf37
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc1\n'}
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc1
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-10-27 15:26:40.863 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-10-27 15:26:40.864 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-10-27 15:26:40.865 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-10-27 15:26:40.865 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-10-27 15:26:40.941 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-10-27 15:26:40.941 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6cf37')
2024-10-27 15:26:40.941 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-10-27 15:26:40.947 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-27 15:26:40.947 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-10-27 15:26:40.947 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-10-27 15:26:40.950 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-10-27 15:26:40.950 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/fpvandoorn-carleson-bec7808b907190882fa1fa54ce749af297c6cf37/c
arleson
2024-10-27 15:26:42.234 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1125 - Loading 2866 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/fpvandoorn-carleson-bec7808b907190882fa1
fa54ce749af297c6cf37/carleson with 31 workers
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2866/286
6 [06:16<00:00,  7.61it/s]
2024-10-27 15:32:58.640 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af2
97c6cf37')
2024-10-27 15:33:00.158 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-10-27 15:33:20.815 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-27 15:33:21.927 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-27 15:33:24.487 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for mathlib4 master
2024-10-27 15:34:09.491 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.13.0-rc3
2024-10-27 15:34:28.523 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-10-27 15:34:29.228 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.13.0-rc1
2024-10-27 15:34:47.936 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='6264905204f3ed595bc990
32ec15af1910a0eddd')
2024-10-27 15:34:49.336 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-10-27 15:35:08.992 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0
2024-10-27 15:35:28.051 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='d36b7fd4c730cae8a3a8edfe98beb34e
f0fc6e0a')
2024-10-27 15:35:28.701 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-10-27 15:35:48.432 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-10-27 15:36:08.196 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-10-27 15:36:10.545 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupported
 Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-10-27 15:36:22.359 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1010 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882f
a1fa54ce749af297c6cf37'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='4cb90dddfcb8ceda2b89711d567d593e1fd07090'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-co
mmunity/batteries', commit='dc72dcdb8e97b3c56bd70f06f043ed2dee3258e6'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='1357f4f49450abb9dfd4783e38219f4ce84f9785'), 'aesop': LeanGitRepo(u
rl='https://github.com/leanprover-community/aesop', commit='9ac12945862fa39eab7795c2f79bb9aa0c8e332c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='baa65c6339a56bd22
b7292aa4511c54b3cc7a6af'), 'Cli': LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4'
, commit='6264905204f3ed595bc99032ec15af1910a0eddd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0ea83a676d288220ba227808568cbb80fe43ace0'), 'LeanSearchClient': LeanG
itRepo(url='https://github.com/leanprover-community/LeanSearchClient', commit='7bedaed1ef024add1e171cc17706b012a9a37802'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='d36b7fd4c730cae
8a3a8edfe98beb34ef0fc6e0a'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unico
de-basic', commit='6d2e06515f1ed1f74208d5a1da3a9cc26c60a7a0'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='85e1e7143dd4cfa2b551826c27867bada60858e8')}, root_dir=PosixPath('/data/yin
gzi_ma/lean_project/.cache/lean_dojo/fpvandoorn-carleson-bec7808b907190882fa1fa54ce749af297c6cf37/carleson'))
2024-10-27 15:36:32.834 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-10-27 15:36:32.835 | WARNING  | generate_benchmark_lean4:safe_remove_dir:281 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa54ce749af297c6cf37 already exists. Rem
oving it now.
2024-10-27 15:36:38.538 | INFO     | generate_benchmark_lean4:split_data:133 - 73851 theorems in total
2024-10-27 15:36:38.538 | INFO     | generate_benchmark_lean4:split_data:138 - 73851 theorems in total, with 1477 for validation and 1477 for testing
2024-10-27 15:36:38.538 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-10-27 15:36:38.561 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-10-27 15:36:43.386 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-10-27 15:36:56.016 | INFO     | generate_benchmark_lean4:export_proofs:202 - 70897 theorems and 117416 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa
1fa54ce749af297c6cf37/random/train.json
2024-10-27 15:36:56.372 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1477 theorems and 2185 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa
54ce749af297c6cf37/random/val.json
2024-10-27 15:36:56.639 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1477 theorems and 2543 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa
54ce749af297c6cf37/random/test.json
2024-10-27 15:37:08.262 | INFO     | generate_benchmark_lean4:export_proofs:202 - 70897 theorems and 111549 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa
1fa54ce749af297c6cf37/novel_premises/train.json
2024-10-27 15:37:08.849 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1477 theorems and 5329 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa
54ce749af297c6cf37/novel_premises/val.json
2024-10-27 15:37:09.323 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1477 theorems and 5266 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa
54ce749af297c6cf37/novel_premises/test.json
2024-10-27 15:37:09.323 | INFO     | generate_benchmark_lean4:export_proofs:206 - 147702 theorems saved in total
2024-10-27 15:37:09.326 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-10-27 15:37:23.949 | INFO     | generate_benchmark_lean4:export_premises:229 - 109334 theorems/definitions from 2866 files saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808
b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-10-27 15:37:23.961 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-10-27 15:37:23.962 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-10-27 15:37:23.962 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-10-27 15:37:24.013 | INFO     | __main__:add_repo_to_database:1050 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/carleson_bec7808b907190882fa1fa54ce749af297c6c
f37
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1477/1477 [
00:00<00:00, 62321.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1477/1477 [
00:00<00:00, 65048.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70897/70897 [
00:01<00:00, 58833.87it/s]
2024-10-27 15:37:27.019 | INFO     | __main__:add_repo_to_database:1075 - Before adding new repo:
2024-10-27 15:37:27.019 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-27 15:37:27.019 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-27 15:37:27.020 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 15:37:27.020 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 15:37:27.020 | INFO     | dynamic_database:add_repository:605 - Repository 'https://github.com/fpvandoorn/carleson' with commit 'bec7808b907190882fa1fa54ce749af297c6cf37' already exists in the database.
2024-10-27 15:37:27.020 | INFO     | __main__:add_repo_to_database:1078 - After adding new repo:
2024-10-27 15:37:27.020 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-27 15:37:27.020 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-27 15:37:27.020 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 15:37:40.445 | INFO     | __main__:main:1537 - Adding repo to repos_for_merged_dataset
2024-10-27 15:37:40.446 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:37:40.447 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:37:40.447 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:37:40.447 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:37:40.447 | INFO     | __main__:main:1563 - Starting training at epoch 16
[rank: 0] Seed set to 3407
2024-10-27 15:37:44.059 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to ru
n Lightning on SLURM, prepend your python command with `srun` like so: srun python mainfull.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-27 15:37:44.167 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:37:44.167 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-27 15:37:50.891 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 15:37:50.904 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:37:50.918 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 15:37:50.918 | INFO     | __main__:main:1674 - Training dataset size after load: 164877
2024-10-27 15:37:50.918 | INFO     | __main__:main:1675 - Validation dataset size after load: 2284
2024-10-27 15:37:50.918 | INFO     | __main__:main:1676 - Testing dataset size after load: 2543
2024-10-27 15:37:50.918 | INFO     | __main__:main:1678 - Starting progressive training from epoch 16 to 17
2024-10-27 15:37:50.918 | INFO     | __main__:main:1681 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-10-27 15:37:57,368] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-27 15:37:57,370] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-27 15:37:57,371] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-27 15:38:00.803 | INFO     | __main__:main:1317 - Running progressive training
2024-10-27 15:38:00.804 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-27 15:38:00.808 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-27 15:38:00.808 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-27 15:38:00.808 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-27 15:38:00.808 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-27 15:38:00.809 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-27 15:38:00.864 | INFO     | __main__:main:1317 - Running progressive training
2024-10-27 15:38:00.864 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-27 15:38:00.869 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-27 15:38:00.869 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-27 15:38:00.869 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-27 15:38:00.869 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-27 15:38:00.870 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-27 15:38:00.875 | INFO     | __main__:main:1317 - Running progressive training
2024-10-27 15:38:00.875 | INFO     | __main__:main:1323 - Configuring LeanDojo...
2024-10-27 15:38:00.878 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-27 15:38:00.878 | INFO     | __main__:main:1325 - LeanDojo configured
2024-10-27 15:38:00.878 | INFO     | __main__:main:1347 - Found 23 repositories
2024-10-27 15:38:00.878 | INFO     | __main__:main:1438 - Starting without curriculum learning
2024-10-27 15:38:00.878 | INFO     | __main__:get_sanitized_repo_info:1492 - Replacing zeta
2024-10-27 15:38:01.182 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-27 15:38:01.182 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-27 15:38:01.182 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-10-27 15:38:20.619 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-10-27 15:38:20.619 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-10-27 15:38:20.775 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-10-27 15:38:40.090 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-27 15:38:40.090 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-27 15:38:40.242 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-10-27 15:38:59.415 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-27 15:38:59.415 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-27 15:38:59.560 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-10-27 15:39:19.558 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:39:19.558 | INFO     | __main__:main:1508 - i: 0
2024-10-27 15:39:19.558 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:39:19.560 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:19.560 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:19.560 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:39:19.560 | INFO     | __main__:main:1563 - Starting training at epoch 16
[rank: 3] Seed set to 3407
2024-10-27 15:39:19.594 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:39:19.594 | INFO     | __main__:main:1508 - i: 0
2024-10-27 15:39:19.594 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:39:19.595 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:19.595 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:19.595 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:39:19.595 | INFO     | __main__:main:1563 - Starting training at epoch 16
[rank: 1] Seed set to 3407
2024-10-27 15:39:19.659 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:39:19.659 | INFO     | __main__:main:1508 - i: 0
2024-10-27 15:39:19.659 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:39:19.659 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:19.660 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:19.660 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:39:19.660 | INFO     | __main__:main:1563 - Starting training at epoch 16
[rank: 2] Seed set to 3407
2024-10-27 15:39:22.304 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:22.399 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:22.400 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:22.412 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:39:22.412 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-27 15:39:22.438 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:39:22.438 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:39:22.439 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-27 15:39:22.439 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-10-27 15:39:32.015 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 15:39:32.031 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:39:32.044 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 15:39:32.044 | INFO     | __main__:main:1674 - Training dataset size after load: 164877
2024-10-27 15:39:32.044 | INFO     | __main__:main:1675 - Validation dataset size after load: 2284
2024-10-27 15:39:32.044 | INFO     | __main__:main:1676 - Testing dataset size after load: 2543
2024-10-27 15:39:32.044 | INFO     | __main__:main:1678 - Starting progressive training from epoch 16 to 17
2024-10-27 15:39:32.044 | INFO     | __main__:main:1681 - hit the barrier before training
2024-10-27 15:39:32.230 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 15:39:32.242 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-10-27 15:39:32.255 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 15:39:32.255 | INFO     | __main__:main:1674 - Training dataset size after load: 164877
2024-10-27 15:39:32.256 | INFO     | __main__:main:1675 - Validation dataset size after load: 2284
2024-10-27 15:39:32.256 | INFO     | __main__:main:1676 - Testing dataset size after load: 2543
2024-10-27 15:39:32.256 | INFO     | __main__:main:1678 - Starting progressive training from epoch 16 to 17
2024-10-27 15:39:32.256 | INFO     | __main__:main:1681 - hit the barrier before training
2024-10-27 15:39:32.496 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-10-27 15:39:32.508 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:39:32.521 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 15:39:32.521 | INFO     | __main__:main:1674 - Training dataset size after load: 164877
2024-10-27 15:39:32.521 | INFO     | __main__:main:1675 - Validation dataset size after load: 2284
2024-10-27 15:39:32.521 | INFO     | __main__:main:1676 - Testing dataset size after load: 2543
2024-10-27 15:39:32.521 | INFO     | __main__:main:1678 - Starting progressive training from epoch 16 to 17
2024-10-27 15:39:32.521 | INFO     | __main__:main:1681 - hit the barrier before training
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-10-27 15:39:34.985 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 15:39:35.112 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:39:35.137 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full exists
 and is not empty.
2024-10-27 15:39:37.416 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
2024-10-27 15:39:37.463 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 15:39:37.496 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:39:37.511 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
Training dataset size: 164877
2024-10-27 15:39:37.543 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:39:37.560 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
2024-10-27 15:39:38.411 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_train/cached_data.pkl
Training dataset size: 164877
2024-10-27 15:39:38.516 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_val/cached_data.pkl
Validation dataset size: 2284
2024-10-27 15:39:38.538 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa5
4ce749af297c6cf37/random/cache_pred/cached_data.pkl
Testing dataset size: 2543
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01
.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-27 15:39:39.883 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-27 15:39:39.883 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-27 15:39:39.885 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-10-27 15:39:39.886 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params | Mode
---------------------------------------------------
0 | encoder | T5EncoderModel | 217 M  | train
---------------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
235       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.c
kpt
`Trainer.fit` stopped: `max_epochs=17` reached.
2024-10-27 15:39:43.036 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 15:39:43.125 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 15:39:43.269 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 15:39:43.468 | INFO     | __main__:main:1684 - hit the barrier after training
2024-10-27 15:39:43.469 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 15:39:43.469 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 15:39:43.469 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 15:39:43.469 | INFO     | __main__:main:1690 - Finished progressive training at epoch 17
2024-10-27 15:39:43.469 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:43.469 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:45.761 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 15:39:45.761 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 15:39:45.761 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:39:45.761 | INFO     | __main__:main:1508 - i: 1
2024-10-27 15:39:45.761 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:39:45.776 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:45.776 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:45.777 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:39:45.777 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 2] Seed set to 3407
2024-10-27 15:39:45.927 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 15:39:45.927 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 15:39:45.927 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:39:45.927 | INFO     | __main__:main:1508 - i: 1
2024-10-27 15:39:45.927 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:39:45.928 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:45.928 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:45.929 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:39:45.929 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 3] Seed set to 3407
2024-10-27 15:39:46.139 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 15:39:46.140 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 15:39:46.140 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 15:39:46.140 | INFO     | __main__:main:1508 - i: 1
2024-10-27 15:39:46.140 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 15:39:46.146 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:46.146 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:46.146 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 15:39:46.146 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 1] Seed set to 3407
2024-10-27 15:39:46.192 | INFO     | __main__:main:1786 - Starting the prover
2024-10-27 15:39:46.192 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-10-27 15:39:46.192 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-10-27 15:39:46.192 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-10-27 15:39:46.193 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b90
7190882fa1fa54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-10-27 15:39:47.022 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749a
f297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:47.022 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749a
f297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:47.906 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:48.011 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:39:48.138 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:48.181 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:39:48.307 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 15:39:48.346 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 15:39:49.978 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 're
triever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.l
ayer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.b
lock.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.laye
r.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention
.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retrie
ver.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.
encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.blo
ck.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm
.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'ret
riever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.
encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_
1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retri
ever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.e
ncoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfA
ttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight',
 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 're
triever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.
1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.la
yer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weigh
t', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.
encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encod
er.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluD
ense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriev
er.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encod
er.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.blo
ck.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer
.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.Dense
ReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_s
tep', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-10-27 15:39:50.668 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-10-27 15:39:50.669 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-10-27 15:39:50.669 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce74
9af297c6cf37/corpus.jsonl
2024-10-27 15:39:56.291 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749
af297c6cf37/corpus.jsonl
2024-10-27 15:39:56.291 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3417/341
7 [05:13<00:00, 10.90it/s]
2024-10-27 15:45:09.919 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-10-27 15:45:09.920 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-10-27 15:45:15,485 INFO worker.py:1777 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=2096808) [2024-10-27 15:45:56,874] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=2096808) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untruste
d-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be a
llowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have
full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2096808)   return torch.load(io.BytesIO(b))
(pid=2096892) [2024-10-27 15:46:07,646] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=2096892) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untruste
d-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be a
llowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have
full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2096892)   return torch.load(io.BytesIO(b))
(pid=2096927) [2024-10-27 15:46:20,162] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-10-27 15:46:23.299 | INFO     | __main__:prove_sorry_theorems:882 - Found 24 sorry theorems to prove
Processing theorems from fpvandoorn/carleson:   0%|                                                                                                                                                                     |
0/24 [00:00<?, ?theorem/s]2024-10-27 15:46:23.300 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for card_le_of_le_dist
2024-10-27 15:46:23.300 | INFO     | __main__:prove_sorry_theorems:906 - Position: (116, 1)
2024-10-27 15:46:23.300 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for prop2_2
2024-10-27 15:46:23.300 | INFO     | __main__:prove_sorry_theorems:906 - Position: (36, 1)
2024-10-27 15:46:23.300 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for partialFourierSum_eq_conv_dirichletKernel'
2024-10-27 15:46:23.300 | INFO     | __main__:prove_sorry_theorems:906 - Position: (198, 1)
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for dirichletKernel'_periodic
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:906 - Position: (22, 1)
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for dirichletKernel_periodic
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:906 - Position: (19, 1)
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for theorem1_2C'
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:906 - Position: (203, 1)
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for volume_ball_le_same
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:906 - Position: (53, 1)
2024-10-27 15:46:23.301 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for fourier_uniformContinuous
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:906 - Position: (99, 1)
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for Hilbert_kernel_regularity
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:906 - Position: (277, 1)
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for prop2_3
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:906 - Position: (35, 1)
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for partialFourierSum_uniformContinuous
2024-10-27 15:46:23.302 | INFO     | __main__:prove_sorry_theorems:906 - Position: (105, 1)
2024-10-27 15:46:23.303 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for theorem1_2C
2024-10-27 15:46:23.303 | INFO     | __main__:prove_sorry_theorems:906 - Position: (191, 1)
2024-10-27 15:46:23.303 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=2096808) 2024-10-27 15:46:23.316 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="dirichletKernel'_periodic")
(ProverActor pid=2096892) 2024-10-27 15:46:24.143 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="partialFourierSum_eq_conv_dirichletKernel'")
(ProverActor pid=2096927) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untruste
d-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be a
llowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have
full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2096927)   return torch.load(io.BytesIO(b))
(pid=2096926) [2024-10-27 15:46:31,988] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=2096926) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), whi
ch uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untruste
d-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be a
llowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have
full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2096926)   return torch.load(io.BytesIO(b))
(ProverActor pid=2096927) 2024-10-27 15:46:37.463 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Proposition2.lean'), full_name='prop2_2')
(ProverActor pid=2096926) 2024-10-27 15:46:48.306 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='card_le_of_le_dist')
(ProverActor pid=2096808) 2024-10-27 15:57:24.830 | INFO     | prover.proof_search:_best_first_search:149 - 1017162.93122041
(ProverActor pid=2096808) 2024-10-27 15:57:24.831 | INFO     | prover.proof_search:_best_first_search:150 - 1016562.934789984
(ProverActor pid=2096808) 2024-10-27 15:57:24.831 | INFO     | prover.proof_search:_best_first_search:151 - 599.9968367629917
(ProverActor pid=2096808) 2024-10-27 15:57:24.831 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096808) 2024-10-27 15:57:24.831 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096808) 2024-10-27 15:57:35.387 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="dirichletKernel'_periodic"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=120.94515226373915, environment_time=
478.72208232735284, total_time=600.9970329969656, num_total_nodes=1274, num_searched_nodes=46)
(ProverActor pid=2096808) 2024-10-27 15:57:35.394 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name='dirichletKernel_periodic')
(ProverActor pid=2096927) 2024-10-27 15:57:25.790 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log dedupl
ication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ProverActor pid=2096927) 2024-10-27 15:57:25.793 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096927) 2024-10-27 15:57:35.587 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Proposition2.lean'), full_name='prop2_2'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=530.17561698996, environment_time=26.597845380194485, total_time=601.0
039512480143, num_total_nodes=620, num_searched_nodes=15)
(ProverActor pid=2096927) 2024-10-27 15:57:35.593 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name="theorem1_2C'")
(ProverActor pid=2096926) 2024-10-27 15:57:39.469 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096926) 2024-10-27 15:57:48.883 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='card_le_of_le_dist'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=541.921843229793, environment_time=41.13517281762324, to
tal_time=601.001327175065, num_total_nodes=629, num_searched_nodes=19)
(ProverActor pid=2096926) 2024-10-27 15:57:48.888 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='volume_ball_le_same')
(ProverActor pid=2096926) 2024-10-27 15:57:39.467 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x across cluster]
(ProverActor pid=2096892) 2024-10-27 15:57:51.282 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096892) 2024-10-27 15:58:06.444 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name="partialFourierSum_eq_conv_dirichletKernel'"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=514.7715778197162, e
nvironment_time=51.956616377457976, total_time=601.0003609519918, num_total_nodes=444, num_searched_nodes=13)
(ProverActor pid=2096892) 2024-10-27 15:58:06.450 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Basic.lean'), full_name='fourier_uniformContinuous')
(ProverActor pid=2096892) 2024-10-27 15:57:51.280 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x across cluster]
(ProverActor pid=2096808) 2024-10-27 15:58:37.048 | INFO     | prover.proof_search:_best_first_search:171 - Found a proof!
(ProverActor pid=2096808) 2024-10-27 15:58:50.408 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Dirichlet_kernel.lean'), full_name='dirichletKernel_periodic'), status=<Status.PROVED: 'Proved'>, proof=['simp [dirichletKernel]'], actor_time=3.3479773299
768567, environment_time=1.2565470580011606, total_time=5.605510403984226, num_total_nodes=22, num_searched_nodes=1)
(ProverActor pid=2096808) 2024-10-27 15:58:50.414 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Hilbert_kernel.lean'), full_name='Hilbert_kernel_regularity')
(ProverActor pid=2096927) 2024-10-27 16:08:35.699 | INFO     | prover.proof_search:_best_first_search:149 - 1017833.800082949
(ProverActor pid=2096927) 2024-10-27 16:08:35.699 | INFO     | prover.proof_search:_best_first_search:150 - 1017233.803323692
(ProverActor pid=2096927) 2024-10-27 16:08:35.700 | INFO     | prover.proof_search:_best_first_search:151 - 599.9972440460697
(ProverActor pid=2096927) 2024-10-27 16:08:35.700 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096927) 2024-10-27 16:08:35.702 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096926) 2024-10-27 16:08:46.167 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x across cluster]
(ProverActor pid=2096926) 2024-10-27 16:08:46.167 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096927) 2024-10-27 16:08:49.029 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name="theorem1_2C'"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=548.3089947663248, environment_time=32.371693298453465, total_time=60
0.9993822540855, num_total_nodes=806, num_searched_nodes=18)
(ProverActor pid=2096927) 2024-10-27 16:08:49.038 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Proposition3.lean'), full_name='prop2_3')
(ProverActor pid=2096926) 2024-10-27 16:08:58.213 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='volume_ball_le_same'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=202.730621593073, environment_time=240.04208132554777,
total_time=600.9996126450133, num_total_nodes=201, num_searched_nodes=4)
(ProverActor pid=2096926) 2024-10-27 16:08:58.219 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Basic.lean'), full_name='partialFourierSum_uniformContinuous')
(ProverActor pid=2096892) 2024-10-27 16:09:09.143 | INFO     | prover.proof_search:_best_first_search:149 - 1017867.243653968
(ProverActor pid=2096892) 2024-10-27 16:09:09.143 | INFO     | prover.proof_search:_best_first_search:150 - 1017267.246705276
(ProverActor pid=2096892) 2024-10-27 16:09:09.143 | INFO     | prover.proof_search:_best_first_search:151 - 599.9975728429854
(ProverActor pid=2096892) 2024-10-27 16:09:09.143 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096892) 2024-10-27 16:09:09.145 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096892) 2024-10-27 16:09:20.031 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Basic.lean'), full_name='fourier_uniformContinuous'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=562.0915226648794, environment_time=37.211400078
376755, total_time=600.9994895770214, num_total_nodes=423, num_searched_nodes=13)
(ProverActor pid=2096892) 2024-10-27 16:09:20.037 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name='theorem1_2C')
(ProverActor pid=2096808) 2024-10-27 16:10:14.243 | INFO     | prover.proof_search:_best_first_search:149 - 1017932.344151908
(ProverActor pid=2096808) 2024-10-27 16:10:14.244 | INFO     | prover.proof_search:_best_first_search:150 - 1017332.349358477
(ProverActor pid=2096808) 2024-10-27 16:10:14.244 | INFO     | prover.proof_search:_best_first_search:151 - 599.9952399790054
(ProverActor pid=2096808) 2024-10-27 16:10:14.244 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096808) 2024-10-27 16:10:14.244 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096808) 2024-10-27 16:10:29.203 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Hilbert_kernel.lean'), full_name='Hilbert_kernel_regularity'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=194.3214705750579, environment_time=233
.3638732676627, total_time=600.9954628519481, num_total_nodes=2763, num_searched_nodes=56)
(ProverActor pid=2096927) 2024-10-27 16:19:40.860 | INFO     | prover.proof_search:_best_first_search:149 - 1018498.961064848
(ProverActor pid=2096927) 2024-10-27 16:19:40.860 | INFO     | prover.proof_search:_best_first_search:150 - 1017898.965690444
(ProverActor pid=2096927) 2024-10-27 16:19:40.861 | INFO     | prover.proof_search:_best_first_search:151 - 599.9958814230049
(ProverActor pid=2096927) 2024-10-27 16:19:40.861 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096927) 2024-10-27 16:19:40.862 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096927) 2024-10-27 16:19:51.437 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Proposition3.lean'), full_name='prop2_3'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=536.2026461305795, environment_time=57.50708069244865, total_time=600.
9967700480483, num_total_nodes=668, num_searched_nodes=16)
(ProverActor pid=2096926) 2024-10-27 16:19:51.793 | INFO     | prover.proof_search:_best_first_search:149 - 1018509.893956418
(ProverActor pid=2096926) 2024-10-27 16:19:51.793 | INFO     | prover.proof_search:_best_first_search:150 - 1017909.898402561
(ProverActor pid=2096926) 2024-10-27 16:19:51.794 | INFO     | prover.proof_search:_best_first_search:151 - 599.9961736680707
(ProverActor pid=2096926) 2024-10-27 16:19:51.795 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096926) 2024-10-27 16:19:51.795 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096926) 2024-10-27 16:20:00.575 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Basic.lean'), full_name='partialFourierSum_uniformContinuous'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=178.6460960028926, environment_time=15
.506711158319376, total_time=600.9975923619932, num_total_nodes=151, num_searched_nodes=4)
(ProverActor pid=2096892) 2024-10-27 16:20:14.539 | INFO     | prover.proof_search:_best_first_search:149 - 1018532.639743311
(ProverActor pid=2096892) 2024-10-27 16:20:14.539 | INFO     | prover.proof_search:_best_first_search:150 - 1017932.642564566
(ProverActor pid=2096892) 2024-10-27 16:20:14.539 | INFO     | prover.proof_search:_best_first_search:151 - 599.9975640020566
(ProverActor pid=2096892) 2024-10-27 16:20:14.539 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096892) 2024-10-27 16:20:14.540 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
2024-10-27 16:20:21.320 | INFO     | __main__:process_theorem_batch:828 - No proof found for dirichletKernel'_periodic
2024-10-27 16:20:21.320 | INFO     | __main__:process_theorem_batch:828 - No proof found for prop2_2
2024-10-27 16:20:21.320 | INFO     | __main__:process_theorem_batch:828 - No proof found for card_le_of_le_dist
2024-10-27 16:20:21.320 | INFO     | __main__:process_theorem_batch:828 - No proof found for partialFourierSum_eq_conv_dirichletKernel'
2024-10-27 16:20:21.320 | INFO     | __main__:process_theorem_batch:814 - Proof found for dirichletKernel_periodic
2024-10-27 16:20:21.323 | INFO     | dynamic_database:update_repository:614 - Attempting to update repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 16:20:21.323 | INFO     | dynamic_database:update_repository:618 - Updated repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 16:20:21.323 | INFO     | __main__:process_theorem_batch:826 - Updated theorem dirichletKernel_periodic in the database
2024-10-27 16:20:21.323 | INFO     | __main__:process_theorem_batch:828 - No proof found for theorem1_2C'
2024-10-27 16:20:21.323 | INFO     | __main__:process_theorem_batch:828 - No proof found for volume_ball_le_same
2024-10-27 16:20:21.323 | INFO     | __main__:process_theorem_batch:828 - No proof found for fourier_uniformContinuous
2024-10-27 16:20:21.323 | INFO     | __main__:process_theorem_batch:828 - No proof found for Hilbert_kernel_regularity
2024-10-27 16:20:21.324 | INFO     | __main__:process_theorem_batch:828 - No proof found for prop2_3
2024-10-27 16:20:21.324 | INFO     | __main__:process_theorem_batch:828 - No proof found for partialFourierSum_uniformContinuous
2024-10-27 16:20:21.324 | INFO     | __main__:process_theorem_batch:828 - No proof found for theorem1_2C
(ProverActor pid=2096892) 2024-10-27 16:20:21.317 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name='theorem1_2C'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=568.6939083121251, environment_time=30.142724062432535, total_time=600
.9979010580573, num_total_nodes=865, num_searched_nodes=19)
2024-10-27 16:20:37.574 | INFO     | __main__:save_progress:837 - Saving encountered theorems...
Processing theorems from fpvandoorn/carleson:  50%|█████████████████████████████████████████████████████████████████████████████▌                                                                             | 12/24 [34:
14<34:14, 171.19s/theorem]2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for rcarleson'
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:906 - Position: (507, 1)
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for equation3_1
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:906 - Position: (109, 1)
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for equation2_2
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:906 - Position: (177, 1)
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for CoveredByBalls.trans
2024-10-27 16:20:37.578 | INFO     | __main__:prove_sorry_theorems:906 - Position: (78, 1)
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for volume_ball_le_of_dist_le
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:906 - Position: (96, 1)
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for CarlesonOperatorReal'_measurable
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:906 - Position: (72, 1)
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for volume_ball_le_of_subset
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:906 - Position: (102, 1)
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for CarlesonOperatorRat'_measurable
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:906 - Position: (48, 1)
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for Memℒp_T
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:906 - Position: (249, 1)
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for ballsCoverBalls
2024-10-27 16:20:37.579 | INFO     | __main__:prove_sorry_theorems:906 - Position: (122, 1)
2024-10-27 16:20:37.580 | INFO     | __main__:prove_sorry_theorems:905 - Searching for proof for prop2_1
2024-10-27 16:20:37.580 | INFO     | __main__:prove_sorry_theorems:906 - Position: (34, 1)
Processing theorems from fpvandoorn/carleson:  96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 23/24 [34
:14<01:29, 89.32s/theorem]
2024-10-27 16:20:37.580 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=2096808) 2024-10-27 16:20:37.588 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/CoverByBalls.lean'), full_name='CoveredByBalls.trans')
(ProverActor pid=2096892) 2024-10-27 16:20:37.587 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/Carleson_on_the_real_line.lean'), full_name="rcarleson'")
(ProverActor pid=2096927) 2024-10-27 16:20:37.586 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name='equation2_2')
(ProverActor pid=2096808) 2024-10-27 16:31:29.196 | INFO     | prover.proof_search:_best_first_search:149 - 1019207.297012834
(ProverActor pid=2096808) 2024-10-27 16:31:29.196 | INFO     | prover.proof_search:_best_first_search:150 - 1018607.299554428
(ProverActor pid=2096808) 2024-10-27 16:31:29.197 | INFO     | prover.proof_search:_best_first_search:151 - 599.9986113960622
(ProverActor pid=2096808) 2024-10-27 16:31:29.197 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096808) 2024-10-27 16:31:29.198 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096926) 2024-10-27 16:20:37.588 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name='equation3_1')
(ProverActor pid=2096808) 2024-10-27 16:31:39.773 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/CoverByBalls.lean'), full_name='CoveredByBalls.trans'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=429.3047365396051, environment_time=166.57172762497794, t
otal_time=600.9989047109848, num_total_nodes=3562, num_searched_nodes=148)
(ProverActor pid=2096808) 2024-10-27 16:31:39.780 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='volume_ball_le_of_dist_le')
(ProverActor pid=2096927) 2024-10-27 16:31:33.182 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 8x across cluster]
(ProverActor pid=2096927) 2024-10-27 16:31:33.184 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions). [repeated 2x across cluster]
(ProverActor pid=2096927) 2024-10-27 16:31:45.300 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name='equation2_2'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=540.102785688825, environment_time=45.52333769807592, total_time=600.9
994625329273, num_total_nodes=880, num_searched_nodes=19)
(ProverActor pid=2096927) 2024-10-27 16:31:45.306 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/CarlesonOperatorReal.lean'), full_name="CarlesonOperatorReal'_measurable")
(ProverActor pid=2096926) 2024-10-27 16:31:47.601 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='volume_ball_le_of_subset')
(ProverActor pid=2096892) 2024-10-27 16:31:50.736 | INFO     | prover.proof_search:_best_first_search:149 - 1019228.836500237
(ProverActor pid=2096892) 2024-10-27 16:31:50.736 | INFO     | prover.proof_search:_best_first_search:150 - 1018628.842391467
(ProverActor pid=2096892) 2024-10-27 16:31:50.736 | INFO     | prover.proof_search:_best_first_search:151 - 599.9944961870788
(ProverActor pid=2096892) 2024-10-27 16:31:50.736 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096892) 2024-10-27 16:31:50.737 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096926) 2024-10-27 16:31:47.592 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Carleson.lean'), full_name='equation3_1'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=570.7427817941643, environment_time=29.17039551748894, total_time=600.
9981942720478, num_total_nodes=634, num_searched_nodes=18)
(ProverActor pid=2096892) 2024-10-27 16:32:00.180 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/Carleson_on_the_real_line.lean'), full_name="rcarleson'"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=565.5258747010957, environment_time=25.3805
0376344472, total_time=600.9956672670087, num_total_nodes=580, num_searched_nodes=15)
(ProverActor pid=2096892) 2024-10-27 16:32:00.187 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Theorem1_1/CarlesonOperatorReal.lean'), full_name="CarlesonOperatorRat'_measurable")
(ProverActor pid=2096808) 2024-10-27 16:42:31.419 | INFO     | prover.proof_search:_best_first_search:149 - 1019869.519734216
(ProverActor pid=2096808) 2024-10-27 16:42:31.419 | INFO     | prover.proof_search:_best_first_search:150 - 1019269.522865153
(ProverActor pid=2096808) 2024-10-27 16:42:31.419 | INFO     | prover.proof_search:_best_first_search:151 - 599.9975387849845
(ProverActor pid=2096808) 2024-10-27 16:42:31.420 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096808) 2024-10-27 16:42:31.420 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096892) 2024-10-27 16:42:48.323 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 12x across cluster]
(ProverActor pid=2096892) 2024-10-27 16:42:48.324 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions). [repeated 3x across cluster]
(ProverActor pid=2096926) 2024-10-27 16:42:51.299 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='volume_ball_le_of_subset'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=101.90534439310431, environment_time=135.844202830
80544, total_time=600.9986250719521, num_total_nodes=85, num_searched_nodes=2)
(ProverActor pid=2096926) 2024-10-27 16:42:51.305 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Defs.lean'), full_name='Memℒp_T')
(ProverActor pid=2096808) 2024-10-27 16:42:54.705 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='volume_ball_le_of_dist_le'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=299.1750478649046, environment_time=171.281775313
31312, total_time=600.9983110380126, num_total_nodes=2600, num_searched_nodes=72)
(ProverActor pid=2096808) 2024-10-27 16:42:54.711 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='ballsCoverBalls')
(ProverActor pid=2096927) 2024-10-27 16:43:00.580 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/CarlesonOperatorReal.lean'), full_name="CarlesonOperatorReal'_measurable"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=517.9406932139536, environ
ment_time=64.44624899688642, total_time=601.0037565949606, num_total_nodes=622, num_searched_nodes=13)
(ProverActor pid=2096927) 2024-10-27 16:43:00.587 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa54ce749af297c6
cf37'), file_path=PosixPath('Carleson/Proposition1.lean'), full_name='prop2_1')
(ProverActor pid=2096892) 2024-10-27 16:43:02.032 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Theorem1_1/CarlesonOperatorReal.lean'), full_name="CarlesonOperatorRat'_measurable"), status=<Status.OPEN: 'Open'>, proof=None, actor_time=550.0565953692421, environm
ent_time=45.22593853692524, total_time=601.0003572290298, num_total_nodes=705, num_searched_nodes=16)
(ProverActor pid=2096808) 2024-10-27 16:43:45.436 | INFO     | prover.proof_search:_best_first_search:167 - Failed early!
(ProverActor pid=2096808) 2024-10-27 16:43:54.825 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/HomogeneousType.lean'), full_name='ballsCoverBalls'), status=<Status.FAILED: 'Failed'>, proof=None, actor_time=4.409270510892384, environment_time=0.31761958298739046
, total_time=5.728153285919689, num_total_nodes=25, num_searched_nodes=1)
(ProverActor pid=2096926) 2024-10-27 16:53:40.001 | INFO     | prover.proof_search:_best_first_search:149 - 1020538.101700078
(ProverActor pid=2096926) 2024-10-27 16:53:40.001 | INFO     | prover.proof_search:_best_first_search:150 - 1019938.104275283
(ProverActor pid=2096926) 2024-10-27 16:53:40.001 | INFO     | prover.proof_search:_best_first_search:151 - 599.9978614929132
(ProverActor pid=2096926) 2024-10-27 16:53:40.001 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2096926) 2024-10-27 16:53:40.004 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096927) 2024-10-27 16:53:46.133 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x across cluster]
(ProverActor pid=2096927) 2024-10-27 16:53:46.135 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource limit (timeout or max_expansions).
(ProverActor pid=2096926) 2024-10-27 16:53:47.935 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Defs.lean'), full_name='Memℒp_T'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=541.20064322697, environment_time=15.14567437605001, total_time=601.0003394759
26, num_total_nodes=503, num_searched_nodes=15)
2024-10-27 16:53:53.560 | INFO     | __main__:process_theorem_batch:828 - No proof found for CoveredByBalls.trans
2024-10-27 16:53:53.560 | INFO     | __main__:process_theorem_batch:828 - No proof found for equation2_2
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for equation3_1
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for rcarleson'
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for volume_ball_le_of_subset
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for volume_ball_le_of_dist_le
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for CarlesonOperatorReal'_measurable
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for CarlesonOperatorRat'_measurable
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for ballsCoverBalls
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for Memℒp_T
2024-10-27 16:53:53.561 | INFO     | __main__:process_theorem_batch:828 - No proof found for prop2_1
(ProverActor pid=2096927) 2024-10-27 16:53:53.557 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(repo=LeanGitRepo(url='https://github.com/fpvandoorn/carleson', commit='bec7808b907190882fa1fa
54ce749af297c6cf37'), file_path=PosixPath('Carleson/Proposition1.lean'), full_name='prop2_1'), status=<Status.OPEN: 'Open'>, proof=None, actor_time=552.9314742228016, environment_time=28.34970706945751, total_time=601.
0003622659715, num_total_nodes=770, num_searched_nodes=17)
2024-10-27 16:54:12.316 | INFO     | __main__:save_progress:837 - Saving encountered theorems...
2024-10-27 16:54:12.320 | INFO     | __main__:prove_sorry_theorems:933 - Finished attempting to prove sorry theorems
2024-10-27 16:54:28.284 | INFO     | __main__:main:1820 - Finished searching for proofs of sorry theorems
2024-10-27 16:54:28.285 | INFO     | __main__:main:1839 - Finished processing the repository
2024-10-27 16:54:28.285 | INFO     | __main__:main:1841 - current epoch: 17
2024-10-27 16:54:28.285 | INFO     | __main__:main:1507 - length of lean_git_repos: 7
2024-10-27 16:54:28.285 | INFO     | __main__:main:1508 - i: 1
2024-10-27 16:54:28.285 | INFO     | __main__:main:1514 - Main process
2024-10-27 16:54:28.285 | INFO     | __main__:main:1515 - Using lambda = 0.1
2024-10-27 16:54:28.285 | INFO     | __main__:main:1516 - Processing https://github.com/YaelDillies/LeanAPAP
2024-10-27 16:54:28.285 | INFO     | __main__:add_repo_to_database:956 - Processing https://github.com/YaelDillies/LeanAPAP.git
2024-10-27 16:54:28.285 | INFO     | __main__:add_repo_to_database:1036 - Found compatible commit 951c660a8d7ba8e39f906fdf657674a984effa8b for https://github.com/YaelDillies/LeanAPAP.git
2024-10-27 16:54:28.286 | INFO     | __main__:add_repo_to_database:1037 - Lean version: v4.8.0-rc2
2024-10-27 16:54:28.286 | INFO     | __main__:add_repo_to_database:1042 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:354 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:361 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0-rc2\n'}
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:363 - lean version v: v4.8.0-rc2
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:364 - is supported: True
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:373 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:374 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-27 16:54:28.286 | INFO     | generate_benchmark_lean4:main:375 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-27 16:54:28.288 | INFO     | generate_benchmark_lean4:main:379 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-27 16:54:28.288 | INFO     | generate_benchmark_lean4:main:381 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-27 16:54:28.288 | INFO     | generate_benchmark_lean4:main:384 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0-rc2
2024-10-27 16:54:28.390 | INFO     | generate_benchmark_lean4:main:386 - lean --version: Lean (version 4.8.0-rc2, x86_64-unknown-linux-gnu, commit 873ef2d894af, Release)

2024-10-27 16:54:28.390 | INFO     | generate_benchmark_lean4:main:387 - repo: LeanGitRepo(url='https://github.com/YaelDillies/LeanAPAP', commit='951c660a8d7ba8e39f906fdf657674a984effa8b')
2024-10-27 16:54:28.390 | INFO     | generate_benchmark_lean4:main:389 - Configuring LeanDojo again...
2024-10-27 16:54:28.397 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-10-27 16:54:28.397 | INFO     | generate_benchmark_lean4:main:391 - LeanDojo configured
2024-10-27 16:54:28.398 | INFO     | generate_benchmark_lean4:main:394 - Tracing the repo...
2024-10-27 16:54:28.401 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-10-27 16:54:28.401 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/YaelDillies-LeanAPAP-951c660a8d7ba8e39f906fdf657674a984effa8b/
LeanAPAP
2024-10-27 16:54:31.108 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1125 - Loading 2950 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/YaelDillies-LeanAPAP-951c660a8d7ba8e39f9
06fdf657674a984effa8b/LeanAPAP with 31 workers
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2950/295
0 [09:31<00:00,  5.16it/s]
2024-10-27 17:04:02.996 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/YaelDillies/LeanAPAP', commit='951c660a8d7ba8e39f906fdf657674a
984effa8b')
2024-10-27 17:04:03.752 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-27 17:04:04.889 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-10-27 17:04:07.742 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='8c2c97e8beb66d75f3ddc8
d4c6878cd4dca30f2d')
2024-10-27 17:04:08.013 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='d36b7fd4c730cae8a3a8edfe98beb34e
f0fc6e0a')
2024-10-27 17:04:22.401 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1010 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/YaelDillies/LeanAPAP', commit='951c660a8d7ba8e39
f906fdf657674a984effa8b'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='4cb90dddfcb8ceda2b89711d567d593e1fd07090'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-c
ommunity/batteries', commit='dc72dcdb8e97b3c56bd70f06f043ed2dee3258e6'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='1357f4f49450abb9dfd4783e38219f4ce84f9785'), 'aesop': LeanGitRepo(
url='https://github.com/leanprover-community/aesop', commit='9ac12945862fa39eab7795c2f79bb9aa0c8e332c'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='baa65c6339a56bd2
2b7292aa4511c54b3cc7a6af'), 'Cli': LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca'), 'mathlib': LeanGitRepo(url='https://github.com/leanprover-community/mathlib4
', commit='8c2c97e8beb66d75f3ddc8d4c6878cd4dca30f2d'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0ea83a676d288220ba227808568cbb80fe43ace0'), 'LeanSearchClient': Lean
GitRepo(url='https://github.com/leanprover-community/LeanSearchClient', commit='7bedaed1ef024add1e171cc17706b012a9a37802'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='d36b7fd4c730ca
e8a3a8edfe98beb34ef0fc6e0a'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unic
ode-basic', commit='6d2e06515f1ed1f74208d5a1da3a9cc26c60a7a0'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='85e1e7143dd4cfa2b551826c27867bada60858e8')}, root_dir=PosixPath('/data/yi
ngzi_ma/lean_project/.cache/lean_dojo/YaelDillies-LeanAPAP-951c660a8d7ba8e39f906fdf657674a984effa8b/LeanAPAP'))
2024-10-27 17:04:36.588 | INFO     | generate_benchmark_lean4:main:396 - Successfully traced the repo
2024-10-27 17:04:43.749 | INFO     | generate_benchmark_lean4:split_data:133 - 71090 theorems in total
2024-10-27 17:04:43.750 | INFO     | generate_benchmark_lean4:split_data:138 - 71090 theorems in total, with 1421 for validation and 1421 for testing
2024-10-27 17:04:43.750 | INFO     | generate_benchmark_lean4:split_randomly:81 - Splitting the theorems randomly
2024-10-27 17:04:43.773 | INFO     | generate_benchmark_lean4:split_by_premise:95 - Splitting the theorems by premises
2024-10-27 17:04:48.847 | INFO     | generate_benchmark_lean4:main:402 - Successfully split the data
2024-10-27 17:05:02.502 | INFO     | generate_benchmark_lean4:export_proofs:202 - 68248 theorems and 101640 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f9
06fdf657674a984effa8b/random/train.json
2024-10-27 17:05:02.909 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1421 theorems and 1966 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906f
df657674a984effa8b/random/val.json
2024-10-27 17:05:03.199 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1421 theorems and 2150 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906f
df657674a984effa8b/random/test.json
2024-10-27 17:05:15.852 | INFO     | generate_benchmark_lean4:export_proofs:202 - 68248 theorems and 97623 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f90
6fdf657674a984effa8b/novel_premises/train.json
2024-10-27 17:05:16.478 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1421 theorems and 4019 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906f
df657674a984effa8b/novel_premises/val.json
2024-10-27 17:05:16.955 | INFO     | generate_benchmark_lean4:export_proofs:202 - 1421 theorems and 4114 tactics saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906f
df657674a984effa8b/novel_premises/test.json
2024-10-27 17:05:16.956 | INFO     | generate_benchmark_lean4:export_proofs:206 - 142180 theorems saved in total
2024-10-27 17:05:16.960 | INFO     | generate_benchmark_lean4:export_data:323 - Successfully exported the proofs
2024-10-27 17:05:34.422 | INFO     | generate_benchmark_lean4:export_premises:229 - 109477 theorems/definitions from 2950 files saved to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660
a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-10-27 17:05:34.436 | INFO     | generate_benchmark_lean4:export_data:327 - Successfully exported the premises
2024-10-27 17:05:34.438 | INFO     | generate_benchmark_lean4:export_data:335 - Successfully exported the metadata
2024-10-27 17:05:34.438 | INFO     | generate_benchmark_lean4:main:404 - Successfully exported the data
2024-10-27 17:05:34.497 | INFO     | __main__:add_repo_to_database:1050 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/LeanAPAP_951c660a8d7ba8e39f906fdf657674a984eff
a8b
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248 [
00:01<00:00, 48853.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421 [
00:00<00:00, 51658.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421 [
00:00<00:00, 56180.77it/s]
2024-10-27 17:05:37.740 | INFO     | __main__:add_repo_to_database:1075 - Before adding new repo:
2024-10-27 17:05:37.740 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-27 17:05:37.740 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-27 17:05:37.740 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 17:05:37.740 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-27 17:05:37.740 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-27 17:05:37.740 | INFO     | __main__:add_repo_to_database:1078 - After adding new repo:
2024-10-27 17:05:37.740 | INFO     | dynamic_database:print_database_contents:624 - Current database contents:
2024-10-27 17:05:37.740 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-10-27 17:05:37.741 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-10-27 17:05:37.741 | INFO     | dynamic_database:print_database_contents:626 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-27 17:06:00.876 | INFO     | __main__:main:1537 - Adding repo to repos_for_merged_dataset
2024-10-27 17:06:00.878 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-10-27 17:06:00.878 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-10-27 17:06:56.150 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b alread
y exists. Removing it now.
2024-10-27 17:08:37.948 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf6
57674a984effa8b
2024-10-27 17:08:38.572 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8
e39f906fdf657674a984effa8b
2024-10-27 17:08:38.587 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f9
06fdf657674a984effa8b
2024-10-27 17:08:38.590 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fd
f657674a984effa8b
2024-10-27 17:08:38.610 | INFO     | __main__:main:1549 - All GPUs
2024-10-27 17:08:38.612 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:08:38.612 | INFO     | __main__:main:1556 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:08:38.613 | INFO     | __main__:main:1562 - Inside train_test_fisher
2024-10-27 17:08:38.613 | INFO     | __main__:main:1563 - Starting training at epoch 17
[rank: 0] Seed set to 3407
2024-10-27 17:08:41.880 | INFO     | __main__:main:1587 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf3
7_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to ru
n Lightning on SLURM, prepend your python command with `srun` like so: srun python mainfull.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-27 17:08:42.023 | INFO     | __main__:main:1645 - right before barrier for data module
2024-10-27 17:08:42.024 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-27 17:08:42.024 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-27 17:08:42.024 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-10-27 17:08:42.024 | INFO     | __main__:main:1660 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248
[00:12<00:00, 5336.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248
[00:10<00:00, 6492.64it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 58217/68248
[00:12<00:01, 5768.68it/s]2024-10-27 17:09:12.545 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Le
anAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cache_train/cached_data.pkl
Training dataset size: 140562
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                         | 59435/68248
[00:12<00:01, 5894.10it/s]2024-10-27 17:09:12.750 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Le
anAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cache_train/cached_data.pkl
Training dataset size: 140562
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421
[00:00<00:00, 7602.24it/s]
  0%|
 | 0/1421 [00:00<?, ?it/s]2024-10-27 17:09:12.778 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Le
anAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cache_val/cached_data.pkl
Validation dataset size: 2025
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421
[00:00<00:00, 7735.42it/s]
2024-10-27 17:09:12.979 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f9
06fdf657674a984effa8b/random/cache_val/cached_data.pkl
Validation dataset size: 2025
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421
[00:00<00:00, 7726.97it/s]
  0%|
 | 0/1421 [00:00<?, ?it/s]2024-10-27 17:09:13.010 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Le
anAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cache_pred/cached_data.pkl
Testing dataset size: 2121
2024-10-27 17:09:13.011 | INFO     | __main__:main:1674 - Training dataset size after load: 140562
2024-10-27 17:09:13.011 | INFO     | __main__:main:1675 - Validation dataset size after load: 2025
2024-10-27 17:09:13.011 | INFO     | __main__:main:1676 - Testing dataset size after load: 2121
2024-10-27 17:09:13.011 | INFO     | __main__:main:1678 - Starting progressive training from epoch 17 to 18
2024-10-27 17:09:13.011 | INFO     | __main__:main:1681 - hit the barrier before training
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1421/1421
[00:00<00:00, 7539.31it/s]
2024-10-27 17:09:13.230 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f9
06fdf657674a984effa8b/random/cache_pred/cached_data.pkl
Testing dataset size: 2121
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 61709/68248
[00:12<00:01, 5603.96it/s]2024-10-27 17:09:13.231 | INFO     | __main__:main:1674 - Training dataset size after load: 140562
2024-10-27 17:09:13.231 | INFO     | __main__:main:1675 - Validation dataset size after load: 2025
2024-10-27 17:09:13.231 | INFO     | __main__:main:1676 - Testing dataset size after load: 2121
2024-10-27 17:09:13.231 | INFO     | __main__:main:1678 - Starting progressive training from epoch 17 to 18
2024-10-27 17:09:13.231 | INFO     | __main__:main:1681 - hit the barrier before training
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248
[00:14<00:00, 4862.23it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68248/68248
[00:14<00:00, 4871.45it/s]
2024-10-27 17:09:15.173 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f9
06fdf657674a984effa8b/random/cache_train/cached_data.pkl
Training dataset size: 140562
2024-10-27 17:09:15.191 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fd
f657674a984effa8b/random/cache_val/cached_data.pkl
Validation dataset size: 2025
2024-10-27 17:09:15.208 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fd
f657674a984effa8b/random/cache_pred/cached_data.pkl
Testing dataset size: 2121
2024-10-27 17:09:15.208 | INFO     | __main__:main:1674 - Training dataset size after load: 140562
2024-10-27 17:09:15.208 | INFO     | __main__:main:1675 - Validation dataset size after load: 2025
2024-10-27 17:09:15.208 | INFO     | __main__:main:1676 - Testing dataset size after load: 2121
2024-10-27 17:09:15.208 | INFO     | __main__:main:1678 - Starting progressive training from epoch 17 to 18
2024-10-27 17:09:15.208 | INFO     | __main__:main:1681 - hit the barrier before training
2024-10-27 17:09:15.235 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f9
06fdf657674a984effa8b/random/cache_train/cached_data.pkl
Training dataset size: 140562
2024-10-27 17:09:15.252 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fd
f657674a984effa8b/random/cache_val/cached_data.pkl
Validation dataset size: 2025
2024-10-27 17:09:15.269 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fd
f657674a984effa8b/random/cache_pred/cached_data.pkl
Testing dataset size: 2121
2024-10-27 17:09:15.269 | INFO     | __main__:main:1674 - Training dataset size after load: 140562
2024-10-27 17:09:15.269 | INFO     | __main__:main:1675 - Validation dataset size after load: 2025
2024-10-27 17:09:15.269 | INFO     | __main__:main:1676 - Testing dataset size after load: 2121
2024-10-27 17:09:15.270 | INFO     | __main__:main:1678 - Starting progressive training from epoch 17 to 18
2024-10-27 17:09:15.270 | INFO     | __main__:main:1681 - hit the barrier before training
An error occurred during training: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1683, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte

2024-10-27 17:09:15.923 | INFO     | __main__:main:1690 - Finished progressive training at epoch 0
2024-10-27 17:09:15.924 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:09:15.924 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
An error occurred during training: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1683, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte

2024-10-27 17:09:17.036 | INFO     | __main__:main:1690 - Finished progressive training at epoch 0
2024-10-27 17:09:17.037 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:09:17.037 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
An error occurred during training: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1683, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte

2024-10-27 17:09:17.687 | INFO     | __main__:main:1690 - Finished progressive training at epoch 0
2024-10-27 17:09:17.688 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:09:17.688 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
An error occurred during training: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1683, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte

2024-10-27 17:09:17.871 | INFO     | __main__:main:1690 - Finished progressive training at epoch 0
2024-10-27 17:09:17.871 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1f
a54ce749af297c6cf37_lambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:09:17.871 | INFO     | __main__:main:1697 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37_l
ambda_0.1_epoch=16-Recall@10_val=68.01.ckpt
2024-10-27 17:09:18.138 | INFO     | __main__:main:1707 - Testing...
2024-10-27 17:09:18.141 | INFO     | retrieval.main:run_cli:60 - PID: 2083664
[rank: 0] Seed set to 3407
2024-10-27 17:09:18.554 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a98
4effa8b/random
2024-10-27 17:09:18.555 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a
984effa8b/corpus.jsonl
2024-10-27 17:09:19.156 | INFO     | __main__:main:1707 - Testing...
2024-10-27 17:09:19.156 | INFO     | retrieval.main:run_cli:60 - PID: 2091106
[rank: 1] Seed set to 3407
2024-10-27 17:09:19.508 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a98
4effa8b/random
2024-10-27 17:09:19.509 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a
984effa8b/corpus.jsonl
2024-10-27 17:09:19.993 | INFO     | __main__:main:1707 - Testing...
2024-10-27 17:09:19.994 | INFO     | retrieval.main:run_cli:60 - PID: 2091107
2024-10-27 17:09:20.000 | INFO     | __main__:main:1707 - Testing...
2024-10-27 17:09:20.001 | INFO     | retrieval.main:run_cli:60 - PID: 2091108
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-27 17:09:20.348 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a98
4effa8b/random
2024-10-27 17:09:20.348 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a
984effa8b/corpus.jsonl
2024-10-27 17:09:20.374 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a98
4effa8b/random
2024-10-27 17:09:20.374 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a
984effa8b/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to ru
n Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-27 17:09:32.325 | INFO     | __main__:main:1843 - An error occurred: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1720, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 394, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 701, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 858, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 897, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
2024-10-27 17:09:35.893 | INFO     | __main__:main:1843 - An error occurred: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1720, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 394, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 701, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 858, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 897, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
2024-10-27 17:09:36.339 | INFO     | __main__:main:1843 - An error occurred: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1720, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 394, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 701, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 858, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 897, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
2024-10-27 17:09:36.426 | INFO     | __main__:main:1843 - An error occurred: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/mainfull.py", line 1720, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 394, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 701, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 858, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 897, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 102, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 189, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 255, in setup
    self.ds_train = RetrievalDataset(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 43, in __init__
    self.data = self.load_or_cache_data(data_paths)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 51, in load_or_cache_data
    data = pickle.load(file)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 11: invalid start byte
(base) yingzi_ma@compute-permanent-node-326:~/lean_project/ReProver$
