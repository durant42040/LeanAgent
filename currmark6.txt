  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 574, in load_state_dict
    return torch.load(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
196, in instantiate_classes
    cfg[subcommand] = subparser.instantiate_classes(cfg[subcommand], instantiate_groups=instantiate_groups)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
1065, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
190, in instantiate_classes
    component.instantiate_class(component, cfg)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
468, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_signatures.py",
line 599, in group_instantiate_class
    parent[key] = instantiator_fn(group.group_class, **value)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
449, in __init__
    super().__init__(open(name, mode))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_common.py", line
 148, in default_class_instantiator
    return class_type(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 49, in __init__
    self.encoder = T5EncoderModel.from_pretrained(model_name)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 3760, in from_pretrained
    state_dict = load_state_dict(resolved_archive_file)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 582, in load_state_dict
    with open(checkpoint_file) as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3.py", line 1484, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", lin
e 385, in __init__
    self.instantiate_classes()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", lin
e 535, in instantiate_classes
    self.config_init = self.parser.instantiate_classes(self.config)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
196, in instantiate_classes
    cfg[subcommand] = subparser.instantiate_classes(cfg[subcommand], instantiate_groups=instantiate_groups)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
190, in instantiate_classes
    component.instantiate_class(component, cfg)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_signatures.py",
line 599, in group_instantiate_class
    parent[key] = instantiator_fn(group.group_class, **value)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_common.py", line
 148, in default_class_instantiator
    return class_type(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 49, in __init__
    self.encoder = T5EncoderModel.from_pretrained(model_name)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 3760, in from_pretrained
    state_dict = load_state_dict(resolved_archive_file)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 582, in load_state_dict
    with open(checkpoint_file) as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'
2024-09-11 02:33:44.021 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/
slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to
run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --confi
g retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
^Z
[5]+  Stopped                 bash run_code3.sh
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ cd ..
(base) yingzi_ma@compute-permanent-node-514:~/lean_project$ cd .cace
bash: cd: .cace: No such file or directory
(base) yingzi_ma@compute-permanent-node-514:~/lean_project$ cd .cache
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/.cache$ ls
lean_dojo  lean_dojo.lock
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/.cache$ cd ..
(base) yingzi_ma@compute-permanent-node-514:~/lean_project$ cd ..
(base) yingzi_ma@compute-permanent-node-514:~$ ls
Visual-Prompt-Driving  chat_with_openai_api  lean_project  miniconda3  trajdata_test.py  unzip.py
(base) yingzi_ma@compute-permanent-node-514:~$ powd
Command 'powd' not found, did you mean:
  command 'pwd' from deb coreutils (8.32-4.1ubuntu1.2)
Try: apt install <deb name>
(base) yingzi_ma@compute-permanent-node-514:~$ pwd
/data/yingzi_ma
(base) yingzi_ma@compute-permanent-node-514:~$ cd .cache
(base) yingzi_ma@compute-permanent-node-514:~/.cache$ ls
Microsoft  conda  huggingface  lean_dojo  lean_dojo.lock  matplotlib  motd.legal-displayed  pip  torch  torc
h_extensions  wandb
(base) yingzi_ma@compute-permanent-node-514:~/.cache$ cd huggingface/
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface$ ls
hub  modules
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface$ cd hub
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface/hub$ ls
models--google--byt5-small  models--kaiyuy--leandojo-lean4-retriever-byt5-small  models--kaiyuy--leandojo-le
an4-retriever-tacgen-byt5-small  version.txt
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface/hub$ rm -rf models--google--byt5-small/ mod
els--kaiyuy--leandojo-lean4-retriever-byt5-small/ models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small
/
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface/hub$ ls
version.txt
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface/hub$ cd ..
(base) yingzi_ma@compute-permanent-node-514:~/.cache/huggingface$ cd ..
(base) yingzi_ma@compute-permanent-node-514:~/.cache$ cd ..
(base) yingzi_ma@compute-permanent-node-514:~$ cd lean_project/
(base) yingzi_ma@compute-permanent-node-514:~/lean_project$ cd ReProver
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ cd .cache^C


(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ bash run_code3.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_GCS.log': Permission
 denied
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_RAYLET.log': Permiss
ion denied
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_AUTOSCALER.log': Per
mission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_AUTOSCALER.log': Pe
rmission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_AUTOSCALER.log': Pe
rmission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_AUTOSCALER.log': Pe
rmission denied
Stopping ray
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=2190478, name='pyt
hon3')
Did not find any active Ray processes.
Running main3.py
[2024-09-11 02:44:20,226] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
2024-09-11 02:44:25.482 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 02:44:25.482 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 02:44:25.485 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 02:44:25.485 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 02:44:25.485 | INFO     | __main__:main:1209 - Starting the main process
2024-09-11 02:44:25.485 | INFO     | __main__:main:1217 - Loading database from /data/yingzi_ma/lean_project
/dynamic_database_PT_single_repo_no_ewc_curriculum.json
2024-09-11 02:45:16.240 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-11 02:45:16.240 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-11 02:45:22.402 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-11 02:45:22.402 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-11 02:45:29.467 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-11 02:45:29.467 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-11 02:45:37.353 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-11 02:45:37.353 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-11 02:45:47.503 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-11 02:45:47.504 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-11 02:45:56.896 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-11 02:45:56.897 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-11 02:45:58.819 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-11 02:45:58.819 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-11 02:45:58.959 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-11 02:45:58.959 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-11 02:46:00.521 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-11 02:46:00.522 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-11 02:46:11.502 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-11 02:46:11.503 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-11 02:46:11.857 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-11 02:46:11.857 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-11 02:46:12.460 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-11 02:46:12.460 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-11 02:46:12.600 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-11 02:46:12.600 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-11 02:46:12.687 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-11 02:46:12.687 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-11 02:46:13.396 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-11 02:46:13.396 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-11 02:46:14.506 | INFO     | __main__:main:1219 - Loaded database from /data/yingzi_ma/lean_project/
dynamic_database_PT_single_repo_no_ewc_curriculum.json
2024-09-11 02:46:14.507 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 02:46:14.507 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 02:46:14.951 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 02:46:31.288 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 02:46:48.933 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 02:47:05.476 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 02:47:23.452 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 02:47:40.995 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 02:47:40.996 | INFO     | __main__:main:1288 - i: 0
2024-09-11 02:47:40.996 | INFO     | __main__:main:1294 - Main process
2024-09-11 02:47:40.996 | INFO     | __main__:main:1295 - Using lambda = 0.1
2024-09-11 02:47:40.996 | INFO     | __main__:main:1296 - Processing https://github.com/dwrensha/compfiles
2024-09-11 02:47:40.997 | INFO     | __main__:main:1303 - Adding repo to repos_for_merged_dataset
2024-09-11 02:47:40.997 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 02:47:40.997 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:47:40.998 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:47:40.998 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 02:47:40.998 | INFO     | __main__:main:1330 - Starting training at epoch 1
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
tokenizer_config.json: 100%|████████████████████████████████████████████████████████████████████████████████
████████████████████████████████████████████████████████████████████████████████████████████████████| 25.6k/
25.6k [00:00<00:00, 183MB/s]
added_tokens.json: 100%|████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████| 3.02k/3
.02k [00:00<00:00, 36.3MB/s]
special_tokens_map.json: 100%|██████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████| 3.09k/3
.09k [00:00<00:00, 38.0MB/s]
config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████| 825
/825 [00:00<00:00, 10.7MB/s]
model.safetensors: 100%|████████████████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████████████████████████████████| 871M
/871M [00:07<00:00, 120MB/s]
2024-09-11 02:47:52.150 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/
slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to
run Lightning on SLURM, prepend your python command with `srun` like so: srun python main3.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-11 02:47:52.283 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 02:47:52.284 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
tokenizer_config.json: 100%|████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████| 2.59k/2
.59k [00:00<00:00, 28.0MB/s]
config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████████| 698
/698 [00:00<00:00, 9.29MB/s]
special_tokens_map.json: 100%|██████████████████████████████████████████████████████████████████████████████
███████████████████████████████████████████████████████████████████████████████████████████████████| 2.50k/2
.50k [00:00<00:00, 30.0MB/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 02:47:53.155 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 02:48:12.792 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:48:12.822 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:48:12.852 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:48:12.852 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 02:48:12.852 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 02:48:12.852 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 02:48:12.852 | INFO     | __main__:main:1445 - Starting progressive training from epoch 1 to 2
2024-09-11 02:48:12.852 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-11 02:48:20,250] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
[2024-09-11 02:48:20,250] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
[2024-09-11 02:48:20,250] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
^Z
[6]+  Stopped                 bash run_code3.sh
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ ls ../checkpoints_PT_single_repo_no_ewc
_curriculum
 mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt  'merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt'
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ ls ../checkpoints_PT_single_repo_no_ewc
_curriculum
 mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt  'merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt'
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ bash run_code3.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_GCS.log': Permission
 denied
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_RAYLET.log': Permiss
ion denied
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_AUTOSCALER.log': Per
mission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_AUTOSCALER.log': Pe
rmission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_AUTOSCALER.log': Pe
rmission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_AUTOSCALER.log': Pe
rmission denied
Stopping ray
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=2190478, name='pyt
hon3')
Did not find any active Ray processes.
Running main3.py
[2024-09-11 02:49:26,880] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
2024-09-11 02:49:31.243 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 02:49:31.243 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 02:49:31.246 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 02:49:31.246 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 02:49:31.246 | INFO     | __main__:main:1209 - Starting the main process
2024-09-11 02:49:31.246 | INFO     | __main__:main:1217 - Loading database from /data/yingzi_ma/lean_project
/dynamic_database_PT_single_repo_no_ewc_curriculum.json
2024-09-11 02:50:22.382 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-11 02:50:22.382 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-11 02:50:28.630 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-11 02:50:28.630 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-11 02:50:35.784 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-11 02:50:35.785 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-11 02:50:43.786 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-11 02:50:43.786 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-11 02:50:54.069 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-11 02:50:54.069 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-11 02:51:03.591 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-11 02:51:03.592 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-11 02:51:05.547 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-11 02:51:05.547 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-11 02:51:05.689 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-11 02:51:05.689 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-11 02:51:07.280 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-11 02:51:07.280 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-11 02:51:18.354 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-11 02:51:18.355 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-11 02:51:18.718 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-11 02:51:18.718 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-11 02:51:19.341 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-11 02:51:19.341 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-11 02:51:19.485 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-11 02:51:19.485 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-11 02:51:19.574 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-11 02:51:19.574 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-11 02:51:20.310 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-11 02:51:20.310 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-11 02:51:21.462 | INFO     | __main__:main:1219 - Loaded database from /data/yingzi_ma/lean_project/
dynamic_database_PT_single_repo_no_ewc_curriculum.json
2024-09-11 02:51:21.463 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 02:51:21.463 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 02:51:21.856 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 02:51:38.163 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 02:51:55.804 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 02:52:11.971 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 02:52:29.833 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 02:52:47.674 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 02:52:47.674 | INFO     | __main__:main:1288 - i: 0
2024-09-11 02:52:47.674 | INFO     | __main__:main:1294 - Main process
2024-09-11 02:52:47.675 | INFO     | __main__:main:1295 - Using lambda = 0.1
2024-09-11 02:52:47.675 | INFO     | __main__:main:1296 - Processing https://github.com/dwrensha/compfiles
2024-09-11 02:52:47.675 | INFO     | __main__:main:1303 - Adding repo to repos_for_merged_dataset
2024-09-11 02:52:47.675 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 02:52:47.676 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:52:47.676 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:52:47.676 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 02:52:47.676 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 02:52:50.165 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/
slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to
run Lightning on SLURM, prepend your python command with `srun` like so: srun python main3.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-11 02:52:50.265 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 02:52:50.265 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 02:52:50.362 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 02:53:10.518 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:53:10.546 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:53:10.575 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:53:10.576 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 02:53:10.576 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 02:53:10.576 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 02:53:10.576 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 02:53:10.576 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-11 02:53:16,096] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
[2024-09-11 02:53:16,096] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
[2024-09-11 02:53:16,097] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
2024-09-11 02:53:20.171 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 02:53:20.171 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 02:53:20.171 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 02:53:20.171 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 02:53:20.171 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 02:53:20.171 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 02:53:20.174 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 02:53:20.174 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 02:53:20.174 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 02:53:20.174 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 02:53:20.174 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 02:53:20.174 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 02:53:20.174 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 02:53:20.174 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 02:53:20.174 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 02:53:20.174 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 02:53:20.174 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 02:53:20.174 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 02:53:20.372 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 02:53:20.379 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 02:53:20.391 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 02:53:36.547 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 02:53:36.718 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 02:53:36.872 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 02:53:53.991 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 02:53:54.218 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 02:53:54.601 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 02:54:10.311 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 02:54:10.478 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 02:54:10.923 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 02:54:28.075 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 02:54:28.418 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 02:54:28.657 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 02:54:45.579 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 02:54:45.579 | INFO     | __main__:main:1288 - i: 0
2024-09-11 02:54:45.579 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 02:54:45.580 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:45.580 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:45.580 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 02:54:45.580 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 02:54:45.931 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 02:54:45.931 | INFO     | __main__:main:1288 - i: 0
2024-09-11 02:54:45.931 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 02:54:45.932 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:45.932 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:45.932 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 02:54:45.932 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 02:54:46.385 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 02:54:46.385 | INFO     | __main__:main:1288 - i: 0
2024-09-11 02:54:46.385 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 02:54:46.386 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:46.386 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:46.386 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 02:54:46.386 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 02:54:48.788 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:48.865 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:48.889 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 02:54:48.890 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-09-11 02:54:48.909 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 02:54:48.909 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 02:54:48.981 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 02:54:49.008 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 02:54:49.320 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:54:49.366 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 02:54:49.367 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 02:54:49.454 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 02:55:17.603 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:55:17.630 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:17.660 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:55:17.660 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 02:55:17.660 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 02:55:17.660 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 02:55:17.660 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 02:55:17.660 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-11 02:55:27.209 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:55:27.234 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:27.262 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:55:27.262 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 02:55:27.262 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 02:55:27.262 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 02:55:27.262 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 02:55:27.262 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-09-11 02:55:28.128 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:55:28.153 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:28.181 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:55:28.181 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 02:55:28.181 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 02:55:28.182 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 02:55:28.182 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 02:55:28.182 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-11 02:55:38.419 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
2024-09-11 02:55:38.556 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:55:38.613 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:38.651 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
Training dataset size: 362149
2024-09-11 02:55:38.741 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:38.773 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:55:40.807 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:55:41.039 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:41.087 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 02:55:44.615 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 02:55:44.856 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 02:55:44.901 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_chec
kpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculu
m exists and is not empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_
curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_v
al=61.55.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-11 02:55:46.595 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-11 02:55:46.595 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-11 02:55:46.596 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-11 02:55:46.597 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_cu
rriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val
=61.55.ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-11 02:55:50.191 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 02:55:50.360 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 02:55:50.666 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 02:55:50.681 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 02:55:50.683 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 02:55:50.683 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 02:55:50.683 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 02:55:50.683 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 02:55:50.683 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:50.683 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 02:55:52.777 | INFO     | __main__:main:1473 - Testing...
2024-09-11 02:55:52.778 | INFO     | retrieval.main:run_cli:60 - PID: 1942722
2024-09-11 02:55:52.921 | INFO     | __main__:main:1473 - Testing...
2024-09-11 02:55:52.922 | INFO     | retrieval.main:run_cli:60 - PID: 1942723
[rank: 1] Seed set to 3407
2024-09-11 02:55:52.972 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 02:55:52.972 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-11 02:55:53.212 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 02:55:53.212 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
2024-09-11 02:55:53.274 | INFO     | __main__:main:1473 - Testing...
2024-09-11 02:55:53.276 | INFO     | retrieval.main:run_cli:60 - PID: 1940460
[rank: 0] Seed set to 3407
2024-09-11 02:55:53.459 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 02:55:53.460 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
2024-09-11 02:55:53.508 | INFO     | __main__:main:1473 - Testing...
2024-09-11 02:55:53.509 | INFO     | retrieval.main:run_cli:60 - PID: 1942724
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
[rank: 3] Seed set to 3407
2024-09-11 02:55:53.697 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 02:55:53.697 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
pytorch_model.bin: 100%|███████████████████████████████████████████████| 1.20G/1.20G [00:03<00:00, 372MB/s]
2024-09-11 02:55:57.409 | INFO     | __main__:main:1986 - An error occurred: [Errno 2] No such file or direc
tory: '/data/yingzi_ma/.cache/huggingface/hub/models--google--byt5-small/snapshots/68377bdc18a2ffec8a0533fef
03b1c513a4dd49d/pytorch_model.bin'
2024-09-11 02:55:57.409 | INFO     | __main__:main:1986 - An error occurred: [Errno 2] No such file or direc
tory: '/data/yingzi_ma/.cache/huggingface/hub/models--google--byt5-small/snapshots/68377bdc18a2ffec8a0533fef
03b1c513a4dd49d/pytorch_model.bin'
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 574, in load_state_dict
    return torch.load(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
1065, in load
    with _open_file_like(f, 'rb') as opened_file:
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
468, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
449, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 574, in load_state_dict
    return torch.load(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
1065, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
468, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/serialization.py", line
449, in __init__
    super().__init__(open(name, mode))

During handling of the above exception, another exception occurred:

FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3.py", line 1486, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", lin
e 385, in __init__
    self.instantiate_classes()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", lin
e 535, in instantiate_classes
    self.config_init = self.parser.instantiate_classes(self.config)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
196, in instantiate_classes
    cfg[subcommand] = subparser.instantiate_classes(cfg[subcommand], instantiate_groups=instantiate_groups)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
190, in instantiate_classes
    component.instantiate_class(component, cfg)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_signatures.py",
line 599, in group_instantiate_class
    parent[key] = instantiator_fn(group.group_class, **value)

During handling of the above exception, another exception occurred:

  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_common.py", line
 148, in default_class_instantiator
    return class_type(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 49, in __init__
    self.encoder = T5EncoderModel.from_pretrained(model_name)
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 3760, in from_pretrained
    state_dict = load_state_dict(resolved_archive_file)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 582, in load_state_dict
    with open(checkpoint_file) as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'
  File "/data/yingzi_ma/lean_project/ReProver/main3.py", line 1486, in main
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 63, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 19, in __init__
    super().__init__(*args,
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", lin
e 385, in __init__
    self.instantiate_classes()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", lin
e 535, in instantiate_classes
    self.config_init = self.parser.instantiate_classes(self.config)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
196, in instantiate_classes
    cfg[subcommand] = subparser.instantiate_classes(cfg[subcommand], instantiate_groups=instantiate_groups)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_deprecated.py",
line 140, in patched_instantiate_classes
    cfg = self._unpatched_instantiate_classes(cfg, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_core.py", line 1
190, in instantiate_classes
    component.instantiate_class(component, cfg)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_signatures.py",
line 599, in group_instantiate_class
    parent[key] = instantiator_fn(group.group_class, **value)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/jsonargparse/_common.py", line
 148, in default_class_instantiator
    return class_type(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 49, in __init__
    self.encoder = T5EncoderModel.from_pretrained(model_name)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 3760, in from_pretrained
    state_dict = load_state_dict(resolved_archive_file)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py
", line 582, in load_state_dict
    with open(checkpoint_file) as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/.cache/huggingface/hub/models--goog
le--byt5-small/snapshots/68377bdc18a2ffec8a0533fef03b1c513a4dd49d/pytorch_model.bin'
2024-09-11 02:55:57.716 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 02:55:57.727 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/
slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to
run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --confi
g retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
^Z
[7]+  Stopped                 bash run_code3.sh
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ bash run_code3.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_GCS.log': Permission
 denied
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_RAYLET.log': Permiss
ion denied
rm: cannot remove '/tmp/ray/session_2024-08-11_18-51-16_685675_730185/logs/events/event_AUTOSCALER.log': Per
mission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-38-44_613233_3568585/logs/events/event_AUTOSCALER.log': Pe
rmission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_22-43-54_089028_3572845/logs/events/event_AUTOSCALER.log': Pe
rmission denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_GCS.log': Permissio
n denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_RAYLET.log': Permis
sion denied
rm: cannot remove '/tmp/ray/session_2024-09-07_21-51-21_516441_3539737/logs/events/event_AUTOSCALER.log': Pe
rmission denied
Stopping ray
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=2190478, name='pyt
hon3')
Did not find any active Ray processes.
Running main3.py
[2024-09-11 02:58:36,018] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
2024-09-11 02:58:39.912 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 02:58:39.912 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 02:58:39.915 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 02:58:39.915 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 02:58:39.915 | INFO     | __main__:main:1209 - Starting the main process
2024-09-11 02:58:39.915 | INFO     | __main__:main:1217 - Loading database from /data/yingzi_ma/lean_project
/dynamic_database_PT_single_repo_no_ewc_curriculum.json
2024-09-11 02:59:30.861 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-11 02:59:30.861 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-11 02:59:37.263 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-11 02:59:37.264 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/ImperialCollegeLondon/FLT (commit: b208a302cdcbfadce33d8165f0b054bfa17e2147)
2024-09-11 02:59:44.615 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-11 02:59:44.616 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-11 02:59:52.840 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-11 02:59:52.840 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-11 03:00:03.404 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-11 03:00:03.404 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/dwrensha/compfiles (commit: f99bf6f2928d47dd1a445b414b3a723c2665f091)
2024-09-11 03:00:13.286 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-11 03:00:13.286 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/google-deepmind/debate (commit: 7fb39251b705797ee54e08c96177fabd29a5b5a3)
2024-09-11 03:00:15.269 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-11 03:00:15.269 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/avigad/mathematics_in_lean_source (commit: 5297e0fb051367c48c0a084411853a576389ecf5)
2024-09-11 03:00:15.412 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-11 03:00:15.412 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/digama0/lean4lean (commit: 05b1f4a68c5facea96a5ee51c6a56fef21276e0f)
2024-09-11 03:00:17.007 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-11 03:00:17.007 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-11 03:00:28.666 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-11 03:00:28.667 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/yuma-mizuno/lean-math-workshop (commit: 5acd4b933d47fd6c1032798a6046c1baf261445d)
2024-09-11 03:00:29.026 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-11 03:00:29.027 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/loganrjmurphy/LeanEuclid (commit: f1912c3090eb82820575758efc31e40b9db86bb8)
2024-09-11 03:00:29.643 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-11 03:00:29.643 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/FormalizedFormalLogic/Foundation (commit: d5fe5d057a90a0703a745cdc318a1b6621490c21)
2024-09-11 03:00:29.787 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-11 03:00:29.787 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/leanprover-community/lean-auto (commit: 0f5f39a0336e36ae4ba8ab45b27865ebd9f8f025)
2024-09-11 03:00:29.875 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-11 03:00:29.875 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/nomeata/loogle (commit: 387ab85308ce817bb95cc99730025eb44cb8a9ab)
2024-09-11 03:00:30.596 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: htt
ps://github.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-11 03:00:30.597 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://git
hub.com/leanprover-community/con-nf (commit: 00bdc85ba7d486a9e544a0806a1018dd06fa3856)
2024-09-11 03:00:31.760 | INFO     | __main__:main:1219 - Loaded database from /data/yingzi_ma/lean_project/
dynamic_database_PT_single_repo_no_ewc_curriculum.json
2024-09-11 03:00:31.761 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 03:00:31.761 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 03:00:32.162 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 03:00:48.731 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 03:01:06.378 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 03:01:23.079 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 03:01:40.856 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 03:01:58.583 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 03:01:58.583 | INFO     | __main__:main:1288 - i: 0
2024-09-11 03:01:58.583 | INFO     | __main__:main:1294 - Main process
2024-09-11 03:01:58.583 | INFO     | __main__:main:1295 - Using lambda = 0.1
2024-09-11 03:01:58.584 | INFO     | __main__:main:1296 - Processing https://github.com/dwrensha/compfiles
2024-09-11 03:01:58.584 | INFO     | __main__:main:1303 - Adding repo to repos_for_merged_dataset
2024-09-11 03:01:58.584 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 03:01:58.585 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:01:58.585 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:01:58.585 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 03:01:58.585 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 03:02:01.189 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/
slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to
run Lightning on SLURM, prepend your python command with `srun` like so: srun python main3.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-11 03:02:01.292 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 03:02:01.293 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 03:02:01.468 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 03:02:21.542 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:02:21.571 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 03:02:21.600 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:02:21.600 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 03:02:21.600 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 03:02:21.600 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 03:02:21.600 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 03:02:21.600 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-11 03:02:27,089] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
[2024-09-11 03:02:27,093] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
[2024-09-11 03:02:27,093] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (a
uto detect)
2024-09-11 03:02:31.131 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 03:02:31.131 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 03:02:31.131 | INFO     | __main__:main:1196 - Running progressive training
2024-09-11 03:02:31.131 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 03:02:31.131 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 03:02:31.131 | INFO     | __main__:main:1202 - Configuring LeanDojo...
2024-09-11 03:02:31.134 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 03:02:31.134 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 03:02:31.134 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 03:02:31.134 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working direc
tory: /data/yingzi_ma/lean_project/ReProver
2024-09-11 03:02:31.134 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 03:02:31.134 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 03:02:31.134 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 03:02:31.134 | INFO     | __main__:main:1204 - LeanDojo configured
2024-09-11 03:02:31.134 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 03:02:31.135 | INFO     | __main__:main:1226 - Found 15 repositories
2024-09-11 03:02:31.135 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 03:02:31.135 | INFO     | __main__:main:1229 - Starting curriculum learning
2024-09-11 03:02:31.338 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 03:02:31.344 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 03:02:31.346 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0
2024-09-11 03:02:47.719 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 03:02:47.790 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 03:02:47.966 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc2
2024-09-11 03:03:05.321 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 03:03:05.530 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 03:03:05.682 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.8.0-rc1
2024-09-11 03:03:21.619 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 03:03:22.008 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 03:03:22.281 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0
2024-09-11 03:03:39.119 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 03:03:39.680 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 03:03:40.343 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit
 hash for lean4 v4.7.0-rc2
2024-09-11 03:03:56.602 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 03:03:56.602 | INFO     | __main__:main:1288 - i: 0
2024-09-11 03:03:56.603 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 03:03:56.603 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:56.604 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:56.604 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 03:03:56.604 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 03:03:57.342 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 03:03:57.342 | INFO     | __main__:main:1288 - i: 0
2024-09-11 03:03:57.342 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 03:03:57.343 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:57.343 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:57.343 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 03:03:57.343 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 03:03:58.333 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 03:03:58.333 | INFO     | __main__:main:1288 - i: 0
2024-09-11 03:03:58.333 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 03:03:58.334 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:58.335 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:58.335 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 03:03:58.335 | INFO     | __main__:main:1330 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-11 03:03:59.566 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:03:59.682 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 03:03:59.682 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 03:03:59.782 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 03:04:00.209 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:00.257 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 03:04:00.257 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 03:04:00.348 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 03:04:01.308 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:01.413 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 03:04:01.413 | INFO     | __main__:main:1427 - Data path: /data/yingzi_ma/lean_project/datasets_P
T_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 03:04:01.515 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 03:04:28.243 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:04:28.272 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 03:04:28.304 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:04:28.304 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 03:04:28.305 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 03:04:28.305 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 03:04:28.305 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 03:04:28.305 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-11 03:04:28.607 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:04:28.633 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 03:04:28.662 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:04:28.662 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 03:04:28.662 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 03:04:28.662 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 03:04:28.662 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 03:04:28.662 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-11 03:04:30.867 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:04:30.893 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 03:04:30.921 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:04:30.921 | INFO     | __main__:main:1441 - Training dataset size after load: 362149
2024-09-11 03:04:30.921 | INFO     | __main__:main:1442 - Validation dataset size after load: 5053
2024-09-11 03:04:30.921 | INFO     | __main__:main:1443 - Testing dataset size after load: 5133
2024-09-11 03:04:30.921 | INFO     | __main__:main:1445 - Starting progressive training from epoch 0 to 1
2024-09-11 03:04:30.921 | INFO     | __main__:main:1448 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-11 03:04:41.422 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:04:41.606 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 03:04:41.642 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:04:43.972 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
2024-09-11 03:04:44.026 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:04:44.218 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Training dataset size: 362149
Validation dataset size: 5053
2024-09-11 03:04:44.269 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
2024-09-11 03:04:44.274 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Testing dataset size: 5133
Validation dataset size: 5053
2024-09-11 03:04:44.322 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:04:45.402 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:04:45.590 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_val/cached_data.pkl
Validation dataset size: 5053
2024-09-11 03:04:45.623 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_chec
kpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculu
m exists and is not empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_
curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_v
al=61.55.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py
:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the defaul
t pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary c
ode during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for mor
e details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits
 the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be l
oaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_glo
bals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control
 of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-11 03:04:47.483 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-11 03:04:47.486 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-11 03:04:47.486 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-11 03:04:47.487 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_cu
rriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val
=61.55.ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-11 03:04:50.972 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 03:04:51.250 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 03:04:51.563 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 03:04:51.574 | INFO     | __main__:main:1451 - hit the barrier after training
2024-09-11 03:04:51.577 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 03:04:51.577 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 03:04:51.577 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 03:04:51.577 | INFO     | __main__:main:1457 - Finished progressive training at epoch 1
2024-09-11 03:04:51.577 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:51.577 | INFO     | __main__:main:1464 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 03:04:54.118 | INFO     | __main__:main:1473 - Testing...
2024-09-11 03:04:54.119 | INFO     | retrieval.main:run_cli:60 - PID: 1948595
2024-09-11 03:04:54.233 | INFO     | __main__:main:1473 - Testing...
2024-09-11 03:04:54.234 | INFO     | retrieval.main:run_cli:60 - PID: 1948593
2024-09-11 03:04:54.277 | INFO     | __main__:main:1473 - Testing...
2024-09-11 03:04:54.278 | INFO     | retrieval.main:run_cli:60 - PID: 1948594
[rank: 3] Seed set to 3407
2024-09-11 03:04:54.311 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 03:04:54.311 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-11 03:04:54.513 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 03:04:54.513 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-11 03:04:54.549 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 03:04:54.549 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
2024-09-11 03:04:54.793 | INFO     | __main__:main:1473 - Testing...
2024-09-11 03:04:54.795 | INFO     | retrieval.main:run_cli:60 - PID: 1946054
2024-09-11 03:04:54.833 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-11 03:04:54.979 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_
ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b41
4b3a723c2665f091/random
2024-09-11 03:04:54.979 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingz
i_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
2024-09-11 03:04:55.030 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.p
y:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
 behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more deta
ils check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-11 03:04:55.291 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
2024-09-11 03:04:55.509 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/
slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to
run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --confi
g retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-11 03:05:36.973 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:05:37.006 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:05:41.656 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:05:41.683 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:05:45.089 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:05:45.111 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-11 03:05:45.132 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-11 03:05:45.153 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /da
ta/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47
dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_
curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_v
al=61.55.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_c
urriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_va
l=61.55.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-11 03:05:48.963 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict sta
rt: True
2024-09-11 03:05:48.964 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                              | 0/2783 [00:00<?, ?it/s]
2024-09-11 03:05:49.167 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict sta
rt: True
2024-09-11 03:05:49.168 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                              | 0/2783 [00:00<?, ?it/s]
2024-09-11 03:05:49.223 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict sta
rt: True
2024-09-11 03:05:49.224 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
Predicting: |                                                                         | 0/? [00:00<?, ?it/s]
2024-09-11 03:05:49.666 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict sta
rt: True
2024-09-11 03:05:49.666 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████| 2783/2783 [16:23<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████| 2783/2783 [16:24<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████| 2783/2783 [36:14<00:00,  1.28it/s]
100%|███████████████████████████████████████████████████████████████████| 2783/2783 [54:08<00:00,  1.17s/it]
Predicting DataLoader 0:   0%|                                                       | 0/21 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loo
p.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|██████████████████████████████████████████████| 21/21 [01:16<00:00,  0.28it/s]
2024-09-11 04:01:14.414 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictio
ns map
2024-09-11 04:01:14.419 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictio
ns map
2024-09-11 04:01:14.419 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictio
ns map
2024-09-11 04:01:14.425 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictio
ns map
2024-09-11 04:01:14.583 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved
to test_pickle_2.pkl
2024-09-11 04:01:14.584 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-11 04:01:14.587 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved
to test_pickle_0.pkl
2024-09-11 04:01:14.587 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-11 04:01:14.652 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved
to test_pickle_1.pkl
2024-09-11 04:01:14.653 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-11 04:01:14.656 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved
to test_pickle_3.pkl
2024-09-11 04:01:14.656 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-11 04:01:14.659 | INFO     | retrieval.model:on_predict_epoch_end:567 - All GPUs have completed thei
r predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████| 21/21 [01:16<00:00,  0.27it/s]
2024-09-11 04:01:15.898 | INFO     | __main__:main:1604 - Finished processing the repository
2024-09-11 04:01:15.898 | INFO     | __main__:main:1606 - current epoch: 1
2024-09-11 04:01:15.899 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 04:01:15.899 | INFO     | __main__:main:1288 - i: 1
2024-09-11 04:01:15.899 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 04:01:15.901 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:15.901 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:15.901 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 04:01:15.901 | INFO     | __main__:main:1330 - Starting training at epoch 1
[rank: 2] Seed set to 3407
2024-09-11 04:01:15.918 | INFO     | __main__:main:1604 - Finished processing the repository
2024-09-11 04:01:15.918 | INFO     | __main__:main:1606 - current epoch: 1
2024-09-11 04:01:15.918 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 04:01:15.918 | INFO     | __main__:main:1288 - i: 1
2024-09-11 04:01:15.918 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 04:01:15.919 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:15.919 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:15.920 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 04:01:15.920 | INFO     | __main__:main:1330 - Starting training at epoch 1
[rank: 3] Seed set to 3407
2024-09-11 04:01:15.954 | INFO     | __main__:main:1604 - Finished processing the repository
2024-09-11 04:01:15.956 | INFO     | __main__:main:1606 - current epoch: 1
2024-09-11 04:01:15.956 | INFO     | __main__:main:1287 - length of lean_git_repos: 15
2024-09-11 04:01:15.956 | INFO     | __main__:main:1288 - i: 1
2024-09-11 04:01:15.956 | INFO     | __main__:main:1316 - All GPUs
2024-09-11 04:01:15.958 | INFO     | __main__:find_latest_checkpoint:516 - Using the latest checkpoint: /dat
a/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d
47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:15.958 | INFO     | __main__:main:1323 - Found latest checkpoint: /data/yingzi_ma/lean_proj
ect/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2
665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:15.958 | INFO     | __main__:main:1329 - Inside train_test_fisher
2024-09-11 04:01:15.958 | INFO     | __main__:main:1330 - Starting training at epoch 1
[rank: 1] Seed set to 3407
2024-09-11 04:01:16.900 | INFO     | __main__:main:1495 - Loaded the predictions pickle files
2024-09-11 04:01:17.013 | INFO     | __main__:main:1498 - Evaluating on /data/yingzi_ma/lean_project/dataset
s_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
/test.json
100%|████████████████████████████████████████████████████████████████| 2427/2427 [00:00<00:00, 19693.55it/s]
2024-09-11 04:01:17.139 | INFO     | __main__:main:1500 - R@1 = 22.60787137723824 %, R@10 = 60.6470636323712
2 %, MRR = 0.5188623950851269
2024-09-11 04:01:17.141 | INFO     | __main__:main:1515 - Average R@1 = 22.60787137723824 %, R@10 = 60.64706
363237122 %, MRR = 0.5188623950851269
2024-09-11 04:01:17.142 | INFO     | __main__:main:1551 - Starting the prover
2024-09-11 04:01:17.142 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-11 04:01:17.142 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-11 04:01:17.142 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-11 04:01:17.143 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest check
point: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f
99bf6f2928d47dd1a445b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your
files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-11 04:01:18.070 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_
ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445
b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:18.070 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_
ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445
b414b3a723c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:18.794 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:18.831 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:18.895 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 04:01:18.895 | INFO     | __main__:main:1412 - right before barrier for data module
2024-09-11 04:01:19.188 | INFO     | __main__:main:1354 - Loaded premise retriever at /data/yingzi_ma/lean_p
roject/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a72
3c2665f091_lambda_0.1_epoch=0-Recall@10_val=61.55.ckpt
2024-09-11 04:01:19.238 | INFO     | __main__:main:1412 - right before barrier for data module
tokenizer_config.json: 100%|████████████████████████████████████████████| 25.6k/25.6k [00:00<00:00, 103MB/s]
added_tokens.json: 100%|███████████████████████████████████████████████| 3.02k/3.02k [00:00<00:00, 32.0MB/s]
special_tokens_map.json: 100%|█████████████████████████████████████████| 3.09k/3.09k [00:00<00:00, 33.4MB/s]
config.json: 100%|█████████████████████████████████████████████████████████| 837/837 [00:00<00:00, 8.30MB/s]
model.safetensors: 100%|████████████████████████████████████████████████| 1.20G/1.20G [00:05<00:00, 217MB/s]
generation_config.json: 100%|██████████████████████████████████████████████| 142/142 [00:00<00:00, 1.36MB/s]
2024-09-11 04:01:29.545 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184:
Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', '
retriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.w
eight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block
.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'ret
riever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.enc
oder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weig
ht', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.Sel
fAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight
', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.enc
oder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttenti
on.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weig
ht', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever
.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weig
ht', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.Sel
fAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight
', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.enc
oder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttenti
on.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weig
ht', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever
.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weig
ht', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.Sel
fAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight
', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.enc
oder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttenti
on.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weig
ht', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
8.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever
.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weig
ht', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.enco
der.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm
.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encode
r.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.w
o.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.
11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 're
triever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.
0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encode
r.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseRel
uDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encod
er.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188:
Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global
_step', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-11 04:01:30.800 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/le
an_project/model_lightning.ckpt
2024-09-11 04:01:30.802 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-11 04:01:30.802 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yi
ngzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a4
45b414b3a723c2665f091/corpus.jsonl
2024-09-11 04:01:30.802 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_pro
ject/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c266
5f091/corpus.jsonl

