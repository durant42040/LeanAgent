(base) yingzi_ma@cais-login-0:~/lean_project/ReProver$ srun --partition=compute --gpus=4 --nodes=1 --time=2-00:00:00 --pty /bin/bash
srun: job 44471 queued and waiting for resources
srun: job 44471 has been allocated resources
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ bash run_code3_more_sorries.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
kill: (7004): Operation not permitted
kill: (8172): Operation not permitted
kill: (8590): Operation not permitted
kill: (10985): Operation not permitted
kill: (11251): Operation not permitted
kill: (11252): Operation not permitted
kill: (11254): Operation not permitted
kill: (11261): Operation not permitted
kill: (11305): Operation not permitted
kill: (11373): Operation not permitted
kill: (11374): Operation not permitted
kill: (11375): Operation not permitted
kill: (11382): Operation not permitted
kill: (11685): Operation not permitted
kill: (11744): Operation not permitted
kill: (11745): Operation not permitted
kill: (11746): Operation not permitted
kill: (11753): Operation not permitted
kill: (3215890): Operation not permitted
kill: (3215906): Operation not permitted
kill: (3215917): Operation not permitted
kill: (3426112): Operation not permitted
kill: (3556613): Operation not permitted
kill: (3584233): Operation not permitted
kill: (3658353): No such process
Sat Sep 28 03:21:31 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   40C    P0             92W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   36C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   36C    P0             85W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   38C    P0             90W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running main3_more_sorries.py
[2024-09-28 03:21:40,055] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-28 03:21:45.445 | INFO     | __main__:main:1606 - Running progressive training
2024-09-28 03:21:45.445 | INFO     | __main__:main:1612 - Configuring LeanDojo...
2024-09-28 03:21:45.448 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-28 03:21:45.448 | INFO     | __main__:main:1614 - LeanDojo configured
2024-09-28 03:21:45.448 | INFO     | __main__:main:1619 - Starting the main process
2024-09-28 03:21:45.448 | INFO     | __main__:main:1627 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_sorries_with_14.json
2024-09-28 03:22:38.952 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-09-28 03:22:38.952 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-09-28 03:22:45.864 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/apnelson1/Matroid (commit: 244315752bb0a771f20b676b946130b664d60712)
2024-09-28 03:22:45.864 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/apnelson1/Matroid (commit: 244315752bb0a771f20b676b946130b664d60712)
2024-09-28 03:22:54.074 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-09-28 03:22:54.074 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-09-28 03:22:55.885 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-09-28 03:22:55.885 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-09-28 03:23:04.734 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-09-28 03:23:04.734 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-09-28 03:23:06.493 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-09-28 03:23:06.493 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-09-28 03:23:16.445 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-28 03:23:16.445 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-28 03:23:16.925 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-09-28 03:23:16.925 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-09-28 03:23:18.741 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f5
15a0e52878)
2024-09-28 03:23:18.742 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f515a0e528
78)
2024-09-28 03:23:30.049 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/corent1234/hairy-ball-theorem-lean (commit: a778826d19c8a7ddf1d26beeea628c45450612e6)
2024-09-28 03:23:30.050 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/corent1234/hairy-ball-theorem-lean (commit: a778826d19c8a7ddf1d26beeea628c45450612e6)
2024-09-28 03:23:31.087 | INFO     | __main__:main:1629 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_sorries_with_14.json
2024-09-28 03:23:31.088 | INFO     | __main__:main:1636 - Found 100 repositories
2024-09-28 03:23:31.088 | INFO     | __main__:main:1639 - Starting curriculum learning
2024-09-28 03:24:00.128 | INFO     | __main__:main:2482 - An error occurred: Failed to read repository information after multiple attempts
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_more_sorries.py", line 1763, in main
    with open(repo_info_file, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/github_search_results_updated_full.json'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main3_more_sorries.py", line 1768, in main
    raise Exception("Failed to read repository information after multiple attempts")
Exception: Failed to read repository information after multiple attempts
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ cd ../datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14$ ls
repo_info_compatible.json
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14$ vim repo_info_compatible.json
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14$ vim repo_info_compatible.json
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14$ cd ../ReProver/
(base) yingzi_ma@compute-permanent-node-514:~/lean_project/ReProver$ bash run_code3_more_sorries.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
kill: (7004): Operation not permitted
kill: (8172): Operation not permitted
kill: (8590): Operation not permitted
kill: (10985): Operation not permitted
kill: (11251): Operation not permitted
kill: (11252): Operation not permitted
kill: (11254): Operation not permitted
kill: (11261): Operation not permitted
kill: (11305): Operation not permitted
kill: (11373): Operation not permitted
kill: (11374): Operation not permitted
kill: (11375): Operation not permitted
kill: (11382): Operation not permitted
kill: (11685): Operation not permitted
kill: (11744): Operation not permitted
kill: (11745): Operation not permitted
kill: (11746): Operation not permitted
kill: (11753): Operation not permitted
kill: (3215890): Operation not permitted
kill: (3215906): Operation not permitted
kill: (3215917): Operation not permitted
kill: (3426112): Operation not permitted
kill: (3556613): Operation not permitted
kill: (3584233): Operation not permitted
kill: (3661101): No such process
Sat Sep 28 03:26:13 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   40C    P0             92W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   37C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   36C    P0             85W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   38C    P0             90W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running main3_more_sorries.py
[2024-09-28 03:26:19,924] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-28 03:26:23.764 | INFO     | __main__:main:1606 - Running progressive training
2024-09-28 03:26:23.764 | INFO     | __main__:main:1612 - Configuring LeanDojo...
2024-09-28 03:26:23.767 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-28 03:26:23.767 | INFO     | __main__:main:1614 - LeanDojo configured
2024-09-28 03:26:23.767 | INFO     | __main__:main:1619 - Starting the main process
2024-09-28 03:26:23.767 | INFO     | __main__:main:1627 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_sorries_with_14.json
2024-09-28 03:27:16.870 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-09-28 03:27:16.870 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-09-28 03:27:23.852 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/apnelson1/Matroid (commit: 244315752bb0a771f20b676b946130b664d60712)
2024-09-28 03:27:23.852 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/apnelson1/Matroid (commit: 244315752bb0a771f20b676b946130b664d60712)
2024-09-28 03:27:32.193 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-09-28 03:27:32.193 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/mo271/formal_book (commit: 6fbe8c2985008c0bfb30050750a71b90388ad3a3)
2024-09-28 03:27:33.989 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-09-28 03:27:33.989 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/fpvandoorn/carleson (commit: bec7808b907190882fa1fa54ce749af297c6cf37)
2024-09-28 03:27:43.085 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-09-28 03:27:43.085 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/YaelDillies/LeanAPAP (commit: 951c660a8d7ba8e39f906fdf657674a984effa8b)
2024-09-28 03:27:44.829 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-09-28 03:27:44.829 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/NUS-Math-Formalization/coxeter (commit: 96af8aee7943ca8685ed1b00cc83a559ea389a97)
2024-09-28 03:27:55.125 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-28 03:27:55.126 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/yangky11/miniF2F-lean4 (commit: 9e445f5435407f014b88b44a98436d50dd7abd00)
2024-09-28 03:27:55.601 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-09-28 03:27:55.601 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/m4lvin/lean4-pdl (commit: c7f649fe3c4891cf1a01c120e82ebc5f6199856e)
2024-09-28 03:27:57.400 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f5
15a0e52878)
2024-09-28 03:27:57.401 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/Louis-Le-Grand/Formalisation-of-constructable-numbers (commit: 01ef1f22a04f2ba8081c5fb29413f515a0e528
78)
2024-09-28 03:28:09.164 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/corent1234/hairy-ball-theorem-lean (commit: a778826d19c8a7ddf1d26beeea628c45450612e6)
2024-09-28 03:28:09.164 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/corent1234/hairy-ball-theorem-lean (commit: a778826d19c8a7ddf1d26beeea628c45450612e6)
2024-09-28 03:28:10.220 | INFO     | __main__:main:1629 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_curriculum_sorries_with_14.json
2024-09-28 03:28:10.221 | INFO     | __main__:main:1636 - Found 100 repositories
2024-09-28 03:28:10.221 | INFO     | __main__:main:1639 - Starting curriculum learning
2024-09-28 03:28:10.647 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
2024-09-28 03:28:28.371 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-28 03:28:47.173 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-28 03:29:05.045 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-28 03:29:22.058 | INFO     | __main__:main:1775 - length of lean_git_repos: 8
2024-09-28 03:29:22.058 | INFO     | __main__:main:1776 - i: 0
2024-09-28 03:29:22.058 | INFO     | __main__:main:1782 - Main process
2024-09-28 03:29:22.058 | INFO     | __main__:main:1783 - Using lambda = 0.1
2024-09-28 03:29:22.058 | INFO     | __main__:main:1784 - Processing https://github.com/ahhwuhu/zeta_3_irrational
2024-09-28 03:29:22.058 | INFO     | __main__:main:1791 - Adding repo to repos_for_merged_dataset
2024-09-28 03:29:22.060 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-28 03:29:22.060 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/ahhwuhu/zeta_3_irrational (commit: 914712200e463cfc97fe37e929d518dd58806a38)
2024-09-28 03:31:47.552 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_irrational_914712200e463cf
c97fe37e929d518dd58806a38 already exists. Removing it now.
2024-09-28 03:32:10.302 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_irra
tional_914712200e463cfc97fe37e929d518dd58806a38
2024-09-28 03:32:10.913 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_
zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38
2024-09-28 03:32:10.933 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_
3_irrational_914712200e463cfc97fe37e929d518dd58806a38
2024-09-28 03:32:10.936 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38
2024-09-28 03:32:10.956 | INFO     | __main__:main:1803 - All GPUs
2024-09-28 03:32:10.957 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4le
an_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:32:10.957 | INFO     | __main__:main:1810 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5facea96
a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:32:10.957 | INFO     | __main__:main:1816 - Inside train_test_fisher
2024-09-28 03:32:10.957 | INFO     | __main__:main:1817 - Starting training at epoch 16
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-28 03:32:13.976 | INFO     | __main__:main:1841 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5face
a96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main3_more_sorries.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-28 03:32:14.081 | INFO     | __main__:main:1899 - right before barrier for data module
2024-09-28 03:32:14.082 | INFO     | __main__:main:1914 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d
518dd58806a38/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115368/115368 [00:16<00:00, 7078.24it/s]
2024-09-28 03:32:59.832 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_
3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2403/2403 [00:00<00:00, 7560.94it/s]
2024-09-28 03:33:00.240 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_
3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2403/2403 [00:00<00:00, 7471.76it/s]
2024-09-28 03:33:00.655 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_
3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:33:00.655 | INFO     | __main__:main:1928 - Training dataset size after load: 357252
2024-09-28 03:33:00.656 | INFO     | __main__:main:1929 - Validation dataset size after load: 4833
2024-09-28 03:33:00.656 | INFO     | __main__:main:1930 - Testing dataset size after load: 5139
2024-09-28 03:33:00.656 | INFO     | __main__:main:1932 - Starting progressive training from epoch 16 to 17
2024-09-28 03:33:00.656 | INFO     | __main__:main:1935 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-28 03:33:06,939] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-28 03:33:06,942] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-28 03:33:06,951] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-28 03:33:10.930 | INFO     | __main__:main:1606 - Running progressive training
2024-09-28 03:33:10.930 | INFO     | __main__:main:1612 - Configuring LeanDojo...
2024-09-28 03:33:10.933 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-28 03:33:10.934 | INFO     | __main__:main:1614 - LeanDojo configured
2024-09-28 03:33:10.934 | INFO     | __main__:main:1636 - Found 100 repositories
2024-09-28 03:33:10.934 | INFO     | __main__:main:1639 - Starting curriculum learning
2024-09-28 03:33:11.133 | INFO     | __main__:main:1606 - Running progressive training
2024-09-28 03:33:11.133 | INFO     | __main__:main:1606 - Running progressive training
2024-09-28 03:33:11.133 | INFO     | __main__:main:1612 - Configuring LeanDojo...
2024-09-28 03:33:11.133 | INFO     | __main__:main:1612 - Configuring LeanDojo...
2024-09-28 03:33:11.138 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-28 03:33:11.138 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-28 03:33:11.138 | INFO     | __main__:main:1614 - LeanDojo configured
2024-09-28 03:33:11.138 | INFO     | __main__:main:1614 - LeanDojo configured
2024-09-28 03:33:11.138 | INFO     | __main__:main:1636 - Found 100 repositories
2024-09-28 03:33:11.138 | INFO     | __main__:main:1636 - Found 100 repositories
2024-09-28 03:33:11.138 | INFO     | __main__:main:1639 - Starting curriculum learning
2024-09-28 03:33:11.138 | INFO     | __main__:main:1639 - Starting curriculum learning
2024-09-28 03:33:11.301 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-28 03:33:11.324 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-28 03:33:11.370 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
Following Github server redirection from /repos/mo271/formal_book to /repositories/537006181
2024-09-28 03:33:29.075 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-28 03:33:29.075 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-28 03:33:29.086 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-28 03:33:47.680 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-28 03:33:47.834 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-28 03:33:47.898 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-28 03:34:05.481 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-28 03:34:05.580 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-28 03:34:06.010 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-28 03:34:22.481 | INFO     | __main__:main:1775 - length of lean_git_repos: 8
2024-09-28 03:34:22.481 | INFO     | __main__:main:1776 - i: 0
2024-09-28 03:34:22.481 | INFO     | __main__:main:1803 - All GPUs
2024-09-28 03:34:22.482 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4le
an_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:22.482 | INFO     | __main__:main:1810 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5facea96
a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:22.482 | INFO     | __main__:main:1816 - Inside train_test_fisher
2024-09-28 03:34:22.482 | INFO     | __main__:main:1817 - Starting training at epoch 16
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-28 03:34:22.794 | INFO     | __main__:main:1775 - length of lean_git_repos: 8
2024-09-28 03:34:22.794 | INFO     | __main__:main:1776 - i: 0
2024-09-28 03:34:22.794 | INFO     | __main__:main:1803 - All GPUs
2024-09-28 03:34:22.795 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4le
an_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:22.795 | INFO     | __main__:main:1810 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5facea96
a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:22.795 | INFO     | __main__:main:1816 - Inside train_test_fisher
2024-09-28 03:34:22.795 | INFO     | __main__:main:1817 - Starting training at epoch 16
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-28 03:34:23.166 | INFO     | __main__:main:1775 - length of lean_git_repos: 8
2024-09-28 03:34:23.166 | INFO     | __main__:main:1776 - i: 0
2024-09-28 03:34:23.166 | INFO     | __main__:main:1803 - All GPUs
2024-09-28 03:34:23.166 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4le
an_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:23.167 | INFO     | __main__:main:1810 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5facea96
a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:23.167 | INFO     | __main__:main:1816 - Inside train_test_fisher
2024-09-28 03:34:23.167 | INFO     | __main__:main:1817 - Starting training at epoch 16
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-28 03:34:25.319 | INFO     | __main__:main:1841 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5face
a96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:25.425 | INFO     | __main__:main:1899 - right before barrier for data module
2024-09-28 03:34:25.425 | INFO     | __main__:main:1914 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d
518dd58806a38/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-28 03:34:25.881 | INFO     | __main__:main:1841 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5face
a96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:25.942 | INFO     | __main__:main:1899 - right before barrier for data module
2024-09-28 03:34:25.943 | INFO     | __main__:main:1914 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d
518dd58806a38/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-28 03:34:26.211 | INFO     | __main__:main:1841 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5face
a96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=15-Recall@10_val=74.85.ckpt
2024-09-28 03:34:26.267 | INFO     | __main__:main:1899 - right before barrier for data module
2024-09-28 03:34:26.268 | INFO     | __main__:main:1914 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d
518dd58806a38/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-28 03:34:55.267 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:34:55.296 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:34:55.327 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:34:55.328 | INFO     | __main__:main:1928 - Training dataset size after load: 357252
2024-09-28 03:34:55.328 | INFO     | __main__:main:1929 - Validation dataset size after load: 4833
2024-09-28 03:34:55.328 | INFO     | __main__:main:1930 - Testing dataset size after load: 5139
2024-09-28 03:34:55.328 | INFO     | __main__:main:1932 - Starting progressive training from epoch 16 to 17
2024-09-28 03:34:55.328 | INFO     | __main__:main:1935 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-28 03:35:12.887 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:35:12.910 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:35:12.931 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:35:12.954 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:35:12.981 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:35:12.981 | INFO     | __main__:main:1928 - Training dataset size after load: 357252
2024-09-28 03:35:12.981 | INFO     | __main__:main:1929 - Validation dataset size after load: 4833
2024-09-28 03:35:12.981 | INFO     | __main__:main:1930 - Testing dataset size after load: 5139
2024-09-28 03:35:12.981 | INFO     | __main__:main:1932 - Starting progressive training from epoch 16 to 17
2024-09-28 03:35:12.981 | INFO     | __main__:main:1935 - hit the barrier before training
2024-09-28 03:35:12.998 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:35:12.998 | INFO     | __main__:main:1928 - Training dataset size after load: 357252
2024-09-28 03:35:12.998 | INFO     | __main__:main:1929 - Validation dataset size after load: 4833
2024-09-28 03:35:12.999 | INFO     | __main__:main:1930 - Testing dataset size after load: 5139
2024-09-28 03:35:12.999 | INFO     | __main__:main:1932 - Starting progressive training from epoch 16 to 17
2024-09-28 03:35:12.999 | INFO     | __main__:main:1935 - hit the barrier before training
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-28 03:35:19.167 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:35:19.489 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:35:26.818 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:35:27.080 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:35:27.120 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:35:27.222 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:35:27.481 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:35:27.519 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:35:29.952 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-28 03:35:30.299 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_val/cached_data.pkl
Validation dataset size: 4833
2024-09-28 03:35:30.365 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-28 03:35:32.638 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_zeta_3_ir
rational_914712200e463cfc97fe37e929d518dd58806a38/random/cache_pred/cached_data.pkl
Testing dataset size: 5139
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum
_sorries_with_14 exists and is not empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoc
h=15-Recall@10_val=74.85.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:361: The dirpath has changed from '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_c
urriculum' to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't
be reloaded. Only `best_model_path` will be reloaded.
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:361: The dirpath has changed from '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_c
urriculum' to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't
be reloaded. Only `best_model_path` will be reloaded.
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:361: The dirpath has changed from '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_c
urriculum' to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't
be reloaded. Only `best_model_path` will be reloaded.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:361: The dirpath has changed from '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_c
urriculum' to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't
be reloaded. Only `best_model_path` will be reloaded.
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-28 03:35:34.141 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-09-28 03:35:34.143 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-09-28 03:35:34.144 | INFO     | common:get_optimizers:448 - Optimizing with AdamW
2024-09-28 03:35:34.145 | INFO     | common:get_optimizers:448 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum_sorries_with_14/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f_lambda_0.1_epoch=
15-Recall@10_val=74.85.ckpt
Epoch 16:  58%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                | 12950/22328 [1:21:18<58:52,  2.65it/s, v_num=9]
