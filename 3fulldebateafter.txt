2024-09-14 07:15:35.645 | INFO     | retrieval.model:validation_step:372 - Recall@14_val: 81.54761904761905
2024-09-14 07:15:35.645 | INFO     | retrieval.model:validation_step:372 - Recall@15_val: 81.54761904761905
2024-09-14 07:15:35.645 | INFO     | retrieval.model:validation_step:372 - Recall@16_val: 81.54761904761905
2024-09-14 07:15:35.645 | INFO     | retrieval.model:validation_step:372 - Recall@17_val: 81.54761904761905
2024-09-14 07:15:35.646 | INFO     | retrieval.model:validation_step:372 - Recall@18_val: 81.54761904761905
2024-09-14 07:15:35.646 | INFO     | retrieval.model:validation_step:372 - Recall@19_val: 83.92857142857143
2024-09-14 07:15:35.646 | INFO     | retrieval.model:validation_step:372 - Recall@20_val: 83.92857142857143
2024-09-14 07:15:35.646 | INFO     | retrieval.model:validation_step:372 - Recall@21_val: 83.92857142857143
2024-09-14 07:15:35.647 | INFO     | retrieval.model:validation_step:372 - Recall@22_val: 85.71428571428571
2024-09-14 07:15:35.647 | INFO     | retrieval.model:validation_step:372 - Recall@23_val: 85.71428571428571
2024-09-14 07:15:35.647 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 85.71428571428571
2024-09-14 07:15:35.647 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 85.71428571428571
2024-09-14 07:15:35.648 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 85.71428571428571
2024-09-14 07:15:35.648 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 85.71428571428571
2024-09-14 07:15:35.648 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 85.71428571428571
2024-09-14 07:15:35.648 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 85.71428571428571
2024-09-14 07:15:35.649 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 85.71428571428571
2024-09-14 07:15:35.649 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 85.71428571428571
2024-09-14 07:15:35.649 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 85.71428571428571
2024-09-14 07:15:35.649 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 85.71428571428571
2024-09-14 07:15:35.650 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 85.71428571428571
2024-09-14 07:15:35.650 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 85.71428571428571
2024-09-14 07:15:35.650 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 85.71428571428571
2024-09-14 07:15:35.651 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 85.71428571428571
2024-09-14 07:15:35.651 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 85.71428571428571
2024-09-14 07:15:35.651 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 85.71428571428571
2024-09-14 07:15:35.651 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 85.71428571428571
2024-09-14 07:15:35.652 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 85.71428571428571
2024-09-14 07:15:35.652 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 85.71428571428571
2024-09-14 07:15:35.652 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 85.71428571428571
2024-09-14 07:15:35.652 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 85.71428571428571
2024-09-14 07:15:35.653 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 85.71428571428571
2024-09-14 07:15:35.653 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 85.71428571428571
2024-09-14 07:15:35.653 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 85.71428571428571
2024-09-14 07:15:35.653 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 85.71428571428571
2024-09-14 07:15:35.654 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 85.71428571428571
2024-09-14 07:15:35.654 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 85.71428571428571
2024-09-14 07:15:35.654 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 85.71428571428571
2024-09-14 07:15:35.654 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 85.71428571428571
2024-09-14 07:15:35.655 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 85.71428571428571
2024-09-14 07:15:35.655 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 85.71428571428571
2024-09-14 07:15:35.655 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 85.71428571428571
2024-09-14 07:15:35.655 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 85.71428571428571
2024-09-14 07:15:35.656 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 85.71428571428571
2024-09-14 07:15:35.656 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 87.5
2024-09-14 07:15:35.656 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 87.5
2024-09-14 07:15:35.656 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 87.5
2024-09-14 07:15:35.657 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 87.5
2024-09-14 07:15:35.657 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 87.5
2024-09-14 07:15:35.657 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 87.5
2024-09-14 07:15:35.657 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 87.5
2024-09-14 07:15:35.658 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 87.5
2024-09-14 07:15:35.658 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 87.5
2024-09-14 07:15:35.658 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 87.5
2024-09-14 07:15:35.659 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 87.5
2024-09-14 07:15:35.659 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 87.5
2024-09-14 07:15:35.659 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 87.5
2024-09-14 07:15:35.659 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 87.5
2024-09-14 07:15:35.660 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 87.5
2024-09-14 07:15:35.660 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 87.5
2024-09-14 07:15:35.660 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 87.5
2024-09-14 07:15:35.660 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 87.5
2024-09-14 07:15:35.661 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 87.5
2024-09-14 07:15:35.661 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 87.5
2024-09-14 07:15:35.661 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 87.5
2024-09-14 07:15:35.661 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 87.5
2024-09-14 07:15:35.662 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 87.5
2024-09-14 07:15:35.662 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 87.5
2024-09-14 07:15:35.662 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 87.5
2024-09-14 07:15:35.662 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 87.5
2024-09-14 07:15:35.663 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 87.5
2024-09-14 07:15:35.663 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 87.5
2024-09-14 07:15:35.663 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 87.5
2024-09-14 07:15:35.663 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 87.5
2024-09-14 07:15:35.664 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 91.07142857142857
2024-09-14 07:15:35.664 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 91.07142857142857
2024-09-14 07:15:35.664 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 91.07142857142857
2024-09-14 07:15:35.664 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 91.07142857142857
2024-09-14 07:15:35.665 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 91.07142857142857
2024-09-14 07:15:35.665 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 91.07142857142857
2024-09-14 07:15:35.665 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 91.07142857142857
2024-09-14 07:15:35.665 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 91.07142857142857
2024-09-14 07:15:35.666 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 91.07142857142857
2024-09-14 07:15:35.666 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 91.07142857142857
2024-09-14 07:15:35.666 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 91.07142857142857
2024-09-14 07:15:35.666 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 91.07142857142857
2024-09-14 07:15:35.667 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 91.07142857142857
2024-09-14 07:15:35.667 | INFO     | retrieval.model:validation_step:381 - MRR: 0.493001443001443
2024-09-14 07:15:35.667 | INFO     | retrieval.model:validation_step:389 - End of validation_step
Epoch 8: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8530/8530 [53:04<00:00,  2.68it/s, v
_num=0][rank: 0] Metric Recall@10_val improved by 0.831 >= min_delta = 0.0. New best score: 70.349

[rank: 2] Metric Recall@10_val improved by 0.831 >= min_delta = 0.0. New best score: 70.349
[rank: 1] Metric Recall@10_val improved by 0.831 >= min_delta = 0.0. New best score: 70.349
[rank: 3] Metric Recall@10_val improved by 0.831 >= min_delta = 0.0. New best score: 70.349
Epoch 8, global step 26263: 'Recall@10_val' reached 70.34945 (best 70.34945), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee5
4e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt' as top 9
`Trainer.fit` stopped: `max_epochs=9` reached.
Epoch 8: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8530/8530 [53:07<00:00,  2.68it/s, v
_num=0]
2024-09-14 07:15:42.330 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-14 07:15:42.506 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-14 07:15:42.579 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-14 07:15:42.649 | INFO     | __main__:main:1452 - hit the barrier after training
2024-09-14 07:15:42.650 | INFO     | __main__:main:1458 - Finished progressive training at epoch 9
2024-09-14 07:15:42.650 | INFO     | __main__:main:1458 - Finished progressive training at epoch 9
2024-09-14 07:15:42.650 | INFO     | __main__:main:1458 - Finished progressive training at epoch 9
2024-09-14 07:15:42.650 | INFO     | __main__:main:1458 - Finished progressive training at epoch 9
2024-09-14 07:15:42.651 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:main:1465 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:main:1465 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:main:1465 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:42.651 | INFO     | __main__:main:1465 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 07:15:44.780 | INFO     | __main__:main:1475 - Testing...
2024-09-14 07:15:44.782 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
2024-09-14 07:15:44.845 | INFO     | __main__:main:1475 - Testing...
2024-09-14 07:15:44.846 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 07:15:44.986 | INFO     | __main__:main:1475 - Testing...
2024-09-14 07:15:44.986 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
[rank: 1] Seed set to 3407
2024-09-14 07:15:44.992 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e0
8c96177fabd29a5b5a3/random
2024-09-14 07:15:44.992 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54
e08c96177fabd29a5b5a3/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-14 07:15:45.041 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e0
8c96177fabd29a5b5a3/random
2024-09-14 07:15:45.041 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54
e08c96177fabd29a5b5a3/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 07:15:45.180 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e0
8c96177fabd29a5b5a3/random
2024-09-14 07:15:45.180 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54
e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-14 07:15:45.358 | INFO     | __main__:main:1475 - Testing...
2024-09-14 07:15:45.360 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
[rank: 0] Seed set to 3407
2024-09-14 07:15:45.557 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e0
8c96177fabd29a5b5a3/random
2024-09-14 07:15:45.557 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54
e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-14 07:15:45.595 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd
29a5b5a3/corpus.jsonl
2024-09-14 07:15:45.690 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd
29a5b5a3/corpus.jsonl
2024-09-14 07:15:46.057 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd
29a5b5a3/corpus.jsonl
2024-09-14 07:15:46.722 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd
29a5b5a3/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-14 07:15:54.568 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136479
2024-09-14 07:15:54.586 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2158
2024-09-14 07:15:56.055 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136479
2024-09-14 07:15:56.068 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2158
2024-09-14 07:15:56.442 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136479
2024-09-14 07:15:56.453 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2158
2024-09-14 07:15:56.503 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_train/cached_data.pkl
Training dataset size: 136479
2024-09-14 07:15:56.515 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b70
5797ee54e08c96177fabd29a5b5a3/random/cache_pred/cached_data.pkl
Testing dataset size: 2158
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 07:15:59.301 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:15:59.302 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1620 [00:00<?,
 ?it/s]2024-09-14 07:15:59.335 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:15:59.345 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1620 [00:00<?,
 ?it/s]2024-09-14 07:15:59.373 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:15:59.374 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 07:16:00.041 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:16:00.042 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:26<00:00,  3.
20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:28<00:00,  3.
19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:28<00:00,  3.
19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1620/1620 [08:30<00:00,  3.
17it/s]
Predicting DataLoader 0:   0%|                                                                                                                                                                     | 0/9 [00:00<?,
 ?it/s]/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:17<00:00,  0.
51it/s]2024-09-14 07:24:48.627 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:24:48.628 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:24:48.628 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:24:48.628 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:24:48.709 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 07:24:48.709 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:24:48.710 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 07:24:48.710 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:24:48.713 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 07:24:48.713 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:24:48.716 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 07:24:48.717 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:24:48.717 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:17<00:00,  0.
51it/s]
2024-09-14 07:24:49.523 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
2024-09-14 07:24:49.559 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
2024-09-14 07:24:49.612 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
[rank: 1] Seed set to 3407
2024-09-14 07:24:49.770 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45
e50c6aee013a2687/random
2024-09-14 07:24:49.771 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c
45e50c6aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 07:24:49.782 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45
e50c6aee013a2687/random
2024-09-14 07:24:49.782 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c
45e50c6aee013a2687/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-14 07:24:49.867 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45
e50c6aee013a2687/random
2024-09-14 07:24:49.868 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c
45e50c6aee013a2687/corpus.jsonl
2024-09-14 07:24:50.217 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 07:24:50.246 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3/ran
dom/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1376/1376 [00:00<00:00, 56603.
07it/s]
2024-09-14 07:24:50.271 | INFO     | __main__:main:1502 - R@1 = 27.103412522529624 %, R@10 = 68.91867342976552 %, MRR = 0.5601286170744593
2024-09-14 07:24:50.272 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
2024-09-14 07:24:50.294 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013
a2687/corpus.jsonl
2024-09-14 07:24:50.371 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013
a2687/corpus.jsonl
2024-09-14 07:24:50.374 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013
a2687/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-14 07:24:50.503 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45
e50c6aee013a2687/random
2024-09-14 07:24:50.503 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c
45e50c6aee013a2687/corpus.jsonl
2024-09-14 07:24:51.093 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013
a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-14 07:25:00.511 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169224
2024-09-14 07:25:00.536 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2735
2024-09-14 07:25:02.497 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169224
2024-09-14 07:25:02.513 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2735
2024-09-14 07:25:02.577 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169224
2024-09-14 07:25:02.593 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2735
2024-09-14 07:25:02.653 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_train/cached_data.pkl
Training dataset size: 169224
2024-09-14 07:25:02.667 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e
94e3294c45e50c6aee013a2687/random/cache_pred/cached_data.pkl
Testing dataset size: 2735
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 07:25:05.319 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:25:05.320 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1717 [00:00<?,
 ?it/s]2024-09-14 07:25:05.361 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:25:05.362 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1717 [00:00<?,
 ?it/s]2024-09-14 07:25:05.381 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:25:05.382 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▌                                                                                                                                                                                  | 5/1717 [00:00<04:57,  5.
76it/s]2024-09-14 07:25:06.094 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:25:06.095 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:07<00:00,  3.
13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:08<00:00,  3.
13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:09<00:00,  3.
13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1717/1717 [09:12<00:00,  3.
11it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:24<00:00,  0.
44it/s]2024-09-14 07:34:43.820 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:34:43.917 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 07:34:43.917 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:34:49.230 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:34:49.368 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 07:34:49.368 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:34:50.145 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:34:50.145 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:34:50.243 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 07:34:50.243 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:34:50.279 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 07:34:50.279 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:34:50.280 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:31<00:00,  0.
35it/s]
2024-09-14 07:34:51.095 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 07:34:51.192 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
2024-09-14 07:34:51.206 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
[rank: 3] Seed set to 3407
2024-09-14 07:34:51.370 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5
297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-14 07:34:51.370 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source
_5297e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-14 07:34:51.421 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5
297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-14 07:34:51.421 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source
_5297e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 07:34:51.440 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5
297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-14 07:34:51.440 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source
_5297e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-14 07:34:51.885 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb0513
67c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-14 07:34:51.920 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb0513
67c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-14 07:34:51.984 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb0513
67c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-14 07:34:51.985 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 07:34:52.026 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1486/1486 [00:00<00:00, 43558.
15it/s]
2024-09-14 07:34:52.062 | INFO     | __main__:main:1502 - R@1 = 24.584032828550146 %, R@10 = 64.12721536773596 %, MRR = 0.5378148171829
2024-09-14 07:34:52.063 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
[rank: 0] Seed set to 3407
2024-09-14 07:34:52.252 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5
297e0fb051367c48c0a084411853a576389ecf5/random
2024-09-14 07:34:52.252 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source
_5297e0fb051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-14 07:34:52.757 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb0513
67c48c0a084411853a576389ecf5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-14 07:35:03.093 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179188
2024-09-14 07:35:03.117 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2694
2024-09-14 07:35:05.436 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179188
2024-09-14 07:35:05.452 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2694
2024-09-14 07:35:05.802 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179188
2024-09-14 07:35:05.816 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2694
2024-09-14 07:35:05.850 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 179188
2024-09-14 07:35:05.864 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lea
n_source_5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2694
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 07:35:08.483 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:35:08.484 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1840 [00:00<?,
 ?it/s]2024-09-14 07:35:08.524 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:35:08.524 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1840 [00:00<?,
 ?it/s]2024-09-14 07:35:08.549 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:35:08.549 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 07:35:09.240 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:35:09.241 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:49<00:00,  3.
12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:50<00:00,  3.
11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:51<00:00,  3.
11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1840/1840 [09:55<00:00,  3.
09it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:35<00:00,  0.
31it/s]2024-09-14 07:45:39.588 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:45:39.588 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:45:39.588 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:45:39.588 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:45:39.687 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 07:45:39.687 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:45:39.693 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 07:45:39.693 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:45:39.693 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 07:45:39.694 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:45:39.697 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 07:45:39.697 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:45:39.698 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:35<00:00,  0.
31it/s]
2024-09-14 07:45:40.667 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 07:45:40.738 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
2024-09-14 07:45:40.826 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
[rank: 3] Seed set to 3407
2024-09-14 07:45:40.950 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165
f0b054bfa17e2147/random
2024-09-14 07:45:40.950 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d81
65f0b054bfa17e2147/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 07:45:41.007 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165
f0b054bfa17e2147/random
2024-09-14 07:45:41.008 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d81
65f0b054bfa17e2147/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-14 07:45:41.078 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165
f0b054bfa17e2147/random
2024-09-14 07:45:41.078 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d81
65f0b054bfa17e2147/corpus.jsonl
2024-09-14 07:45:41.518 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17
e2147/corpus.jsonl
2024-09-14 07:45:41.520 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17
e2147/corpus.jsonl
2024-09-14 07:45:41.680 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17
e2147/corpus.jsonl
2024-09-14 07:45:41.691 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 07:45:41.752 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0844
11853a576389ecf5/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1577/1577 [00:00<00:00, 33932.
10it/s]
2024-09-14 07:45:41.800 | INFO     | __main__:main:1502 - R@1 = 27.290060475483475 %, R@10 = 67.88206930569434 %, MRR = 0.5821908351378275
2024-09-14 07:45:41.801 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
[rank: 0] Seed set to 3407
2024-09-14 07:45:42.089 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165
f0b054bfa17e2147/random
2024-09-14 07:45:42.090 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d81
65f0b054bfa17e2147/corpus.jsonl
2024-09-14 07:45:42.665 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17
e2147/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-14 07:45:55.933 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-14 07:45:55.963 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-14 07:46:01.602 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-14 07:46:01.631 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-14 07:46:01.920 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-14 07:46:04.992 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
2024-09-14 07:46:05.421 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_train/cached_data.pkl
Training dataset size: 156073
2024-09-14 07:46:05.442 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfa
dce33d8165f0b054bfa17e2147/random/cache_pred/cached_data.pkl
Testing dataset size: 2421
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 07:46:08.583 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:46:08.584 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1795 [00:00<?,
 ?it/s]2024-09-14 07:46:08.620 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:46:08.621 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1795 [00:00<?,
 ?it/s]2024-09-14 07:46:08.688 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:46:08.692 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 07:46:09.408 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:46:09.408 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:41<00:00,  3.
09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:42<00:00,  3.
08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:42<00:00,  3.
08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [09:46<00:00,  3.
06it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:18<00:00,  0.
53it/s]2024-09-14 07:56:14.884 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:56:14.885 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:56:14.885 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:56:14.885 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 07:56:14.978 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 07:56:14.978 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:56:14.981 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 07:56:14.982 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:56:14.983 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 07:56:14.983 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:56:14.984 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 07:56:14.984 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 07:56:14.984 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:19<00:00,  0.
52it/s]
2024-09-14 07:56:15.957 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 07:56:15.964 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
2024-09-14 07:56:16.027 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
[rank: 3] Seed set to 3407
2024-09-14 07:56:16.227 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a
445b414b3a723c2665f091/random
2024-09-14 07:56:16.227 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd
1a445b414b3a723c2665f091/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-14 07:56:16.228 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a
445b414b3a723c2665f091/random
2024-09-14 07:56:16.229 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd
1a445b414b3a723c2665f091/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 07:56:16.272 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a
445b414b3a723c2665f091/random
2024-09-14 07:56:16.272 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd
1a445b414b3a723c2665f091/corpus.jsonl
2024-09-14 07:56:16.731 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 07:56:16.763 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a7
23c2665f091/corpus.jsonl
2024-09-14 07:56:16.771 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
/test.json
  0%|                                                                                                                                                                                           | 0/1501 [00:00<?,
 ?it/s]2024-09-14 07:56:16.800 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b
414b3a723c2665f091/corpus.jsonl
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1501/1501 [00:00<00:00, 39076.
72it/s]
2024-09-14 07:56:16.811 | INFO     | __main__:main:1502 - R@1 = 25.840116682037973 %, R@10 = 68.94304048302321 %, MRR = 0.5620569001754041
2024-09-14 07:56:16.812 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
2024-09-14 07:56:16.837 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a7
23c2665f091/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-14 07:56:17.095 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a
445b414b3a723c2665f091/random
2024-09-14 07:56:17.095 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd
1a445b414b3a723c2665f091/corpus.jsonl
2024-09-14 07:56:17.722 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a7
23c2665f091/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-14 07:56:58.639 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-14 07:56:58.700 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-14 07:57:07.443 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-14 07:57:07.494 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-14 07:57:08.561 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-14 07:57:08.605 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-14 07:57:08.818 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-14 07:57:08.859 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2
928d47dd1a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 07:57:12.237 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:57:12.237 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2783 [00:00<?,
 ?it/s]2024-09-14 07:57:12.289 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:57:12.290 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2783 [00:00<?,
 ?it/s]2024-09-14 07:57:12.345 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:57:12.353 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 07:57:13.009 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 07:57:13.009 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:21<00:00,  2.
83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:23<00:00,  2.
83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:24<00:00,  2.
83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:30<00:00,  2.
81it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:52<00:00,  0.
40it/s]2024-09-14 08:14:36.662 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:14:36.662 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:14:36.662 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:14:36.662 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:14:36.827 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 08:14:36.827 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:14:36.828 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 08:14:36.829 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:14:36.832 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 08:14:36.832 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 08:14:36.832 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:14:36.832 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:14:36.833 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:53<00:00,  0.
40it/s]
2024-09-14 08:14:38.097 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
2024-09-14 08:14:38.113 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 08:14:38.135 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
[rank: 3] Seed set to 3407
2024-09-14 08:14:38.306 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933
d47fd6c1032798a6046c1baf261445d/random
2024-09-14 08:14:38.306 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b9
33d47fd6c1032798a6046c1baf261445d/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 08:14:38.325 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933
d47fd6c1032798a6046c1baf261445d/random
2024-09-14 08:14:38.325 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b9
33d47fd6c1032798a6046c1baf261445d/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-14 08:14:38.342 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933
d47fd6c1032798a6046c1baf261445d/random
2024-09-14 08:14:38.342 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b9
33d47fd6c1032798a6046c1baf261445d/corpus.jsonl
2024-09-14 08:14:38.857 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032
798a6046c1baf261445d/corpus.jsonl
2024-09-14 08:14:38.860 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032
798a6046c1baf261445d/corpus.jsonl
2024-09-14 08:14:38.864 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032
798a6046c1baf261445d/corpus.jsonl
2024-09-14 08:14:39.227 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 08:14:39.338 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/
random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2427/2427 [00:00<00:00, 21942.
67it/s]
2024-09-14 08:14:39.451 | INFO     | __main__:main:1502 - R@1 = 22.69966677038971 %, R@10 = 60.153335213407054 %, MRR = 0.5116208678126696
2024-09-14 08:14:39.452 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
[rank: 0] Seed set to 3407
2024-09-14 08:14:39.736 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933
d47fd6c1032798a6046c1baf261445d/random
2024-09-14 08:14:39.736 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b9
33d47fd6c1032798a6046c1baf261445d/corpus.jsonl
2024-09-14 08:14:40.317 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032
798a6046c1baf261445d/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-14 08:15:13.795 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166685
2024-09-14 08:15:13.831 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2381
2024-09-14 08:15:14.812 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166685
2024-09-14 08:15:14.828 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2381
2024-09-14 08:15:15.287 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166685
2024-09-14 08:15:15.300 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2381
2024-09-14 08:15:16.704 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 166685
2024-09-14 08:15:16.725 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop
_5acd4b933d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 2381
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 08:15:19.777 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:15:19.777 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1805 [00:00<?,
 ?it/s]2024-09-14 08:15:19.873 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:15:19.876 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/1805 [00:00<01:58, 15.
22it/s]2024-09-14 08:15:19.997 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:15:20.001 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 08:15:20.711 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:15:20.712 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:37<00:00,  3.
13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:38<00:00,  3.
12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:38<00:00,  3.
12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1805/1805 [09:42<00:00,  3.
10it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:16<00:00,  0.
59it/s]2024-09-14 08:25:20.015 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:25:20.113 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 08:25:20.114 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:25:25.310 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:25:25.310 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:25:25.310 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:25:25.405 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 08:25:25.405 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:25:25.443 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 08:25:25.443 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:25:25.446 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 08:25:25.446 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:25:25.446 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:22<00:00,  0.
45it/s]
2024-09-14 08:25:26.562 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 08:25:26.673 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
2024-09-14 08:25:26.726 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
[rank: 3] Seed set to 3407
2024-09-14 08:25:26.836 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e7
1da6eb9c916e62655744/random
2024-09-14 08:25:26.836 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172
e71da6eb9c916e62655744/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 08:25:26.917 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e7
1da6eb9c916e62655744/random
2024-09-14 08:25:26.917 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172
e71da6eb9c916e62655744/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-14 08:25:26.954 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e7
1da6eb9c916e62655744/random
2024-09-14 08:25:26.954 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172
e71da6eb9c916e62655744/corpus.jsonl
2024-09-14 08:25:27.332 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 08:25:27.374 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1ba
f261445d/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1538/1538 [00:00<00:00, 49513.
67it/s]
2024-09-14 08:25:27.406 | INFO     | __main__:main:1502 - R@1 = 26.28597687792168 %, R@10 = 66.1893594713575 %, MRR = 0.5670610225247092
2024-09-14 08:25:27.407 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
2024-09-14 08:25:27.416 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/corpus.jsonl
2024-09-14 08:25:27.451 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-14 08:25:27.596 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e7
1da6eb9c916e62655744/random
2024-09-14 08:25:27.596 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172
e71da6eb9c916e62655744/corpus.jsonl
2024-09-14 08:25:27.627 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/corpus.jsonl
2024-09-14 08:25:28.148 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-14 08:25:39.356 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149335
2024-09-14 08:25:39.378 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2136
2024-09-14 08:25:41.492 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149335
2024-09-14 08:25:41.507 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2136
2024-09-14 08:25:41.634 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149335
2024-09-14 08:25:41.647 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2136
2024-09-14 08:25:45.568 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149335
2024-09-14 08:25:45.583 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e
3db2a172e71da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2136
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 08:25:48.269 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:25:48.270 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2027 [00:00<?,
 ?it/s]2024-09-14 08:25:48.313 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:25:48.314 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2027 [00:00<?,
 ?it/s]2024-09-14 08:25:48.330 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:25:48.331 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 08:25:49.094 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:25:49.094 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:23<00:00,  3.
60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:24<00:00,  3.
59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:24<00:00,  3.
59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:28<00:00,  3.
57it/s]
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:25<00:00,  0.
36it/s]2024-09-14 08:35:42.684 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:35:42.685 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:35:42.685 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:35:42.685 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:35:42.768 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 08:35:42.768 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:35:42.770 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 08:35:42.770 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:35:42.806 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 08:35:42.807 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:35:42.807 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 08:35:42.807 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:35:42.808 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:25<00:00,  0.
35it/s]
2024-09-14 08:35:43.836 | INFO     | retrieval.main:run_cli:60 - PID: 2993009
2024-09-14 08:35:43.874 | INFO     | retrieval.main:run_cli:60 - PID: 2993011
2024-09-14 08:35:43.922 | INFO     | retrieval.main:run_cli:60 - PID: 2993010
[rank: 1] Seed set to 3407
2024-09-14 08:35:44.121 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29badd
d685660b5fedd7bd67f9916ae24253d566/random
2024-09-14 08:35:44.121 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29ba
ddd685660b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-14 08:35:44.158 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29badd
d685660b5fedd7bd67f9916ae24253d566/random
2024-09-14 08:35:44.158 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29ba
ddd685660b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-14 08:35:44.200 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29badd
d685660b5fedd7bd67f9916ae24253d566/random
2024-09-14 08:35:44.200 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29ba
ddd685660b5fedd7bd67f9916ae24253d566/corpus.jsonl
2024-09-14 08:35:44.574 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 08:35:44.609 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/ra
ndom/test.json
  0%|                                                                                                                                                                                           | 0/1444 [00:00<?,
 ?it/s]2024-09-14 08:35:44.620 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685
660b5fedd7bd67f9916ae24253d566/corpus.jsonl
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1444/1444 [00:00<00:00, 54064.
98it/s]
2024-09-14 08:35:44.636 | INFO     | __main__:main:1502 - R@1 = 27.002506939434962 %, R@10 = 68.94310521480176 %, MRR = 0.5747638554312104
2024-09-14 08:35:44.637 | INFO     | retrieval.main:run_cli:60 - PID: 2991451
[rank: 0] Seed set to 3407
2024-09-14 08:35:44.823 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29badd
d685660b5fedd7bd67f9916ae24253d566/random
2024-09-14 08:35:44.824 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29ba
ddd685660b5fedd7bd67f9916ae24253d566/corpus.jsonl
2024-09-14 08:35:44.841 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fe
dd7bd67f9916ae24253d566/corpus.jsonl
2024-09-14 08:35:44.843 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fe
dd7bd67f9916ae24253d566/corpus.jsonl
2024-09-14 08:35:45.450 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fe
dd7bd67f9916ae24253d566/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-14 08:36:01.946 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 194827
2024-09-14 08:36:01.982 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2856
2024-09-14 08:36:03.395 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 194827
2024-09-14 08:36:03.412 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2856
2024-09-14 08:36:05.773 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 194827
2024-09-14 08:36:05.793 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2856
2024-09-14 08:36:08.189 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 194827
2024-09-14 08:36:08.218 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheorem
And_29baddd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2856
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10
_val=70.35.ckpt
2024-09-14 08:36:11.282 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:36:11.283 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/1809 [00:00<?,
 ?it/s]2024-09-14 08:36:11.365 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:36:11.366 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/1809 [00:00<01:48, 16.
66it/s]2024-09-14 08:36:11.537 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:36:11.537 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?,
 ?it/s]2024-09-14 08:36:12.175 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-14 08:36:12.175 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1809/1809 [09:39<00:00,  3.
12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1809/1809 [09:41<00:00,  3.
11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1809/1809 [09:41<00:00,  3.
11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1809/1809 [09:45<00:00,  3.
09it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:34<00:00,  0.
35it/s]2024-09-14 08:46:31.611 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:46:31.611 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:46:31.612 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:46:31.612 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-14 08:46:31.714 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-14 08:46:31.714 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:46:31.720 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-14 08:46:31.720 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:46:31.763 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-14 08:46:31.763 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:46:31.764 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-14 08:46:31.764 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-14 08:46:31.765 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:34<00:00,  0.
35it/s]
2024-09-14 08:46:32.839 | INFO     | __main__:main:1615 - Finished processing the repository
2024-09-14 08:46:32.839 | INFO     | __main__:main:1617 - current epoch: 9
2024-09-14 08:46:32.839 | INFO     | __main__:main:1288 - length of lean_git_repos: 9
2024-09-14 08:46:32.839 | INFO     | __main__:main:1289 - i: 2
2024-09-14 08:46:32.840 | INFO     | __main__:main:1317 - All GPUs
2024-09-14 08:46:32.842 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:32.842 | INFO     | __main__:main:1324 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:32.842 | INFO     | __main__:main:1330 - Inside train_test_fisher
2024-09-14 08:46:32.842 | INFO     | __main__:main:1331 - Starting training at epoch 9
[rank: 1] Seed set to 3407
2024-09-14 08:46:32.875 | INFO     | __main__:main:1615 - Finished processing the repository
2024-09-14 08:46:32.875 | INFO     | __main__:main:1617 - current epoch: 9
2024-09-14 08:46:32.875 | INFO     | __main__:main:1288 - length of lean_git_repos: 9
2024-09-14 08:46:32.875 | INFO     | __main__:main:1289 - i: 2
2024-09-14 08:46:32.875 | INFO     | __main__:main:1317 - All GPUs
2024-09-14 08:46:32.877 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:32.877 | INFO     | __main__:main:1324 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:32.878 | INFO     | __main__:main:1330 - Inside train_test_fisher
2024-09-14 08:46:32.878 | INFO     | __main__:main:1331 - Starting training at epoch 9
[rank: 2] Seed set to 3407
2024-09-14 08:46:32.964 | INFO     | __main__:main:1615 - Finished processing the repository
2024-09-14 08:46:32.966 | INFO     | __main__:main:1617 - current epoch: 9
2024-09-14 08:46:32.966 | INFO     | __main__:main:1288 - length of lean_git_repos: 9
2024-09-14 08:46:32.966 | INFO     | __main__:main:1289 - i: 2
2024-09-14 08:46:32.966 | INFO     | __main__:main:1317 - All GPUs
2024-09-14 08:46:32.969 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:32.969 | INFO     | __main__:main:1324 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:32.969 | INFO     | __main__:main:1330 - Inside train_test_fisher
2024-09-14 08:46:32.969 | INFO     | __main__:main:1331 - Starting training at epoch 9
[rank: 3] Seed set to 3407
2024-09-14 08:46:34.191 | INFO     | __main__:main:1497 - Loaded the predictions pickle files
2024-09-14 08:46:34.241 | INFO     | __main__:main:1500 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916
ae24253d566/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1582/1582 [00:00<00:00, 35864.
64it/s]
2024-09-14 08:46:34.286 | INFO     | __main__:main:1502 - R@1 = 24.806269434673226 %, R@10 = 62.286496517728665 %, MRR = 0.5503710880940497
2024-09-14 08:46:34.288 | INFO     | __main__:main:1517 - Average R@1 = 25.7015053163776 %, R@10 = 65.93041187543925 %, MRR = 0.5557510004291537
2024-09-14 08:46:34.289 | INFO     | __main__:main:1553 - Starting the prover
2024-09-14 08:46:34.289 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-14 08:46:34.289 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-14 08:46:34.289 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-14 08:46:34.290 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debat
e_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ck
pt`
2024-09-14 08:46:35.227 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee5
4e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:35.227 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee5
4e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:37.868 | INFO     | __main__:main:1355 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c9617
7fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:37.872 | INFO     | __main__:main:1355 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c9617
7fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:37.874 | INFO     | __main__:main:1355 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c9617
7fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:46:37.971 | INFO     | __main__:main:1413 - right before barrier for data module
2024-09-14 08:46:37.971 | INFO     | __main__:main:1413 - right before barrier for data module
2024-09-14 08:46:37.971 | INFO     | __main__:main:1413 - right before barrier for data module
2024-09-14 08:46:38.963 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weig
ht', 'retriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'ret
riever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encod
er.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.enc
oder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encode
r.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2
.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer
.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.
DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAtten
tion.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weig
ht', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.
weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'r
etriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.en
coder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retrieve
r.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.e
ncoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.
block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.lay
er.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseR
eluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.la
yer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention
.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weig
ht', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight',
'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retri
ever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.en
coder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder
.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encod
er.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.bloc
k.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.
layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1
.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.S
elfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.Self
Attention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseRel
uDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', '
global_step', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-14 08:46:39.690 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-09-14 08:46:39.691 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-14 08:46:39.692 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797e
e54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-14 08:46:39.692 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd
29a5b5a3/corpus.jsonl
2024-09-14 08:46:45.048 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-14 08:46:45.049 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee
54e08c96177fabd29a5b5a3/corpus.jsonl
2024-09-14 08:46:45.049 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3240/3240 [04:57<00:00, 10.
88it/s]
2024-09-14 08:51:42.846 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-09-14 08:51:42.846 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-09-14 08:51:47,271 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=3242282) [2024-09-14 08:52:29,626] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=3242282) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default val
ue), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECU
RITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary obj
ects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for an
y use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=3242282)   return torch.load(io.BytesIO(b))
(pid=3242439) [2024-09-14 08:52:37,269] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=3242439) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default val
ue), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECU
RITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary obj
ects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for an
y use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=3242439)   return torch.load(io.BytesIO(b))
2024-09-14 08:52:47.849 | INFO     | __main__:prove_sorry_theorems:822 - Found 0 sorry theorems to prove
Processing theorems from google-deepmind/debate: 0theorem [00:00, ?theorem/s]
2024-09-14 08:52:47.850 | INFO     | __main__:save_progress:777 - Saving encountered theorems...
2024-09-14 08:52:47.852 | INFO     | __main__:prove_sorry_theorems:873 - Finished attempting to prove sorry theorems
(pid=3242622) [2024-09-14 08:52:47,905] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=3242622) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default val
ue), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECU
RITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary obj
ects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for an
y use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=3242622)   return torch.load(io.BytesIO(b))
(pid=3243457) [2024-09-14 08:52:58,098] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-14 08:54:47.083 | INFO     | __main__:main:1592 - Finished searching for proofs of sorry theorems
2024-09-14 08:54:47.083 | INFO     | __main__:main:1595 - Shutting down Ray after proving
(ProverActor pid=3243457) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default val
ue), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECU
RITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary obj
ects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for an
y use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=3243457)   return torch.load(io.BytesIO(b))
2024-09-14 08:54:49.711 | INFO     | __main__:main:1615 - Finished processing the repository
2024-09-14 08:54:49.712 | INFO     | __main__:main:1617 - current epoch: 9
2024-09-14 08:54:49.712 | INFO     | __main__:main:1288 - length of lean_git_repos: 9
2024-09-14 08:54:49.712 | INFO     | __main__:main:1289 - i: 2
2024-09-14 08:54:49.712 | INFO     | __main__:main:1295 - Main process
2024-09-14 08:54:49.712 | INFO     | __main__:main:1296 - Using lambda = 0.1
2024-09-14 08:54:49.712 | INFO     | __main__:main:1297 - Processing https://github.com/eric-wieser/lean-matrix-cookbook
2024-09-14 08:54:49.712 | INFO     | __main__:main:1304 - Adding repo to repos_for_merged_dataset
2024-09-14 08:54:49.714 | INFO     | dynamic_database:generate_merged_dataset:415 - Merging selected repositories in the database:
2024-09-14 08:54:49.714 | INFO     | dynamic_database:generate_merged_dataset:417 -   - https://github.com/eric-wieser/lean-matrix-cookbook (commit: f15a149d321ac99ff9b9c024b58e7882f564669f)
2024-09-14 08:55:34.113 | WARNING  | dynamic_database:safe_remove_dir_path:377 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c
024b58e7882f564669f already exists. Removing it now.
2024-09-14 08:55:51.614 | INFO     | dynamic_database:generate_merged_dataset:439 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook
_f15a149d321ac99ff9b9c024b58e7882f564669f
2024-09-14 08:55:51.983 | INFO     | dynamic_database:generate_merged_dataset:442 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matr
ix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f
2024-09-14 08:55:51.992 | INFO     | dynamic_database:generate_merged_dataset:445 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-co
okbook_f15a149d321ac99ff9b9c024b58e7882f564669f
2024-09-14 08:55:51.993 | INFO     | dynamic_database:generate_merged_dataset:448 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f
2024-09-14 08:55:52.006 | INFO     | __main__:main:1317 - All GPUs
2024-09-14 08:55:52.008 | INFO     | __main__:find_latest_checkpoint:517 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b
705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:55:52.008 | INFO     | __main__:main:1324 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fa
bd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
2024-09-14 08:55:52.008 | INFO     | __main__:main:1330 - Inside train_test_fisher
2024-09-14 08:55:52.008 | INFO     | __main__:main:1331 - Starting training at epoch 9
[rank: 0] Seed set to 3407
2024-09-14 08:55:53.486 | INFO     | __main__:main:1355 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c9617
7fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_val=70.35.ckpt
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-14 08:55:53.585 | INFO     | __main__:main:1413 - right before barrier for data module
2024-09-14 08:55:53.585 | INFO     | __main__:main:1428 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random
2024-09-14 08:55:53.585 | INFO     | __main__:main:1428 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random
2024-09-14 08:55:53.585 | INFO     | __main__:main:1428 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random
2024-09-14 08:55:53.585 | INFO     | __main__:main:1428 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f
564669f/random
2024-09-14 08:55:53.683 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9
b9c024b58e7882f564669f/corpus.jsonl
2024-09-14 08:55:53.683 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9
b9c024b58e7882f564669f/corpus.jsonl
2024-09-14 08:55:53.683 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9
b9c024b58e7882f564669f/corpus.jsonl
2024-09-14 08:55:53.685 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9
b9c024b58e7882f564669f/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64883/64883 [00:07<00:00, 8787.
23it/s]
 21%|████████████████████████████████████▎                                                                                                                                       | 13703/64883 [00:01<00:05, 9325.
95it/s]2024-09-14 08:56:09.434 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-ma
trix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134137
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1351/1351 [00:00<00:00, 8120.
60it/s]
2024-09-14 08:56:09.646 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-co
okbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1351/1351 [00:00<00:00, 9921.
86it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                             | 17553/64883 [00:01<00:05, 9307.
07it/s]2024-09-14 08:56:09.820 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-ma
trix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
2024-09-14 08:56:09.820 | INFO     | __main__:main:1442 - Training dataset size after load: 134137
2024-09-14 08:56:09.820 | INFO     | __main__:main:1443 - Validation dataset size after load: 2044
2024-09-14 08:56:09.820 | INFO     | __main__:main:1444 - Testing dataset size after load: 1745
2024-09-14 08:56:09.820 | INFO     | __main__:main:1446 - Starting progressive training from epoch 9 to 10
2024-09-14 08:56:09.821 | INFO     | __main__:main:1449 - hit the barrier before training
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64883/64883 [00:08<00:00, 7910.
87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64883/64883 [00:08<00:00, 7971.
57it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 64061/64883 [00:08<00:00, 8772.
59it/s]2024-09-14 08:56:16.432 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-ma
trix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134137
2024-09-14 08:56:16.445 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:16.455 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
2024-09-14 08:56:16.455 | INFO     | __main__:main:1442 - Training dataset size after load: 134137
2024-09-14 08:56:16.455 | INFO     | __main__:main:1443 - Validation dataset size after load: 2044
2024-09-14 08:56:16.455 | INFO     | __main__:main:1444 - Testing dataset size after load: 1745
2024-09-14 08:56:16.455 | INFO     | __main__:main:1446 - Starting progressive training from epoch 9 to 10
2024-09-14 08:56:16.455 | INFO     | __main__:main:1449 - hit the barrier before training
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64883/64883 [00:08<00:00, 7754.
59it/s]
2024-09-14 08:56:16.747 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-co
okbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134137
2024-09-14 08:56:16.760 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:16.770 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
2024-09-14 08:56:16.770 | INFO     | __main__:main:1442 - Training dataset size after load: 134137
2024-09-14 08:56:16.770 | INFO     | __main__:main:1443 - Validation dataset size after load: 2044
2024-09-14 08:56:16.770 | INFO     | __main__:main:1444 - Testing dataset size after load: 1745
2024-09-14 08:56:16.770 | INFO     | __main__:main:1446 - Starting progressive training from epoch 9 to 10
2024-09-14 08:56:16.770 | INFO     | __main__:main:1449 - hit the barrier before training
2024-09-14 08:56:17.094 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-co
okbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134137
2024-09-14 08:56:17.108 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:17.118 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
2024-09-14 08:56:17.118 | INFO     | __main__:main:1442 - Training dataset size after load: 134137
2024-09-14 08:56:17.118 | INFO     | __main__:main:1443 - Validation dataset size after load: 2044
2024-09-14 08:56:17.118 | INFO     | __main__:main:1444 - Testing dataset size after load: 1745
2024-09-14 08:56:17.118 | INFO     | __main__:main:1446 - Starting progressive training from epoch 9 to 10
2024-09-14 08:56:17.118 | INFO     | __main__:main:1449 - hit the barrier before training
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 0] Seed set to 3407
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f_False_lambda_0.1/lightning_logs
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f_False_lambda_0.1/lightning_logs
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f_False_lambda_0.1/lightning_logs
Missing logger folder: /data/yingzi_ma/lean_project/lightning_logs/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f_False_lambda_0.1/lightning_logs
2024-09-14 08:56:17.531 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134137
2024-09-14 08:56:17.623 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:17.635 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
2024-09-14 08:56:18.622 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
2024-09-14 08:56:18.630 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
Training dataset size: 134137
Training dataset size: 134137
2024-09-14 08:56:18.696 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_train/cached_data.pkl
2024-09-14 08:56:18.701 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:18.705 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:18.715 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
2024-09-14 08:56:18.717 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
Training dataset size: 134137
2024-09-14 08:56:18.772 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_val/cached_data.pkl
Validation dataset size: 2044
2024-09-14 08:56:18.784 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_curriculum/merged_with_new_lean-matrix-cookbo
ok_f15a149d321ac99ff9b9c024b58e7882f564669f/random/cache_pred/cached_data.pkl
Testing dataset size: 1745
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@1
0_val=70.35.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-14 08:56:20.089 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-14 08:56:20.089 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-14 08:56:20.089 | INFO     | common:get_optimizers:449 - Optimizing with AdamW
2024-09-14 08:56:20.090 | INFO     | common:get_optimizers:449 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_curriculum/merged_with_new_debate_7fb39251b705797ee54e08c96177fabd29a5b5a3_lambda_0.1_epoch=8-Recall@10_
val=70.35.ckpt
Epoch 9:  17%|███████████████████████████                                                                                                                                   | 1433/8Epoch 9:  17%|█████▎
               | 1434/8383 [08:00<38:46,  2.99it/s, v_num=0]                                                                                          Epoch 9:  31%|█████████▌                     | 2588/8383 [14
Epoch 9:  31%|██████████████████████████████████████████████▉                                                           Epoch 9:  31%|█████████▋                     | 2610/8383 [14:39<32:25,  2.97it/s, v_num=0]
Epoch 9:  42%|██████████████████████████████████████████████████████████████▋                                                                                   Epoch 9:  42%|████████████████████████████████████
█████▏                                                         | 3484/8383 [19:34<27:30,  2.97it/s, v_num=0]Epoch 9:  42%|█████████████████████████████████████████▋
Epoch 9:  47%|███████████████████████████████████████████████████████████████████████▍                                  Epoch 9:  47%|██████████████▋                | 3970/8383 [22:19<24:48,  2.96it/s, v_num=0]
Epoch 9:  49%|█████████████████████████████████████████████████████████████████████████▏                                                                             | 4066/8383 [22:49<24:14,  2.97it/s, v_num=0]
