056
2024-08-10 11:25:40.415 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 54.563492063492
056
2024-08-10 11:25:40.416 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 56.944444444444
44
2024-08-10 11:25:40.416 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 58.531746031746
025
2024-08-10 11:25:40.417 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 58.531746031746
025
2024-08-10 11:25:40.417 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 59.126984126984
13
2024-08-10 11:25:40.418 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 59.126984126984
13
2024-08-10 11:25:40.418 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 59.126984126984
13
2024-08-10 11:25:40.419 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 59.126984126984
13
2024-08-10 11:25:40.420 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 59.126984126984
13
2024-08-10 11:25:40.420 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 60.714285714285
71
2024-08-10 11:25:40.421 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 60.714285714285
71
2024-08-10 11:25:40.421 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 60.714285714285
71
2024-08-10 11:25:40.422 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 60.714285714285
71
2024-08-10 11:25:40.422 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 60.714285714285
71
2024-08-10 11:25:40.423 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 60.714285714285
71
2024-08-10 11:25:40.423 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 60.714285714285
71
2024-08-10 11:25:40.424 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 60.714285714285
71
2024-08-10 11:25:40.424 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 60.714285714285
71
2024-08-10 11:25:40.425 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 60.714285714285
71
2024-08-10 11:25:40.425 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 60.714285714285
71
2024-08-10 11:25:40.426 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 60.714285714285
71
2024-08-10 11:25:40.427 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 60.714285714285
71
2024-08-10 11:25:40.427 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 60.714285714285
71
2024-08-10 11:25:40.428 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 60.714285714285
71
2024-08-10 11:25:40.428 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 60.714285714285
71
2024-08-10 11:25:40.429 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 60.714285714285
71
2024-08-10 11:25:40.429 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 60.714285714285
71
2024-08-10 11:25:40.430 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 60.714285714285
71
2024-08-10 11:25:40.430 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 60.714285714285
71
2024-08-10 11:25:40.431 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 60.714285714285
71
2024-08-10 11:25:40.431 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 60.714285714285
71
2024-08-10 11:25:40.432 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 60.714285714285
71
2024-08-10 11:25:40.432 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 60.714285714285
71
2024-08-10 11:25:40.433 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 60.714285714285
71
2024-08-10 11:25:40.434 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 60.714285714285
71
2024-08-10 11:25:40.434 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 60.714285714285
71
2024-08-10 11:25:40.435 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 60.714285714285
71
2024-08-10 11:25:40.435 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 62.301587301587
29
2024-08-10 11:25:40.436 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 63.888888888888
886
2024-08-10 11:25:40.436 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 63.888888888888
886
2024-08-10 11:25:40.437 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 63.888888888888
886
2024-08-10 11:25:40.438 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 63.888888888888
886
2024-08-10 11:25:40.438 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 63.888888888888
886
2024-08-10 11:25:40.439 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 63.888888888888
886
2024-08-10 11:25:40.439 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 63.888888888888
886
2024-08-10 11:25:40.440 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 63.888888888888
886
2024-08-10 11:25:40.440 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 65.079365079365
08
2024-08-10 11:25:40.441 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 69.841269841269
83
2024-08-10 11:25:40.441 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 69.841269841269
83
2024-08-10 11:25:40.442 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 69.841269841269
83
2024-08-10 11:25:40.442 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 69.841269841269
83
2024-08-10 11:25:40.443 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 69.841269841269
83
2024-08-10 11:25:40.443 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 69.841269841269
83
2024-08-10 11:25:40.444 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 69.841269841269
83
2024-08-10 11:25:40.445 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 69.841269841269
83
2024-08-10 11:25:40.445 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 71.428571428571
43
2024-08-10 11:25:40.446 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 73.015873015873
01
2024-08-10 11:25:40.446 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 73.015873015873
01
2024-08-10 11:25:40.447 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 73.015873015873
01
2024-08-10 11:25:40.447 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 73.015873015873
01
2024-08-10 11:25:40.448 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 73.015873015873
01
2024-08-10 11:25:40.448 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 73.015873015873
01
2024-08-10 11:25:40.449 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 73.015873015873
01
2024-08-10 11:25:40.449 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 73.015873015873
01
2024-08-10 11:25:40.450 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 73.015873015873
01
2024-08-10 11:25:40.450 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 73.015873015873
01
2024-08-10 11:25:40.451 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 73.015873015873
01
2024-08-10 11:25:40.452 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 73.015873015873
01
2024-08-10 11:25:40.452 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 73.015873015873
01
2024-08-10 11:25:40.453 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 73.015873015873
01
2024-08-10 11:25:40.453 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 73.015873015873
01
2024-08-10 11:25:40.454 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 73.015873015873
01
2024-08-10 11:25:40.454 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 73.01587301587
301
2024-08-10 11:25:40.455 | INFO     | retrieval.model:validation_step:362 - MRR: 0.2764077201761931
2024-08-10 11:25:40.455 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        2
024-08-10 11:25:40.462 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:40.463 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:41.556 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 13.5869565217391
29
2024-08-10 11:25:41.557 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 18.5559006211180
1
2024-08-10 11:25:41.558 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 18.5559006211180
1
2024-08-10 11:25:41.558 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 20.0051759834368
5
2024-08-10 11:25:41.559 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 27.9399585921325
02
2024-08-10 11:25:41.559 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 32.2877846790890
3
2024-08-10 11:25:41.560 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 37.1790890269151
15
2024-08-10 11:25:41.560 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 37.1790890269151
15
2024-08-10 11:25:41.561 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 37.1790890269151
15
2024-08-10 11:25:41.561 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 37.179089026915
115
2024-08-10 11:25:41.562 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 39.974120082815
74
2024-08-10 11:25:41.562 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 39.974120082815
74
2024-08-10 11:25:41.563 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 41.423395445134
574
2024-08-10 11:25:41.564 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 47.220496894409
93
2024-08-10 11:25:41.564 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 51.568322981366
46
2024-08-10 11:25:41.565 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 51.568322981366
46
2024-08-10 11:25:41.565 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 51.568322981366
46
2024-08-10 11:25:41.566 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 53.017598343685
29
2024-08-10 11:25:41.566 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 53.017598343685
29
2024-08-10 11:25:41.567 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 57.986542443064
174
2024-08-10 11:25:41.567 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 57.986542443064
174
2024-08-10 11:25:41.568 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 57.986542443064
174
2024-08-10 11:25:41.568 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 57.986542443064
174
2024-08-10 11:25:41.569 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 57.986542443064
174
2024-08-10 11:25:41.569 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 57.986542443064
174
2024-08-10 11:25:41.570 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 57.986542443064
174
2024-08-10 11:25:41.570 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 58.530020703933
74
2024-08-10 11:25:41.571 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 58.530020703933
74
2024-08-10 11:25:41.571 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 58.530020703933
74
2024-08-10 11:25:41.572 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 58.530020703933
74
2024-08-10 11:25:41.573 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 58.530020703933
74
2024-08-10 11:25:41.573 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 58.530020703933
74
2024-08-10 11:25:41.574 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 58.530020703933
74
2024-08-10 11:25:41.574 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 59.616977225672
876
2024-08-10 11:25:41.575 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 59.616977225672
876
2024-08-10 11:25:41.575 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 59.616977225672
876
2024-08-10 11:25:41.576 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 59.616977225672
876
2024-08-10 11:25:41.576 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 61.790890269151
134
2024-08-10 11:25:41.577 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 61.790890269151
134
2024-08-10 11:25:41.577 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 61.790890269151
134
2024-08-10 11:25:41.578 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 66.138716356107
65
2024-08-10 11:25:41.578 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 66.138716356107
65
2024-08-10 11:25:41.579 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 66.138716356107
65
2024-08-10 11:25:41.579 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 68.312629399585
92
2024-08-10 11:25:41.580 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 68.312629399585
92
2024-08-10 11:25:41.580 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 68.312629399585
92
2024-08-10 11:25:41.581 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 68.312629399585
92
2024-08-10 11:25:41.582 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 68.312629399585
92
2024-08-10 11:25:41.582 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 68.312629399585
92
2024-08-10 11:25:41.583 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 68.312629399585
92
2024-08-10 11:25:41.583 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 72.660455486542
45
2024-08-10 11:25:41.584 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 73.203933747412
01
2024-08-10 11:25:41.584 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 73.203933747412
01
2024-08-10 11:25:41.585 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 73.203933747412
01
2024-08-10 11:25:41.585 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 73.203933747412
01
2024-08-10 11:25:41.586 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 73.203933747412
01
2024-08-10 11:25:41.586 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 75.740165631469
98
2024-08-10 11:25:41.587 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 75.740165631469
98
2024-08-10 11:25:41.588 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 75.740165631469
98
2024-08-10 11:25:41.588 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 75.740165631469
98
2024-08-10 11:25:41.589 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 75.740165631469
98
2024-08-10 11:25:41.589 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 75.740165631469
98
2024-08-10 11:25:41.590 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 75.740165631469
98
2024-08-10 11:25:41.590 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 75.740165631469
98
2024-08-10 11:25:41.591 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 76.827122153209
1
2024-08-10 11:25:41.591 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 76.827122153209
1
2024-08-10 11:25:41.592 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 76.827122153209
1
2024-08-10 11:25:41.592 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 76.827122153209
1
2024-08-10 11:25:41.593 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 76.827122153209
1
2024-08-10 11:25:41.593 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 76.827122153209
1
2024-08-10 11:25:41.594 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 76.827122153209
1
2024-08-10 11:25:41.594 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 76.827122153209
1
2024-08-10 11:25:41.595 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 76.827122153209
1
2024-08-10 11:25:41.595 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 76.827122153209
1
2024-08-10 11:25:41.596 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 76.827122153209
1
2024-08-10 11:25:41.597 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 76.827122153209
1
2024-08-10 11:25:41.597 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 76.827122153209
1
2024-08-10 11:25:41.598 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 76.827122153209
1
2024-08-10 11:25:41.598 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 76.827122153209
1
2024-08-10 11:25:41.599 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 77.370600414078
67
2024-08-10 11:25:41.599 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 77.370600414078
67
2024-08-10 11:25:41.600 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 77.370600414078
67
2024-08-10 11:25:41.600 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 78.819875776397
51
2024-08-10 11:25:41.601 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 78.819875776397
51
2024-08-10 11:25:41.601 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 79.906832298136
64
2024-08-10 11:25:41.602 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 79.906832298136
64
2024-08-10 11:25:41.602 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 79.906832298136
64
2024-08-10 11:25:41.603 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 80.776397515527
95
2024-08-10 11:25:41.604 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 80.776397515527
95
2024-08-10 11:25:41.604 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 80.776397515527
95
2024-08-10 11:25:41.605 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 80.776397515527
95
2024-08-10 11:25:41.605 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 80.776397515527
95
2024-08-10 11:25:41.606 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 80.776397515527
95
2024-08-10 11:25:41.606 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 80.776397515527
95
2024-08-10 11:25:41.607 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 80.776397515527
95
2024-08-10 11:25:41.607 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 80.776397515527
95
2024-08-10 11:25:41.608 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 80.776397515527
95
2024-08-10 11:25:41.608 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 80.776397515527
95
2024-08-10 11:25:41.609 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 80.776397515527
95
2024-08-10 11:25:41.609 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 80.77639751552
795
2024-08-10 11:25:41.610 | INFO     | retrieval.model:validation_step:362 - MRR: 0.28418770086591316
2024-08-10 11:25:41.611 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        2
024-08-10 11:25:41.616 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:41.616 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:42.646 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 19.1666666666666
64
2024-08-10 11:25:42.647 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 24.1666666666666
64
2024-08-10 11:25:42.647 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 25.8333333333333
3
2024-08-10 11:25:42.648 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 33.3333333333333
3
2024-08-10 11:25:42.648 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 35.0
2024-08-10 11:25:42.649 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 40.0
2024-08-10 11:25:42.649 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 40.0
2024-08-10 11:25:42.650 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 40.0
2024-08-10 11:25:42.650 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 45.0
2024-08-10 11:25:42.651 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 51.666666666666
66
2024-08-10 11:25:42.652 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 59.166666666666
66
2024-08-10 11:25:42.652 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 60.833333333333
33
2024-08-10 11:25:42.653 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 62.5
2024-08-10 11:25:42.653 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 62.5
2024-08-10 11:25:42.654 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 62.5
2024-08-10 11:25:42.654 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 62.5
2024-08-10 11:25:42.655 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 62.5
2024-08-10 11:25:42.655 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 62.5
2024-08-10 11:25:42.656 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 62.5
2024-08-10 11:25:42.656 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 67.5
2024-08-10 11:25:42.657 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 67.5
2024-08-10 11:25:42.658 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 67.5
2024-08-10 11:25:42.658 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 67.5
2024-08-10 11:25:42.659 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 67.5
2024-08-10 11:25:42.659 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 67.5
2024-08-10 11:25:42.660 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 67.5
2024-08-10 11:25:42.660 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 69.166666666666
67
2024-08-10 11:25:42.661 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 69.166666666666
67
2024-08-10 11:25:42.661 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 69.166666666666
67
2024-08-10 11:25:42.662 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 69.166666666666
67
2024-08-10 11:25:42.662 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 69.166666666666
67
2024-08-10 11:25:42.663 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 69.166666666666
67
2024-08-10 11:25:42.663 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 69.166666666666
67
2024-08-10 11:25:42.664 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 69.166666666666
67
2024-08-10 11:25:42.665 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 69.166666666666
67
2024-08-10 11:25:42.665 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 69.166666666666
67
2024-08-10 11:25:42.666 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 69.166666666666
67
2024-08-10 11:25:42.666 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 69.166666666666
67
2024-08-10 11:25:42.667 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 69.166666666666
67
2024-08-10 11:25:42.667 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 69.166666666666
67
2024-08-10 11:25:42.668 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 69.166666666666
67
2024-08-10 11:25:42.668 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 69.166666666666
67
2024-08-10 11:25:42.669 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 69.166666666666
67
2024-08-10 11:25:42.669 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 74.166666666666
67
2024-08-10 11:25:42.670 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 74.166666666666
67
2024-08-10 11:25:42.670 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 74.166666666666
67
2024-08-10 11:25:42.671 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 74.166666666666
67
2024-08-10 11:25:42.672 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 76.666666666666
67
2024-08-10 11:25:42.672 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 76.666666666666
67
2024-08-10 11:25:42.673 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 76.666666666666
67
2024-08-10 11:25:42.673 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 81.666666666666
67
2024-08-10 11:25:42.674 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 81.666666666666
67
2024-08-10 11:25:42.674 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 81.666666666666
67
2024-08-10 11:25:42.675 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 81.666666666666
67
2024-08-10 11:25:42.675 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 81.666666666666
67
2024-08-10 11:25:42.676 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 81.666666666666
67
2024-08-10 11:25:42.676 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 81.666666666666
67
2024-08-10 11:25:42.677 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 81.666666666666
67
2024-08-10 11:25:42.677 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 81.666666666666
67
2024-08-10 11:25:42.678 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 81.666666666666
67
2024-08-10 11:25:42.679 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 81.666666666666
67
2024-08-10 11:25:42.679 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 81.666666666666
67
2024-08-10 11:25:42.680 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 81.666666666666
67
2024-08-10 11:25:42.680 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 81.666666666666
67
2024-08-10 11:25:42.681 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 81.666666666666
67
2024-08-10 11:25:42.681 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 81.666666666666
67
2024-08-10 11:25:42.682 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 81.666666666666
67
2024-08-10 11:25:42.682 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 81.666666666666
67
2024-08-10 11:25:42.683 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 86.666666666666
66
2024-08-10 11:25:42.683 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 86.666666666666
66
2024-08-10 11:25:42.684 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 86.666666666666
66
2024-08-10 11:25:42.685 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 86.666666666666
66
2024-08-10 11:25:42.685 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 86.666666666666
66
2024-08-10 11:25:42.686 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 86.666666666666
66
2024-08-10 11:25:42.686 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 86.666666666666
66
2024-08-10 11:25:42.687 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 86.666666666666
66
2024-08-10 11:25:42.687 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 86.666666666666
66
2024-08-10 11:25:42.688 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 86.666666666666
66
2024-08-10 11:25:42.688 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 86.666666666666
66
2024-08-10 11:25:42.689 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 86.666666666666
66
2024-08-10 11:25:42.689 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 86.666666666666
66
2024-08-10 11:25:42.690 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 86.666666666666
66
2024-08-10 11:25:42.691 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 86.666666666666
66
2024-08-10 11:25:42.691 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 91.666666666666
66
2024-08-10 11:25:42.692 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 91.666666666666
66
2024-08-10 11:25:42.692 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 91.666666666666
66
2024-08-10 11:25:42.693 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 91.666666666666
66
2024-08-10 11:25:42.693 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 91.666666666666
66
2024-08-10 11:25:42.694 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 91.666666666666
66
2024-08-10 11:25:42.694 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 91.666666666666
66
2024-08-10 11:25:42.695 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 91.666666666666
66
2024-08-10 11:25:42.695 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 91.666666666666
66
2024-08-10 11:25:42.696 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 91.666666666666
66
2024-08-10 11:25:42.696 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 91.666666666666
66
2024-08-10 11:25:42.697 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 91.666666666666
66
2024-08-10 11:25:42.697 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 91.666666666666
66
2024-08-10 11:25:42.698 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 91.666666666666
66
2024-08-10 11:25:42.699 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 91.666666666666
66
2024-08-10 11:25:42.699 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 91.666666666666
66
2024-08-10 11:25:42.700 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 91.66666666666
666
2024-08-10 11:25:42.700 | INFO     | retrieval.model:validation_step:362 - MRR: 0.356037641670634
2024-08-10 11:25:42.701 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        2
024-08-10 11:25:42.708 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:42.708 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:43.693 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 11.2318840579710
14
2024-08-10 11:25:43.694 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 20.2898550724637
66
2024-08-10 11:25:43.694 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 23.5507246376811
57
2024-08-10 11:25:43.695 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 27.2946859903381
6
2024-08-10 11:25:43.696 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 29.4685990338164
25
2024-08-10 11:25:43.696 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 29.4685990338164
25
2024-08-10 11:25:43.697 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 29.4685990338164
25
2024-08-10 11:25:43.697 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 35.7487922705314
2024-08-10 11:25:43.698 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 36.2318840579710
16
2024-08-10 11:25:43.698 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 36.231884057971
016
2024-08-10 11:25:43.699 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 38.405797101449
28
2024-08-10 11:25:43.699 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 47.101449275362
32
2024-08-10 11:25:43.700 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 47.101449275362
32
2024-08-10 11:25:43.700 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 47.101449275362
32
2024-08-10 11:25:43.701 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 48.188405797101
45
2024-08-10 11:25:43.702 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 53.019323671497
59
2024-08-10 11:25:43.702 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 53.019323671497
59
2024-08-10 11:25:43.703 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 57.367149758454
104
2024-08-10 11:25:43.703 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 57.367149758454
104
2024-08-10 11:25:43.704 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 57.367149758454
104
2024-08-10 11:25:43.704 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 57.367149758454
104
2024-08-10 11:25:43.705 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 57.367149758454
104
2024-08-10 11:25:43.705 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 57.367149758454
104
2024-08-10 11:25:43.706 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 57.367149758454
104
2024-08-10 11:25:43.706 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 57.367149758454
104
2024-08-10 11:25:43.707 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 57.367149758454
104
2024-08-10 11:25:43.707 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 58.454106280193
244
2024-08-10 11:25:43.708 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 58.454106280193
244
2024-08-10 11:25:43.709 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 59.541062801932
36
2024-08-10 11:25:43.709 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 59.541062801932
36
2024-08-10 11:25:43.710 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 59.541062801932
36
2024-08-10 11:25:43.710 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 59.541062801932
36
2024-08-10 11:25:43.711 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 59.541062801932
36
2024-08-10 11:25:43.711 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 63.888888888888
89
2024-08-10 11:25:43.712 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 63.888888888888
89
2024-08-10 11:25:43.712 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 63.888888888888
89
2024-08-10 11:25:43.713 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 63.888888888888
89
2024-08-10 11:25:43.713 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 69.323671497584
54
2024-08-10 11:25:43.714 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 69.323671497584
54
2024-08-10 11:25:43.715 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 69.323671497584
54
2024-08-10 11:25:43.715 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 69.323671497584
54
2024-08-10 11:25:43.716 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 69.323671497584
54
2024-08-10 11:25:43.716 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 69.323671497584
54
2024-08-10 11:25:43.717 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 69.323671497584
54
2024-08-10 11:25:43.717 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 69.323671497584
54
2024-08-10 11:25:43.718 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 70.772946859903
39
2024-08-10 11:25:43.718 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 70.772946859903
39
2024-08-10 11:25:43.719 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 70.772946859903
39
2024-08-10 11:25:43.719 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 70.772946859903
39
2024-08-10 11:25:43.720 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 70.772946859903
39
2024-08-10 11:25:43.720 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 70.772946859903
39
2024-08-10 11:25:43.721 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 70.772946859903
39
2024-08-10 11:25:43.722 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 70.772946859903
39
2024-08-10 11:25:43.722 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 70.772946859903
39
2024-08-10 11:25:43.723 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 70.772946859903
39
2024-08-10 11:25:43.723 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 70.772946859903
39
2024-08-10 11:25:43.724 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 71.256038647343
2024-08-10 11:25:43.724 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 71.256038647343
2024-08-10 11:25:43.725 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 71.256038647343
2024-08-10 11:25:43.725 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 71.256038647343
2024-08-10 11:25:43.726 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 71.739130434782
61
2024-08-10 11:25:43.726 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 71.739130434782
61
2024-08-10 11:25:43.727 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 71.739130434782
61
2024-08-10 11:25:43.728 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 71.739130434782
61
2024-08-10 11:25:43.728 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 71.739130434782
61
2024-08-10 11:25:43.729 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 71.739130434782
61
2024-08-10 11:25:43.729 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 71.739130434782
61
2024-08-10 11:25:43.730 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 71.739130434782
61
2024-08-10 11:25:43.730 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 73.913043478260
86
2024-08-10 11:25:43.731 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 73.913043478260
86
2024-08-10 11:25:43.731 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 73.913043478260
86
2024-08-10 11:25:43.732 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 73.913043478260
86
2024-08-10 11:25:43.732 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 73.913043478260
86
2024-08-10 11:25:43.733 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 73.913043478260
86
2024-08-10 11:25:43.733 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 73.913043478260
86
2024-08-10 11:25:43.734 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 73.913043478260
86
2024-08-10 11:25:43.735 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 73.913043478260
86
2024-08-10 11:25:43.735 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 73.913043478260
86
2024-08-10 11:25:43.736 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 73.913043478260
86
2024-08-10 11:25:43.736 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 73.913043478260
86
2024-08-10 11:25:43.737 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 73.913043478260
86
2024-08-10 11:25:43.737 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 73.913043478260
86
2024-08-10 11:25:43.738 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 73.913043478260
86
2024-08-10 11:25:43.738 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 73.913043478260
86
2024-08-10 11:25:43.739 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 73.913043478260
86
2024-08-10 11:25:43.739 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 73.913043478260
86
2024-08-10 11:25:43.740 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 73.913043478260
86
2024-08-10 11:25:43.740 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 73.913043478260
86
2024-08-10 11:25:43.741 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 73.913043478260
86
2024-08-10 11:25:43.742 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 73.913043478260
86
2024-08-10 11:25:43.742 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 73.913043478260
86
2024-08-10 11:25:43.743 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 73.913043478260
86
2024-08-10 11:25:43.743 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 73.913043478260
86
2024-08-10 11:25:43.744 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 73.913043478260
86
2024-08-10 11:25:43.744 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 73.913043478260
86
2024-08-10 11:25:43.745 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 73.913043478260
86
2024-08-10 11:25:43.745 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 73.913043478260
86
2024-08-10 11:25:43.746 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 73.913043478260
86
2024-08-10 11:25:43.746 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 73.913043478260
86
2024-08-10 11:25:43.747 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 73.91304347826
086
2024-08-10 11:25:43.747 | INFO     | retrieval.model:validation_step:362 - MRR: 0.28055237732011185
2024-08-10 11:25:43.748 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        2
024-08-10 11:25:43.756 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:43.756 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:45.078 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 9.04761904761904
7
2024-08-10 11:25:45.079 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 14.6428571428571
4
2024-08-10 11:25:45.079 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 21.7857142857142
9
2024-08-10 11:25:45.080 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 22.9761904761904
78
2024-08-10 11:25:45.080 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 22.9761904761904
78
2024-08-10 11:25:45.081 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 24.7619047619047
63
2024-08-10 11:25:45.081 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 25.9523809523809
56
2024-08-10 11:25:45.082 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 27.1428571428571
46
2024-08-10 11:25:45.082 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 27.8571428571428
58
2024-08-10 11:25:45.083 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 27.857142857142
858
2024-08-10 11:25:45.083 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 29.047619047619
044
2024-08-10 11:25:45.084 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 34.404761904761
905
2024-08-10 11:25:45.085 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 35.297619047619
044
2024-08-10 11:25:45.085 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 35.297619047619
044
2024-08-10 11:25:45.086 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 35.297619047619
044
2024-08-10 11:25:45.086 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 35.297619047619
044
2024-08-10 11:25:45.087 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 35.744047619047
62
2024-08-10 11:25:45.087 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 35.744047619047
62
2024-08-10 11:25:45.088 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 35.744047619047
62
2024-08-10 11:25:45.088 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 36.934523809523
8
2024-08-10 11:25:45.089 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 36.934523809523
8
2024-08-10 11:25:45.089 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 36.934523809523
8
2024-08-10 11:25:45.090 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 36.934523809523
8
2024-08-10 11:25:45.090 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 36.934523809523
8
2024-08-10 11:25:45.091 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 37.380952380952
37
2024-08-10 11:25:45.092 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 37.380952380952
37
2024-08-10 11:25:45.092 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 37.380952380952
37
2024-08-10 11:25:45.093 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 37.380952380952
37
2024-08-10 11:25:45.093 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 37.380952380952
37
2024-08-10 11:25:45.094 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 38.095238095238
095
2024-08-10 11:25:45.094 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 39.285714285714
285
2024-08-10 11:25:45.095 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 39.285714285714
285
2024-08-10 11:25:45.095 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 39.285714285714
285
2024-08-10 11:25:45.096 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 41.785714285714
285
2024-08-10 11:25:45.096 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 42.678571428571
42
2024-08-10 11:25:45.097 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 42.678571428571
42
2024-08-10 11:25:45.097 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 43.571428571428
57
2024-08-10 11:25:45.098 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 43.571428571428
57
2024-08-10 11:25:45.099 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 43.571428571428
57
2024-08-10 11:25:45.099 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 45.952380952380
94
2024-08-10 11:25:45.100 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 49.523809523809
51
2024-08-10 11:25:45.100 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 49.523809523809
51
2024-08-10 11:25:45.101 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 49.523809523809
51
2024-08-10 11:25:45.101 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 49.523809523809
51
2024-08-10 11:25:45.102 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 49.523809523809
51
2024-08-10 11:25:45.102 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 49.523809523809
51
2024-08-10 11:25:45.103 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 49.523809523809
51
2024-08-10 11:25:45.103 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 49.523809523809
51
2024-08-10 11:25:45.104 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 49.523809523809
51
2024-08-10 11:25:45.104 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 53.095238095238
09
2024-08-10 11:25:45.105 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 53.095238095238
09
2024-08-10 11:25:45.105 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 53.095238095238
09
2024-08-10 11:25:45.106 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 53.095238095238
09
2024-08-10 11:25:45.107 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 57.857142857142
84
2024-08-10 11:25:45.107 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 57.857142857142
84
2024-08-10 11:25:45.108 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 57.857142857142
84
2024-08-10 11:25:45.108 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 57.857142857142
84
2024-08-10 11:25:45.109 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 58.571428571428
56
2024-08-10 11:25:45.109 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 58.571428571428
56
2024-08-10 11:25:45.110 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 58.571428571428
56
2024-08-10 11:25:45.110 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 58.571428571428
56
2024-08-10 11:25:45.111 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 63.035714285714
285
2024-08-10 11:25:45.111 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 63.035714285714
285
2024-08-10 11:25:45.112 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 63.035714285714
285
2024-08-10 11:25:45.112 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 63.035714285714
285
2024-08-10 11:25:45.113 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 63.035714285714
285
2024-08-10 11:25:45.113 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 63.035714285714
285
2024-08-10 11:25:45.114 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 66.607142857142
85
2024-08-10 11:25:45.114 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 66.607142857142
85
2024-08-10 11:25:45.115 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 66.607142857142
85
2024-08-10 11:25:45.116 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 66.607142857142
85
2024-08-10 11:25:45.116 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 66.607142857142
85
2024-08-10 11:25:45.117 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 67.5
2024-08-10 11:25:45.117 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 67.5
2024-08-10 11:25:45.118 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 67.5
2024-08-10 11:25:45.118 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 67.5
2024-08-10 11:25:45.119 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 67.5
2024-08-10 11:25:45.119 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 68.690476190476
19
2024-08-10 11:25:45.120 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 68.690476190476
19
2024-08-10 11:25:45.120 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 68.690476190476
19
2024-08-10 11:25:45.121 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 68.690476190476
19
2024-08-10 11:25:45.121 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 68.690476190476
19
2024-08-10 11:25:45.122 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 72.708333333333
34
2024-08-10 11:25:45.122 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 72.708333333333
34
2024-08-10 11:25:45.123 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 72.708333333333
34
2024-08-10 11:25:45.123 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 72.708333333333
34
2024-08-10 11:25:45.124 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 72.708333333333
34
2024-08-10 11:25:45.125 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 72.708333333333
34
2024-08-10 11:25:45.125 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 72.708333333333
34
2024-08-10 11:25:45.126 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 72.708333333333
34
2024-08-10 11:25:45.126 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 72.708333333333
34
2024-08-10 11:25:45.127 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 72.708333333333
34
2024-08-10 11:25:45.127 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 72.708333333333
34
2024-08-10 11:25:45.128 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 72.708333333333
34
2024-08-10 11:25:45.128 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 72.708333333333
34
2024-08-10 11:25:45.129 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 72.708333333333
34
2024-08-10 11:25:45.129 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 72.708333333333
34
2024-08-10 11:25:45.130 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 72.708333333333
34
2024-08-10 11:25:45.130 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 72.708333333333
34
2024-08-10 11:25:45.131 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 72.70833333333
334
2024-08-10 11:25:45.131 | INFO     | retrieval.model:validation_step:362 - MRR: 0.2697387736530384
2024-08-10 11:25:45.132 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        2
024-08-10 11:25:45.138 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:45.138 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:46.519 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 25.8333333333333
36
2024-08-10 11:25:46.521 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 37.0833333333333
36
2024-08-10 11:25:46.521 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 47.6388888888888
9
2024-08-10 11:25:46.522 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 64.3055555555555
6
2024-08-10 11:25:46.522 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 64.3055555555555
6
2024-08-10 11:25:46.523 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 65.6944444444444
4
2024-08-10 11:25:46.523 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 69.8611111111111
1
2024-08-10 11:25:46.524 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 69.8611111111111
1
2024-08-10 11:25:46.524 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 71.25
2024-08-10 11:25:46.525 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 72.083333333333
33
2024-08-10 11:25:46.525 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 72.083333333333
33
2024-08-10 11:25:46.526 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 76.25
2024-08-10 11:25:46.526 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 76.25
2024-08-10 11:25:46.527 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 76.25
2024-08-10 11:25:46.528 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 79.166666666666
66
2024-08-10 11:25:46.528 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 79.166666666666
66
2024-08-10 11:25:46.529 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 79.166666666666
66
2024-08-10 11:25:46.529 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 81.25
2024-08-10 11:25:46.530 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 81.25
2024-08-10 11:25:46.530 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 81.25
2024-08-10 11:25:46.531 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 81.25
2024-08-10 11:25:46.531 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 81.25
2024-08-10 11:25:46.532 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 81.25
2024-08-10 11:25:46.532 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 81.25
2024-08-10 11:25:46.533 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 81.25
2024-08-10 11:25:46.533 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 81.25
2024-08-10 11:25:46.534 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 81.25
2024-08-10 11:25:46.534 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 81.25
2024-08-10 11:25:46.535 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 82.083333333333
33
2024-08-10 11:25:46.536 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 82.083333333333
33
2024-08-10 11:25:46.536 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 82.083333333333
33
2024-08-10 11:25:46.537 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 82.083333333333
33
2024-08-10 11:25:46.537 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 82.083333333333
33
2024-08-10 11:25:46.538 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 82.083333333333
33
2024-08-10 11:25:46.538 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 82.083333333333
33
2024-08-10 11:25:46.539 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 82.083333333333
33
2024-08-10 11:25:46.539 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 82.083333333333
33
2024-08-10 11:25:46.540 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 82.083333333333
33
2024-08-10 11:25:46.540 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 84.166666666666
67
2024-08-10 11:25:46.541 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 84.166666666666
67
2024-08-10 11:25:46.541 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 84.166666666666
67
2024-08-10 11:25:46.542 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 84.166666666666
67
2024-08-10 11:25:46.543 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 84.166666666666
67
2024-08-10 11:25:46.543 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 88.333333333333
33
2024-08-10 11:25:46.544 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 88.333333333333
33
2024-08-10 11:25:46.544 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 88.333333333333
33
2024-08-10 11:25:46.545 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 88.333333333333
33
2024-08-10 11:25:46.545 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 88.333333333333
33
2024-08-10 11:25:46.546 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 88.333333333333
33
2024-08-10 11:25:46.546 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 88.333333333333
33
2024-08-10 11:25:46.547 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 88.333333333333
33
2024-08-10 11:25:46.547 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 88.333333333333
33
2024-08-10 11:25:46.548 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 88.333333333333
33
2024-08-10 11:25:46.548 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 88.333333333333
33
2024-08-10 11:25:46.549 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 88.333333333333
33
2024-08-10 11:25:46.549 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 88.333333333333
33
2024-08-10 11:25:46.550 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 88.333333333333
33
2024-08-10 11:25:46.551 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 88.333333333333
33
2024-08-10 11:25:46.551 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 88.333333333333
33
2024-08-10 11:25:46.552 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 88.333333333333
33
2024-08-10 11:25:46.552 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 88.333333333333
33
2024-08-10 11:25:46.553 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 88.333333333333
33
2024-08-10 11:25:46.553 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 88.333333333333
33
2024-08-10 11:25:46.554 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 88.333333333333
33
2024-08-10 11:25:46.554 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 88.333333333333
33
2024-08-10 11:25:46.555 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 88.333333333333
33
2024-08-10 11:25:46.555 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 88.333333333333
33
2024-08-10 11:25:46.556 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 88.333333333333
33
2024-08-10 11:25:46.556 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 88.333333333333
33
2024-08-10 11:25:46.557 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 88.333333333333
33
2024-08-10 11:25:46.558 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 88.333333333333
33
2024-08-10 11:25:46.558 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 88.333333333333
33
2024-08-10 11:25:46.559 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 88.333333333333
33
2024-08-10 11:25:46.559 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 88.333333333333
33
2024-08-10 11:25:46.560 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 88.333333333333
33
2024-08-10 11:25:46.560 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 88.333333333333
33
2024-08-10 11:25:46.561 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 88.333333333333
33
2024-08-10 11:25:46.561 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 88.333333333333
33
2024-08-10 11:25:46.562 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 88.333333333333
33
2024-08-10 11:25:46.562 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 88.333333333333
33
2024-08-10 11:25:46.563 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 88.333333333333
33
2024-08-10 11:25:46.563 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 88.333333333333
33
2024-08-10 11:25:46.564 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 88.333333333333
33
2024-08-10 11:25:46.565 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 88.333333333333
33
2024-08-10 11:25:46.565 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 88.333333333333
33
2024-08-10 11:25:46.566 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 88.333333333333
33
2024-08-10 11:25:46.566 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 88.333333333333
33
2024-08-10 11:25:46.567 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 88.333333333333
33
2024-08-10 11:25:46.567 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 88.333333333333
33
2024-08-10 11:25:46.568 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 88.333333333333
33
2024-08-10 11:25:46.568 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 88.333333333333
33
2024-08-10 11:25:46.569 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 88.333333333333
33
2024-08-10 11:25:46.569 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 88.333333333333
33
2024-08-10 11:25:46.570 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 88.333333333333
33
2024-08-10 11:25:46.570 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 88.333333333333
33
2024-08-10 11:25:46.571 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 88.333333333333
33
2024-08-10 11:25:46.571 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 88.333333333333
33
2024-08-10 11:25:46.572 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 88.333333333333
33
2024-08-10 11:25:46.572 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 88.333333333333
33
2024-08-10 11:25:46.573 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 88.33333333333
333
2024-08-10 11:25:46.574 | INFO     | retrieval.model:validation_step:362 - MRR: 0.48537157287157284
2024-08-10 11:25:46.574 | INFO     | retrieval.model:validation_step:370 - End of validation_step
                                                                                                        2
024-08-10 11:25:46.581 | INFO     | retrieval.model:validation_step:299 - Inside validation_step0.67it/s]
2024-08-10 11:25:46.581 | INFO     | retrieval.model:validation_step:300 - All training loss for epoch
2024-08-10 11:25:47.612 | INFO     | retrieval.model:validation_step:353 - Recall@1_val: 20.2075702075702
03
2024-08-10 11:25:47.613 | INFO     | retrieval.model:validation_step:353 - Recall@2_val: 27.3504273504273
5
2024-08-10 11:25:47.613 | INFO     | retrieval.model:validation_step:353 - Recall@3_val: 30.0976800976800
97
2024-08-10 11:25:47.614 | INFO     | retrieval.model:validation_step:353 - Recall@4_val: 31.6849816849816
9
2024-08-10 11:25:47.615 | INFO     | retrieval.model:validation_step:353 - Recall@5_val: 32.0512820512820
5
2024-08-10 11:25:47.615 | INFO     | retrieval.model:validation_step:353 - Recall@6_val: 32.0512820512820
5
2024-08-10 11:25:47.616 | INFO     | retrieval.model:validation_step:353 - Recall@7_val: 33.6080586080586
06
2024-08-10 11:25:47.616 | INFO     | retrieval.model:validation_step:353 - Recall@8_val: 43.4981684981684
96
2024-08-10 11:25:47.617 | INFO     | retrieval.model:validation_step:353 - Recall@9_val: 45.0854700854700
8
2024-08-10 11:25:47.617 | INFO     | retrieval.model:validation_step:353 - Recall@10_val: 47.832722832722
83
2024-08-10 11:25:47.618 | INFO     | retrieval.model:validation_step:353 - Recall@11_val: 47.832722832722
83
2024-08-10 11:25:47.618 | INFO     | retrieval.model:validation_step:353 - Recall@12_val: 50.213675213675
22
2024-08-10 11:25:47.619 | INFO     | retrieval.model:validation_step:353 - Recall@13_val: 50.213675213675
22
2024-08-10 11:25:47.619 | INFO     | retrieval.model:validation_step:353 - Recall@14_val: 52.167277167277
16
2024-08-10 11:25:47.620 | INFO     | retrieval.model:validation_step:353 - Recall@15_val: 52.167277167277
16
2024-08-10 11:25:47.621 | INFO     | retrieval.model:validation_step:353 - Recall@16_val: 53.754578754578
75
2024-08-10 11:25:47.621 | INFO     | retrieval.model:validation_step:353 - Recall@17_val: 53.754578754578
75
2024-08-10 11:25:47.622 | INFO     | retrieval.model:validation_step:353 - Recall@18_val: 53.754578754578
75
2024-08-10 11:25:47.622 | INFO     | retrieval.model:validation_step:353 - Recall@19_val: 55.341880341880
334
2024-08-10 11:25:47.623 | INFO     | retrieval.model:validation_step:353 - Recall@20_val: 55.341880341880
334
2024-08-10 11:25:47.623 | INFO     | retrieval.model:validation_step:353 - Recall@21_val: 55.341880341880
334
2024-08-10 11:25:47.624 | INFO     | retrieval.model:validation_step:353 - Recall@22_val: 60.103785103785
1
2024-08-10 11:25:47.624 | INFO     | retrieval.model:validation_step:353 - Recall@23_val: 60.103785103785
1
2024-08-10 11:25:47.625 | INFO     | retrieval.model:validation_step:353 - Recall@24_val: 60.103785103785
1
2024-08-10 11:25:47.625 | INFO     | retrieval.model:validation_step:353 - Recall@25_val: 61.691086691086
68
2024-08-10 11:25:47.626 | INFO     | retrieval.model:validation_step:353 - Recall@26_val: 61.691086691086
68
2024-08-10 11:25:47.626 | INFO     | retrieval.model:validation_step:353 - Recall@27_val: 61.691086691086
68
2024-08-10 11:25:47.627 | INFO     | retrieval.model:validation_step:353 - Recall@28_val: 61.691086691086
68
2024-08-10 11:25:47.628 | INFO     | retrieval.model:validation_step:353 - Recall@29_val: 61.691086691086
68
2024-08-10 11:25:47.628 | INFO     | retrieval.model:validation_step:353 - Recall@30_val: 61.691086691086
68
2024-08-10 11:25:47.629 | INFO     | retrieval.model:validation_step:353 - Recall@31_val: 61.691086691086
68
2024-08-10 11:25:47.629 | INFO     | retrieval.model:validation_step:353 - Recall@32_val: 61.691086691086
68
2024-08-10 11:25:47.630 | INFO     | retrieval.model:validation_step:353 - Recall@33_val: 61.691086691086
68
2024-08-10 11:25:47.630 | INFO     | retrieval.model:validation_step:353 - Recall@34_val: 61.691086691086
68
2024-08-10 11:25:47.631 | INFO     | retrieval.model:validation_step:353 - Recall@35_val: 62.057387057387
05
2024-08-10 11:25:47.631 | INFO     | retrieval.model:validation_step:353 - Recall@36_val: 62.057387057387
05
2024-08-10 11:25:47.632 | INFO     | retrieval.model:validation_step:353 - Recall@37_val: 62.057387057387
05
2024-08-10 11:25:47.632 | INFO     | retrieval.model:validation_step:353 - Recall@38_val: 64.438339438339
43
2024-08-10 11:25:47.633 | INFO     | retrieval.model:validation_step:353 - Recall@39_val: 64.804639804639
79
2024-08-10 11:25:47.633 | INFO     | retrieval.model:validation_step:353 - Recall@40_val: 65.995115995116
2024-08-10 11:25:47.634 | INFO     | retrieval.model:validation_step:353 - Recall@41_val: 65.995115995116
2024-08-10 11:25:47.634 | INFO     | retrieval.model:validation_step:353 - Recall@42_val: 65.995115995116
2024-08-10 11:25:47.635 | INFO     | retrieval.model:validation_step:353 - Recall@43_val: 65.995115995116
2024-08-10 11:25:47.636 | INFO     | retrieval.model:validation_step:353 - Recall@44_val: 65.995115995116
2024-08-10 11:25:47.636 | INFO     | retrieval.model:validation_step:353 - Recall@45_val: 65.995115995116
2024-08-10 11:25:47.637 | INFO     | retrieval.model:validation_step:353 - Recall@46_val: 65.995115995116
2024-08-10 11:25:47.637 | INFO     | retrieval.model:validation_step:353 - Recall@47_val: 66.361416361416
36
2024-08-10 11:25:47.638 | INFO     | retrieval.model:validation_step:353 - Recall@48_val: 68.742368742368
74
2024-08-10 11:25:47.638 | INFO     | retrieval.model:validation_step:353 - Recall@49_val: 68.742368742368
74
2024-08-10 11:25:47.639 | INFO     | retrieval.model:validation_step:353 - Recall@50_val: 68.742368742368
74
2024-08-10 11:25:47.639 | INFO     | retrieval.model:validation_step:353 - Recall@51_val: 68.742368742368
74
2024-08-10 11:25:47.640 | INFO     | retrieval.model:validation_step:353 - Recall@52_val: 68.742368742368
74
2024-08-10 11:25:47.640 | INFO     | retrieval.model:validation_step:353 - Recall@53_val: 68.742368742368
74
2024-08-10 11:25:47.641 | INFO     | retrieval.model:validation_step:353 - Recall@54_val: 68.742368742368
74
2024-08-10 11:25:47.641 | INFO     | retrieval.model:validation_step:353 - Recall@55_val: 68.742368742368
74
2024-08-10 11:25:47.642 | INFO     | retrieval.model:validation_step:353 - Recall@56_val: 68.742368742368
74
2024-08-10 11:25:47.642 | INFO     | retrieval.model:validation_step:353 - Recall@57_val: 68.742368742368
74
2024-08-10 11:25:47.643 | INFO     | retrieval.model:validation_step:353 - Recall@58_val: 68.742368742368
74
2024-08-10 11:25:47.643 | INFO     | retrieval.model:validation_step:353 - Recall@59_val: 68.742368742368
74
2024-08-10 11:25:47.644 | INFO     | retrieval.model:validation_step:353 - Recall@60_val: 68.742368742368
74
2024-08-10 11:25:47.645 | INFO     | retrieval.model:validation_step:353 - Recall@61_val: 68.742368742368
74
2024-08-10 11:25:47.645 | INFO     | retrieval.model:validation_step:353 - Recall@62_val: 71.123321123321
12
2024-08-10 11:25:47.646 | INFO     | retrieval.model:validation_step:353 - Recall@63_val: 71.123321123321
12
2024-08-10 11:25:47.646 | INFO     | retrieval.model:validation_step:353 - Recall@64_val: 71.123321123321
12
2024-08-10 11:25:47.647 | INFO     | retrieval.model:validation_step:353 - Recall@65_val: 71.123321123321
12
2024-08-10 11:25:47.647 | INFO     | retrieval.model:validation_step:353 - Recall@66_val: 71.123321123321
12
2024-08-10 11:25:47.648 | INFO     | retrieval.model:validation_step:353 - Recall@67_val: 71.123321123321
12
2024-08-10 11:25:47.648 | INFO     | retrieval.model:validation_step:353 - Recall@68_val: 71.123321123321
12
2024-08-10 11:25:47.649 | INFO     | retrieval.model:validation_step:353 - Recall@69_val: 71.123321123321
12
2024-08-10 11:25:47.649 | INFO     | retrieval.model:validation_step:353 - Recall@70_val: 71.123321123321
12
2024-08-10 11:25:47.650 | INFO     | retrieval.model:validation_step:353 - Recall@71_val: 71.123321123321
12
2024-08-10 11:25:47.651 | INFO     | retrieval.model:validation_step:353 - Recall@72_val: 71.123321123321
12
2024-08-10 11:25:47.651 | INFO     | retrieval.model:validation_step:353 - Recall@73_val: 71.123321123321
12
2024-08-10 11:25:47.652 | INFO     | retrieval.model:validation_step:353 - Recall@74_val: 71.123321123321
12
2024-08-10 11:25:47.652 | INFO     | retrieval.model:validation_step:353 - Recall@75_val: 71.123321123321
12
2024-08-10 11:25:47.653 | INFO     | retrieval.model:validation_step:353 - Recall@76_val: 71.123321123321
12
2024-08-10 11:25:47.653 | INFO     | retrieval.model:validation_step:353 - Recall@77_val: 71.489621489621
48
2024-08-10 11:25:47.654 | INFO     | retrieval.model:validation_step:353 - Recall@78_val: 71.489621489621
48
2024-08-10 11:25:47.654 | INFO     | retrieval.model:validation_step:353 - Recall@79_val: 71.489621489621
48
2024-08-10 11:25:47.655 | INFO     | retrieval.model:validation_step:353 - Recall@80_val: 71.489621489621
48
2024-08-10 11:25:47.655 | INFO     | retrieval.model:validation_step:353 - Recall@81_val: 71.489621489621
48
2024-08-10 11:25:47.656 | INFO     | retrieval.model:validation_step:353 - Recall@82_val: 71.489621489621
48
2024-08-10 11:25:47.656 | INFO     | retrieval.model:validation_step:353 - Recall@83_val: 71.489621489621
48
2024-08-10 11:25:47.657 | INFO     | retrieval.model:validation_step:353 - Recall@84_val: 71.489621489621
48
2024-08-10 11:25:47.658 | INFO     | retrieval.model:validation_step:353 - Recall@85_val: 71.489621489621
48
2024-08-10 11:25:47.658 | INFO     | retrieval.model:validation_step:353 - Recall@86_val: 71.489621489621
48
2024-08-10 11:25:47.659 | INFO     | retrieval.model:validation_step:353 - Recall@87_val: 71.489621489621
48
2024-08-10 11:25:47.659 | INFO     | retrieval.model:validation_step:353 - Recall@88_val: 71.489621489621
48
2024-08-10 11:25:47.660 | INFO     | retrieval.model:validation_step:353 - Recall@89_val: 71.489621489621
48
2024-08-10 11:25:47.660 | INFO     | retrieval.model:validation_step:353 - Recall@90_val: 71.489621489621
48
2024-08-10 11:25:47.661 | INFO     | retrieval.model:validation_step:353 - Recall@91_val: 71.489621489621
48
2024-08-10 11:25:47.661 | INFO     | retrieval.model:validation_step:353 - Recall@92_val: 71.489621489621
48
2024-08-10 11:25:47.662 | INFO     | retrieval.model:validation_step:353 - Recall@93_val: 71.489621489621
48
2024-08-10 11:25:47.662 | INFO     | retrieval.model:validation_step:353 - Recall@94_val: 71.489621489621
48
2024-08-10 11:25:47.663 | INFO     | retrieval.model:validation_step:353 - Recall@95_val: 71.489621489621
48
2024-08-10 11:25:47.663 | INFO     | retrieval.model:validation_step:353 - Recall@96_val: 71.489621489621
48
2024-08-10 11:25:47.664 | INFO     | retrieval.model:validation_step:353 - Recall@97_val: 71.489621489621
48
2024-08-10 11:25:47.664 | INFO     | retrieval.model:validation_step:353 - Recall@98_val: 71.489621489621
48
2024-08-10 11:25:47.665 | INFO     | retrieval.model:validation_step:353 - Recall@99_val: 73.076923076923
08
2024-08-10 11:25:47.665 | INFO     | retrieval.model:validation_step:353 - Recall@100_val: 73.07692307692
308
2024-08-10 11:25:47.666 | INFO     | retrieval.model:validation_step:362 - MRR: 0.4168527107812822
2024-08-10 11:25:47.667 | INFO     | retrieval.model:validation_step:370 - End of validation_step
Epoch 0: 100%|███████████████████████████████████████| 176750/176750 [11:58:03<00:00,  4.10it/s, v_num=1]
Metric Recall@10_val improved. New best score: 46.043
Epoch 0, global step 176750: 'Recall@10_val' reached 46.04282 (best 46.04282), saving model to '/raid/ada
rsh/checkpoints_test/_epoch=0-Recall@10_val=46.04.ckpt' as top 1
`Trainer.fit` stopped: `max_epochs=1` reached.
Epoch 0: 100%|███████████████████████████████████████| 176750/176750 [11:58:11<00:00,  4.10it/s, v_num=1]
2024-08-10 11:26:35.800 | INFO     | __main__:train:547 - Finished progressive training
2024-08-10 11:26:35.800 | INFO     | __main__:train:551 - New best model saved at: /raid/adarsh/checkpoin
ts_test/_epoch=0-Recall@10_val=46.04.ckpt
2024-08-10 11:26:35.801 | INFO     | __main__:cleanup_old_checkpoint:447 - Removed old checkpoint: /home/
adarsh/.cache/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d0
3912f2d86f/model.ckpt
2024-08-10 11:26:35.801 | INFO     | __main__:train:556 - Removing merged dataset
2024-08-10 11:26:35.801 | INFO     | __main__:cleanup_merged_dataset:456 - Cleaning up merged dataset at
/raid/adarsh/datasets_test/merged
2024-08-10 11:26:35.868 | INFO     | __main__:cleanup_merged_dataset:458 - Merged dataset deleted success
fully
2024-08-10 11:26:35.868 | INFO     | __main__:train:558 - Finished removing merged dataset
2024-08-10 11:26:35.868 | INFO     | __main__:train:560 - Converting and uploading models
2024-08-10 11:26:35.868 | INFO     | __main__:convert_and_upload_models:405 - Best model path: /raid/adar
sh/checkpoints_test/_epoch=0-Recall@10_val=46.04.ckpt
2024-08-10 11:26:35.868 | INFO     | __main__:convert_and_upload_models:407 - Converting best model to Hu
ggingFace format
^C[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 651, in <module>
[rank0]:     main()
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 641, in main
[rank0]:     train(model_checkpoint_path, merged_data_path, next_suffix)
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 561, in train
[rank0]:     convert_and_upload_models(best_model_path, new_data_path, next_suffix)
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 409, in convert_and_upload_models
[rank0]:     convert_to_hf(best_model_path, hf_path)
[rank0]:   File "/home/adarsh/ReProver/compute_server.py", line 332, in convert_to_hf
[rank0]:     model = PremiseRetriever.load(best_model_path, device, freeze=True, config=config)
[rank0]:   File "/home/adarsh/ReProver/retrieval/model.py", line 113, in load
[rank0]:     return load_checkpoint(cls, ckpt_path, device, freeze, config)
[rank0]:   File "/home/adarsh/ReProver/common.py", line 469, in load_checkpoint
[rank0]:     model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_
lightning/utilities/model_helpers.py", line 125, in wrapper
[rank0]:     return self.method(cls, *args, **kwargs)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_
lightning/core/module.py", line 1582, in load_from_checkpoint
[rank0]:     loaded = _load_from_checkpoint(
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_
lightning/core/saving.py", line 99, in _load_from_checkpoint
[rank0]:     return model.to(device)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/lightnin
g_fabric/utilities/device_dtype_mixin.py", line 55, in to
[rank0]:     return super().to(*args, **kwargs)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn
/modules/module.py", line 1174, in to
[rank0]:     return self._apply(convert)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn
/modules/module.py", line 780, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn
/modules/module.py", line 780, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn
/modules/module.py", line 780, in _apply
[rank0]:     module._apply(fn)
[rank0]:   [Previous line repeated 5 more times]
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn
/modules/module.py", line 805, in _apply
[rank0]:     param_applied = fn(param)
[rank0]:   File "/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/torch/nn
/modules/module.py", line 1160, in convert
[rank0]:     return t.to(
[rank0]: KeyboardInterrupt
^C
^C

^Z
[3]+  Stopped                 bash run_compute_server.sh
(base) adarsh@tensorlab-DGX-Station-A100-920-23487-2531-000:~/ReProver$ bash run_compute_server.sh
Script executed from: /home/adarsh/ReProver
[2024-08-10 11:28:48,468] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda
 (auto detect)
 [WARNING]  async_io requires the dev libaio .so object and headers but these were not found.
 [WARNING]  async_io: please install the libaio-dev package with apt
 [WARNING]  If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS envi
ronment variables to where it can be found.
 [WARNING]  Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
 [WARNING]  sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.4
 [WARNING]  using untested triton version (3.0.0), only 1.0.0 is known to be compatible
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/deepspeed/runtime/zero/li
near.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.cust
om_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/deepspeed/runtime/zero/li
near.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.cust
om_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
2024-08-10 11:28:54.786 | INFO     | __main__:check_progress_file:586 - Checking contents of /home/adarsh
/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/pytorch_lightning/loops/progress.py
2024-08-10 11:28:54.787 | INFO     | __main__:check_progress_file:590 - Contents of progress.py:
2024-08-10 11:28:54.787 | INFO     | __main__:check_progress_file:591 - # Copyright The Lightning AI team
.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
from dataclasses import asdict, dataclass, field
from typing import Type

from typing_extensions import override


@dataclass
class _BaseProgress:
    """Mixin that implements state-loading utilities for dataclasses."""

    def state_dict(self) -> dict:
        return asdict(self)

    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["completed"] == None:
            state_dict["completed"] = 0
        self.__dict__.update(state_dict)

    @classmethod
    def from_state_dict(cls, state_dict: dict) -> "_BaseProgress":
        obj = cls()
        obj.load_state_dict(state_dict)
        return obj

    def reset(self) -> None:
        """Reset the object's state."""
        raise NotImplementedError


@dataclass
class _ReadyCompletedTracker(_BaseProgress):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` las
t.

    """

    ready: int = 0
    completed: int = 0

    @override
    def reset(self) -> None:
        """Reset the state."""
        self.ready = 0
        self.completed = 0

    def reset_on_restart(self) -> None:
        """Reset the progress on restart.

        If there is a failure before all attributes are increased, restore the attributes to the last ful
ly completed
        value.

        """
        self.ready = self.completed


@dataclass
class _StartedTracker(_ReadyCompletedTracker):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        started: Intended to be incremented after the event is started (e.g. after ``on_*_start`` runs).
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` las
t.

    """

    started: int = 0

    @override
    def reset(self) -> None:
        super().reset()
        self.started = 0

    @override
    def reset_on_restart(self) -> None:
        super().reset_on_restart()
        self.started = self.completed


@dataclass
class _ProcessedTracker(_StartedTracker):
    """Track an event's progress.

    Args:
        ready: Intended to track the number of events ready to start.
        started: Intended to be incremented after the event is started (e.g. after ``on_*_start`` runs).
        processed: Intended to be incremented after the event is processed.
        completed: Intended to be incremented after the event completes (e.g. after ``on_*_end`` runs).

    These attributes should be increased in order, that is, :attr:`ready` first and :attr:`completed` las
t.

    """

    processed: int = 0

    @override
    def reset(self) -> None:
        super().reset()
        self.processed = 0

    @override
    def reset_on_restart(self) -> None:
        super().reset_on_restart()
        self.processed = self.completed


@dataclass
class _Progress(_BaseProgress):
    """Track aggregated and current progress.

    Args:
        total: Intended to track the total progress of an event.
        current: Intended to track the current progress of an event.

    """

    total: _ReadyCompletedTracker = field(default_factory=_ProcessedTracker)
    current: _ReadyCompletedTracker = field(default_factory=_ProcessedTracker)

    def __post_init__(self) -> None:
        if self.total.__class__ is not self.current.__class__:
            raise ValueError("The `total` and `current` instances should be of the same class")

    def increment_ready(self) -> None:
        self.total.ready += 1
        self.current.ready += 1

    def increment_started(self) -> None:
        if not isinstance(self.total, _StartedTracker):
            raise TypeError(f"`{self.total.__class__.__name__}` doesn't have a `started` attribute")
        self.total.started += 1
        self.current.started += 1

    def increment_processed(self) -> None:
        if not isinstance(self.total, _ProcessedTracker):
            raise TypeError(f"`{self.total.__class__.__name__}` doesn't have a `processed` attribute")
        self.total.processed += 1
        self.current.processed += 1

    def increment_completed(self) -> None:
        self.total.completed += 1
        self.current.completed += 1

    @classmethod
    def from_defaults(cls, tracker_cls: Type[_ReadyCompletedTracker], **kwargs: int) -> "_Progress":
        """Utility function to easily create an instance from keyword arguments to both ``Tracker``s."""
        return cls(total=tracker_cls(**kwargs), current=tracker_cls(**kwargs))

    @override
    def reset(self) -> None:
        self.total.reset()
        self.current.reset()

    def reset_on_run(self) -> None:
        self.current.reset()

    def reset_on_restart(self) -> None:
        self.current.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["total"]["completed"] == None:
            state_dict["total"]["completed"] = 0
        self.total.load_state_dict(state_dict["total"])
        self.current.load_state_dict(state_dict["current"])


@dataclass
class _BatchProgress(_Progress):
    """Tracks batch progress.

    These counters are local to a trainer rank. By default, they are not globally synced across all ranks
.

    Args:
        total: Tracks the total batch progress.
        current: Tracks the current batch progress.
        is_last_batch: Whether the batch is the last one. This is useful for iterable datasets.

    """

    is_last_batch: bool = False

    @override
    def reset(self) -> None:
        super().reset()
        self.is_last_batch = False

    @override
    def reset_on_run(self) -> None:
        super().reset_on_run()
        self.is_last_batch = False

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["total"]["completed"] == None:
            state_dict["total"]["completed"] = 0
        super().load_state_dict(state_dict)
        self.is_last_batch = state_dict["is_last_batch"]


@dataclass
class _SchedulerProgress(_Progress):
    """Tracks scheduler progress.

    These counters are local to a trainer rank. By default, they are not globally synced across all ranks
.

    Args:
        total: Tracks the total scheduler progress.
        current: Tracks the current scheduler progress.

    """

    total: _ReadyCompletedTracker = field(default_factory=_ReadyCompletedTracker)
    current: _ReadyCompletedTracker = field(default_factory=_ReadyCompletedTracker)


@dataclass
class _OptimizerProgress(_BaseProgress):
    """Track optimizer progress.

    Args:
        step: Tracks ``optimizer.step`` calls.
        zero_grad: Tracks ``optimizer.zero_grad`` calls.

    """

    step: _Progress = field(default_factory=lambda: _Progress.from_defaults(_ReadyCompletedTracker))
    zero_grad: _Progress = field(default_factory=lambda: _Progress.from_defaults(_StartedTracker))

    @override
    def reset(self) -> None:
        self.step.reset()
        self.zero_grad.reset()

    def reset_on_run(self) -> None:
        self.step.reset_on_run()
        self.zero_grad.reset_on_run()

    def reset_on_restart(self) -> None:
        self.step.reset_on_restart()
        self.zero_grad.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["step"]["total"]["completed"] == None:
            state_dict["step"]["total"]["completed"] = 0
        self.step.load_state_dict(state_dict["step"])
        self.zero_grad.load_state_dict(state_dict["zero_grad"])


@dataclass
class _OptimizationProgress(_BaseProgress):
    """Track optimization progress.

    Args:
        optimizer: Tracks optimizer progress.

    """

    optimizer: _OptimizerProgress = field(default_factory=_OptimizerProgress)

    @property
    def optimizer_steps(self) -> int:
        return self.optimizer.step.total.completed

    @override
    def reset(self) -> None:
        self.optimizer.reset()

    def reset_on_run(self) -> None:
        self.optimizer.reset_on_run()

    def reset_on_restart(self) -> None:
        self.optimizer.reset_on_restart()

    @override
    def load_state_dict(self, state_dict: dict) -> None:
        if state_dict["optimizer"]["step"]["total"]["completed"] == None:
            state_dict["optimizer"]["step"]["total"]["completed"] = 0
        self.optimizer.load_state_dict(state_dict["optimizer"])

2024-08-10 11:28:54.787 | INFO     | __main__:main:608 - Starting compute server...
2024-08-10 11:28:54.787 | INFO     | __main__:main:609 - Current working directory: /home/adarsh/ReProver
2024-08-10 11:28:54.787 | INFO     | __main__:main:613 - ROOT_DIR: /raid/adarsh
2024-08-10 11:28:54.787 | INFO     | __main__:main:614 - DATA_DIR: datasets_test
2024-08-10 11:28:54.787 | INFO     | __main__:main:618 - Configuring LeanDojo...
2024-08-10 11:28:54.790 | INFO     | generate_benchmark_lean4:configure_leandojo:294 - Current working di
rectory: /home/adarsh/ReProver
2024-08-10 11:28:54.790 | INFO     | __main__:main:620 - LeanDojo configured
2024-08-10 11:28:54.791 | INFO     | __main__:main:628 - Unique URLs: {'https://github.com/teorth/pfr.git
'}
2024-08-10 11:28:54.791 | INFO     | __main__:main:629 - About to generate datasets...
2024-08-10 11:28:54.791 | INFO     | __main__:generate_dataset:226 - Generating 1 datasets
2024-08-10 11:28:54.791 | INFO     | __main__:generate_dataset:231 - Processing https://github.com/teorth
/pfr.git
2024-08-10 11:28:55.010 | INFO     | __main__:get_compatible_commit:166 - Latest commit: 6a5082ee465f9e44
cea479c7b741b3163162bb7e
2024-08-10 11:28:55.011 | INFO     | __main__:get_compatible_commit:169 - Creating LeanGitRepo for https:
//github.com/teorth/pfr
2024-08-10 11:28:55.425 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.8.0-rc1
2024-08-10 11:28:56.005 | INFO     | __main__:get_compatible_commit:171 - Getting config for https://gith
ub.com/teorth/pfr.git
2024-08-10 11:28:56.005 | INFO     | __main__:get_compatible_commit:175 - Latest commit compatible for ur
l https://github.com/teorth/pfr.git
2024-08-10 11:28:56.005 | INFO     | __main__:generate_dataset:236 - Found compatible commit 6a5082ee465f
9e44cea479c7b741b3163162bb7e for https://github.com/teorth/pfr.git
2024-08-10 11:28:56.005 | INFO     | __main__:generate_dataset:237 - Lean version: v4.8.0-rc1
2024-08-10 11:28:56.005 | INFO     | __main__:generate_dataset:240 - Creating LeanGitRepo for https://git
hub.com/teorth/pfr
2024-08-10 11:28:56.006 | INFO     | __main__:generate_dataset:244 - Generating benchmark at /raid/adarsh
/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:301 - Generating dataset to go into /r
aid/adarsh/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:308 - lean toolchain version: {'conten
t': 'leanprover/lean4:v4.8.0-rc1\n'}
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:310 - lean version v: v4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:311 - is supported: True
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:321 - lean path1 /home/adarsh/.elan/to
olchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:322 - lean path2 /.elan/toolchains/lea
nprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:323 - lean path3 ~/.elan/toolchains/le
anprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:327 - Lean toolchain path 2 does not e
xist: /.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:329 - Lean toolchain path 3 does not e
xist: ~/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.006 | INFO     | generate_benchmark_lean4:main:332 - Switched to Lean toolchain at: /
home/adarsh/.elan/toolchains/leanprover--lean4---4.8.0-rc1
2024-08-10 11:28:56.039 | INFO     | generate_benchmark_lean4:main:334 - lean --version: Lean (version 4.
8.0-rc1, x86_64-unknown-linux-gnu, commit dcccfb73cb24, Release)

2024-08-10 11:28:56.040 | INFO     | generate_benchmark_lean4:main:335 - repo: LeanGitRepo(url='https://g
ithub.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162bb7e')
2024-08-10 11:28:56.040 | INFO     | generate_benchmark_lean4:main:337 - Configuring LeanDojo again...
2024-08-10 11:28:56.043 | INFO     | generate_benchmark_lean4:configure_leandojo:294 - Current working di
rectory: /home/adarsh/ReProver
2024-08-10 11:28:56.043 | INFO     | generate_benchmark_lean4:main:339 - LeanDojo configured
2024-08-10 11:28:56.043 | INFO     | generate_benchmark_lean4:main:342 - Tracing the repo...
2024-08-10 11:28:56.043 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:217 - The trace
d repo is available in the cache.
2024-08-10 11:28:56.043 | INFO     | lean_dojo.data_extraction.trace:trace:246 - Loading the traced repo
from /raid/adarsh/.cache/lean_dojo/teorth-pfr-6a5082ee465f9e44cea479c7b741b3163162bb7e/pfr
2024-08-10 11:28:56.046 | DEBUG    | lean_dojo.utils:execute:110 - git remote get-url origin
2024-08-10 11:28:56.049 | DEBUG    | lean_dojo.utils:execute:110 - git log -n 1
2024-08-10 11:28:56.240 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1169 - Loading
2890 traced XML files from /raid/adarsh/.cache/lean_dojo/teorth-pfr-6a5082ee465f9e44cea479c7b741b3163162b
b7e/pfr with 31 workers
2024-08-10 11:28:57,561 INFO worker.py:1772 -- Started a local Ray instance. View the dashboard at 127.0.
0.1:8267
  4%|██▊                                                              | 123/2890 [00:06<01:19, 35.01it/s]
(raylet) [2024-08-10 11:29:07,455 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648814080; capacity: 1887507697
664. Object creation will fail if spilling is required.
 13%|████████▌                                                        | 380/2890 [00:15<00:50, 49.60it/s]
(raylet) [2024-08-10 11:29:17,463 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648764928; capacity: 1887507697
664. Object creation will fail if spilling is required.
 20%|█████████████                                                    | 582/2890 [00:23<00:40, 56.33it/s]
(raylet) [2024-08-10 11:29:27,469 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648736256; capacity: 1887507697
664. Object creation will fail if spilling is required.
 31%|████████████████████                                             | 891/2890 [00:36<00:28, 69.42it/s]
(raylet) [2024-08-10 11:29:37,476 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648625664; capacity: 1887507697
664. Object creation will fail if spilling is required.
 34%|██████████████████████▍                                          | 997/2890 [00:45<00:45, 41.38it/s]
(raylet) [2024-08-10 11:29:47,480 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93648609280; capacity: 1887507697
664. Object creation will fail if spilling is required.
 38%|████████████████████████                                        | 1089/2890 [01:07<22:27,  1.34it/s]
(raylet) [2024-08-10 11:30:07,491 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93647622144; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 2x across cluster] (Ray deduplicates lo
gs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ra
y-observability/user-guides/configure-logging.html#log-deduplication for more options.)
 42%|██████████████████████████▋                                     | 1203/2890 [01:23<00:42, 39.26it/s]
(raylet) [2024-08-10 11:30:17,496 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93647593472; capacity: 1887507697
664. Object creation will fail if spilling is required.
 46%|█████████████████████████████▋                                  | 1338/2890 [01:43<00:36, 42.83it/s]
(raylet) [2024-08-10 11:30:27,502 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93647556608; capacity: 1887507697
664. Object creation will fail if spilling is required.
 51%|████████████████████████████████▍                               | 1463/2890 [01:56<02:59,  7.96it/s]
(raylet) [2024-08-10 11:30:57,556 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93644828672; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 3x across cluster]
 54%|█████████████████████████████████▍                            | 1559/2890 [03:10<2:50:35,  7.69s/it]
(raylet) [2024-08-10 11:31:07,573 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93643739136; capacity: 1887507697
664. Object creation will fail if spilling is required.
(raylet) [2024-08-10 11:31:17,589 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93643730944; capacity: 1887507697
664. Object creation will fail if spilling is required.
 56%|███████████████████████████████████▉                            | 1625/2890 [03:16<02:32,  8.30it/s]
(raylet) [2024-08-10 11:32:17,795 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93642104832; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 6x across cluster]
 58%|█████████████████████████████████████▍                          | 1690/2890 [03:26<02:42,  7.38it/s]
(raylet) [2024-08-10 11:32:27,818 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93642076160; capacity: 1887507697
664. Object creation will fail if spilling is required.
 60%|█████████████████████████████████████▎                        | 1741/2890 [04:09<1:44:02,  5.43s/it]
(raylet) [2024-08-10 11:32:37,853 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93642047488; capacity: 1887507697
664. Object creation will fail if spilling is required.
 71%|█████████████████████████████████████████████▍                  | 2052/2890 [04:46<26:23,  1.89s/it]
(raylet) [2024-08-10 11:33:17,969 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93639749632; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 4x across cluster]
 80%|███████████████████████████████████████████████████             | 2307/2890 [05:31<23:26,  2.41s/it]
(raylet) [2024-08-10 11:33:57,989 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93639602176; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 4x across cluster]
 85%|██████████████████████████████████████████████████████▎         | 2450/2890 [05:37<00:11, 39.26it/s]
(raylet) [2024-08-10 11:34:38,028 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93638209536; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 4x across cluster]
 89%|████████████████████████████████████████████████████████▊       | 2567/2890 [06:27<16:18,  3.03s/it]
(raylet) [2024-08-10 11:34:48,034 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93638189056; capacity: 1887507697
664. Object creation will fail if spilling is required.
(raylet) [2024-08-10 11:34:58,040 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93638135808; capacity: 1887507697
664. Object creation will fail if spilling is required.
100%|████████████████████████████████████████████████████████████████| 2890/2890 [06:31<00:00,  7.38it/s]
(raylet) [2024-08-10 11:35:28,057 E 3149617 3149650] (raylet) file_system_monitor.cc:111: /tmp/ray/sessio
n_2024-08-10_11-28-56_358123_3148492 is over 95% full, available space: 93637283840; capacity: 1887507697
664. Object creation will fail if spilling is required. [repeated 3x across cluster]
2024-08-10 11:35:34.043 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the d
ependencies of LeanGitRepo(url='https://github.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163
162bb7e')
2024-08-10 11:35:35.488 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.6.0-rc1
2024-08-10 11:35:37.749 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.7.0
2024-08-10 11:35:38.710 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https:/
/github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-10 11:35:39.833 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https:/
/github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-10 11:35:43.077 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.10.0
2024-08-10 11:35:44.255 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for doc-gen4 main
2024-08-10 11:35:44.880 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.11.0-rc1
2024-08-10 11:35:45.552 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the d
ependencies of LeanGitRepo(url='https://github.com/YaelDillies/LeanAPAP', commit='f47447e44d8e82ab214ed8c
1b199329141fc5b1f')
2024-08-10 11:35:46.263 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.9.0-rc1
2024-08-10 11:35:47.307 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.10.0-rc1
2024-08-10 11:35:48.036 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.9.0
2024-08-10 11:35:49.648 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https:/
/github.com/leanprover-community/mathlib4.git") failed. Retrying...
2024-08-10 11:35:50.777 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:68 - url_to_repo("https:/
/github.com/leanprover-community/mathlib4.git") failed. Retrying...
2024-08-10 11:35:53.981 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the d
ependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='ac1484f2267e5d
4757bcc02e57c0d84d0cfee51e')
2024-08-10 11:35:55.182 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:489 - Querying the d
ependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='6d8e3118ab526f8dfcabcbdf
9f05dc34e5c423a8')
2024-08-10 11:35:56.199 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 v4.10.0-rc2
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-08-10 11:35:58.040 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 nightly-2024-06-05
2024-08-10 11:35:59.291 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for md4lean main
2024-08-10 11:35:59.494 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for BibtexQuery master
2024-08-10 11:35:59.910 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4-unicode-basic main
2024-08-10 11:36:00.571 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4-cli nightly
2024-08-10 11:36:00.814 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:88 - Querying the com
mit hash for lean4 nightly-2024-06-05
2024-08-10 11:36:02.093 | INFO     | generate_benchmark_lean4:main:346 - Failed to trace repo LeanGitRepo
(url='https://github.com/teorth/pfr', commit='6a5082ee465f9e44cea479c7b741b3163162bb7e') because of Inval
id tag or branch: `nightly-2024-06-05` for Repository(full_name="leanprover/lean4")
2024-08-10 11:36:12.414 | INFO     | __main__:generate_dataset:246 - Finished generating benchmark at /ra
id/adarsh/datasets_test/pfr_6a5082ee465f9e44cea479c7b741b3163162bb7e
2024-08-10 11:36:12.418 | INFO     | __main__:generate_dataset:247 - Merging datasets
2024-08-10 11:36:12.418 | INFO     | __main__:merge_datasets:74 - Merging datasets for random
2024-08-10 11:36:12.418 | INFO     | __main__:merge_datasets:80 - Processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing val split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing val split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing test split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing test split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:105 - Finished merging datasets for random
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:74 - Merging datasets for novel_premises
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:104 - Finished processing train split
2024-08-10 11:36:12.419 | INFO     | __main__:merge_datasets:80 - Processing val split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:104 - Finished processing val split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:80 - Processing test split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:104 - Finished processing test split
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:105 - Finished merging datasets for novel_pr
emises
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:107 - Merging corpus
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:130 - Finished merging corpus
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:132 - Adding metadata
2024-08-10 11:36:12.420 | WARNING  | __main__:merge_datasets:152 - No metadata file found
2024-08-10 11:36:12.420 | INFO     | __main__:merge_datasets:154 - Deleting individual datasets
2024-08-10 11:36:12.420 | INFO     | __main__:generate_dataset:249 - Finished merging datasets
2024-08-10 11:36:12.514 | INFO     | __main__:main:635 - Latest PL checkpoint found: AK123321/pl-leancopi
lot-2
2024-08-10 11:36:12.662 | INFO     | __main__:download_pl_checkpoint:274 - Checkpoint downloaded to: /hom
e/adarsh/.cache/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162
d03912f2d86f/model.ckpt
2024-08-10 11:36:12.662 | INFO     | __main__:main:638 - Checkpoint path: /home/adarsh/.cache/huggingface
/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.ckpt
2024-08-10 11:36:12.662 | INFO     | __main__:train:464 - Training model with checkpoint: /home/adarsh/.c
ache/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86
f/model.ckpt
Seed set to 3407
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to yo
ur files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../.cache/huggingface
/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/model.ckpt`
2024-08-10 11:36:25.012 | INFO     | __main__:train:486 - Loaded premise retriever at /home/adarsh/.cache
/huggingface/hub/models--AK123321--pl-leancopilot-2/snapshots/d4955ed1972ad84c03dce9189162d03912f2d86f/mo
del.ckpt
2024-08-10 11:36:25.012 | INFO     | __main__:train:490 - Data path: /raid/adarsh/datasets_test/merged/ra
ndom
/home/adarsh/miniconda3/envs/ReProverComputeServer/lib/python3.10/site-packages/transformers/tokenization
_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True`
by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by def
ault. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-08-10 11:36:25.118 | INFO     | common:__init__:199 - Building the corpus from /raid/adarsh/datasets
_test/merged/corpus.jsonl
2024-08-10 11:36:25.120 | INFO     | __main__:main:647 - An error occurred: [Errno 2] No such file or dir
ectory: '/raid/adarsh/datasets_test/merged/random/../metadata.json'
Traceback (most recent call last):
  File "/home/adarsh/ReProver/compute_server.py", line 641, in main
    train(model_checkpoint_path, merged_data_path, next_suffix)
  File "/home/adarsh/ReProver/compute_server.py", line 491, in train
    data_module = RetrievalDataModule(
  File "/home/adarsh/ReProver/retrieval/datamodule.py", line 246, in __init__
    metadata = json.load(open(os.path.join(data_path, "../metadata.json")))
FileNotFoundError: [Errno 2] No such file or directory: '/raid/adarsh/datasets_test/merged/random/../meta
data.json'
(base) adarsh@tensorlab-DGX-Station-A100-920-23487-2531-000:~/ReProver$
