2024-08-31 22:52:49.939 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
2024-08-31 22:52:49.939 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl
2024-08-31 22:52:51.443 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python main.py
[2024-08-31 23:22:56,319] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-08-31 23:23:04.024 | INFO     | __main__:main:1211 - Running progressive training
2024-08-31 23:23:04.024 | INFO     | __main__:main:1217 - Configuring LeanDojo...
2024-08-31 23:23:04.030 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-08-31 23:23:04.030 | INFO     | __main__:main:1219 - LeanDojo configured
2024-08-31 23:23:05.624 | INFO     | __main__:search_github_repositories:373 - Processing leanprover/lean4
2024-08-31 23:23:05.624 | INFO     | __main__:search_github_repositories:391 - Skipping leanprover/lean4 since it is a known repository
2024-08-31 23:23:05.624 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-08-31 23:23:06.523 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-08-31 23:23:07.563 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-08-31 23:23:09.602 | INFO     | __main__:search_github_repositories:389 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-08-31 23:23:09.603 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-08-31 23:23:10.604 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
[E831 23:23:16.365761254 socket.cpp:957] [c10d] The client socket has timed out after 1800s while trying to connect to (127.0.0.1, 54545).
2024-08-31 23:23:17.000 | INFO     | __main__:main:1230 - An error occurred: The client socket has timed out after 1800s while trying to connect to (127.0.0.1, 54545).
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1210, in main
    if run_progressive_training:
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1102, in retrieve_proof
    # The user can choose to generate a dataset from the entire dynamic database or a subset of it.
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 737, in train_test_fisher
    best_model.eval()
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    self.strategy.setup_environment()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
    self.setup_distributed()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
    return TCPStore(
torch.distributed.DistNetworkError: The client socket has timed out after 1800s while trying to connect to (127.0.0.1, 54545).
2024-08-31 23:23:25.922 | INFO     | __main__:search_github_repositories:373 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-08-31 23:23:26.828 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-08-31 23:23:27.874 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-08-31 23:23:29.915 | INFO     | __main__:search_github_repositories:389 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-08-31 23:23:29.916 | INFO     | __main__:search_github_repositories:373 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-08-31 23:23:30.709 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-08-31 23:23:31.749 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-08-31 23:23:33.790 | INFO     | __main__:search_github_repositories:389 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-08-31 23:23:33.792 | INFO     | __main__:search_github_repositories:373 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-08-31 23:23:34.507 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-08-31 23:23:35.546 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-08-31 23:23:37.585 | INFO     | __main__:search_github_repositories:389 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-08-31 23:23:37.586 | INFO     | __main__:search_github_repositories:373 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-08-31 23:23:38.278 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-08-31 23:23:39.317 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-08-31 23:23:41.358 | INFO     | __main__:search_github_repositories:389 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-08-31 23:23:41.359 | INFO     | __main__:search_github_repositories:373 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-08-31 23:23:42.136 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-08-31 23:23:43.175 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-08-31 23:23:45.215 | INFO     | __main__:search_github_repositories:389 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-08-31 23:23:45.216 | INFO     | __main__:search_github_repositories:373 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-08-31 23:23:45.932 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-08-31 23:24:01.088 | INFO     | __main__:retrieve_proof:1026 - Processing https://github.com/leanprover-community/mathlib4.git
2024-08-31 23:24:01.089 | INFO     | __main__:retrieve_proof:1042 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-08-31 23:24:01.089 | INFO     | __main__:retrieve_proof:1043 - Lean version: v4.8.0
2024-08-31 23:24:01.290 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-08-31 23:24:16.503 | INFO     | __main__:retrieve_proof:1048 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:24:16.503 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:24:16.503 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-08-31 23:24:16.503 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-08-31 23:24:16.504 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-08-31 23:24:16.504 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-08-31 23:24:16.504 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-08-31 23:24:16.504 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-08-31 23:24:16.508 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-08-31 23:24:16.509 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-08-31 23:24:16.509 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-08-31 23:24:16.584 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-08-31 23:24:16.584 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-08-31 23:24:16.584 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-08-31 23:24:16.600 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-08-31 23:24:16.600 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-08-31 23:24:16.600 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-08-31 23:24:16.613 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-08-31 23:24:16.613 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4
2024-08-31 23:24:27.340 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb
1310/mathlib4 with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [16:37<00:00,  5.53it/s]
2024-08-31 23:41:05.109 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-08-31 23:41:06.323 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-08-31 23:41:22.578 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-08-31 23:41:38.514 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-08-31 23:41:54.340 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-31 23:41:55.450 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-08-31 23:41:57.996 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-08-31 23:41:58.444 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-08-31 23:42:07.698 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-08-31 23:42:08.147 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-08-31 23:42:23.645 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-08-31 23:42:24.568 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-08-31 23:42:39.896 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-08-31 23:42:40.690 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-08-31 23:42:41.132 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-08-31 23:42:56.933 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-08-31 23:42:57.386 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe')
2024-08-31 23:42:57.787 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-08-31 23:43:14.394 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-08-31 23:43:15.969 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupported Lean version: fbb3055f82f
f9a4bc82f6722f6e73225617342fd
2024-08-31 23:43:15.969 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf10839227bbb9e8492be2d')
2024-08-31 23:43:16.017 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e350841ce65a1ec42c')
2024-08-31 23:43:16.065 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c1066493c3f5dc51c9713e')
2024-08-31 23:43:16.159 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5')
2024-08-31 23:43:16.256 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0')
2024-08-31 23:43:16.306 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')
2024-08-31 23:43:50.815 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306b
eb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='021e272cb5cdcc
82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad
7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', c
ommit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', comm
it='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/Bi
btexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean
_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-08-31 23:44:26.030 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-08-31 23:44:26.031 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-08-31 23:44:26.032 | INFO     | __main__:retrieve_proof:1056 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:44:43.060 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-08-31 23:44:43.060 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 31644.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [01:53<00:00, 1024.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 35001.93it/s]
2024-08-31 23:46:42.857 | INFO     | __main__:retrieve_proof:1094 - Before adding new repo:
2024-08-31 23:46:42.857 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-08-31 23:46:42.857 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-08-31 23:46:42.858 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-08-31 23:46:42.858 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the database.
2024-08-31 23:46:42.858 | INFO     | __main__:retrieve_proof:1097 - After adding new repo:
2024-08-31 23:46:42.858 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-08-31 23:46:42.858 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-08-31 23:47:04.927 | INFO     | __main__:retrieve_proof:1106 - Adding repo to repos_for_merged_dataset
2024-08-31 23:47:04.930 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-08-31 23:47:04.930 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-08-31 23:50:43.021 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Removing it now.
2024-08-31 23:51:21.433 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:51:22.509 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:51:22.535 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:51:22.540 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-08-31 23:51:22.580 | INFO     | __main__:find_latest_checkpoint:456 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epo
ch=0-Recall@10_val=58.95.ckpt
2024-08-31 23:51:22.580 | INFO     | __main__:retrieve_proof:1118 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall
@10_val=58.95.ckpt
2024-08-31 23:51:22.580 | INFO     | __main__:train_test_fisher:596 - Inside train_test_fisher
2024-08-31 23:51:22.580 | INFO     | __main__:train_test_fisher:597 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/migration/utils.py:56: The loaded checkpoint was produced with Lightning v2.4.0, which is newer than your current Lightning version: v2.2.4
2024-08-31 23:51:29.953 | INFO     | __main__:train_test_fisher:621 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-R
ecall@10_val=58.95.ckpt and reset epoch count
2024-08-31 23:51:29.957 | INFO     | __main__:find_latest_fisher:466 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is
possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weight
s_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serializ
ation.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-08-31 23:51:30.812 | INFO     | __main__:load_fisher_information:443 - Fisher Information successfully loaded.
2024-08-31 23:51:30.812 | INFO     | retrieval.model:set_fisher_info:62 - Fisher Information has been updated in the model.
2024-08-31 23:51:30.813 | INFO     | __main__:train_test_fisher:627 - Fisher Information Matrix loaded.
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-08-31 23:51:30.947 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:31<00:00, 3660.15it/s]
2024-08-31 23:52:44.309 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/cache
_train/cached_data.pkl
Training dataset size: 359583
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 3765.36it/s]
2024-08-31 23:52:45.117 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/cache
_val/cached_data.pkl
Validation dataset size: 4874
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 3943.24it/s]
2024-08-31 23:52:45.886 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/cache
_pred/cached_data.pkl
Testing dataset size: 4922
Training dataset size after load: 359583
Validation dataset size after load: 4874
Testing dataset size after load: 4922
2024-08-31 23:52:45.889 | INFO     | __main__:main:1252 - An error occurred: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1232, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1124, in retrieve_proof
    train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 689, in train_test_fisher
    init_process_group()
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 683, in init_process_group
    dist.init_process_group(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 246, in _env_rendezvous_handler
    rank = int(_get_env_or_raise("RANK"))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 231, in _get_env_or_raise
    raise _env_error(env_var)
ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python main.py
[2024-09-01 00:25:32,352] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-01 00:25:36.743 | INFO     | __main__:main:1211 - Running progressive training
2024-09-01 00:25:36.744 | INFO     | __main__:main:1217 - Configuring LeanDojo...
2024-09-01 00:25:36.750 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:25:36.750 | INFO     | __main__:main:1219 - LeanDojo configured
2024-09-01 00:25:38.315 | INFO     | __main__:search_github_repositories:373 - Processing leanprover/lean4
2024-09-01 00:25:38.315 | INFO     | __main__:search_github_repositories:391 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 00:25:38.316 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 00:25:39.765 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:25:40.804 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:25:42.901 | INFO     | __main__:search_github_repositories:389 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 00:25:42.902 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 00:25:43.896 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 00:25:59.157 | INFO     | __main__:search_github_repositories:373 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 00:25:59.880 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:26:00.932 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:26:02.975 | INFO     | __main__:search_github_repositories:389 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 00:26:02.976 | INFO     | __main__:search_github_repositories:373 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 00:26:03.675 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:26:04.714 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:26:06.754 | INFO     | __main__:search_github_repositories:389 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 00:26:06.756 | INFO     | __main__:search_github_repositories:373 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 00:26:07.494 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:26:08.534 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:26:10.574 | INFO     | __main__:search_github_repositories:389 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 00:26:10.575 | INFO     | __main__:search_github_repositories:373 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 00:26:11.317 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:26:12.359 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:26:14.401 | INFO     | __main__:search_github_repositories:389 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 00:26:14.402 | INFO     | __main__:search_github_repositories:373 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 00:26:15.161 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:26:16.233 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:26:18.274 | INFO     | __main__:search_github_repositories:389 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 00:26:18.275 | INFO     | __main__:search_github_repositories:373 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 00:26:18.957 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 00:26:34.267 | INFO     | __main__:retrieve_proof:1026 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:26:34.268 | INFO     | __main__:retrieve_proof:1042 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:26:34.268 | INFO     | __main__:retrieve_proof:1043 - Lean version: v4.8.0
2024-09-01 00:26:34.513 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-01 00:26:49.893 | INFO     | __main__:retrieve_proof:1048 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:26:49.893 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:26:49.893 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 00:26:49.893 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 00:26:49.894 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 00:26:49.894 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:26:49.894 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:26:49.894 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:26:49.896 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:26:49.896 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:26:49.896 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:26:49.959 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 00:26:49.959 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 00:26:49.959 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 00:26:49.968 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:26:49.968 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 00:26:49.968 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 00:26:49.974 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 00:26:49.974 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4
2024-09-01 00:26:55.438 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb
1310/mathlib4 with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [15:52<00:00,  5.79it/s]
2024-09-01 00:42:47.576 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 00:42:48.956 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-01 00:43:06.515 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 00:43:22.335 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 00:43:37.888 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 00:43:39.017 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 00:43:41.607 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 00:43:42.201 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 00:43:51.523 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 00:43:51.948 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 00:44:06.998 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 00:44:08.197 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 00:44:23.288 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 00:44:24.119 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 00:44:24.781 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 00:44:40.604 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 00:44:41.198 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe')
2024-09-01 00:44:41.760 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 00:44:58.607 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 00:45:00.022 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupported Lean version: fbb3055f82f
f9a4bc82f6722f6e73225617342fd
2024-09-01 00:45:00.022 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf10839227bbb9e8492be2d')
2024-09-01 00:45:00.213 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e350841ce65a1ec42c')
2024-09-01 00:45:00.422 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c1066493c3f5dc51c9713e')
2024-09-01 00:45:00.870 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 00:45:01.279 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0')
2024-09-01 00:45:01.477 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')
2024-09-01 00:45:34.496 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306b
eb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='021e272cb5cdcc
82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad
7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', c
ommit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', comm
it='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/Bi
btexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean
_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 00:45:59.547 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 00:45:59.548 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 00:45:59.548 | INFO     | __main__:retrieve_proof:1056 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:46:16.103 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 00:46:16.103 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 34814.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [01:51<00:00, 1041.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 35343.91it/s]
2024-09-01 00:48:14.014 | INFO     | __main__:retrieve_proof:1094 - Before adding new repo:
2024-09-01 00:48:14.014 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 00:48:14.014 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 00:48:14.015 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 00:48:14.015 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the database.
2024-09-01 00:48:14.015 | INFO     | __main__:retrieve_proof:1097 - After adding new repo:
2024-09-01 00:48:14.015 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 00:48:14.015 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 00:48:35.274 | INFO     | __main__:retrieve_proof:1106 - Adding repo to repos_for_merged_dataset
2024-09-01 00:48:35.275 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 00:48:35.275 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 00:52:02.364 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Removing it now.
2024-09-01 00:52:37.871 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:52:38.838 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:52:38.859 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:52:38.862 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:52:38.898 | INFO     | __main__:find_latest_checkpoint:456 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epo
ch=0-Recall@10_val=58.95.ckpt
2024-09-01 00:52:38.898 | INFO     | __main__:retrieve_proof:1118 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall
@10_val=58.95.ckpt
2024-09-01 00:52:38.898 | INFO     | __main__:train_test_fisher:596 - Inside train_test_fisher
2024-09-01 00:52:38.898 | INFO     | __main__:train_test_fisher:597 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/migration/utils.py:56: The loaded checkpoint was produced with Lightning v2.4.0, which is newer than your current Lightning version: v2.2.4
2024-09-01 00:52:44.658 | INFO     | __main__:train_test_fisher:621 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-R
ecall@10_val=58.95.ckpt and reset epoch count
2024-09-01 00:52:44.659 | INFO     | __main__:find_latest_fisher:466 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is
possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weight
s_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serializ
ation.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-01 00:52:45.518 | INFO     | __main__:load_fisher_information:443 - Fisher Information successfully loaded.
2024-09-01 00:52:45.519 | INFO     | retrieval.model:set_fisher_info:62 - Fisher Information has been updated in the model.
2024-09-01 00:52:45.519 | INFO     | __main__:train_test_fisher:627 - Fisher Information Matrix loaded.
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-01 00:52:45.628 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:28<00:00, 4147.99it/s]
2024-09-01 00:53:45.694 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/cache
_train/cached_data.pkl
Training dataset size: 359583
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 4323.34it/s]
2024-09-01 00:53:46.392 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/cache
_val/cached_data.pkl
Validation dataset size: 4874
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 4443.79it/s]
2024-09-01 00:53:47.069 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/cache
_pred/cached_data.pkl
Testing dataset size: 4922
Training dataset size after load: 359583
Validation dataset size after load: 4874
Testing dataset size after load: 4922
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-01 00:53:47.168 | INFO     | __main__:train_test_fisher:709 - Starting progressive training from epoch 0 to 1
2024-09-01 00:53:47.168 | INFO     | __main__:train_test_fisher:723 - Finished progressive training at epoch 0
2024-09-01 00:53:47.168 | WARNING  | __main__:train_test_fisher:733 - No best model found. Using the last trained model.
2024-09-01 00:53:47.169 | INFO     | __main__:train_test_fisher:739 - Testing...
2024-09-01 00:53:47.171 | INFO     | retrieval.main:run_cli:55 - PID: 1430035
[rank: 0] Seed set to 3407
2024-09-01 00:53:47.452 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
2024-09-01 00:53:47.452 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl
2024-09-01 00:53:48.073 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-01 00:54:25,277] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-01 00:54:25,277] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-01 00:54:25,278] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-01 00:54:29.262 | INFO     | __main__:main:1211 - Running progressive training
2024-09-01 00:54:29.262 | INFO     | __main__:main:1211 - Running progressive training
2024-09-01 00:54:29.262 | INFO     | __main__:main:1211 - Running progressive training
2024-09-01 00:54:29.262 | INFO     | __main__:main:1217 - Configuring LeanDojo...
2024-09-01 00:54:29.262 | INFO     | __main__:main:1217 - Configuring LeanDojo...
2024-09-01 00:54:29.262 | INFO     | __main__:main:1217 - Configuring LeanDojo...
2024-09-01 00:54:29.266 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:54:29.266 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:54:29.266 | INFO     | __main__:main:1219 - LeanDojo configured
2024-09-01 00:54:29.266 | INFO     | __main__:main:1219 - LeanDojo configured
2024-09-01 00:54:29.266 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:54:29.267 | INFO     | __main__:main:1219 - LeanDojo configured
2024-09-01 00:54:30.695 | INFO     | __main__:search_github_repositories:373 - Processing leanprover/lean4
2024-09-01 00:54:30.695 | INFO     | __main__:search_github_repositories:391 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 00:54:30.695 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 00:54:30.781 | INFO     | __main__:search_github_repositories:373 - Processing leanprover/lean4
2024-09-01 00:54:30.782 | INFO     | __main__:search_github_repositories:391 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 00:54:30.782 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 00:54:31.037 | INFO     | __main__:search_github_repositories:373 - Processing leanprover/lean4
2024-09-01 00:54:31.037 | INFO     | __main__:search_github_repositories:391 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 00:54:31.037 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 00:54:31.648 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:54:31.648 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:54:31.742 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:54:32.686 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:54:32.687 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:54:32.782 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying...
2024-09-01 00:54:34.725 | INFO     | __main__:search_github_repositories:389 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 00:54:34.726 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 00:54:34.727 | INFO     | __main__:search_github_repositories:389 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 00:54:34.728 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 00:54:34.822 | INFO     | __main__:search_github_repositories:389 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 00:54:34.823 | INFO     | __main__:search_github_repositories:373 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 00:54:35.644 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 00:54:35.644 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 00:54:35.644 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 00:54:50.847 | INFO     | __main__:search_github_repositories:373 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 00:54:50.911 | INFO     | __main__:search_github_repositories:373 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 00:54:51.103 | INFO     | __main__:search_github_repositories:373 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 00:54:51.566 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:54:51.566 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:54:51.645 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:54:52.605 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:54:52.606 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:54:52.685 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 00:54:54.645 | INFO     | __main__:search_github_repositories:389 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 00:54:54.646 | INFO     | __main__:search_github_repositories:389 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 00:54:54.646 | INFO     | __main__:search_github_repositories:373 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 00:54:54.647 | INFO     | __main__:search_github_repositories:373 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 00:54:54.725 | INFO     | __main__:search_github_repositories:389 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 00:54:54.726 | INFO     | __main__:search_github_repositories:373 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 00:54:55.389 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:54:55.389 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:54:55.390 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:54:56.429 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:54:56.429 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:54:56.429 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 00:54:58.469 | INFO     | __main__:search_github_repositories:389 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 00:54:58.470 | INFO     | __main__:search_github_repositories:389 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 00:54:58.470 | INFO     | __main__:search_github_repositories:389 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 00:54:58.470 | INFO     | __main__:search_github_repositories:373 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 00:54:58.470 | INFO     | __main__:search_github_repositories:373 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 00:54:58.471 | INFO     | __main__:search_github_repositories:373 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 00:54:59.121 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:54:59.122 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:54:59.122 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:55:00.161 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:55:00.161 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:55:00.162 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 00:55:02.201 | INFO     | __main__:search_github_repositories:389 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 00:55:02.201 | INFO     | __main__:search_github_repositories:389 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 00:55:02.202 | INFO     | __main__:search_github_repositories:389 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 00:55:02.202 | INFO     | __main__:search_github_repositories:373 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 00:55:02.202 | INFO     | __main__:search_github_repositories:373 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 00:55:02.203 | INFO     | __main__:search_github_repositories:373 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 00:55:02.878 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:55:02.878 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:55:02.879 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:55:03.918 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:55:03.918 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:55:03.918 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 00:55:05.958 | INFO     | __main__:search_github_repositories:389 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 00:55:05.958 | INFO     | __main__:search_github_repositories:389 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 00:55:05.958 | INFO     | __main__:search_github_repositories:389 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 00:55:05.958 | INFO     | __main__:search_github_repositories:373 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 00:55:05.959 | INFO     | __main__:search_github_repositories:373 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 00:55:05.959 | INFO     | __main__:search_github_repositories:373 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 00:55:06.714 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:55:06.714 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:55:06.716 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:55:07.753 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:55:07.754 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:55:07.755 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain failed. Retrying...
2024-09-01 00:55:09.793 | INFO     | __main__:search_github_repositories:389 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 00:55:09.793 | INFO     | __main__:search_github_repositories:389 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 00:55:09.794 | INFO     | __main__:search_github_repositories:373 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 00:55:09.794 | INFO     | __main__:search_github_repositories:373 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 00:55:09.794 | INFO     | __main__:search_github_repositories:389 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 00:55:09.795 | INFO     | __main__:search_github_repositories:373 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 00:55:10.441 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-01 00:55:10.441 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-01 00:55:10.442 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 00:55:25.441 | INFO     | __main__:retrieve_proof:1026 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:55:25.441 | INFO     | __main__:retrieve_proof:1042 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:55:25.441 | INFO     | __main__:retrieve_proof:1043 - Lean version: v4.8.0
2024-09-01 00:55:25.638 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 00:55:25.892 | INFO     | __main__:retrieve_proof:1026 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:55:25.893 | INFO     | __main__:retrieve_proof:1042 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:55:25.893 | INFO     | __main__:retrieve_proof:1043 - Lean version: v4.8.0
2024-09-01 00:55:25.931 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 00:55:25.934 | INFO     | __main__:retrieve_proof:1026 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:55:25.935 | INFO     | __main__:retrieve_proof:1042 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 00:55:25.935 | INFO     | __main__:retrieve_proof:1043 - Lean version: v4.8.0
2024-09-01 00:55:25.972 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-01 00:55:40.671 | INFO     | __main__:retrieve_proof:1048 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:55:40.671 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:55:40.671 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 00:55:40.672 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 00:55:40.672 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 00:55:40.672 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:40.672 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:40.672 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:40.673 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:40.673 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:40.673 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:40.732 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 00:55:40.733 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 00:55:40.733 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 00:55:40.740 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:55:40.740 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 00:55:40.740 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 00:55:40.743 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 00:55:40.743 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4
2024-09-01 00:55:41.221 | INFO     | __main__:retrieve_proof:1048 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:55:41.221 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:55:41.221 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 00:55:41.221 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 00:55:41.221 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 00:55:41.221 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.222 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.222 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.222 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.222 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.222 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.274 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 00:55:41.274 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 00:55:41.274 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 00:55:41.279 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:55:41.279 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 00:55:41.279 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 00:55:41.281 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 00:55:41.281 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4
2024-09-01 00:55:41.301 | INFO     | __main__:retrieve_proof:1048 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:55:41.301 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 00:55:41.301 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 00:55:41.301 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 00:55:41.301 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 00:55:41.301 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.302 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.302 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.302 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.302 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.302 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 00:55:41.350 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 00:55:41.350 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 00:55:41.350 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 00:55:41.355 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 00:55:41.355 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 00:55:41.355 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 00:55:41.357 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 00:55:41.357 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4
2024-09-01 00:55:43.611 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb
1310/mathlib4 with 31 workers
  0%|                                                                                                                                                                                   | 1/5514 [00:00<52:49,  1.74it/s]2024-09-01 00:55:44.274 | D
EBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 worke
rs
  0%|▏                                                                                                                                                                                  | 6/5514 [00:00<08:21, 10.98it/s]2024-09-01 00:55:44.388 | D
EBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 worke
rs
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [16:42<00:00,  5.50it/s]
2024-09-01 01:12:26.851 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 5279/5514 [16:43<00:43,  5.42it/s]2024-09-01 01:12:28.243 | D
EBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [16:48<00:00,  5.47it/s]
2024-09-01 01:12:31.977 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 5403/5514 [16:48<00:02, 39.08it/s]2024-09-01 01:12:33.214 | D
EBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [16:52<00:00,  5.45it/s]
2024-09-01 01:12:36.906 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 01:12:38.127 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-01 01:12:44.526 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 01:12:49.577 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 01:12:54.540 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 01:13:00.549 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 01:13:05.533 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 01:13:10.241 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 01:13:16.371 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 01:13:17.488 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 01:13:20.127 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 01:13:20.738 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 01:13:21.380 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 01:13:22.498 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 01:13:25.061 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 01:13:25.510 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 01:13:26.006 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 01:13:27.126 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 01:13:29.702 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 01:13:30.044 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 01:13:30.180 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 01:13:30.487 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 01:13:35.056 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 01:13:35.466 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 01:13:39.632 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 01:13:40.055 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 01:13:45.638 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 01:13:46.740 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 01:13:50.852 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 01:13:51.762 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 01:13:55.629 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 01:13:56.552 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 01:14:01.842 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 01:14:02.696 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 01:14:03.423 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 01:14:07.428 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 01:14:08.228 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 01:14:08.665 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 01:14:12.211 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 01:14:13.004 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 01:14:13.483 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 01:14:19.196 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 01:14:19.855 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe')
2024-09-01 01:14:20.430 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-09-01 01:14:24.359 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 01:14:24.828 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe')
2024-09-01 01:14:25.259 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-09-01 01:14:29.259 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 01:14:29.736 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe')
2024-09-01 01:14:30.146 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 01:14:37.436 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 01:14:38.802 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupported Lean version: fbb3055f82f
f9a4bc82f6722f6e73225617342fd
2024-09-01 01:14:38.802 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf10839227bbb9e8492be2d')
2024-09-01 01:14:39.009 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e350841ce65a1ec42c')
2024-09-01 01:14:39.182 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c1066493c3f5dc51c9713e')
2024-09-01 01:14:39.554 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 01:14:39.966 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0')
2024-09-01 01:14:40.219 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 01:14:42.336 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 01:14:43.916 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupported Lean version: fbb3055f82f
f9a4bc82f6722f6e73225617342fd
2024-09-01 01:14:43.916 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf10839227bbb9e8492be2d')
2024-09-01 01:14:43.961 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e350841ce65a1ec42c')
2024-09-01 01:14:44.007 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c1066493c3f5dc51c9713e')
2024-09-01 01:14:44.091 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 01:14:44.176 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0')
2024-09-01 01:14:44.219 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 01:14:47.132 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 01:14:48.751 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupported Lean version: fbb3055f82f
f9a4bc82f6722f6e73225617342fd
2024-09-01 01:14:48.752 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf10839227bbb9e8492be2d')
2024-09-01 01:14:48.797 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e350841ce65a1ec42c')
2024-09-01 01:14:48.839 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c1066493c3f5dc51c9713e')
2024-09-01 01:14:48.930 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 01:14:49.023 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0')
2024-09-01 01:14:49.067 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')
2024-09-01 01:15:15.280 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306b
eb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='021e272cb5cdcc
82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad
7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', c
ommit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', comm
it='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/Bi
btexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean
_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 01:15:18.759 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306b
eb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='021e272cb5cdcc
82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad
7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', c
ommit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', comm
it='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/Bi
btexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean
_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 01:15:26.371 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306b
eb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='021e272cb5cdcc
82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad
7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', c
ommit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', comm
it='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/Bi
btexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean
_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 01:16:11.961 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 01:16:11.962 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 01:16:11.962 | INFO     | __main__:retrieve_proof:1056 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:16:12.127 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 01:16:12.127 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 01:16:12.128 | INFO     | __main__:retrieve_proof:1056 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:16:15.967 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 01:16:15.968 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 01:16:15.968 | INFO     | __main__:retrieve_proof:1056 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:16:29.632 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:16:29.633 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 33433.13it/s]
2024-09-01 01:16:30.257 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:16:30.257 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 32534.30it/s]
2024-09-01 01:16:33.523 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:16:33.523 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 33902.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [02:05<00:00, 929.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 32419.62it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [02:05<00:00, 929.39it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 33545.01it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▋                                                                                   | 59636/116251 [02:03<00:20, 2781.96it/s]2024-09-01 01:18:41.025 | I
NFO     | __main__:retrieve_proof:1094 - Before adding new repo:
2024-09-01 01:18:41.025 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 01:18:41.025 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:18:41.025 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:18:41.026 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the database.
2024-09-01 01:18:41.026 | INFO     | __main__:retrieve_proof:1097 - After adding new repo:
2024-09-01 01:18:41.026 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 01:18:41.026 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
 73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                             | 84924/116251 [02:03<00:01, 19662.97it/s]2024-09-01 01:18:41.854 | I
NFO     | __main__:retrieve_proof:1094 - Before adding new repo:
2024-09-01 01:18:41.854 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 01:18:41.854 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:18:41.854 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:18:41.855 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the database.
2024-09-01 01:18:41.855 | INFO     | __main__:retrieve_proof:1097 - After adding new repo:
2024-09-01 01:18:41.855 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 01:18:41.855 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [02:04<00:00, 930.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 33155.42it/s]
2024-09-01 01:18:44.743 | INFO     | __main__:retrieve_proof:1094 - Before adding new repo:
2024-09-01 01:18:44.743 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 01:18:44.743 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:18:44.743 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:18:44.743 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the database.
2024-09-01 01:18:44.743 | INFO     | __main__:retrieve_proof:1097 - After adding new repo:
2024-09-01 01:18:44.744 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 01:18:44.744 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:19:04.316 | INFO     | __main__:retrieve_proof:1106 - Adding repo to repos_for_merged_dataset
2024-09-01 01:19:04.316 | INFO     | __main__:retrieve_proof:1106 - Adding repo to repos_for_merged_dataset
2024-09-01 01:19:04.319 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 01:19:04.319 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 01:19:04.320 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:19:04.320 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:19:06.412 | INFO     | __main__:retrieve_proof:1106 - Adding repo to repos_for_merged_dataset
2024-09-01 01:19:06.417 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 01:19:06.417 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 01:22:40.883 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Removing it now.
2024-09-01 01:22:41.428 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Removing it now.
2024-09-01 01:22:46.874 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Removing it now.
2024-09-01 01:23:36.978 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:23:36.979 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.329 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.337 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.352 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.356 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.360 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.364 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:24:01.392 | INFO     | __main__:find_latest_checkpoint:456 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epo
ch=0-Recall@10_val=58.95.ckpt
2024-09-01 01:24:01.392 | INFO     | __main__:retrieve_proof:1118 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall
@10_val=58.95.ckpt
2024-09-01 01:24:01.393 | INFO     | __main__:train_test_fisher:596 - Inside train_test_fisher
2024-09-01 01:24:01.393 | INFO     | __main__:train_test_fisher:597 - Starting training at epoch 0
[rank: 1] Seed set to 3407
2024-09-01 01:24:01.403 | INFO     | __main__:find_latest_checkpoint:456 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epo
ch=0-Recall@10_val=58.95.ckpt
2024-09-01 01:24:01.403 | INFO     | __main__:retrieve_proof:1118 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall
@10_val=58.95.ckpt
2024-09-01 01:24:01.403 | INFO     | __main__:train_test_fisher:596 - Inside train_test_fisher
2024-09-01 01:24:01.403 | INFO     | __main__:train_test_fisher:597 - Starting training at epoch 0
[rank: 3] Seed set to 3407
2024-09-01 01:24:17.431 | INFO     | __main__:main:1252 - An error occurred: Timed out after 1801 seconds waiting for clients. 1/4 clients joined.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1232, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1124, in retrieve_proof
    train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 751, in train_test_fisher
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    self.strategy.setup_environment()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
    self.setup_distributed()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
    return TCPStore(
torch.distributed.DistStoreError: Timed out after 1801 seconds waiting for clients. 1/4 clients joined.
2024-09-01 01:24:27.372 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:25:09.737 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:25:09.769 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:25:09.778 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 01:25:09.820 | INFO     | __main__:find_latest_checkpoint:456 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epo
ch=0-Recall@10_val=58.95.ckpt
2024-09-01 01:25:09.820 | INFO     | __main__:retrieve_proof:1118 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall
@10_val=58.95.ckpt
2024-09-01 01:25:09.820 | INFO     | __main__:train_test_fisher:596 - Inside train_test_fisher
2024-09-01 01:25:09.820 | INFO     | __main__:train_test_fisher:597 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
^Z
[7]+  Stopped                 python main.py
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ nvidia-smi
Sun Sep  1 03:07:59 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   40C    P0             96W /  400W |   28560MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   36C    P0             83W /  400W |     913MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   36C    P0             84W /  400W |     625MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   37C    P0             84W /  400W |     769MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A   1209465      C   python                                       5332MiB |
|    0   N/A  N/A   1223620      C   ...miniconda3/envs/ReProver/bin/python       2220MiB |
|    0   N/A  N/A   1223621      C   ...miniconda3/envs/ReProver/bin/python       2220MiB |
|    0   N/A  N/A   1223622      C   ...miniconda3/envs/ReProver/bin/python       2220MiB |
|    0   N/A  N/A   1248488      C   python                                       4024MiB |
|    0   N/A  N/A   1275469      C   python                                       4024MiB |
|    0   N/A  N/A   1430035      C   python                                       2220MiB |
|    0   N/A  N/A   1445585      C   ...miniconda3/envs/ReProver/bin/python       3132MiB |
|    0   N/A  N/A   1445587      C   ...miniconda3/envs/ReProver/bin/python       3132MiB |
|    1   N/A  N/A   1223620      C   ...miniconda3/envs/ReProver/bin/python        618MiB |
|    2   N/A  N/A   1223621      C   ...miniconda3/envs/ReProver/bin/python        618MiB |
|    3   N/A  N/A   1223622      C   ...miniconda3/envs/ReProver/bin/python        618MiB |
+-----------------------------------------------------------------------------------------+
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python distributed_test.py --timeout 30 --num_gpus 4
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 30 --num_gpus 4 ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 30 --num_gpus 4 ...
You are using a CUDA device ('NVIDIA A100-SXM4-80GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read
 https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name  | Type   | Params
---------------------------------
0 | layer | Linear | 2
---------------------------------
2         Trainable params
0         Non-trainable params
2         Total params
0.000     Total estimated model params size (MB)
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (3) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_ever
y_n_steps if you want to see logs for the training epoch.
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  8.23it/s, v_num=12]
`Trainer.fit` stopped: `max_epochs=1` reached.
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.84it/s, v_num=12]
[rank0]:[W901 03:09:49.335566434 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any
 pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only bee
n added since PyTorch 2.4 (function operator())
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python distributed_test.py --timeout 2 --num_gpus 4
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 2 --num_gpus 4 ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 2 --num_gpus 4 ...
You are using a CUDA device ('NVIDIA A100-SXM4-80GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read
 https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 58, in <module>
    main(args)
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 50, in main
    trainer.fit(model, train_loader)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    self.strategy.setup_environment()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
    self.setup_distributed()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
    return TCPStore(
torch.distributed.DistStoreError: Timed out after 3 seconds waiting for clients. 1/4 clients joined.
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
[E901 03:10:09.665466823 socket.cpp:957] [c10d] The client socket has timed out after 2s while trying to connect to (127.0.0.1, 42733).
[E901 03:10:09.666354495 socket.cpp:957] [c10d] The client socket has timed out after 2s while trying to connect to (127.0.0.1, 42733).
[E901 03:10:09.666372206 socket.cpp:957] [c10d] The client socket has timed out after 2s while trying to connect to (127.0.0.1, 42733).
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 58, in <module>
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 58, in <module>
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 58, in <module>
    # Set up DDPStrategy with NCCL backend
    # Set up DDPStrategy with NCCL backend
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 50, in main
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 50, in main
    # Set up DDPStrategy with NCCL backend
  File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 50, in main
    train_loader = DataLoader(train_data, batch_size=10)
    train_loader = DataLoader(train_data, batch_size=10)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    train_loader = DataLoader(train_data, batch_size=10)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    self.strategy.setup_environment()
    self.strategy.setup_environment()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
    self.strategy.setup_environment()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
    self.setup_distributed()
    self.setup_distributed()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
    self.setup_distributed()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    func_return = func(*args, **kwargs)
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
    return TCPStore(
    return TCPStore(
torch.distributed.DistNetworkError: The client socket has timed out after 2s while trying to connect to (127.0.0.1, 42733).
torch.distributed.DistNetworkError: The client socket has timed out after 2s while trying to connect to (127.0.0.1, 42733).
    return TCPStore(
torch.distributed.DistNetworkError: The client socket has timed out after 2s while trying to connect to (127.0.0.1, 42733).
^C
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python distributed_test.py --timeout 30 --num_gpus 4
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 30 --num_gpus 4 ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 30 --num_gpus 4 ...
You are using a CUDA device ('NVIDIA A100-SXM4-80GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read
 https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name  | Type   | Params
---------------------------------
0 | layer | Linear | 2
---------------------------------
2         Trainable params
0         Non-trainable params
2         Total params
0.000     Total estimated model params size (MB)
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (3) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_ever
y_n_steps if you want to see logs for the training epoch.
Epoch 0:   0%|                                                                                                                                                                                                                | 0/3 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 82, in <module>
[rank0]:     main(args)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 74, in main
[rank0]:     trainer.fit(model, train_loader)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank0]:     call._call_and_handle_interrupt(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank0]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank0]:     return function(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank0]:     self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank0]:     results = self._run_stage()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank0]:     self.fit_loop.run()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank0]:     self.advance()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank0]:     self.epoch_loop.run(self._data_fetcher)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank0]:     self.advance(data_fetcher)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank0]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank0]:     self._optimizer_step(batch_idx, closure)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank0]:     call._call_lightning_module_hook(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank0]:     optimizer.step(closure=optimizer_closure)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank0]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank0]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank0]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank0]:     return optimizer.step(closure=closure, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank0]:     out = func(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank0]:     ret = func(self, *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank0]:     loss = closure()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank0]:     closure_result = closure()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank0]:     self._result = self.closure(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank0]:     step_output = self._step_fn()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank0]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank0]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank0]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank0]:     out = method(*_args, **_kwargs)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 36, in training_step
[rank0]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 14, in monitored_gloo_barrier
[rank0]:     dist.init_process_group('gloo')
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
[rank0]:     func_return = func(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
[rank0]:     store, rank, world_size = next(rendezvous_iterator)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 246, in _env_rendezvous_handler
[rank0]:     rank = int(_get_env_or_raise("RANK"))
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 231, in _get_env_or_raise
[rank0]:     raise _env_error(env_var)
[rank0]: ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
[rank3]: Traceback (most recent call last):
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 82, in <module>
[rank3]:     main(args)
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 74, in main
[rank3]:     trainer.fit(model, train_loader)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank3]:     call._call_and_handle_interrupt(
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank3]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank3]:     return function(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank3]:     self._run(model, ckpt_path=ckpt_path)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank3]:     results = self._run_stage()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank3]:     self.fit_loop.run()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank3]:     self.advance()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank3]:     self.epoch_loop.run(self._data_fetcher)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank3]:     self.advance(data_fetcher)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank3]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank3]:     self._optimizer_step(batch_idx, closure)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank3]:     call._call_lightning_module_hook(
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank3]:     output = fn(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank3]:     optimizer.step(closure=optimizer_closure)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank3]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank3]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank3]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank3]:     return optimizer.step(closure=closure, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank3]:     out = func(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank3]:     ret = func(self, *args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank3]:     loss = closure()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank3]:     closure_result = closure()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank3]:     self._result = self.closure(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank3]:     return func(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank3]:     step_output = self._step_fn()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank3]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank3]:     output = fn(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank3]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank3]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank3]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank3]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank3]:     out = method(*_args, **_kwargs)
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 36, in training_step
[rank3]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 14, in monitored_gloo_barrier
[rank3]:     dist.init_process_group('gloo')
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
[rank3]:     return func(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
[rank3]:     func_return = func(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
[rank3]:     store, rank, world_size = next(rendezvous_iterator)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 246, in _env_rendezvous_handler
[rank3]:     rank = int(_get_env_or_raise("RANK"))
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 231, in _get_env_or_raise
[rank3]:     raise _env_error(env_var)
[rank3]: ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
[rank2]: Traceback (most recent call last):
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 82, in <module>
[rank2]:     main(args)
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 74, in main
[rank2]:     trainer.fit(model, train_loader)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank2]:     call._call_and_handle_interrupt(
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank2]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank2]:     return function(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank2]:     self._run(model, ckpt_path=ckpt_path)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank2]:     results = self._run_stage()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank2]:     self.fit_loop.run()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank2]:     self.advance()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank2]:     self.epoch_loop.run(self._data_fetcher)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank2]:     self.advance(data_fetcher)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank2]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank2]:     self._optimizer_step(batch_idx, closure)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank2]:     call._call_lightning_module_hook(
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank2]:     output = fn(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank2]:     optimizer.step(closure=optimizer_closure)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank2]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank2]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank2]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank2]:     return optimizer.step(closure=closure, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank2]:     out = func(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank2]:     ret = func(self, *args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank2]:     loss = closure()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank2]:     closure_result = closure()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank2]:     self._result = self.closure(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank2]:     step_output = self._step_fn()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank2]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank2]:     output = fn(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank2]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank2]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank2]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank2]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank2]:     out = method(*_args, **_kwargs)
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 36, in training_step
[rank2]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 14, in monitored_gloo_barrier
[rank2]:     dist.init_process_group('gloo')
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
[rank2]:     return func(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
[rank2]:     func_return = func(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
[rank2]:     store, rank, world_size = next(rendezvous_iterator)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 246, in _env_rendezvous_handler
[rank2]:     rank = int(_get_env_or_raise("RANK"))
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 231, in _get_env_or_raise
[rank2]:     raise _env_error(env_var)
[rank2]: ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
[rank1]: Traceback (most recent call last):
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 82, in <module>
[rank1]:     main(args)
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 74, in main
[rank1]:     trainer.fit(model, train_loader)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank1]:     call._call_and_handle_interrupt(
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank1]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank1]:     return function(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank1]:     self._run(model, ckpt_path=ckpt_path)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank1]:     results = self._run_stage()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank1]:     self.fit_loop.run()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank1]:     self.advance()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank1]:     self.epoch_loop.run(self._data_fetcher)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank1]:     self.advance(data_fetcher)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank1]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank1]:     self._optimizer_step(batch_idx, closure)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank1]:     call._call_lightning_module_hook(
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank1]:     optimizer.step(closure=optimizer_closure)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank1]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank1]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank1]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank1]:     return optimizer.step(closure=closure, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank1]:     out = func(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank1]:     ret = func(self, *args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank1]:     loss = closure()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank1]:     closure_result = closure()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank1]:     self._result = self.closure(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank1]:     step_output = self._step_fn()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank1]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank1]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank1]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank1]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank1]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank1]:     out = method(*_args, **_kwargs)
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 36, in training_step
[rank1]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 14, in monitored_gloo_barrier
[rank1]:     dist.init_process_group('gloo')
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
[rank1]:     func_return = func(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
[rank1]:     store, rank, world_size = next(rendezvous_iterator)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 246, in _env_rendezvous_handler
[rank1]:     rank = int(_get_env_or_raise("RANK"))
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 231, in _get_env_or_raise
[rank1]:     raise _env_error(env_var)
[rank1]: ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
Epoch 0:   0%|          | 0/3 [00:01<?, ?it/s]
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python distributed_test.py --timeout 30 --num_gpus 4
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 30 --num_gpus 4 ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python distributed_test.py --timeout 30 --num_gpus 4 ...
You are using a CUDA device ('NVIDIA A100-SXM4-80GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read
 https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python /data/yingzi_ma/lean_project/ReProver/distributed_te ...
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python /data/yingzi_ma/lean_project/ReProver/distributed_te ...
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python /data/yingzi_ma/lean_project/ReProver/distributed_te ...
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name  | Type   | Params
---------------------------------
0 | layer | Linear | 2
---------------------------------
2         Trainable params
0         Non-trainable params
2         Total params
0.000     Total estimated model params size (MB)
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (3) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_ever
y_n_steps if you want to see logs for the training epoch.
Epoch 0:   0%|                                                                                                                                                                                                                | 0/3 [00:00<?, ?it/s]
[rank3]: Traceback (most recent call last):
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 96, in <module>
[rank3]:     main(args)
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 88, in main
[rank3]:     trainer.fit(model, train_loader)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank3]:     call._call_and_handle_interrupt(
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank3]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank3]:     return function(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank3]:     self._run(model, ckpt_path=ckpt_path)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank3]:     results = self._run_stage()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank3]:     self.fit_loop.run()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank3]:     self.advance()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank3]:     self.epoch_loop.run(self._data_fetcher)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank3]:     self.advance(data_fetcher)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank3]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank3]:     self._optimizer_step(batch_idx, closure)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank3]:     call._call_lightning_module_hook(
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank3]:     output = fn(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank3]:     optimizer.step(closure=optimizer_closure)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank3]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank3]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank3]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank3]:     return optimizer.step(closure=closure, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank3]:     out = func(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank3]:     ret = func(self, *args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank3]:     loss = closure()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank3]:     closure_result = closure()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank3]:     self._result = self.closure(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank3]:     return func(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank3]:     step_output = self._step_fn()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank3]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank3]:     output = fn(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank3]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank3]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank3]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank3]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank3]:     out = method(*_args, **_kwargs)
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 46, in training_step
[rank3]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank3]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 22, in monitored_gloo_barrier
[rank3]:     setup_distributed_env(dist.get_world_size())
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1832, in get_world_size
[rank3]:     return _get_group_size(group)
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 864, in _get_group_size
[rank3]:     default_pg = _get_default_group()
[rank3]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
[rank3]:     raise ValueError(
[rank3]: ValueError: Default process group has not been initialized, please make sure to call init_process_group.
[rank2]: Traceback (most recent call last):
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 96, in <module>
[rank2]:     main(args)
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 88, in main
[rank2]:     trainer.fit(model, train_loader)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank2]:     call._call_and_handle_interrupt(
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank2]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank2]:     return function(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank2]:     self._run(model, ckpt_path=ckpt_path)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank2]:     results = self._run_stage()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank2]:     self.fit_loop.run()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank2]:     self.advance()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank2]:     self.epoch_loop.run(self._data_fetcher)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank2]:     self.advance(data_fetcher)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank2]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank2]:     self._optimizer_step(batch_idx, closure)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank2]:     call._call_lightning_module_hook(
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank2]:     output = fn(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank2]:     optimizer.step(closure=optimizer_closure)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank2]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank2]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank2]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank2]:     return optimizer.step(closure=closure, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank2]:     out = func(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank2]:     ret = func(self, *args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank2]:     loss = closure()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank2]:     closure_result = closure()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank2]:     self._result = self.closure(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank2]:     step_output = self._step_fn()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank2]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank2]:     output = fn(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank2]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank2]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank2]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank2]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank2]:     out = method(*_args, **_kwargs)
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 46, in training_step
[rank2]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank2]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 22, in monitored_gloo_barrier
[rank2]:     setup_distributed_env(dist.get_world_size())
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1832, in get_world_size
[rank2]:     return _get_group_size(group)
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 864, in _get_group_size
[rank2]:     default_pg = _get_default_group()
[rank2]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
[rank2]:     raise ValueError(
[rank2]: ValueError: Default process group has not been initialized, please make sure to call init_process_group.
[rank1]: Traceback (most recent call last):
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 96, in <module>
[rank1]:     main(args)
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 88, in main
[rank1]:     trainer.fit(model, train_loader)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank1]:     call._call_and_handle_interrupt(
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank1]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank1]:     return function(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank1]:     self._run(model, ckpt_path=ckpt_path)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank1]:     results = self._run_stage()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank1]:     self.fit_loop.run()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank1]:     self.advance()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank1]:     self.epoch_loop.run(self._data_fetcher)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank1]:     self.advance(data_fetcher)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank1]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank1]:     self._optimizer_step(batch_idx, closure)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank1]:     call._call_lightning_module_hook(
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank1]:     optimizer.step(closure=optimizer_closure)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank1]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank1]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank1]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank1]:     return optimizer.step(closure=closure, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank1]:     out = func(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank1]:     ret = func(self, *args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank1]:     loss = closure()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank1]:     closure_result = closure()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank1]:     self._result = self.closure(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank1]:     step_output = self._step_fn()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank1]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank1]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank1]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank1]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank1]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank1]:     out = method(*_args, **_kwargs)
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 46, in training_step
[rank1]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank1]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 22, in monitored_gloo_barrier
[rank1]:     setup_distributed_env(dist.get_world_size())
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1832, in get_world_size
[rank1]:     return _get_group_size(group)
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 864, in _get_group_size
[rank1]:     default_pg = _get_default_group()
[rank1]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
[rank1]:     raise ValueError(
[rank1]: ValueError: Default process group has not been initialized, please make sure to call init_process_group.
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 96, in <module>
[rank0]:     main(args)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 88, in main
[rank0]:     trainer.fit(model, train_loader)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
[rank0]:     call._call_and_handle_interrupt(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank0]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank0]:     return function(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
[rank0]:     self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
[rank0]:     results = self._run_stage()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
[rank0]:     self.fit_loop.run()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
[rank0]:     self.advance()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
[rank0]:     self.epoch_loop.run(self._data_fetcher)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
[rank0]:     self.advance(data_fetcher)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
[rank0]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
[rank0]:     self._optimizer_step(batch_idx, closure)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
[rank0]:     call._call_lightning_module_hook(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
[rank0]:     optimizer.step(closure=optimizer_closure)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
[rank0]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank0]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank0]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
[rank0]:     return optimizer.step(closure=closure, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 484, in wrapper
[rank0]:     out = func(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/optimizer.py", line 89, in _use_grad
[rank0]:     ret = func(self, *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/optim/sgd.py", line 112, in step
[rank0]:     loss = closure()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
[rank0]:     closure_result = closure()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
[rank0]:     self._result = self.closure(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
[rank0]:     step_output = self._step_fn()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
[rank0]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank0]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
[rank0]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
[rank0]:     out = method(*_args, **_kwargs)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 46, in training_step
[rank0]:     monitored_gloo_barrier(timeout=timedelta(seconds=30), wait_all_ranks=True)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/distributed_test.py", line 22, in monitored_gloo_barrier
[rank0]:     setup_distributed_env(dist.get_world_size())
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1832, in get_world_size
[rank0]:     return _get_group_size(group)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 864, in _get_group_size
[rank0]:     default_pg = _get_default_group()
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
[rank0]:     raise ValueError(
[rank0]: ValueError: Default process group has not been initialized, please make sure to call init_process_group.
Epoch 0:   0%|          | 0/3 [00:01<?, ?it/s]
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$
