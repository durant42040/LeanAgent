                63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                64%|██████████████████████████████████████████████████
█████████████████████████████████████████████████████████████▊                                                                | 1764/2776 [09:14<03:56,  4.28it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▏                               64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉
                                         | 1765/2776 [09:14<04:51,  3.46it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               64%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▉                               63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏
        64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                | 1767/2776 [09:14<04:11,  4.
01it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▎                                                                | 1755/2776 [09:14<05:27,  3.12it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▎                               64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████
        64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                               | 1769/2776 [09:15<05:05,  3.
29it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▍                                                                | 1757/2776 [09:15<05:31,  3.07it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                               64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▏                                                               | 1770/2776 [09:15<05:06,  3.29it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▍                               64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎
                                         | 1771/2776 [09:16<05:05,  3.29it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▌                                                                | 1759/2776 [09:15<05:27,  3.10it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▎                                                               | 1772/2776 [09:16<05:25,  3.09it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▌                               64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍
        63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                | 1761/2776 [09:16<05:47,  2.
92it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 1766/2776 [09:18<04:50,  3.48it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                               63%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▋                               64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊
        64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              64%|██████████████████████████████████████████████████████████
█████████████████████████████████████████████████████▊                                                                | 1764/2776 [09:17<03:56,  4.28it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                               64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▌                                                               | 1775/2776 [09:18<07:14,  2.30it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              64%|█████████████████████████████████████████████████████████████████
██████████████████████████████████████████████▉                                                                | 1765/2776 [09:17<04:54,  3.44it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▏                              64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████
        64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 1776/2776 [09:18<07:47,  2.
14it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▋                              64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋
                                         | 1778/2776 [09:18<05:21,  3.11it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████                               64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊
        64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              64%|██████████████████████████████████████████████████████████
██████████████████████████████████████████████████████▏                                                               | 1769/2776 [09:18<05:07,  3.28it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▏                              64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉
        64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                               | 1771/2776 [09:19<05:06,  3.
28it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▉                              64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎
                                         | 1772/2776 [09:19<05:26,  3.07it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              64%|█████████████████████████████████████████████████████████████████
████████████████████████████████████████████████                              64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍
                                         | 1773/2776 [09:20<06:33,  2.55it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 1776/2776 [09:21<07:49,  2.13it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                              64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▍                              64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████
                                         | 1784/2776 [09:21<07:23,  2.24it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 1778/2776 [09:22<05:22,  3.09it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                               | 1779/2776 [09:22<04:33,  3.65it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              64%|█████████████████████████████████████████████████████████████████
███████████████████████████████████████████████▌                              64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏
                                         | 1785/2776 [100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
██████████████████| 2776/2776 [16:07<00:00,  2.87it/s]
2024-09-01 02:49:53.388 | INFO     | retrieval.model:reindex_corpus:328 - End of reindex_corpus█████████████████████████████████████████████████████████████████████████████████████▎| 2766/2776 [16:07<00:03,  2.76it/s]
2024-09-01 02:49:53.388 | INFO     | retrieval.model:reindex_corpus:329 - Embeddings staled end of reindex corpus: False
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2776/2776 [16:12<00:00,  2.85it/s]
2024-09-01 02:49:57.941 | INFO     | retrieval.model:reindex_corpus:328 - End of reindex_corpus██████████████████████████████████████████████████████████████████████████████████████| 2776/2776 [16:12<00:00,  1.91it/s]
2024-09-01 02:49:57.941 | INFO     | retrieval.model:reindex_corpus:329 - Embeddings staled end of reindex corpus: False
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2776/2776 [16:12<00:00,  2.85it/s]
    | 0/22 [00:00<?, ?it/s]
2024-09-01 02:49:58.225 | INFO     | retrieval.model:reindex_corpus:328 - End of reindex_corpus
2024-09-01 02:49:58.225 | INFO     | retrieval.model:reindex_corpus:329 - Embeddings staled end of reindex corpus: False
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2776/2776 [16:12<00:00,  2.85it/s]
2024-09-01 02:49:59.198 | INFO     | retrieval.model:reindex_corpus:328 - End of reindex_corpus
2024-09-01 02:49:59.198 | INFO     | retrieval.model:reindex_corpus:329 - Embeddings staled end of reindex corpus: False
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 22/
22 [01:26<00:00,  0.25it/s]2024-09-01 02:51:24.469 | INFO     | retrieval.model:on_predict_epoch_end:531 - About to construct predictions map
2024-09-01 02:51:24.470 | INFO     | retrieval.model:on_predict_epoch_end:531 - About to construct predictions map
2024-09-01 02:51:24.470 | INFO     | retrieval.model:on_predict_epoch_end:531 - About to construct predictions map
2024-09-01 02:51:24.470 | INFO     | retrieval.model:on_predict_epoch_end:531 - About to construct predictions map
2024-09-01 02:51:24.667 | INFO     | retrieval.model:on_predict_epoch_end:551 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-01 02:51:24.667 | INFO     | retrieval.model:on_predict_epoch_end:551 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-01 02:51:24.729 | INFO     | retrieval.model:on_predict_epoch_end:551 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-01 02:51:24.738 | INFO     | retrieval.model:on_predict_epoch_end:551 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-01 02:51:24.738 | INFO     | retrieval.model:on_predict_epoch_end:593 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 22/
22 [01:26<00:00,  0.25it/s]
2024-09-01 02:51:27.548 | INFO     | retrieval.main:run_cli:59 - Configuration:

2024-09-01 02:51:27.553 | INFO     | retrieval.main:run_cli:59 - Configuration:

2024-09-01 02:51:27.680 | INFO     | retrieval.main:run_cli:59 - Configuration:

2024-09-01 02:51:27.719 | INFO     | retrieval.main:run_cli:59 - Configuration:

2024-09-01 02:51:28.149 | INFO     | __main__:train_test_fisher:745 - Loaded the predictions pickle files
2024-09-01 02:51:28.153 | INFO     | __main__:train_test_fisher:745 - Loaded the predictions pickle files
2024-09-01 02:51:28.223 | INFO     | __main__:train_test_fisher:748 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/
test.json
  0%|
  | 0/2421 [00:00<?, ?it/s]2024-09-01 02:51:28.225 | INFO     | __main__:train_test_fisher:748 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bce
cc7c0fe19306beb1310/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421
[00:00<00:00, 29595.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421
[00:00<00:00, 29885.07it/s]
2024-09-01 02:51:28.306 | INFO     | __main__:train_test_fisher:750 - R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.307 | INFO     | __main__:train_test_fisher:750 - R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.307 | INFO     | __main__:train_test_fisher:745 - Loaded the predictions pickle files
2024-09-01 02:51:28.308 | INFO     | __main__:train_test_fisher:762 - Average R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.309 | INFO     | __main__:train_test_fisher:762 - Average R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.375 | INFO     | __main__:train_test_fisher:748 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/
test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421
[00:00<00:00, 29638.83it/s]
2024-09-01 02:51:28.457 | INFO     | __main__:train_test_fisher:750 - R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.459 | INFO     | __main__:train_test_fisher:762 - Average R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.468 | INFO     | prover.proof_search:find_latest_checkpoint:308 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240
a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:51:28.468 | INFO     | prover.proof_search:find_latest_checkpoint:308 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240
a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:51:28.530 | INFO     | __main__:train_test_fisher:745 - Loaded the predictions pickle files
2024-09-01 02:51:28.617 | INFO     | prover.proof_search:find_latest_checkpoint:308 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240
a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:51:28.631 | INFO     | __main__:train_test_fisher:748 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random/
test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421
[00:00<00:00, 22828.13it/s]
2024-09-01 02:51:28.738 | INFO     | __main__:train_test_fisher:750 - R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.740 | INFO     | __main__:train_test_fisher:762 - Average R@1 = 22.812892272364884 %, R@10 = 62.34675584265411 %, MRR = 0.5130105194232376
2024-09-01 02:51:28.929 | INFO     | prover.proof_search:find_latest_checkpoint:308 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240
a427bcecc7c0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-ret
riever-tacgen-byt5-small/model_lightning.ckpt`
2024-09-01 02:51:59.753 | INFO     | generator.model:__init__:109 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:51:59.753 | INFO     | generator.model:__init__:123 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-ret
riever-tacgen-byt5-small/model_lightning.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-ret
riever-tacgen-byt5-small/model_lightning.ckpt`
2024-09-01 02:52:00.527 | INFO     | generator.model:__init__:109 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:52:00.527 | INFO     | generator.model:__init__:123 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:52:00.527 | INFO     | generator.model:__init__:109 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:52:00.527 | INFO     | generator.model:__init__:123 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-ret
riever-tacgen-byt5-small/model_lightning.ckpt`
2024-09-01 02:52:00.558 | INFO     | generator.model:__init__:109 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 02:52:00.559 | INFO     | generator.model:__init__:123 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
tokenizer_config.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25.6k/2
5.6k [00:00<00:00, 108MB/s]
added_tokens.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3.02k/3.
02k [00:00<00:00, 19.3MB/s]
special_tokens_map.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3.09k/3.
09k [00:00<00:00, 24.9MB/s]
config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 837/
837 [00:00<00:00, 4.89MB/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py:991: UserWarning: Not enough free disk space to download the file. The expected file size is: 1198.57 MB. The targ
et location /data/yingzi_ma/.cache/huggingface/hub/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/blobs only has 1121.79 MB free disk space.
  warnings.warn(
model.safetensors: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1.20G/1.
20G [00:25<00:00, 46.8MB/s]
Could not set the permissions on the file '/data/yingzi_ma/.cache/huggingface/hub/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/blobs/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.incom
plete'. Error: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/blobs/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db
944.incomplete'.
Continuing without setting permissions.
2024-09-01 02:52:33.384 | INFO     | __main__:main:1232 - An error occurred: [Errno 28] No space left on device: '../../blobs/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944' -> '/data/yingzi_ma/.cach
e/huggingface/hub/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/snapshots/ecace32f4ff71b460a04888b9e9ab81a3e6db5e4/model.safetensors'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1212, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1118, in retrieve_proof
    prover = DistributedProver(
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 364, in __init__
    tac_gen = RetrievalAugmentedGenerator.load(
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 142, in load
    return load_checkpoint(cls, ckpt_path, device, freeze, config)
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 482, in load_checkpoint
    model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1581, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 91, in _load_from_checkpoint
    model = _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 158, in _load_state
    obj = cls(**_cls_kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 129, in __init__
    self.generator = T5ForConditionalGeneration.from_pretrained(model_name)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3550, in from_pretrained
    resolved_archive_file = cached_file(pretrained_model_name_or_path, filename, **cached_file_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/utils/hub.py", line 402, in cached_file
    resolved_file = hf_hub_download(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1240, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1399, in _hf_hub_download_to_cache_dir
    _create_symlink(blob_path, pointer_path, new_blob=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 924, in _create_symlink
    os.symlink(src_rel_or_abs, abs_dst)
OSError: [Errno 28] No space left on device: '../../blobs/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944' -> '/data/yingzi_ma/.cache/huggingface/hub/models--kaiyuy--leandojo-lean4-retriever-tacgen-by
t5-small/snapshots/ecace32f4ff71b460a04888b9e9ab81a3e6db5e4/model.safetensors'
2024-09-01 02:52:33.418 | INFO     | __main__:main:1232 - An error occurred: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/.locks/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-smal
l/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.lock'
2024-09-01 02:52:33.421 | INFO     | __main__:main:1232 - An error occurred: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/.locks/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-smal
l/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.lock'
2024-09-01 02:52:33.424 | INFO     | __main__:main:1232 - An error occurred: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/.locks/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-smal
l/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.lock'
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1212, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1212, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1118, in retrieve_proof
    prover = DistributedProver(
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1118, in retrieve_proof
    prover = DistributedProver(
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 364, in __init__
    tac_gen = RetrievalAugmentedGenerator.load(
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 364, in __init__
    tac_gen = RetrievalAugmentedGenerator.load(
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1212, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 142, in load
    return load_checkpoint(cls, ckpt_path, device, freeze, config)
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 142, in load
    return load_checkpoint(cls, ckpt_path, device, freeze, config)
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1118, in retrieve_proof
    prover = DistributedProver(
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 482, in load_checkpoint
    model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 482, in load_checkpoint
    model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 364, in __init__
    tac_gen = RetrievalAugmentedGenerator.load(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 142, in load
    return load_checkpoint(cls, ckpt_path, device, freeze, config)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1581, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1581, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 482, in load_checkpoint
    model = model_cls.load_from_checkpoint(ckpt_path, strict=False, **config).to(device)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 91, in _load_from_checkpoint
    model = _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 91, in _load_from_checkpoint
    model = _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 158, in _load_state
    obj = cls(**_cls_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 158, in _load_state
    obj = cls(**_cls_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1581, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 129, in __init__
    self.generator = T5ForConditionalGeneration.from_pretrained(model_name)
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 129, in __init__
    self.generator = T5ForConditionalGeneration.from_pretrained(model_name)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 91, in _load_from_checkpoint
    model = _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3550, in from_pretrained
    resolved_archive_file = cached_file(pretrained_model_name_or_path, filename, **cached_file_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3550, in from_pretrained
    resolved_archive_file = cached_file(pretrained_model_name_or_path, filename, **cached_file_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 158, in _load_state
    obj = cls(**_cls_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/utils/hub.py", line 402, in cached_file
    resolved_file = hf_hub_download(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/utils/hub.py", line 402, in cached_file
    resolved_file = hf_hub_download(
  File "/data/yingzi_ma/lean_project/ReProver/generator/model.py", line 129, in __init__
    self.generator = T5ForConditionalGeneration.from_pretrained(model_name)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3550, in from_pretrained
    resolved_archive_file = cached_file(pretrained_model_name_or_path, filename, **cached_file_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/utils/hub.py", line 402, in cached_file
    resolved_file = hf_hub_download(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1240, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1240, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1388, in _hf_hub_download_to_cache_dir
    with WeakFileLock(lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1388, in _hf_hub_download_to_cache_dir
    with WeakFileLock(lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1240, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_fixes.py", line 91, in WeakFileLock
    lock.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_fixes.py", line 91, in WeakFileLock
    lock.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1388, in _hf_hub_download_to_cache_dir
    with WeakFileLock(lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/huggingface_hub/utils/_fixes.py", line 91, in WeakFileLock
    lock.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/.locks/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.l
ock'
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/.locks/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.l
ock'
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.cache/huggingface/hub/.locks/models--kaiyuy--leandojo-lean4-retriever-tacgen-byt5-small/e7c471f38a37b27730fb665cdb1ebbf83a37572913e4186d02a85bf1924db944.l
ock'
Exception ignored in atexit callback: <function matmul_ext_update_autotune_table at 0x73a325581990>
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 473, in matmul_ext_update_autotune_table
Exception ignored in atexit callback: <function matmul_ext_update_autotune_table at 0x76c1a9b6d990>
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 473, in matmul_ext_update_autotune_table
Exception ignored in atexit callback: <function matmul_ext_update_autotune_table at 0x7b1c50765990>
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 473, in matmul_ext_update_autotune_table
    fp16_matmul._update_autotune_table()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 450, in _update_autotune_table
    fp16_matmul._update_autotune_table()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 450, in _update_autotune_table
    TritonMatmul._update_autotune_table(__class__.__name__ + "_2d_kernel", __class__._2d_kernel)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 179, in _update_autotune_table
    TritonMatmul._update_autotune_table(__class__.__name__ + "_2d_kernel", __class__._2d_kernel)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 179, in _update_autotune_table
    cache_manager.put(autotune_table)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 95, in put
    fp16_matmul._update_autotune_table()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 450, in _update_autotune_table
    cache_manager.put(autotune_table)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 95, in put
    with FileLock(self.lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 297, in __enter__
    with FileLock(self.lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 297, in __enter__
    TritonMatmul._update_autotune_table(__class__.__name__ + "_2d_kernel", __class__._2d_kernel)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 179, in _update_autotune_table
    self.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    self.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    cache_manager.put(autotune_table)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 95, in put
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.triton/autotune/Fp16Matmul_2d_kernel.pickle.lock'
    with FileLock(self.lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 297, in __enter__
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.triton/autotune/Fp16Matmul_2d_kernel.pickle.lock'
    self.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.triton/autotune/Fp16Matmul_2d_kernel.pickle.lock'
Exception ignored in atexit callback: <function matmul_ext_update_autotune_table at 0x7d53e8e61990>
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 473, in matmul_ext_update_autotune_table
    fp16_matmul._update_autotune_table()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 450, in _update_autotune_table
    TritonMatmul._update_autotune_table(__class__.__name__ + "_2d_kernel", __class__._2d_kernel)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 179, in _update_autotune_table
    cache_manager.put(autotune_table)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 95, in put
    with FileLock(self.lock_path):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 297, in __enter__
    self.acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_api.py", line 255, in acquire
    self._acquire()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/filelock/_unix.py", line 39, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/data/yingzi_ma/.triton/autotune/Fp16Matmul_2d_kernel.pickle.lock'
[rank0]:[W901 02:55:48.404752378 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_proce
ss_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint h
as always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
(ReProver) yingzi_ma@compute-permanent-node-834:~/lean_project/ReProver$ python main2.py
[2024-09-01 04:26:32,747] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-01 04:26:35.135 | INFO     | __main__:main:1232 - Running progressive training
2024-09-01 04:26:35.136 | INFO     | __main__:main:1238 - Configuring LeanDojo...
2024-09-01 04:26:35.139 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:26:35.139 | INFO     | __main__:main:1240 - LeanDojo configured
2024-09-01 04:26:37.063 | INFO     | __main__:search_github_repositories:403 - Processing leanprover/lean4
2024-09-01 04:26:37.063 | INFO     | __main__:search_github_repositories:421 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 04:26:37.063 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 04:26:38.204 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:26:39.230 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:26:41.256 | INFO     | __main__:search_github_repositories:419 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 04:26:41.257 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 04:26:42.094 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 04:26:57.374 | INFO     | __main__:search_github_repositories:403 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 04:26:58.085 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:26:59.111 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:27:01.137 | INFO     | __main__:search_github_repositories:419 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 04:27:01.137 | INFO     | __main__:search_github_repositories:403 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 04:27:01.833 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:27:02.860 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:27:04.887 | INFO     | __main__:search_github_repositories:419 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 04:27:04.888 | INFO     | __main__:search_github_repositories:403 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 04:27:05.545 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:27:06.572 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:27:08.599 | INFO     | __main__:search_github_repositories:419 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 04:27:08.600 | INFO     | __main__:search_github_repositories:403 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 04:27:09.200 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:27:10.227 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:27:12.252 | INFO     | __main__:search_github_repositories:419 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 04:27:12.253 | INFO     | __main__:search_github_repositories:403 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 04:27:12.956 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:27:13.984 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:27:16.011 | INFO     | __main__:search_github_repositories:419 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 04:27:16.012 | INFO     | __main__:search_github_repositories:403 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 04:27:16.632 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 04:27:32.093 | INFO     | __main__:retrieve_proof:1047 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:27:32.094 | INFO     | __main__:retrieve_proof:1063 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:27:32.094 | INFO     | __main__:retrieve_proof:1064 - Lean version: v4.8.0
2024-09-01 04:27:32.312 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-01 04:27:47.534 | INFO     | __main__:retrieve_proof:1069 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:27:47.534 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:27:47.534 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 04:27:47.534 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 04:27:47.534 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 04:27:47.535 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:27:47.535 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:27:47.535 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:27:47.536 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:27:47.536 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:27:47.536 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:27:47.572 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 04:27:47.572 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 04:27:47.572 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 04:27:47.578 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:27:47.578 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 04:27:47.578 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 04:27:47.581 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 04:27:47.581 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe193
06beb1310/mathlib4
2024-09-01 04:27:49.716 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e7343
8e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [11:41<00:00,  7.86it/s]
2024-09-01 04:39:30.935 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bce
cc7c0fe19306beb1310')
2024-09-01 04:39:32.171 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-01 04:39:48.827 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 04:40:04.925 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 04:40:20.786 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 04:40:21.896 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 04:40:24.474 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 04:40:24.917 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 04:40:34.396 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 04:40:34.809 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 04:40:50.272 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 04:40:51.177 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 04:41:06.506 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 04:41:07.302 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 04:41:07.774 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 04:41:23.745 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 04:41:24.184 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426
b91a0d2fe')
2024-09-01 04:41:24.583 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 04:41:41.361 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 04:41:42.963 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupporte
d Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-01 04:41:42.963 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf1
0839227bbb9e8492be2d')
2024-09-01 04:41:42.993 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e
350841ce65a1ec42c')
2024-09-01 04:41:43.022 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c10664
93c3f5dc51c9713e')
2024-09-01 04:41:43.079 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77
ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 04:41:43.138 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b67
5ef3e347d0')
2024-09-01 04:41:43.167 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4
bc3c9a45fc03cf97a0b1a0c')
2024-09-01 04:42:05.557 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73
438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/l
eanprover-community/batteries', commit='021e272cb5cdcc82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop':
LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b
6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprov
er/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='h
ttps://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c424
13cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/le
anprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 04:42:23.970 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 04:42:23.971 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 04:42:23.971 | INFO     | __main__:retrieve_proof:1077 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:42:34.198 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 04:42:34.198 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 49998.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 52028.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [01:36<00:00, 1206.86it/s]
2024-09-01 04:44:14.471 | INFO     | __main__:retrieve_proof:1115 - Before adding new repo:
2024-09-01 04:44:14.471 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 04:44:14.471 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 04:44:14.471 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 04:44:14.471 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the dat
abase.
2024-09-01 04:44:14.471 | INFO     | __main__:retrieve_proof:1118 - After adding new repo:
2024-09-01 04:44:14.471 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 04:44:14.471 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 04:44:27.794 | INFO     | __main__:retrieve_proof:1127 - Adding repo to repos_for_merged_dataset
2024-09-01 04:44:27.797 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 04:44:27.798 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 04:46:54.577 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already
 exists. Removing it now.
2024-09-01 04:47:17.407 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe1
9306beb1310
2024-09-01 04:47:18.001 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427
bcecc7c0fe19306beb1310
2024-09-01 04:47:18.015 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310
2024-09-01 04:47:18.019 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0f
e19306beb1310
2024-09-01 04:47:18.040 | INFO     | __main__:find_latest_checkpoint:486 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c
0fe19306beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 04:47:18.040 | INFO     | __main__:retrieve_proof:1139 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb
1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt
2024-09-01 04:47:18.040 | INFO     | __main__:train_test_fisher:626 - Inside train_test_fisher
2024-09-01 04:47:18.040 | INFO     | __main__:train_test_fisher:627 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-01 04:47:21.744 | INFO     | __main__:train_test_fisher:651 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe193
06beb1310_lambda_0.1_epoch=0-Recall@10_val=60.65.ckpt and reset epoch count
2024-09-01 04:47:21.745 | INFO     | __main__:find_latest_fisher:496 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_no_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069
194c5_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-01 04:47:22.398 | INFO     | __main__:load_fisher_information:473 - Fisher Information successfully loaded.
2024-09-01 04:47:22.398 | INFO     | retrieval.model:set_fisher_info:62 - Fisher Information has been updated in the model.
2024-09-01 04:47:22.398 | INFO     | __main__:train_test_fisher:657 - Fisher Information Matrix loaded.
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-01 04:47:22.498 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.
jsonl
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:17<00:00, 6529.64it/s]
2024-09-01 04:48:02.522 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 6636.47it/s]
2024-09-01 04:48:02.985 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4904
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 6314.91it/s]
2024-09-01 04:48:03.472 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc
7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
Training dataset size after load: 358647
Validation dataset size after load: 4904
Testing dataset size after load: 5431
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main2.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-01 04:48:03.558 | INFO     | __main__:train_test_fisher:730 - Starting progressive training from epoch 0 to 1
2024-09-01 04:48:03.558 | INFO     | __main__:train_test_fisher:744 - Finished progressive training at epoch 0
2024-09-01 04:48:03.559 | WARNING  | __main__:train_test_fisher:754 - No best model found. Using the last trained model.
2024-09-01 04:48:03.559 | INFO     | __main__:train_test_fisher:760 - Testing...
2024-09-01 04:48:03.562 | INFO     | retrieval.main:run_cli:55 - PID: 1565939
[rank: 0] Seed set to 3407
2024-09-01 04:48:03.767 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1
310/random
2024-09-01 04:48:03.767 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306be
b1310/corpus.jsonl
2024-09-01 04:48:04.287 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.
jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-01 04:48:31,175] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-01 04:48:31,175] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-01 04:48:31,175] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-01 04:48:34.402 | INFO     | __main__:main:1232 - Running progressive training
2024-09-01 04:48:34.402 | INFO     | __main__:main:1232 - Running progressive training
2024-09-01 04:48:34.402 | INFO     | __main__:main:1232 - Running progressive training
2024-09-01 04:48:34.402 | INFO     | __main__:main:1238 - Configuring LeanDojo...
2024-09-01 04:48:34.402 | INFO     | __main__:main:1238 - Configuring LeanDojo...
2024-09-01 04:48:34.402 | INFO     | __main__:main:1238 - Configuring LeanDojo...
2024-09-01 04:48:34.405 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:48:34.405 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:48:34.405 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:48:34.405 | INFO     | __main__:main:1240 - LeanDojo configured
2024-09-01 04:48:34.405 | INFO     | __main__:main:1240 - LeanDojo configured
2024-09-01 04:48:34.406 | INFO     | __main__:main:1240 - LeanDojo configured
2024-09-01 04:48:35.921 | INFO     | __main__:search_github_repositories:403 - Processing leanprover/lean4
2024-09-01 04:48:35.921 | INFO     | __main__:search_github_repositories:421 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 04:48:35.921 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 04:48:35.953 | INFO     | __main__:search_github_repositories:403 - Processing leanprover/lean4
2024-09-01 04:48:35.953 | INFO     | __main__:search_github_repositories:421 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 04:48:35.953 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 04:48:36.760 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:48:36.760 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:48:37.125 | INFO     | __main__:search_github_repositories:403 - Processing leanprover/lean4
2024-09-01 04:48:37.125 | INFO     | __main__:search_github_repositories:421 - Skipping leanprover/lean4 since it is a known repository
2024-09-01 04:48:37.125 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-01 04:48:37.787 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:48:37.802 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:48:37.908 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:48:38.934 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Retrying..
.
2024-09-01 04:48:39.812 | INFO     | __main__:search_github_repositories:419 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 04:48:39.813 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 04:48:39.843 | INFO     | __main__:search_github_repositories:419 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 04:48:39.844 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 04:48:40.754 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 04:48:40.754 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 04:48:40.961 | INFO     | __main__:search_github_repositories:419 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-01 04:48:40.962 | INFO     | __main__:search_github_repositories:403 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-01 04:48:41.622 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
2024-09-01 04:48:55.960 | INFO     | __main__:search_github_repositories:403 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 04:48:56.137 | INFO     | __main__:search_github_repositories:403 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 04:48:56.657 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:48:56.657 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:48:57.282 | INFO     | __main__:search_github_repositories:403 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-01 04:48:57.684 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:48:57.697 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:48:57.800 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:48:58.826 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-01 04:48:59.712 | INFO     | __main__:search_github_repositories:419 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 04:48:59.713 | INFO     | __main__:search_github_repositories:403 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 04:48:59.737 | INFO     | __main__:search_github_repositories:419 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 04:48:59.738 | INFO     | __main__:search_github_repositories:403 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 04:49:00.402 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:49:00.402 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:49:00.853 | INFO     | __main__:search_github_repositories:419 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-01 04:49:00.854 | INFO     | __main__:search_github_repositories:403 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-01 04:49:01.312 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:49:01.428 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:49:01.441 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:49:02.338 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-01 04:49:03.456 | INFO     | __main__:search_github_repositories:419 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 04:49:03.457 | INFO     | __main__:search_github_repositories:403 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 04:49:03.484 | INFO     | __main__:search_github_repositories:419 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 04:49:03.485 | INFO     | __main__:search_github_repositories:403 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 04:49:04.098 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:49:04.098 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:49:04.365 | INFO     | __main__:search_github_repositories:419 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-01 04:49:04.366 | INFO     | __main__:search_github_repositories:403 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-01 04:49:04.821 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:49:05.124 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:49:05.124 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:49:05.848 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-01 04:49:07.150 | INFO     | __main__:search_github_repositories:419 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 04:49:07.151 | INFO     | __main__:search_github_repositories:403 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 04:49:07.152 | INFO     | __main__:search_github_repositories:419 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 04:49:07.153 | INFO     | __main__:search_github_repositories:403 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 04:49:07.813 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:49:07.813 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:49:07.874 | INFO     | __main__:search_github_repositories:419 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-01 04:49:07.874 | INFO     | __main__:search_github_repositories:403 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-01 04:49:08.408 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:49:08.838 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:49:08.839 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:49:09.434 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-01 04:49:10.865 | INFO     | __main__:search_github_repositories:419 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 04:49:10.865 | INFO     | __main__:search_github_repositories:419 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 04:49:10.866 | INFO     | __main__:search_github_repositories:403 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 04:49:10.866 | INFO     | __main__:search_github_repositories:403 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 04:49:11.462 | INFO     | __main__:search_github_repositories:419 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-01 04:49:11.463 | INFO     | __main__:search_github_repositories:403 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-01 04:49:11.584 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:49:11.584 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:49:12.020 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:49:12.610 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:49:12.622 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:49:13.047 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolchain fa
iled. Retrying...
2024-09-01 04:49:14.637 | INFO     | __main__:search_github_repositories:419 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 04:49:14.638 | INFO     | __main__:search_github_repositories:403 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 04:49:14.663 | INFO     | __main__:search_github_repositories:419 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 04:49:14.664 | INFO     | __main__:search_github_repositories:403 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 04:49:15.096 | INFO     | __main__:search_github_repositories:419 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-01 04:49:15.097 | INFO     | __main__:search_github_repositories:403 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-01 04:49:15.245 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-01 04:49:15.246 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
2024-09-01 04:49:15.581 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 04:49:30.573 | INFO     | __main__:retrieve_proof:1047 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:49:30.574 | INFO     | __main__:retrieve_proof:1063 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:49:30.574 | INFO     | __main__:retrieve_proof:1064 - Lean version: v4.8.0
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 04:49:30.645 | INFO     | __main__:retrieve_proof:1047 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:49:30.645 | INFO     | __main__:retrieve_proof:1063 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:49:30.645 | INFO     | __main__:retrieve_proof:1064 - Lean version: v4.8.0
2024-09-01 04:49:30.782 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-01 04:49:30.782 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-01 04:49:31.302 | INFO     | __main__:retrieve_proof:1047 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:49:31.302 | INFO     | __main__:retrieve_proof:1063 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-01 04:49:31.302 | INFO     | __main__:retrieve_proof:1064 - Lean version: v4.8.0
2024-09-01 04:49:31.328 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-01 04:49:45.856 | INFO     | __main__:retrieve_proof:1069 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:49:45.856 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:49:45.856 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 04:49:45.856 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 04:49:45.856 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 04:49:45.856 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:45.856 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:45.857 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:45.858 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:45.858 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:45.858 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:45.941 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 04:49:45.941 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 04:49:45.941 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 04:49:45.947 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:49:45.947 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 04:49:45.947 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 04:49:45.950 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 04:49:45.950 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe193
06beb1310/mathlib4
2024-09-01 04:49:46.133 | INFO     | __main__:retrieve_proof:1069 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.133 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.134 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.134 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.134 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.179 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 04:49:46.179 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 04:49:46.179 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 04:49:46.183 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:49:46.183 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 04:49:46.183 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 04:49:46.184 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 04:49:46.185 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe193
06beb1310/mathlib4
2024-09-01 04:49:46.865 | INFO     | __main__:retrieve_proof:1069 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.866 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.867 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.867 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.867 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-01 04:49:46.912 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-01 04:49:46.912 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-01 04:49:46.913 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-01 04:49:46.916 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-01 04:49:46.916 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-01 04:49:46.916 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-01 04:49:46.918 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-01 04:49:46.918 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe193
06beb1310/mathlib4
2024-09-01 04:49:48.088 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e7343
8e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
  0%|                                                                                                                                                                                           | 0/5514 [00:00<?, ?it/s]
2024-09-01 04:49:48.323 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e7343
8e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
  0%|▎                                                                                                                                                                                 | 11/5514 [00:00<07:01, 13.06it/s]
2024-09-01 04:49:49.032 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e7343
8e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [12:56<00:00,  7.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [12:55<00:00,  7.11it/s]
2024-09-01 05:02:44.927 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bce
cc7c0fe19306beb1310')
2024-09-01 05:02:44.927 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bce
cc7c0fe19306beb1310')
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 5295/5514 [12:58<00:22,  9.92it/s]
2024-09-01 05:02:46.321 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-01 05:02:46.322 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [13:02<00:00,  7.04it/s]
2024-09-01 05:02:50.794 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bce
cc7c0fe19306beb1310')
2024-09-01 05:02:52.037 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-01 05:03:02.426 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 05:03:02.426 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 05:03:08.600 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-01 05:03:18.297 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 05:03:18.349 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 05:03:24.985 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-01 05:03:33.793 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 05:03:34.071 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 05:03:34.908 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 05:03:35.203 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 05:03:37.461 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 05:03:37.790 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 05:03:38.053 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 05:03:38.227 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 05:03:40.848 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 05:03:41.962 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-01 05:03:44.524 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-01 05:03:44.988 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-01 05:03:47.599 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 05:03:47.613 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 05:03:48.042 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 05:03:48.085 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 05:03:54.592 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-01 05:03:55.032 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.10.0
2024-09-01 05:04:03.337 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 05:04:03.498 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 05:04:04.391 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 05:04:04.418 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 05:04:10.574 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-01 05:04:11.445 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc1
2024-09-01 05:04:19.773 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 05:04:19.922 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 05:04:20.592 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 05:04:20.888 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 05:04:21.180 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 05:04:21.342 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 05:04:26.921 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-01 05:04:27.725 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-01 05:04:28.181 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-01 05:04:36.922 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 05:04:37.482 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426
b91a0d2fe')
2024-09-01 05:04:37.994 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-09-01 05:04:38.042 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 05:04:38.505 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426
b91a0d2fe')
2024-09-01 05:04:38.896 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-09-01 05:04:43.931 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-01 05:04:44.392 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='83f718b9055972dce4f92f5b3917426
b91a0d2fe')
2024-09-01 05:04:44.801 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 05:04:54.995 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 05:04:55.786 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 05:04:56.441 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupporte
d Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-01 05:04:56.442 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf1
0839227bbb9e8492be2d')
2024-09-01 05:04:56.631 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e
350841ce65a1ec42c')
2024-09-01 05:04:56.815 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c10664
93c3f5dc51c9713e')
2024-09-01 05:04:57.224 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77
ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 05:04:57.401 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupporte
d Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-01 05:04:57.401 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf1
0839227bbb9e8492be2d')
2024-09-01 05:04:57.432 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e
350841ce65a1ec42c')
2024-09-01 05:04:57.462 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c10664
93c3f5dc51c9713e')
2024-09-01 05:04:57.520 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77
ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 05:04:57.581 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b67
5ef3e347d0')
2024-09-01 05:04:57.583 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b67
5ef3e347d0')
2024-09-01 05:04:57.764 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4
bc3c9a45fc03cf97a0b1a0c')
2024-09-01 05:04:57.764 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4
bc3c9a45fc03cf97a0b1a0c')
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-01 05:05:01.952 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-01 05:05:03.558 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an unsupporte
d Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-01 05:05:03.558 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='a7fd140a94bbbfa40cf1
0839227bbb9e8492be2d')
2024-09-01 05:05:03.591 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='d38fb94558af9957b8f479e
350841ce65a1ec42c')
2024-09-01 05:05:03.629 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='6c89b6765913a0d727c10664
93c3f5dc51c9713e')
2024-09-01 05:05:03.691 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c61280c77
ade6bbf0bc3c66a44fe2e0c5')
2024-09-01 05:05:03.755 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b67
5ef3e347d0')
2024-09-01 05:05:03.787 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4
bc3c9a45fc03cf97a0b1a0c')
2024-09-01 05:05:23.038 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73
438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/l
eanprover-community/batteries', commit='021e272cb5cdcc82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop':
LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b
6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprov
er/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='h
ttps://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c424
13cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/le
anprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 05:05:23.134 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73
438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/l
eanprover-community/batteries', commit='021e272cb5cdcc82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop':
LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b
6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprov
er/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='h
ttps://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c424
13cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/le
anprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 05:05:28.730 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73
438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='daa22187642d4cf6954c39a23eab20d8a8675416'), 'batteries': LeanGitRepo(url='https://github.com/l
eanprover-community/batteries', commit='021e272cb5cdcc82b7e1e760fe915ff2f64169ad'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b961bd8d6'), 'aesop':
LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b
6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRepo(url='https://github.com/leanprov
er/doc-gen4', commit='83f718b9055972dce4f92f5b3917426b91a0d2fe'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56fb005'), 'UnicodeBasic': LeanGitRepo(url='h
ttps://github.com/fgdorais/lean4-unicode-basic', commit='9447739fe9714f8a091192bad5cd5e7b5a8ae1e4'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQuery', commit='c138ab5c566c4268798b24bfcbea2f4c424
13cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='0a756018b736ef4f4bc3c9a45fc03cf97a0b1a0c')}, root_dir=PosixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/le
anprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-01 05:05:42.320 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 05:05:42.322 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 05:05:42.322 | INFO     | __main__:retrieve_proof:1077 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 05:05:42.539 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 05:05:42.540 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 05:05:42.540 | INFO     | __main__:retrieve_proof:1077 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 05:05:52.774 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-01 05:05:52.775 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it instead.
2024-09-01 05:05:52.775 | INFO     | __main__:retrieve_proof:1077 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-01 05:05:52.918 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:05:52.918 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:05:52.990 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:05:52.990 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 48794.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 46677.93it/s]
 21%|███████████████████████████████████▍                                                                                                                                      | 24270/116251 [00:00<00:01, 47635.75it/s]
2024-09-01 05:06:09.522 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:06:09.522 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 30733.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [01:50<00:00, 1051.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [01:50<00:00, 1048.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 51221.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 49180.33it/s]
2024-09-01 05:07:47.573 | INFO     | __main__:retrieve_proof:1115 - Before adding new repo:
2024-09-01 05:07:47.573 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 05:07:47.573 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:07:47.573 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:07:47.573 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the dat
abase.
2024-09-01 05:07:47.573 | INFO     | __main__:retrieve_proof:1118 - After adding new repo:
2024-09-01 05:07:47.573 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 05:07:47.573 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:07:47.803 | INFO     | __main__:retrieve_proof:1115 - Before adding new repo:
2024-09-01 05:07:47.803 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 05:07:47.803 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:07:47.803 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:07:47.804 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the dat
abase.
2024-09-01 05:07:47.804 | INFO     | __main__:retrieve_proof:1118 - After adding new repo:
2024-09-01 05:07:47.804 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 05:07:47.804 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:08:00.880 | INFO     | __main__:retrieve_proof:1127 - Adding repo to repos_for_merged_dataset
2024-09-01 05:08:00.881 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 05:08:00.881 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:08:01.196 | INFO     | __main__:retrieve_proof:1127 - Adding repo to repos_for_merged_dataset
2024-09-01 05:08:01.197 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 05:08:01.197 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [01:59<00:00, 974.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 51628.83it/s]
2024-09-01 05:08:14.415 | INFO     | __main__:retrieve_proof:1115 - Before adding new repo:
2024-09-01 05:08:14.415 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 05:08:14.415 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:08:14.415 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:08:14.415 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in the dat
abase.
2024-09-01 05:08:14.415 | INFO     | __main__:retrieve_proof:1118 - After adding new repo:
2024-09-01 05:08:14.415 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-01 05:08:14.416 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:08:27.732 | INFO     | __main__:retrieve_proof:1127 - Adding repo to repos_for_merged_dataset
2024-09-01 05:08:27.734 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-01 05:08:27.734 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-01 05:10:27.092 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already ex
ists. Removing it now.
2024-09-01 05:10:27.556 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already ex
ists. Removing it now.
2024-09-01 05:10:50.422 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe1930
6beb1310
2024-09-01 05:10:51.021 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bce
cc7c0fe19306beb1310
2024-09-01 05:10:51.036 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0
fe19306beb1310
2024-09-01 05:10:51.039 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19
306beb1310
2024-09-01 05:10:51.061 | INFO     | __main__:find_latest_checkpoint:486 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe
19306beb1310_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt
2024-09-01 05:10:51.061 | INFO     | __main__:retrieve_proof:1139 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb131
0_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt
2024-09-01 05:10:51.061 | INFO     | __main__:train_test_fisher:626 - Inside train_test_fisher
2024-09-01 05:10:51.061 | INFO     | __main__:train_test_fisher:627 - Starting training at epoch 0
[rank: 3] Seed set to 3407
2024-09-01 05:10:51.593 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe1930
6beb1310
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-01 05:10:52.602 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bce
cc7c0fe19306beb1310
2024-09-01 05:10:52.627 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0
fe19306beb1310
2024-09-01 05:10:52.634 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19
306beb1310
2024-09-01 05:10:52.677 | INFO     | __main__:find_latest_checkpoint:486 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe
19306beb1310_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt
2024-09-01 05:10:52.677 | INFO     | __main__:retrieve_proof:1139 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb131
0_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt
2024-09-01 05:10:52.677 | INFO     | __main__:train_test_fisher:626 - Inside train_test_fisher
2024-09-01 05:10:52.677 | INFO     | __main__:train_test_fisher:627 - Starting training at epoch 0
[rank: 2] Seed set to 3407
2024-09-01 05:10:53.312 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already ex
ists. Removing it now.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-01 05:10:55.667 | INFO     | __main__:train_test_fisher:651 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt and reset epoch count
2024-09-01 05:10:55.668 | INFO     | __main__:find_latest_fisher:496 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194
c5_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-01 05:10:56.360 | INFO     | __main__:load_fisher_information:473 - Fisher Information successfully loaded.
2024-09-01 05:10:56.361 | INFO     | retrieval.model:set_fisher_info:62 - Fisher Information has been updated in the model.
2024-09-01 05:10:56.361 | INFO     | __main__:train_test_fisher:657 - Fisher Information Matrix loaded.
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-01 05:10:56.459 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jso
nl
2024-09-01 05:10:56.460 | INFO     | __main__:main:1273 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/corpus.jsonl'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1253, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1145, in retrieve_proof
    train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 665, in train_test_fisher
    data_module = RetrievalDataModule(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 245, in __init__
    self.corpus = Corpus(corpus_path)
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 210, in __init__
    for line in open(jsonl_path):
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl'
2024-09-01 05:10:56.801 | INFO     | __main__:train_test_fisher:651 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt and reset epoch count
2024-09-01 05:10:56.802 | INFO     | __main__:find_latest_fisher:496 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194
c5_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-01 05:10:57.270 | INFO     | __main__:load_fisher_information:473 - Fisher Information successfully loaded.
2024-09-01 05:10:57.270 | INFO     | retrieval.model:set_fisher_info:62 - Fisher Information has been updated in the model.
2024-09-01 05:10:57.270 | INFO     | __main__:train_test_fisher:657 - Fisher Information Matrix loaded.
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-01 05:10:57.378 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jso
nl
2024-09-01 05:10:57.378 | INFO     | __main__:main:1273 - An error occurred: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/corpus.jsonl'
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1253, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1145, in retrieve_proof
    train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 665, in train_test_fisher
    data_module = RetrievalDataModule(
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/datamodule.py", line 245, in __init__
    self.corpus = Corpus(corpus_path)
  File "/data/yingzi_ma/lean_project/ReProver/common.py", line 210, in __init__
    for line in open(jsonl_path):
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jsonl'
2024-09-01 05:11:16.710 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe1930
6beb1310
2024-09-01 05:11:17.316 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bce
cc7c0fe19306beb1310
2024-09-01 05:11:17.331 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0
fe19306beb1310
2024-09-01 05:11:17.334 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19
306beb1310
2024-09-01 05:11:17.357 | INFO     | __main__:find_latest_checkpoint:486 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe
19306beb1310_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt
2024-09-01 05:11:17.358 | INFO     | __main__:retrieve_proof:1139 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb131
0_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt
2024-09-01 05:11:17.358 | INFO     | __main__:train_test_fisher:626 - Inside train_test_fisher
2024-09-01 05:11:17.358 | INFO     | __main__:train_test_fisher:627 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default
 pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more
details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be load
ed via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of
the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-01 05:11:20.475 | INFO     | __main__:train_test_fisher:651 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306b
eb1310_lambda_0.1_epoch=0-Recall@10_val=58.95.ckpt and reset epoch count
2024-09-01 05:11:20.476 | INFO     | __main__:find_latest_fisher:496 - Using the latest Fisher Information Matrix: /data/yingzi_ma/lean_project/fisher_PT_single_repo_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194
c5_fisher_info.pkl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickl
e module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more detail
s). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via
 this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the lo
aded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
2024-09-01 05:11:20.880 | INFO     | __main__:load_fisher_information:473 - Fisher Information successfully loaded.
2024-09-01 05:11:20.880 | INFO     | retrieval.model:set_fisher_info:62 - Fisher Information has been updated in the model.
2024-09-01 05:11:20.880 | INFO     | __main__:train_test_fisher:657 - Fisher Information Matrix loaded.
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This
behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-01 05:11:20.976 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jso
nl
 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                              | 88740/116 77
%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 89417/116 78%|█
████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 90146/116251 [00:1
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 90790/116251
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                          | 91431/116251
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                         | 92084/116251
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 92715/116251
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                       | 93341/116251
 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                     | 94019/116251
 81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 94651/116251
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                   | 95280/116251
 83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                  | 95908/116251
 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 96529/116251
 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 97180/116251
 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 97800/116251
 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 98411/116251
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 99180/116251
 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 99852/116251
 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 100512/116251
 87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 101168/116251
 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                        | 101795/116251
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 102421/116251
 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 103073/116251
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 103689/116251
 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                    | 104297/116251
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 104892/116251
 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                  | 105538/116251
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 106185/116251
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                | 106785/116251
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 107439/116251
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 108055/116251
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍            | 108834/116251
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 109486/116251
 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 110150/116251
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 110930/116251
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 111617/116251
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 112273/116251
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 112901/116251
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 113488/116251
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 114186/116251
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 114789/116251
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 115423/116251
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 116106/116251
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251
 [00:18<00:00, 6165.08it/s]
2024-09-01 05:12:03.326 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0
fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 359583
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 6252.14it/s]
2024-09-01 05:12:03.810 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0
fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4874
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 6354.54it/s]
2024-09-01 05:12:04.284 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0
fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 4922
Training dataset size after load: 359583
Validation dataset size after load: 4874
Testing dataset size after load: 4922
2024-09-01 05:12:04.369 | INFO     | __main__:train_test_fisher:730 - Starting progressive training from epoch 0 to 1
2024-09-01 05:12:04.370 | INFO     | __main__:train_test_fisher:744 - Finished progressive training at epoch 0
2024-09-01 05:12:04.370 | WARNING  | __main__:train_test_fisher:754 - No best model found. Using the last trained model.
2024-09-01 05:12:04.371 | INFO     | __main__:train_test_fisher:760 - Testing...
2024-09-01 05:12:04.373 | INFO     | retrieval.main:run_cli:55 - PID: 1577407
[rank: 1] Seed set to 3407
2024-09-01 05:12:04.612 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
/random
2024-09-01 05:12:04.613 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb13
10/corpus.jsonl
2024-09-01 05:12:05.133 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/corpus.jso
nl
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-01 05:18:25.086 | INFO     | __main__:main:1273 - An error occurred: Timed out after 1801 seconds waiting for clients. 2/4 clients joined.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1253, in main
    proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 1145, in retrieve_proof
    train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
  File "/data/yingzi_ma/lean_project/ReProver/main2.py", line 772, in train_test_fisher
    run_cli(best_model_path, data_path)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 943, in _run
    self.strategy.setup_environment()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 154, in setup_environment
    self.setup_distributed()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 203, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 291, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 93, in wrapper
    func_return = func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1361, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout, use_libuv)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/rendezvous.py", line 185, in _create_c10d_store
    return TCPStore(
torch.distributed.DistStoreError: Timed out after 1801 seconds waiting for clients. 2/4 clients joined.
2024-09-01 05:18:25.102 | INFO     | __main__:main:1273 - An error occurred: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error:
 Connection reset by peer
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x733917935f86 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d0ffbe (0x7339032d6fbe in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x7339032d1857 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/
lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x7339032d1b82 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x7339032d2d71 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7339032877c1 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7339032877c1 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7339032877c1 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x7338c9bc2f6f in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_
cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x114c (0x7338c9bced4c in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libt
orch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) + 0x643 (0x7338c9bdb833 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/sit
e-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x5cb44e6 (0x73390327b4e6 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5cbf796 (0x733903286796 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x52dfa0b (0x7339028a6a0b in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x52dd284 (0x7339028a4284 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x1adf2b8 (0x7338ff0a62b8 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5cc46aa (0x73390328b6aa in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x5cd428c (0x73390329b28c in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xdb3265 (0x7339165a8265 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x4b00e4 (0x733915ca50e4 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x4fdc87]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f741b in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #22: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x509cbf]
frame #23: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #24: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #25: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #26: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #27: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #28: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4a3 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #29: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #30: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #31: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #32: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #33: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4a3 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #34: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #35: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #36: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x508626]
frame #37: _PyObject_GenericGetAttrWithDict + 0x499 (0x4fc8d9 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #38: PyObject_GetAttr + 0x40 (0x4fb2f0 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x4907 (0x4f29f7 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #41: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #42: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x5099ce]
frame #43: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4a3 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #44: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x509b26]
frame #45: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #46: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x5099ce]
frame #47: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #48: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #49: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #50: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #51: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x5099ce]
frame #52: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #53: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #54: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #55: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #56: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #57: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x507588]
frame #58: _PyObject_MakeTpCall + 0x2ab (0x4f746b in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #59: _PyEval_EvalFrameDefault + 0x4dde (0x4f2ece in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #61: _PyEval_EvalFrameDefault + 0x31f (0x4ee40f in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up issue.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1253, in main
    print(f"Processing {repo}")
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1145, in retrieve_proof
    # Train the model on the new dataset that we generated from the dynamic database.
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 772, in train_test_fisher
    # subprocess.run(["python","retrieval/main.py", "predict", "--config", "retrieval/confs/cli_lean4_random.yaml", "--ckpt_path", model_checkpoint_path, "--data-path", data_path], check=True)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
    cli = CLI(PremiseRetriever, RetrievalDataModule)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
    self._run_subcommand(self.subcommand)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
    fn(**fn_kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
    return call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 944, in _run
    self.__setup_profiler()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1079, in __setup_profiler
    self.profiler.setup(stage=self.state.fn, local_rank=local_rank, log_dir=self.log_dir)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1249, in log_dir
    dirpath = self.strategy.broadcast(dirpath)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 307, in broadcast
    torch.distributed.broadcast_object_list(obj, src, group=_group.WORLD)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 2901, in broadcast_object_list
    broadcast(object_sizes_tensor, src=src, group=group)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 2205, in broadcast
    work = default_pg.broadcast([tensor], opts)
torch.distributed.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x733917935f86 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d0ffbe (0x7339032d6fbe in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x7339032d1857 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/
lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x7339032d1b82 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x7339032d2d71 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7339032877c1 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7339032877c1 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7339032877c1 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x7338c9bc2f6f in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_
cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x114c (0x7338c9bced4c in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libt
orch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) + 0x643 (0x7338c9bdb833 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/sit
e-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x5cb44e6 (0x73390327b4e6 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5cbf796 (0x733903286796 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x52dfa0b (0x7339028a6a0b in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x52dd284 (0x7339028a4284 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x1adf2b8 (0x7338ff0a62b8 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5cc46aa (0x73390328b6aa in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x5cd428c (0x73390329b28c in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xdb3265 (0x7339165a8265 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x4b00e4 (0x733915ca50e4 in /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x4fdc87]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f741b in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #22: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x509cbf]
frame #23: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #24: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #25: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #26: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #27: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #28: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4a3 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #29: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #30: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #31: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #32: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #33: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4a3 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #34: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #35: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #36: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x508626]
frame #37: _PyObject_GenericGetAttrWithDict + 0x499 (0x4fc8d9 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #38: PyObject_GetAttr + 0x40 (0x4fb2f0 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x4907 (0x4f29f7 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #41: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #42: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x5099ce]
frame #43: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4a3 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #44: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x509b26]
frame #45: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #46: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x5099ce]
frame #47: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #48: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #49: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #50: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #51: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x5099ce]
frame #52: PyObject_Call + 0xb8 (0x50a508 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #53: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #54: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #55: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #56: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #57: /data/yingzi_ma/miniconda3/envs/ReProver/bin/python() [0x507588]
frame #58: _PyObject_MakeTpCall + 0x2ab (0x4f746b in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #59: _PyEval_EvalFrameDefault + 0x4dde (0x4f2ece in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #61: _PyEval_EvalFrameDefault + 0x31f (0x4ee40f in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /data/yingzi_ma/miniconda3/envs/ReProver/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up issue.

