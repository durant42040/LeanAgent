2024-10-24 13:35:17.169 | INFO     | retrieval.model:validation_step:370 - Recall@11_val: 69.04761904761905
2024-10-24 13:35:17.170 | INFO     | retrieval.model:validation_step:370 - Recall@12_val: 69.04761904761905
2024-10-24 13:35:17.171 | INFO     | retrieval.model:validation_step:370 - Recall@13_val: 70.84942084942085
2024-10-24 13:35:17.172 | INFO     | retrieval.model:validation_step:370 - Recall@14_val: 72.2007722007722
2024-10-24 13:35:17.173 | INFO     | retrieval.model:validation_step:370 - Recall@15_val: 72.87644787644788
2024-10-24 13:35:17.175 | INFO     | retrieval.model:validation_step:370 - Recall@16_val: 72.87644787644788
2024-10-24 13:35:17.176 | INFO     | retrieval.model:validation_step:370 - Recall@17_val: 72.87644787644788
2024-10-24 13:35:17.177 | INFO     | retrieval.model:validation_step:370 - Recall@18_val: 72.87644787644788
2024-10-24 13:35:17.178 | INFO     | retrieval.model:validation_step:370 - Recall@19_val: 74.22779922779922
2024-10-24 13:35:17.179 | INFO     | retrieval.model:validation_step:370 - Recall@20_val: 74.22779922779922
2024-10-24 13:35:17.180 | INFO     | retrieval.model:validation_step:370 - Recall@21_val: 74.61389961389962
2024-10-24 13:35:17.181 | INFO     | retrieval.model:validation_step:370 - Recall@22_val: 74.61389961389962
2024-10-24 13:35:17.182 | INFO     | retrieval.model:validation_step:370 - Recall@23_val: 74.61389961389962
2024-10-24 13:35:17.183 | INFO     | retrieval.model:validation_step:370 - Recall@24_val: 75.96525096525096
2024-10-24 13:35:17.185 | INFO     | retrieval.model:validation_step:370 - Recall@25_val: 77.31660231660233
2024-10-24 13:35:17.186 | INFO     | retrieval.model:validation_step:370 - Recall@26_val: 77.31660231660233
2024-10-24 13:35:17.187 | INFO     | retrieval.model:validation_step:370 - Recall@27_val: 78.37837837837837
2024-10-24 13:35:17.188 | INFO     | retrieval.model:validation_step:370 - Recall@28_val: 79.72972972972973
2024-10-24 13:35:17.189 | INFO     | retrieval.model:validation_step:370 - Recall@29_val: 79.72972972972973
2024-10-24 13:35:17.190 | INFO     | retrieval.model:validation_step:370 - Recall@30_val: 82.43243243243244
2024-10-24 13:35:17.191 | INFO     | retrieval.model:validation_step:370 - Recall@31_val: 82.43243243243244
2024-10-24 13:35:17.192 | INFO     | retrieval.model:validation_step:370 - Recall@32_val: 82.43243243243244
2024-10-24 13:35:17.193 | INFO     | retrieval.model:validation_step:370 - Recall@33_val: 82.43243243243244
2024-10-24 13:35:17.195 | INFO     | retrieval.model:validation_step:370 - Recall@34_val: 82.43243243243244
2024-10-24 13:35:17.196 | INFO     | retrieval.model:validation_step:370 - Recall@35_val: 82.81853281853282
2024-10-24 13:35:17.197 | INFO     | retrieval.model:validation_step:370 - Recall@36_val: 82.81853281853282
2024-10-24 13:35:17.198 | INFO     | retrieval.model:validation_step:370 - Recall@37_val: 82.81853281853282
2024-10-24 13:35:17.199 | INFO     | retrieval.model:validation_step:370 - Recall@38_val: 82.81853281853282
2024-10-24 13:35:17.200 | INFO     | retrieval.model:validation_step:370 - Recall@39_val: 83.20463320463321
2024-10-24 13:35:17.201 | INFO     | retrieval.model:validation_step:370 - Recall@40_val: 83.20463320463321
2024-10-24 13:35:17.202 | INFO     | retrieval.model:validation_step:370 - Recall@41_val: 83.20463320463321
2024-10-24 13:35:17.203 | INFO     | retrieval.model:validation_step:370 - Recall@42_val: 83.20463320463321
2024-10-24 13:35:17.204 | INFO     | retrieval.model:validation_step:370 - Recall@43_val: 83.20463320463321
2024-10-24 13:35:17.205 | INFO     | retrieval.model:validation_step:370 - Recall@44_val: 85.9073359073359
2024-10-24 13:35:17.206 | INFO     | retrieval.model:validation_step:370 - Recall@45_val: 87.25868725868725
2024-10-24 13:35:17.207 | INFO     | retrieval.model:validation_step:370 - Recall@46_val: 87.25868725868725
2024-10-24 13:35:17.209 | INFO     | retrieval.model:validation_step:370 - Recall@47_val: 87.25868725868725
2024-10-24 13:35:17.210 | INFO     | retrieval.model:validation_step:370 - Recall@48_val: 87.93436293436294
2024-10-24 13:35:17.211 | INFO     | retrieval.model:validation_step:370 - Recall@49_val: 88.32046332046333
2024-10-24 13:35:17.212 | INFO     | retrieval.model:validation_step:370 - Recall@50_val: 88.32046332046333
2024-10-24 13:35:17.213 | INFO     | retrieval.model:validation_step:370 - Recall@51_val: 89.67181467181467
2024-10-24 13:35:17.214 | INFO     | retrieval.model:validation_step:370 - Recall@52_val: 89.67181467181467
2024-10-24 13:35:17.215 | INFO     | retrieval.model:validation_step:370 - Recall@53_val: 89.67181467181467
2024-10-24 13:35:17.216 | INFO     | retrieval.model:validation_step:370 - Recall@54_val: 89.67181467181467
2024-10-24 13:35:17.217 | INFO     | retrieval.model:validation_step:370 - Recall@55_val: 89.67181467181467
2024-10-24 13:35:17.218 | INFO     | retrieval.model:validation_step:370 - Recall@56_val: 89.67181467181467
2024-10-24 13:35:17.219 | INFO     | retrieval.model:validation_step:370 - Recall@57_val: 89.67181467181467
2024-10-24 13:35:17.221 | INFO     | retrieval.model:validation_step:370 - Recall@58_val: 89.67181467181467
2024-10-24 13:35:17.222 | INFO     | retrieval.model:validation_step:370 - Recall@59_val: 90.57271557271557
2024-10-24 13:35:17.223 | INFO     | retrieval.model:validation_step:370 - Recall@60_val: 91.24839124839124
2024-10-24 13:35:17.224 | INFO     | retrieval.model:validation_step:370 - Recall@61_val: 91.24839124839124
2024-10-24 13:35:17.225 | INFO     | retrieval.model:validation_step:370 - Recall@62_val: 91.63449163449164
2024-10-24 13:35:17.226 | INFO     | retrieval.model:validation_step:370 - Recall@63_val: 91.63449163449164
2024-10-24 13:35:17.227 | INFO     | retrieval.model:validation_step:370 - Recall@64_val: 91.63449163449164
2024-10-24 13:35:17.228 | INFO     | retrieval.model:validation_step:370 - Recall@65_val: 91.63449163449164
2024-10-24 13:35:17.229 | INFO     | retrieval.model:validation_step:370 - Recall@66_val: 92.98584298584298
2024-10-24 13:35:17.230 | INFO     | retrieval.model:validation_step:370 - Recall@67_val: 92.98584298584298
2024-10-24 13:35:17.231 | INFO     | retrieval.model:validation_step:370 - Recall@68_val: 92.98584298584298
2024-10-24 13:35:17.232 | INFO     | retrieval.model:validation_step:370 - Recall@69_val: 92.98584298584298
2024-10-24 13:35:17.233 | INFO     | retrieval.model:validation_step:370 - Recall@70_val: 92.98584298584298
2024-10-24 13:35:17.235 | INFO     | retrieval.model:validation_step:370 - Recall@71_val: 92.98584298584298
2024-10-24 13:35:17.236 | INFO     | retrieval.model:validation_step:370 - Recall@72_val: 92.98584298584298
2024-10-24 13:35:17.237 | INFO     | retrieval.model:validation_step:370 - Recall@73_val: 92.98584298584298
2024-10-24 13:35:17.238 | INFO     | retrieval.model:validation_step:370 - Recall@74_val: 93.66151866151866
2024-10-24 13:35:17.239 | INFO     | retrieval.model:validation_step:370 - Recall@75_val: 93.66151866151866
2024-10-24 13:35:17.240 | INFO     | retrieval.model:validation_step:370 - Recall@76_val: 93.66151866151866
2024-10-24 13:35:17.241 | INFO     | retrieval.model:validation_step:370 - Recall@77_val: 93.66151866151866
2024-10-24 13:35:17.242 | INFO     | retrieval.model:validation_step:370 - Recall@78_val: 94.33719433719435
2024-10-24 13:35:17.243 | INFO     | retrieval.model:validation_step:370 - Recall@79_val: 94.33719433719435
2024-10-24 13:35:17.244 | INFO     | retrieval.model:validation_step:370 - Recall@80_val: 94.33719433719435
2024-10-24 13:35:17.245 | INFO     | retrieval.model:validation_step:370 - Recall@81_val: 94.33719433719435
2024-10-24 13:35:17.247 | INFO     | retrieval.model:validation_step:370 - Recall@82_val: 95.23809523809524
2024-10-24 13:35:17.248 | INFO     | retrieval.model:validation_step:370 - Recall@83_val: 95.23809523809524
2024-10-24 13:35:17.249 | INFO     | retrieval.model:validation_step:370 - Recall@84_val: 95.23809523809524
2024-10-24 13:35:17.250 | INFO     | retrieval.model:validation_step:370 - Recall@85_val: 95.62419562419562
2024-10-24 13:35:17.251 | INFO     | retrieval.model:validation_step:370 - Recall@86_val: 95.62419562419562
2024-10-24 13:35:17.252 | INFO     | retrieval.model:validation_step:370 - Recall@87_val: 95.62419562419562
2024-10-24 13:35:17.253 | INFO     | retrieval.model:validation_step:370 - Recall@88_val: 96.01029601029602
2024-10-24 13:35:17.254 | INFO     | retrieval.model:validation_step:370 - Recall@89_val: 96.01029601029602
2024-10-24 13:35:17.255 | INFO     | retrieval.model:validation_step:370 - Recall@90_val: 96.01029601029602
2024-10-24 13:35:17.256 | INFO     | retrieval.model:validation_step:370 - Recall@91_val: 96.01029601029602
2024-10-24 13:35:17.257 | INFO     | retrieval.model:validation_step:370 - Recall@92_val: 96.01029601029602
2024-10-24 13:35:17.258 | INFO     | retrieval.model:validation_step:370 - Recall@93_val: 96.01029601029602
2024-10-24 13:35:17.259 | INFO     | retrieval.model:validation_step:370 - Recall@94_val: 96.01029601029602
2024-10-24 13:35:17.261 | INFO     | retrieval.model:validation_step:370 - Recall@95_val: 96.01029601029602
2024-10-24 13:35:17.262 | INFO     | retrieval.model:validation_step:370 - Recall@96_val: 96.01029601029602
2024-10-24 13:35:17.263 | INFO     | retrieval.model:validation_step:370 - Recall@97_val: 96.01029601029602
2024-10-24 13:35:17.264 | INFO     | retrieval.model:validation_step:370 - Recall@98_val: 96.01029601029602
2024-10-24 13:35:17.265 | INFO     | retrieval.model:validation_step:370 - Recall@99_val: 96.01029601029602
2024-10-24 13:35:17.266 | INFO     | retrieval.model:validation_step:370 - Recall@100_val: 96.01029601029602
2024-10-24 13:35:17.267 | INFO     | retrieval.model:validation_step:379 - MRR: 0.575504885250648
2024-10-24 13:35:17.268 | INFO     | retrieval.model:validation_step:387 - End of validation_step
Epoch 13: 100%|██████████████████████| 947/947 [08:33<00:00,  1.84it/s, v_num=8]Epoch 13, global step 27778: 'Recall@10_val' reached 69.71989 (best 78.26855), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/me
rged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt' as top 14
`Trainer.fit` stopped: `max_epochs=14` reached.
Epoch 13: 100%|██████████████████████| 947/947 [09:08<00:00,  1.73it/s, v_num=8]
2024-10-24 13:35:56.250 | INFO     | __main__:main:1667 - hit the barrier after training
2024-10-24 13:35:56.425 | INFO     | __main__:main:1667 - hit the barrier after training
2024-10-24 13:35:56.478 | INFO     | __main__:main:1667 - hit the barrier after training
2024-10-24 13:35:56.495 | INFO     | __main__:main:1667 - hit the barrier after training
2024-10-24 13:35:56.496 | INFO     | __main__:main:1673 - Finished progressive training at epoch 14
2024-10-24 13:35:56.496 | INFO     | __main__:main:1673 - Finished progressive training at epoch 14
2024-10-24 13:35:56.496 | INFO     | __main__:main:1673 - Finished progressive training at epoch 14
2024-10-24 13:35:56.496 | INFO     | __main__:main:1673 - Finished progressive training at epoch 14
2024-10-24 13:35:56.497 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1
_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:35:56.497 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1
_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:35:56.497 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1
_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:35:56.497 | INFO     | __main__:main:1680 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_v
al=69.72.ckpt
2024-10-24 13:35:56.497 | INFO     | __main__:main:1680 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_v
al=69.72.ckpt
2024-10-24 13:35:56.497 | INFO     | __main__:main:1680 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_v
al=69.72.ckpt
2024-10-24 13:35:56.497 | INFO     | __main__:find_latest_checkpoint:577 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1
_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:35:56.498 | INFO     | __main__:main:1680 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_v
al=69.72.ckpt
2024-10-24 13:35:59.786 | INFO     | __main__:main:1689 - Testing...
2024-10-24 13:35:59.787 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 13:35:59.887 | INFO     | __main__:main:1689 - Testing...
2024-10-24 13:35:59.888 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 13:36:00.035 | INFO     | __main__:main:1689 - Testing...
2024-10-24 13:36:00.036 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 13:36:00.057 | INFO     | __main__:main:1689 - Testing...
2024-10-24 13:36:00.060 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 1] Seed set to 3407
2024-10-24 13:36:00.238 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random
2024-10-24 13:36:00.239 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/corpu
s.jsonl
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 0] Seed set to 3407
2024-10-24 13:36:00.363 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random
2024-10-24 13:36:00.364 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/corpu
s.jsonl
2024-10-24 13:36:00.443 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random
2024-10-24 13:36:00.443 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/corpu
s.jsonl
2024-10-24 13:36:00.452 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random
2024-10-24 13:36:00.453 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/corpu
s.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 13:36:19.100 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_train/cached_data.pkl
Training dataset size: 194421
2024-10-24 13:36:19.142 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_pred/cached_data.pkl
Testing dataset size: 2882
2024-10-24 13:36:22.747 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_train/cached_data.pkl
Training dataset size: 194421
2024-10-24 13:36:22.778 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_pred/cached_data.pkl
Testing dataset size: 2882
2024-10-24 13:36:23.394 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_train/cached_data.pkl
Training dataset size: 194421
2024-10-24 13:36:23.416 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_pred/cached_data.pkl
Testing dataset size: 2882
2024-10-24 13:36:23.997 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_train/cached_data.pkl
Training dataset size: 194421
2024-10-24 13:36:24.028 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b
21/random/cache_pred/cached_data.pkl
Testing dataset size: 2882
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:36:27.723 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:36:27.724 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1803 [00:00<?, ?it/s]2024-10-24 13:36:27.870 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:36:27.870 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1803 [00:00<?, ?it/s]2024-10-24 13:36:27.917 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:36:27.919 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 13:36:28.527 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:36:28.528 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1803/1803 [09:43<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1803/1803 [09:44<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1803/1803 [09:44<00:00,  3.08it/s]
100%|███████████████████████████████████████| 1803/1803 [09:44<00:00,  3.09it/s]
Predicting DataLoader 0:   0%|                           | 0/12 [00:00<?, ?it/s]/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, igno
re this warning...
Predicting DataLoader 0: 100%|██████████████████| 12/12 [00:33<00:00,  0.36it/s]2024-10-24 13:46:46.032 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:46:46.168 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 13:46:46.168 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:46:53.181 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:46:53.181 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:46:53.181 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:46:53.332 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 13:46:53.332 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:46:53.362 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 13:46:53.363 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:46:53.376 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 13:46:53.376 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:46:53.377 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 12/12 [00:40<00:00,  0.30it/s]
2024-10-24 13:46:54.724 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 13:46:54.953 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 13:46:55.083 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-24 13:46:55.288 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-24 13:46:55.289 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-10-24 13:46:55.384 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-24 13:46:55.384 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
[rank: 2] Seed set to 3407
2024-10-24 13:46:55.556 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-24 13:46:55.556 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-10-24 13:46:55.871 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 13:46:55.931 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_PrimeNumberTheoremAnd_89bf7b5e3a226525e8580bae21ef543604f99b21/random/test.json
100%|████████████████████████████████████| 1576/1576 [00:00<00:00, 31091.72it/s]
2024-10-24 13:46:55.983 | INFO     | __main__:main:1716 - R@1 = 26.186463343649557 %, R@10 = 65.84636325806824 %, MRR = 0.5570720062450167
2024-10-24 13:46:55.985 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 13:46:56.484 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-10-24 13:46:56.485 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 13:47:00.313 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 6761
2024-10-24 13:47:00.316 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 108
2024-10-24 13:47:00.371 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 6761
2024-10-24 13:47:00.373 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 108
2024-10-24 13:47:00.406 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 6761
2024-10-24 13:47:00.407 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 108
2024-10-24 13:47:00.408 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 6761
2024-10-24 13:47:00.409 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 108
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:47:15.976 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:47:15.977 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  1%|▏                                          | 2/355 [00:00<00:22, 15.90it/s]2024-10-24 13:47:16.287 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:47:16.288 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                   | 0/355 [00:00<?, ?it/s]2024-10-24 13:47:16.315 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:47:16.316 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 13:47:16.878 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:47:16.879 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████| 355/355 [02:21<00:00,  2.52it/s]
100%|█████████████████████████████████████████| 355/355 [02:21<00:00,  2.51it/s]
100%|█████████████████████████████████████████| 355/355 [02:21<00:00,  2.51it/s]
100%|█████████████████████████████████████████| 355/355 [02:21<00:00,  2.51it/s]
Predicting DataLoader 0: 100%|████████████████████| 1/1 [00:00<00:00,  1.47it/s]2024-10-24 13:49:39.002 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:49:39.002 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:49:39.002 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:49:39.002 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 13:49:39.013 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 13:49:39.013 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:49:39.014 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 13:49:39.014 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:49:39.015 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 13:49:39.016 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:49:39.016 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 13:49:39.016 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 13:49:39.016 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████| 1/1 [00:00<00:00,  1.43it/s]
2024-10-24 13:49:40.240 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
[rank: 3] Seed set to 3407
2024-10-24 13:49:40.789 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 13:49:40.867 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 13:49:40.872 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-24 13:49:40.872 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 13:49:41.189 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-24 13:49:41.189 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-24 13:49:41.271 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-24 13:49:41.271 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-10-24 13:49:41.342 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 13:49:41.354 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/test.json
100%|████████████████████████████████████████| 51/51 [00:00<00:00, 43672.83it/s]
2024-10-24 13:49:41.355 | INFO     | __main__:main:1716 - R@1 = 35.91530054644809 %, R@10 = 80.45277127244339 %, MRR = 0.6459937982478966
2024-10-24 13:49:41.357 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 13:49:41.761 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-10-24 13:49:41.761 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 13:49:58.807 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 169335
2024-10-24 13:49:58.836 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2866
2024-10-24 13:50:01.259 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 169335
2024-10-24 13:50:01.282 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2866
2024-10-24 13:50:01.685 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 169335
2024-10-24 13:50:01.706 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2866
2024-10-24 13:50:01.857 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 169335
2024-10-24 13:50:01.878 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2866
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 13:50:20.986 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:50:21.046 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1717 [00:00<?, ?it/s]2024-10-24 13:50:21.142 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:50:21.165 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/1717 [00:00<02:18, 12.35it/s]2024-10-24 13:50:21.250 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:50:21.251 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 13:50:22.238 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 13:50:22.240 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1717/1717 [09:15<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1717/1717 [09:15<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1717/1717 [09:16<00:00,  3.08it/s]
100%|███████████████████████████████████████| 1717/1717 [09:16<00:00,  3.09it/s]
Predicting DataLoader 0: 100%|██████████████████| 12/12 [00:43<00:00,  0.28it/s]2024-10-24 14:00:21.744 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:00:21.745 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:00:21.745 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:00:21.745 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:00:21.905 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 14:00:21.905 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:00:21.911 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 14:00:21.911 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:00:21.919 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 14:00:21.920 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:00:21.936 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 14:00:21.936 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:00:21.937 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 12/12 [00:43<00:00,  0.28it/s]
2024-10-24 14:00:23.503 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 14:00:23.531 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 14:00:23.623 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 14:00:23.987 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-24 14:00:23.987 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-24 14:00:24.007 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-24 14:00:24.007 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-24 14:00:24.075 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-24 14:00:24.075 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-10-24 14:00:24.296 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 14:00:24.341 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|████████████████████████████████████| 1486/1486 [00:00<00:00, 36978.78it/s]
2024-10-24 14:00:24.383 | INFO     | __main__:main:1716 - R@1 = 27.309554972988042 %, R@10 = 66.06511694665693 %, MRR = 0.5542634969494272
2024-10-24 14:00:24.384 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 14:00:24.816 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-10-24 14:00:24.817 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 14:00:40.953 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 156244
2024-10-24 14:00:40.983 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2416
2024-10-24 14:00:44.076 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 156244
2024-10-24 14:00:44.099 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2416
2024-10-24 14:00:44.440 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 156244
2024-10-24 14:00:44.462 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2416
2024-10-24 14:00:45.055 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 156244
2024-10-24 14:00:45.073 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 2416
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 14:00:52.394 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:00:52.395 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1795 [00:00<?, ?it/s]2024-10-24 14:00:52.475 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:00:52.476 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/1795 [00:00<02:00, 14.91it/s]2024-10-24 14:00:52.612 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:00:52.613 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 14:00:53.722 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:00:53.723 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1795/1795 [09:47<00:00,  3.05it/s]
100%|███████████████████████████████████████| 1795/1795 [09:47<00:00,  3.05it/s]
100%|███████████████████████████████████████| 1795/1795 [09:49<00:00,  3.05it/s]
100%|███████████████████████████████████████| 1795/1795 [09:48<00:00,  3.05it/s]
Predicting DataLoader 0: 100%|██████████████████| 10/10 [00:29<00:00,  0.34it/s]2024-10-24 14:11:12.085 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:11:12.229 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 14:11:12.229 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:11:16.732 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:11:16.732 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:11:16.881 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 14:11:16.881 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:11:16.902 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 14:11:16.903 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:11:17.523 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:11:17.710 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 14:11:17.710 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:11:17.711 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 10/10 [00:35<00:00,  0.28it/s]
2024-10-24 14:11:19.449 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 14:11:19.460 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 14:11:19.608 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 14:11:19.903 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-24 14:11:19.903 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-10-24 14:11:19.904 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-24 14:11:19.904 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
[rank: 3] Seed set to 3407
2024-10-24 14:11:20.019 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-24 14:11:20.019 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-10-24 14:11:20.121 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 14:11:20.167 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
100%|████████████████████████████████████| 1501/1501 [00:00<00:00, 37489.51it/s]
2024-10-24 14:11:20.209 | INFO     | __main__:main:1716 - R@1 = 27.9078640546239 %, R@10 = 69.22299286573522 %, MRR = 0.5804973818462645
2024-10-24 14:11:20.211 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 14:11:20.602 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-10-24 14:11:20.602 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 14:11:40.294 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178522
2024-10-24 14:11:40.322 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2954
2024-10-24 14:11:43.770 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178522
2024-10-24 14:11:43.797 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2954
2024-10-24 14:11:45.204 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178522
2024-10-24 14:11:45.231 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2954
2024-10-24 14:11:46.968 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 178522
2024-10-24 14:11:46.993 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 2954
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 14:11:50.614 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:11:50.615 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 1/1840 [00:00<03:13,  9.49it/s]2024-10-24 14:11:50.913 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:11:50.915 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 3/1840 [00:00<03:28,  8.81it/s]2024-10-24 14:11:51.054 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:11:51.056 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 14:11:52.243 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:11:52.243 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1840/1840 [09:54<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1840/1840 [09:54<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1840/1840 [09:56<00:00,  3.09it/s]
100%|███████████████████████████████████████| 1840/1840 [09:55<00:00,  3.09it/s]
Predicting DataLoader 0: 100%|██████████████████| 12/12 [00:42<00:00,  0.28it/s]2024-10-24 14:22:30.598 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:22:30.797 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 14:22:30.797 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:22:32.067 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:22:32.067 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:22:32.067 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:22:32.246 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 14:22:32.246 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:22:32.251 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 14:22:32.251 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:22:32.278 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 14:22:32.278 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:22:32.279 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 12/12 [00:44<00:00,  0.27it/s]
2024-10-24 14:22:33.946 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 14:22:33.982 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 14:22:34.108 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-10-24 14:22:34.532 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-24 14:22:34.532 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-10-24 14:22:34.543 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-24 14:22:34.543 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-10-24 14:22:34.608 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-24 14:22:34.608 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-10-24 14:22:35.144 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 14:22:35.200 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/test.json
100%|████████████████████████████████████| 1577/1577 [00:00<00:00, 32397.09it/s]
2024-10-24 14:22:35.249 | INFO     | __main__:main:1716 - R@1 = 26.312381899644784 %, R@10 = 68.16582635029317 %, MRR = 0.5583395377088854
2024-10-24 14:22:35.251 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 14:22:35.658 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-10-24 14:22:35.659 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 14:22:51.890 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 134332
2024-10-24 14:22:51.912 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 2116
2024-10-24 14:22:53.203 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 134332
2024-10-24 14:22:53.223 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 2116
2024-10-24 14:22:54.540 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 134332
2024-10-24 14:22:54.564 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 2116
2024-10-24 14:22:55.707 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 134332
2024-10-24 14:22:55.727 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 2116
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-24 14:22:59.402 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:22:59.403 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/1599 [00:00<01:53, 14.04it/s]2024-10-24 14:22:59.572 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:22:59.576 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1599 [00:00<?, ?it/s]2024-10-24 14:22:59.707 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:22:59.708 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 14:23:00.950 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:23:00.951 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1599/1599 [08:26<00:00,  3.16it/s]
100%|███████████████████████████████████████| 1599/1599 [08:26<00:00,  3.16it/s]
100%|███████████████████████████████████████| 1599/1599 [08:27<00:00,  3.15it/s]
100%|███████████████████████████████████████| 1599/1599 [08:27<00:00,  3.15it/s]
Predicting DataLoader 0: 100%|████████████████████| 9/9 [00:26<00:00,  0.34it/s]2024-10-24 14:31:54.630 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:31:54.787 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 14:31:54.787 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:31:56.026 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:31:56.148 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 14:31:56.149 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:31:56.629 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:31:56.629 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:31:56.744 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 14:31:56.745 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:31:56.789 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 14:31:56.790 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:31:56.790 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████| 9/9 [00:28<00:00,  0.31it/s]
2024-10-24 14:31:58.768 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 14:31:58.865 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 14:31:58.937 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 14:31:59.257 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-24 14:31:59.258 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
[rank: 1] Seed set to 3407
2024-10-24 14:31:59.315 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-24 14:31:59.315 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-24 14:31:59.379 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-24 14:31:59.379 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-10-24 14:31:59.596 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 14:31:59.637 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
100%|████████████████████████████████████| 1351/1351 [00:00<00:00, 45932.09it/s]
2024-10-24 14:31:59.667 | INFO     | __main__:main:1716 - R@1 = 28.47909663237718 %, R@10 = 70.47054755199551 %, MRR = 0.5982325082329886
2024-10-24 14:31:59.669 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 14:32:00.107 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-10-24 14:32:00.107 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 14:33:15.291 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 137027
2024-10-24 14:33:15.317 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 2009
2024-10-24 14:33:18.872 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 137027
2024-10-24 14:33:18.892 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 2009
2024-10-24 14:33:19.264 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 137027
2024-10-24 14:33:19.283 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 2009
2024-10-24 14:33:19.550 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 137027
2024-10-24 14:33:19.568 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 2009
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-24 14:33:23.220 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:33:23.221 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/1621 [00:00<02:00, 13.42it/s]2024-10-24 14:33:23.402 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:33:23.404 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1621 [00:00<?, ?it/s]2024-10-24 14:33:23.518 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:33:23.519 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 14:33:25.029 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:33:25.029 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1621/1621 [08:31<00:00,  3.17it/s]
100%|███████████████████████████████████████| 1621/1621 [08:32<00:00,  3.17it/s]
100%|███████████████████████████████████████| 1621/1621 [08:33<00:00,  3.16it/s]
100%|███████████████████████████████████████| 1621/1621 [08:32<00:00,  3.16it/s]
Predicting DataLoader 0: 100%|████████████████████| 8/8 [00:25<00:00,  0.32it/s]2024-10-24 14:42:22.475 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:42:22.475 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:42:22.475 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:42:22.475 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 14:42:22.597 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 14:42:22.597 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:42:22.603 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 14:42:22.603 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:42:22.618 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 14:42:22.619 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:42:22.648 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 14:42:22.648 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 14:42:22.649 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████| 8/8 [00:25<00:00,  0.32it/s]
2024-10-24 14:42:24.478 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 14:42:24.546 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 14:42:24.666 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 14:42:25.044 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-24 14:42:25.045 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-24 14:42:25.045 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-24 14:42:25.045 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-24 14:42:25.110 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-24 14:42:25.110 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-10-24 14:42:25.664 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 14:42:25.721 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/test.json
100%|████████████████████████████████████| 1377/1377 [00:00<00:00, 31031.03it/s]
2024-10-24 14:42:25.769 | INFO     | __main__:main:1716 - R@1 = 27.97296617827258 %, R@10 = 69.7337976088285 %, MRR = 0.5905675732915391
2024-10-24 14:42:25.771 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 14:42:26.270 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-10-24 14:42:26.270 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 14:43:13.153 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 361128
2024-10-24 14:43:13.202 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 5157
2024-10-24 14:43:26.100 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 361128
2024-10-24 14:43:26.172 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 5157
2024-10-24 14:43:28.248 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 361128
2024-10-24 14:43:28.294 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 5157
2024-10-24 14:43:28.382 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 361128
2024-10-24 14:43:28.427 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 5157
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-24 14:43:32.567 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:43:32.569 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/2783 [00:00<04:05, 11.32it/s]2024-10-24 14:43:32.901 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:43:32.904 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/2783 [00:00<?, ?it/s]2024-10-24 14:43:32.948 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:43:32.949 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 14:43:34.477 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 14:43:34.478 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 2783/2783 [16:23<00:00,  2.83it/s]
100%|███████████████████████████████████████| 2783/2783 [16:23<00:00,  2.83it/s]
100%|███████████████████████████████████████| 2783/2783 [16:26<00:00,  2.82it/s]
100%|███████████████████████████████████████| 2783/2783 [16:46<00:00,  2.77it/s]
Predicting DataLoader 0: 100%|██████████████████| 21/21 [01:29<00:00,  0.24it/s]2024-10-24 15:01:50.106 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:01:50.106 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:01:50.106 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:01:50.106 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:01:50.334 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 15:01:50.334 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:01:50.402 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 15:01:50.402 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:01:50.408 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 15:01:50.408 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:01:50.409 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 15:01:50.410 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:01:50.410 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████| 21/21 [01:29<00:00,  0.23it/s]
2024-10-24 15:01:52.095 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 15:01:52.355 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 15:01:52.428 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
[rank: 3] Seed set to 3407
2024-10-24 15:01:52.667 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-24 15:01:52.667 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 15:01:52.816 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-24 15:01:52.817 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-24 15:01:52.896 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-24 15:01:52.896 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-10-24 15:01:54.171 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 15:01:54.301 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
100%|████████████████████████████████████| 2427/2427 [00:00<00:00, 16512.55it/s]
2024-10-24 15:01:54.450 | INFO     | __main__:main:1716 - R@1 = 23.169350357556556 %, R@10 = 60.9149011559409 %, MRR = 0.5172949460372223
2024-10-24 15:01:54.453 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 15:01:54.951 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-10-24 15:01:54.951 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 15:01:58.209 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 15153
2024-10-24 15:01:58.213 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 251
2024-10-24 15:01:58.227 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 15153
2024-10-24 15:01:58.229 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 251
2024-10-24 15:01:58.235 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 15153
2024-10-24 15:01:58.239 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 251
2024-10-24 15:01:58.256 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 15153
2024-10-24 15:01:58.259 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 251
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 15:02:01.940 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:02:01.941 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                   | 0/540 [00:00<?, ?it/s]2024-10-24 15:02:01.967 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:02:01.968 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                   | 0/540 [00:00<?, ?it/s]2024-10-24 15:02:01.983 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:02:01.984 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 15:02:03.428 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:02:03.428 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████| 540/540 [03:16<00:00,  2.75it/s]
100%|█████████████████████████████████████████| 540/540 [03:16<00:00,  2.75it/s]
100%|█████████████████████████████████████████| 540/540 [03:16<00:00,  2.75it/s]
100%|█████████████████████████████████████████| 540/540 [03:16<00:00,  2.75it/s]
Predicting DataLoader 0: 100%|████████████████████| 1/1 [00:01<00:00,  0.78it/s]2024-10-24 15:05:21.021 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:05:21.022 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:05:21.022 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:05:21.022 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:05:21.039 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 15:05:21.039 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:05:21.040 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 15:05:21.040 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:05:21.044 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 15:05:21.045 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:05:21.049 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 15:05:21.049 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:05:21.050 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████| 1/1 [00:01<00:00,  0.76it/s]
2024-10-24 15:05:22.635 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 15:05:22.689 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 15:05:22.720 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-24 15:05:23.237 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-24 15:05:23.237 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-10-24 15:05:23.250 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-24 15:05:23.251 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-10-24 15:05:23.290 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-24 15:05:23.290 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-10-24 15:05:23.585 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 15:05:23.612 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/test.json
100%|██████████████████████████████████████| 219/219 [00:00<00:00, 53669.45it/s]
2024-10-24 15:05:23.618 | INFO     | __main__:main:1716 - R@1 = 42.64532744665195 %, R@10 = 83.12362030905078 %, MRR = 0.6874400430139641
2024-10-24 15:05:23.619 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 15:05:24.069 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-10-24 15:05:24.069 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 15:05:36.425 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 17731
2024-10-24 15:05:36.429 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 267
2024-10-24 15:05:36.429 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 17731
2024-10-24 15:05:36.432 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 267
2024-10-24 15:05:36.444 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 17731
2024-10-24 15:05:36.447 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 267
2024-10-24 15:05:43.987 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 17731
2024-10-24 15:05:43.991 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 267
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 15:05:47.383 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:05:47.384 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                   | 0/634 [00:00<?, ?it/s]2024-10-24 15:05:47.424 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:05:47.425 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                   | 0/634 [00:00<?, ?it/s]2024-10-24 15:05:47.454 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:05:47.455 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 15:05:49.605 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:05:49.606 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████| 634/634 [03:44<00:00,  2.83it/s]
100%|█████████████████████████████████████████| 634/634 [03:44<00:00,  2.82it/s]
100%|█████████████████████████████████████████| 634/634 [03:44<00:00,  2.82it/s]
100%|█████████████████████████████████████████| 634/634 [03:44<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|████████████████████| 2/2 [00:01<00:00,  1.06it/s]2024-10-24 15:09:36.261 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:09:36.262 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:09:36.262 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:09:36.262 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:09:36.281 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 15:09:36.281 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:09:36.286 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 15:09:36.287 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:09:36.288 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 15:09:36.288 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:09:36.290 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 15:09:36.291 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:09:36.291 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████| 2/2 [00:01<00:00,  1.04it/s]
2024-10-24 15:09:38.135 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
2024-10-24 15:09:38.199 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 15:09:38.199 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-10-24 15:09:38.640 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-24 15:09:38.640 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-10-24 15:09:38.654 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-24 15:09:38.655 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-10-24 15:09:38.691 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-24 15:09:38.691 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-10-24 15:09:38.760 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 15:09:38.768 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/test.json
100%|██████████████████████████████████████| 308/308 [00:00<00:00, 58888.89it/s]
2024-10-24 15:09:38.774 | INFO     | __main__:main:1716 - R@1 = 34.42646606581033 %, R@10 = 78.14113027227782 %, MRR = 0.6347520978666055
2024-10-24 15:09:38.775 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 15:09:39.152 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-10-24 15:09:39.153 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 15:09:53.366 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 50881
2024-10-24 15:09:53.377 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 785
2024-10-24 15:09:53.419 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 50881
2024-10-24 15:09:54.587 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 50881
2024-10-24 15:09:54.594 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 785
2024-10-24 15:09:54.662 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 785
2024-10-24 15:09:54.940 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 50881
2024-10-24 15:09:54.949 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 785
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-10-24 15:09:58.596 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:09:58.597 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1003 [00:00<?, ?it/s]2024-10-24 15:09:58.695 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:09:58.706 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/1003 [00:00<01:14, 13.40it/s]2024-10-24 15:09:58.832 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:09:58.833 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 15:10:00.041 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:10:00.041 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████| 1003/1003 [05:00<00:00,  3.34it/s]
100%|███████████████████████████████████████| 1003/1003 [05:00<00:00,  3.34it/s]
100%|███████████████████████████████████████| 1003/1003 [05:01<00:00,  3.33it/s]
100%|███████████████████████████████████████| 1003/1003 [05:01<00:00,  3.33it/s]
Predicting DataLoader 0: 100%|████████████████████| 4/4 [00:06<00:00,  0.61it/s]2024-10-24 15:15:07.915 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:15:07.915 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:15:07.915 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:15:07.915 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-10-24 15:15:07.965 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-10-24 15:15:07.965 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:15:07.965 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-10-24 15:15:07.965 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:15:07.972 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-10-24 15:15:07.973 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:15:07.978 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-10-24 15:15:07.978 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-10-24 15:15:07.978 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████| 4/4 [00:06<00:00,  0.60it/s]
2024-10-24 15:15:09.907 | INFO     | retrieval.main:run_cli:60 - PID: 2741637
2024-10-24 15:15:10.015 | INFO     | retrieval.main:run_cli:60 - PID: 2741636
2024-10-24 15:15:10.022 | INFO     | retrieval.main:run_cli:60 - PID: 2741635
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-10-24 15:15:10.428 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-24 15:15:10.428 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-10-24 15:15:10.479 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-24 15:15:10.479 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-10-24 15:15:10.482 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-24 15:15:10.482 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-10-24 15:15:10.708 | INFO     | __main__:main:1711 - Loaded the predictions pickle files
2024-10-24 15:15:10.723 | INFO     | __main__:main:1714 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/test.json
100%|██████████████████████████████████████| 589/589 [00:00<00:00, 42114.64it/s]
2024-10-24 15:15:10.738 | INFO     | __main__:main:1716 - R@1 = 32.49189407084144 %, R@10 = 70.47575231785758 %, MRR = 0.6155658274180564
2024-10-24 15:15:10.740 | INFO     | retrieval.main:run_cli:60 - PID: 2729974
[rank: 0] Seed set to 3407
2024-10-24 15:15:11.119 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-10-24 15:15:11.119 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-10-24 15:15:29.005 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 166257
2024-10-24 15:15:29.036 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2463
2024-10-24 15:15:29.949 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 166257
2024-10-24 15:15:32.186 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2463
2024-10-24 15:15:33.328 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 166257
2024-10-24 15:15:33.346 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2463
2024-10-24 15:15:33.501 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 166257
2024-10-24 15:15:33.522 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 2463
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a_lambda_0.1_epoch=13-Recall@10_val=69.72.ckpt
2024-10-24 15:15:36.852 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:15:36.855 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                          | 2/1805 [00:00<02:13, 13.49it/s]2024-10-24 15:15:37.072 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:15:37.073 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                  | 0/1805 [00:00<?, ?it/s]2024-10-24 15:15:37.213 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:15:37.214 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                             | 0/? [00:00<?, ?it/s]2024-10-24 15:15:38.454 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-10-24 15:15:38.455 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
 82%|████████████████████████████████▏      | 1487/1805 [07:47<01:20,  3.95it/s]
 82%|████████████████████████████████       | 1482/1805 [07:46<01:52,  2.88it/s]
