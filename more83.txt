2024-09-21 08:40:32.057 | INFO     | retrieval.model:validation_step:372 - Recall@24_val: 89.28571428571429
2024-09-21 08:40:32.057 | INFO     | retrieval.model:validation_step:372 - Recall@25_val: 89.28571428571429
2024-09-21 08:40:32.057 | INFO     | retrieval.model:validation_step:372 - Recall@26_val: 89.28571428571429
2024-09-21 08:40:32.058 | INFO     | retrieval.model:validation_step:372 - Recall@27_val: 89.28571428571429
2024-09-21 08:40:32.058 | INFO     | retrieval.model:validation_step:372 - Recall@28_val: 89.28571428571429
2024-09-21 08:40:32.058 | INFO     | retrieval.model:validation_step:372 - Recall@29_val: 89.28571428571429
2024-09-21 08:40:32.059 | INFO     | retrieval.model:validation_step:372 - Recall@30_val: 89.28571428571429
2024-09-21 08:40:32.059 | INFO     | retrieval.model:validation_step:372 - Recall@31_val: 89.28571428571429
2024-09-21 08:40:32.059 | INFO     | retrieval.model:validation_step:372 - Recall@32_val: 89.28571428571429
2024-09-21 08:40:32.060 | INFO     | retrieval.model:validation_step:372 - Recall@33_val: 89.28571428571429
2024-09-21 08:40:32.060 | INFO     | retrieval.model:validation_step:372 - Recall@34_val: 89.28571428571429
2024-09-21 08:40:32.060 | INFO     | retrieval.model:validation_step:372 - Recall@35_val: 89.28571428571429
2024-09-21 08:40:32.061 | INFO     | retrieval.model:validation_step:372 - Recall@36_val: 89.28571428571429
2024-09-21 08:40:32.061 | INFO     | retrieval.model:validation_step:372 - Recall@37_val: 89.28571428571429
2024-09-21 08:40:32.061 | INFO     | retrieval.model:validation_step:372 - Recall@38_val: 89.28571428571429
2024-09-21 08:40:32.061 | INFO     | retrieval.model:validation_step:372 - Recall@39_val: 89.28571428571429
2024-09-21 08:40:32.062 | INFO     | retrieval.model:validation_step:372 - Recall@40_val: 89.28571428571429
2024-09-21 08:40:32.062 | INFO     | retrieval.model:validation_step:372 - Recall@41_val: 89.28571428571429
2024-09-21 08:40:32.062 | INFO     | retrieval.model:validation_step:372 - Recall@42_val: 89.28571428571429
2024-09-21 08:40:32.063 | INFO     | retrieval.model:validation_step:372 - Recall@43_val: 89.28571428571429
2024-09-21 08:40:32.063 | INFO     | retrieval.model:validation_step:372 - Recall@44_val: 89.28571428571429
2024-09-21 08:40:32.063 | INFO     | retrieval.model:validation_step:372 - Recall@45_val: 89.28571428571429
2024-09-21 08:40:32.064 | INFO     | retrieval.model:validation_step:372 - Recall@46_val: 89.28571428571429
2024-09-21 08:40:32.064 | INFO     | retrieval.model:validation_step:372 - Recall@47_val: 89.28571428571429
2024-09-21 08:40:32.064 | INFO     | retrieval.model:validation_step:372 - Recall@48_val: 89.28571428571429
2024-09-21 08:40:32.065 | INFO     | retrieval.model:validation_step:372 - Recall@49_val: 89.28571428571429
2024-09-21 08:40:32.065 | INFO     | retrieval.model:validation_step:372 - Recall@50_val: 89.28571428571429
2024-09-21 08:40:32.065 | INFO     | retrieval.model:validation_step:372 - Recall@51_val: 89.28571428571429
2024-09-21 08:40:32.065 | INFO     | retrieval.model:validation_step:372 - Recall@52_val: 89.28571428571429
2024-09-21 08:40:32.066 | INFO     | retrieval.model:validation_step:372 - Recall@53_val: 90.87301587301587
2024-09-21 08:40:32.066 | INFO     | retrieval.model:validation_step:372 - Recall@54_val: 90.87301587301587
2024-09-21 08:40:32.066 | INFO     | retrieval.model:validation_step:372 - Recall@55_val: 90.87301587301587
2024-09-21 08:40:32.067 | INFO     | retrieval.model:validation_step:372 - Recall@56_val: 90.87301587301587
2024-09-21 08:40:32.067 | INFO     | retrieval.model:validation_step:372 - Recall@57_val: 90.87301587301587
2024-09-21 08:40:32.067 | INFO     | retrieval.model:validation_step:372 - Recall@58_val: 90.87301587301587
2024-09-21 08:40:32.068 | INFO     | retrieval.model:validation_step:372 - Recall@59_val: 90.87301587301587
2024-09-21 08:40:32.068 | INFO     | retrieval.model:validation_step:372 - Recall@60_val: 90.87301587301587
2024-09-21 08:40:32.068 | INFO     | retrieval.model:validation_step:372 - Recall@61_val: 90.87301587301587
2024-09-21 08:40:32.069 | INFO     | retrieval.model:validation_step:372 - Recall@62_val: 90.87301587301587
2024-09-21 08:40:32.069 | INFO     | retrieval.model:validation_step:372 - Recall@63_val: 90.87301587301587
2024-09-21 08:40:32.069 | INFO     | retrieval.model:validation_step:372 - Recall@64_val: 90.87301587301587
2024-09-21 08:40:32.069 | INFO     | retrieval.model:validation_step:372 - Recall@65_val: 90.87301587301587
2024-09-21 08:40:32.070 | INFO     | retrieval.model:validation_step:372 - Recall@66_val: 90.87301587301587
2024-09-21 08:40:32.070 | INFO     | retrieval.model:validation_step:372 - Recall@67_val: 90.87301587301587
2024-09-21 08:40:32.070 | INFO     | retrieval.model:validation_step:372 - Recall@68_val: 90.87301587301587
2024-09-21 08:40:32.071 | INFO     | retrieval.model:validation_step:372 - Recall@69_val: 90.87301587301587
2024-09-21 08:40:32.071 | INFO     | retrieval.model:validation_step:372 - Recall@70_val: 90.87301587301587
2024-09-21 08:40:32.071 | INFO     | retrieval.model:validation_step:372 - Recall@71_val: 90.87301587301587
2024-09-21 08:40:32.072 | INFO     | retrieval.model:validation_step:372 - Recall@72_val: 90.87301587301587
2024-09-21 08:40:32.072 | INFO     | retrieval.model:validation_step:372 - Recall@73_val: 90.87301587301587
2024-09-21 08:40:32.072 | INFO     | retrieval.model:validation_step:372 - Recall@74_val: 90.87301587301587
2024-09-21 08:40:32.073 | INFO     | retrieval.model:validation_step:372 - Recall@75_val: 90.87301587301587
2024-09-21 08:40:32.073 | INFO     | retrieval.model:validation_step:372 - Recall@76_val: 90.87301587301587
2024-09-21 08:40:32.073 | INFO     | retrieval.model:validation_step:372 - Recall@77_val: 90.87301587301587
2024-09-21 08:40:32.073 | INFO     | retrieval.model:validation_step:372 - Recall@78_val: 90.87301587301587
2024-09-21 08:40:32.074 | INFO     | retrieval.model:validation_step:372 - Recall@79_val: 90.87301587301587
2024-09-21 08:40:32.074 | INFO     | retrieval.model:validation_step:372 - Recall@80_val: 90.87301587301587
2024-09-21 08:40:32.074 | INFO     | retrieval.model:validation_step:372 - Recall@81_val: 90.87301587301587
2024-09-21 08:40:32.075 | INFO     | retrieval.model:validation_step:372 - Recall@82_val: 90.87301587301587
2024-09-21 08:40:32.075 | INFO     | retrieval.model:validation_step:372 - Recall@83_val: 90.87301587301587
2024-09-21 08:40:32.075 | INFO     | retrieval.model:validation_step:372 - Recall@84_val: 90.87301587301587
2024-09-21 08:40:32.076 | INFO     | retrieval.model:validation_step:372 - Recall@85_val: 90.87301587301587
2024-09-21 08:40:32.076 | INFO     | retrieval.model:validation_step:372 - Recall@86_val: 90.87301587301587
2024-09-21 08:40:32.076 | INFO     | retrieval.model:validation_step:372 - Recall@87_val: 90.87301587301587
2024-09-21 08:40:32.077 | INFO     | retrieval.model:validation_step:372 - Recall@88_val: 90.87301587301587
2024-09-21 08:40:32.077 | INFO     | retrieval.model:validation_step:372 - Recall@89_val: 90.87301587301587
2024-09-21 08:40:32.077 | INFO     | retrieval.model:validation_step:372 - Recall@90_val: 90.87301587301587
2024-09-21 08:40:32.077 | INFO     | retrieval.model:validation_step:372 - Recall@91_val: 90.87301587301587
2024-09-21 08:40:32.078 | INFO     | retrieval.model:validation_step:372 - Recall@92_val: 90.87301587301587
2024-09-21 08:40:32.078 | INFO     | retrieval.model:validation_step:372 - Recall@93_val: 90.87301587301587
2024-09-21 08:40:32.078 | INFO     | retrieval.model:validation_step:372 - Recall@94_val: 90.87301587301587
2024-09-21 08:40:32.079 | INFO     | retrieval.model:validation_step:372 - Recall@95_val: 90.87301587301587
2024-09-21 08:40:32.079 | INFO     | retrieval.model:validation_step:372 - Recall@96_val: 90.87301587301587
2024-09-21 08:40:32.079 | INFO     | retrieval.model:validation_step:372 - Recall@97_val: 90.87301587301587
2024-09-21 08:40:32.080 | INFO     | retrieval.model:validation_step:372 - Recall@98_val: 90.87301587301587
2024-09-21 08:40:32.080 | INFO     | retrieval.model:validation_step:372 - Recall@99_val: 90.87301587301587
2024-09-21 08:40:32.080 | INFO     | retrieval.model:validation_step:372 - Recall@100_val: 90.87301587301587
2024-09-21 08:40:32.081 | INFO     | retrieval.model:validation_step:381 - MRR: 0.6645502645502644
2024-09-21 08:40:32.081 | INFO     | retrieval.model:validation_step:389 - End of validation_step
Epoch 6: 100%|███████████████████████████████████████████████████████████████████| 9431/9431 [1:03:40<00:00,  2.47it/s, v_num=0]
Epoch 6, global step 20124: 'Recall@10_val' reached 69.23007 (best 71.53125), saving model to '/data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=
6-Recall@10_val=69.23.ckpt' as top 7
`Trainer.fit` stopped: `max_epochs=7` reached.
Epoch 6: 100%|███████████████████████████████████████████████████████████████████| 9431/9431 [1:03:43<00:00,  2.47it/s, v_num=0]
2024-09-21 08:40:37.897 | INFO     | __main__:main:1936 - hit the barrier after training
2024-09-21 08:40:37.911 | INFO     | __main__:main:1936 - hit the barrier after training
2024-09-21 08:40:38.128 | INFO     | __main__:main:1936 - hit the barrier after training
2024-09-21 08:40:38.417 | INFO     | __main__:main:1936 - hit the barrier after training
2024-09-21 08:40:38.418 | INFO     | __main__:main:1942 - Finished progressive training at epoch 7
2024-09-21 08:40:38.418 | INFO     | __main__:main:1942 - Finished progressive training at epoch 7
2024-09-21 08:40:38.418 | INFO     | __main__:main:1942 - Finished progressive training at epoch 7
2024-09-21 08:40:38.418 | INFO     | __main__:main:1942 - Finished progressive training at epoch 7
2024-09-21 08:40:38.419 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:main:1949 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:main:1949 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:main:1949 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 08:40:38.419 | INFO     | __main__:main:1949 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 08:40:45.710 | INFO     | __main__:main:1959 - Testing...
2024-09-21 08:40:45.713 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
2024-09-21 08:40:45.760 | INFO     | __main__:main:1959 - Testing...
2024-09-21 08:40:45.764 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
2024-09-21 08:40:45.772 | INFO     | __main__:main:1959 - Testing...
2024-09-21 08:40:45.772 | INFO     | __main__:main:1959 - Testing...
2024-09-21 08:40:45.777 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
2024-09-21 08:40:45.782 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
[rank: 0] Seed set to 3407
2024-09-21 08:40:45.937 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f5
15a0e52878/random
2024-09-21 08:40:45.937 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413
f515a0e52878/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-21 08:40:45.963 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f5
15a0e52878/random
2024-09-21 08:40:45.963 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413
f515a0e52878/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarnin
g: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transform
ers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transfo
rmers/issues/31884
  warnings.warn(
[rank: 2] Seed set to 3407
2024-09-21 08:40:46.058 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f5
15a0e52878/random
2024-09-21 08:40:46.058 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413
f515a0e52878/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-21 08:40:46.065 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f5
15a0e52878/random
2024-09-21 08:40:46.065 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413
f515a0e52878/corpus.jsonl
2024-09-21 08:40:46.513 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f515a0e52878/
corpus.jsonl
2024-09-21 08:40:46.515 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f515a0e52878/
corpus.jsonl
2024-09-21 08:40:46.576 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f515a0e52878/
corpus.jsonl
2024-09-21 08:40:46.621 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f515a0e52878/
corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `s
run` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your pyt
hon command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-21 08:40:59.737 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_train/cached_data.pkl
Training dataset size: 165974
2024-09-21 08:40:59.755 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_pred/cached_data.pkl
Testing dataset size: 2472
2024-09-21 08:41:01.878 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_train/cached_data.pkl
Training dataset size: 165974
2024-09-21 08:41:01.893 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_pred/cached_data.pkl
Testing dataset size: 2472
2024-09-21 08:41:02.720 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_train/cached_data.pkl
Training dataset size: 165974
2024-09-21 08:41:02.738 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_pred/cached_data.pkl
Testing dataset size: 2472
2024-09-21 08:41:03.293 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_train/cached_data.pkl
Training dataset size: 165974
2024-09-21 08:41:03.314 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c
5fb29413f515a0e52878/random/cache_pred/cached_data.pkl
Testing dataset size: 2472
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-21 08:41:06.714 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:41:06.715 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/1714 [00:00<?, ?it/s]
2024-09-21 08:41:06.819 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:41:06.820 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/1714 [00:00<01:56, 14.66it/s]
2024-09-21 08:41:06.862 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:41:06.868 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 08:41:07.391 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:41:07.391 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 1714/1714 [09:05<00:00,  3.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1714/1714 [09:07<00:00,  3.13it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1714/1714 [09:10<00:00,  3.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1714/1714 [09:10<00:00,  3.11it/s]
Predicting DataLoader 0:   0%|                                                                           | 0/10 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict re
turned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████| 10/10 [00:27<00:00,  0.37it/s]
2024-09-21 08:50:45.005 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 08:50:45.005 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 08:50:45.005 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 08:50:45.005 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 08:50:45.144 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 08:50:45.144 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 08:50:45.144 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 08:50:45.144 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 08:50:45.176 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 08:50:45.176 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 08:50:45.181 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 08:50:45.181 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 08:50:45.181 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████| 10/10 [00:27<00:00,  0.37it/s]
2024-09-21 08:50:45.739 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
2024-09-21 08:50:45.800 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
2024-09-21 08:50:45.884 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
[rank: 1] Seed set to 3407
2024-09-21 08:50:46.033 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-09-21 08:50:46.033 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-21 08:50:46.075 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-09-21 08:50:46.075 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-21 08:50:46.166 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-09-21 08:50:46.167 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-09-21 08:50:46.497 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 08:50:46.529 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_Formalisation-of-constructable-numbers_01ef1f22a04f2ba8081c5fb29413f515a0e52878/random/test.
json
100%|████████████████████████████████████████████████████████████████████████████████████| 1481/1481 [00:00<00:00, 53435.45it/s]
2024-09-21 08:50:46.557 | INFO     | __main__:main:1988 - R@1 = 26.548660891939836 %, R@10 = 66.51127894758307 %, MRR = 0.572675
978668844
2024-09-21 08:50:46.558 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
2024-09-21 08:50:46.577 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-09-21 08:50:46.666 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-09-21 08:50:46.734 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-21 08:50:46.756 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random
2024-09-21 08:50:46.756 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
2024-09-21 08:50:47.296 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-21 08:51:01.376 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_train/cached_data.pkl
Training dataset size: 140605
2024-09-21 08:51:01.406 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2195
2024-09-21 08:51:02.537 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_train/cached_data.pkl
Training dataset size: 140605
2024-09-21 08:51:02.550 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2195
2024-09-21 08:51:02.991 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_train/cached_data.pkl
Training dataset size: 140605
2024-09-21 08:51:03.003 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2195
2024-09-21 08:51:03.880 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_train/cached_data.pkl
Training dataset size: 140605
2024-09-21 08:51:06.986 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2195
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-21 08:51:11.824 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:51:11.825 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/1711 [00:00<?, ?it/s]
2024-09-21 08:51:11.884 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:51:11.885 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/1711 [00:00<02:29, 11.44it/s]
2024-09-21 08:51:12.005 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:51:12.006 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 08:51:12.903 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 08:51:12.903 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:11<00:00,  3.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:13<00:00,  3.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:17<00:00,  3.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1711/1711 [09:17<00:00,  3.07it/s]
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:21<00:00,  0.43it/s]
2024-09-21 09:00:51.267 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:00:51.267 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:00:51.386 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 09:00:51.387 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:00:51.433 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 09:00:51.433 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:00:51.886 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:00:51.886 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:00:52.005 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 09:00:52.006 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:00:52.038 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 09:00:52.039 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:00:52.039 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:21<00:00,  0.41it/s]
2024-09-21 09:00:52.689 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
2024-09-21 09:00:52.747 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
2024-09-21 09:00:52.764 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
[rank: 3] Seed set to 3407
2024-09-21 09:00:52.980 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-09-21 09:00:52.980 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-21 09:00:53.015 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-09-21 09:00:53.015 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-21 09:00:53.040 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-09-21 09:00:53.040 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 09:00:53.445 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 09:00:53.479 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████| 1421/1421 [00:00<00:00, 58655.53it/s]
2024-09-21 09:00:53.504 | INFO     | __main__:main:1988 - R@1 = 26.775090067071762 %, R@10 = 67.3518898619551 %, MRR = 0.5718571
88295938
2024-09-21 09:00:53.506 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
2024-09-21 09:00:53.523 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 09:00:53.574 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 09:00:53.607 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-21 09:00:53.710 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-09-21 09:00:53.710 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 09:00:54.286 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-21 09:01:19.788 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 09:01:19.811 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 09:01:21.428 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 09:01:21.441 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 09:01:21.527 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 09:01:21.537 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 09:01:22.190 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 09:01:22.206 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-21 09:01:25.276 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:01:25.282 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/1994 [00:00<02:03, 16.11it/s]
2024-09-21 09:01:25.437 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:01:25.438 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/1994 [00:00<?, ?it/s]
2024-09-21 09:01:25.487 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:01:25.487 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 09:01:26.292 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:01:26.293 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:17<00:00,  3.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:19<00:00,  3.56it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:23<00:00,  3.54it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1994/1994 [09:23<00:00,  3.54it/s]
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:23<00:00,  0.39it/s]
2024-09-21 09:11:12.833 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:11:12.833 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:11:12.833 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:11:12.833 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:11:12.914 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 09:11:12.914 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:11:12.915 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 09:11:12.915 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:11:12.947 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 09:11:12.947 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:11:12.955 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 09:11:12.955 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:11:12.956 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:23<00:00,  0.38it/s]
2024-09-21 09:11:13.709 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
2024-09-21 09:11:13.764 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
[rank: 2] Seed set to 3407
2024-09-21 09:11:14.003 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-09-21 09:11:14.004 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-09-21 09:11:14.045 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
[rank: 3] Seed set to 3407
2024-09-21 09:11:14.065 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-09-21 09:11:14.065 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-21 09:11:14.266 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-09-21 09:11:14.266 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-09-21 09:11:14.516 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 09:11:14.548 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/test.json
  0%|                                                                                                  | 0/1425 [00:00<?, ?it/s]
2024-09-21 09:11:14.553 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████████████| 1425/1425 [00:00<00:00, 54353.58it/s]
2024-09-21 09:11:14.575 | INFO     | __main__:main:1988 - R@1 = 27.708844413223975 %, R@10 = 69.5226413219114 %, MRR = 0.5865230
697826836
2024-09-21 09:11:14.576 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
[rank: 0] Seed set to 3407
2024-09-21 09:11:14.784 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-09-21 09:11:14.784 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-09-21 09:11:14.825 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-09-21 09:11:14.834 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-09-21 09:11:15.347 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-21 09:11:29.917 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_train/cached_data.pkl
Training dataset size: 164994
2024-09-21 09:11:29.941 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2520
2024-09-21 09:11:31.901 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_train/cached_data.pkl
Training dataset size: 164994
2024-09-21 09:11:31.917 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2520
2024-09-21 09:11:33.006 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_train/cached_data.pkl
Training dataset size: 164994
2024-09-21 09:11:33.029 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2520
2024-09-21 09:11:33.280 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_train/cached_data.pkl
Training dataset size: 164994
2024-09-21 09:11:33.301 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/ca
che_pred/cached_data.pkl
Testing dataset size: 2520
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-21 09:11:36.346 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:11:36.346 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/1709 [00:00<01:53, 14.99it/s]
2024-09-21 09:11:36.513 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:11:36.513 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/1709 [00:00<?, ?it/s]
2024-09-21 09:11:36.594 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:11:36.595 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 09:11:37.107 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:11:37.107 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:01<00:00,  3.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:03<00:00,  3.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:06<00:00,  3.13it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1709/1709 [09:06<00:00,  3.13it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  0.34it/s]
2024-09-21 09:21:12.791 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:21:12.791 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:21:12.791 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:21:12.791 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:21:12.926 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 09:21:12.926 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:21:12.936 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 09:21:12.936 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:21:12.958 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 09:21:12.958 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:21:12.959 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 09:21:12.959 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:21:12.960 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  0.34it/s]
2024-09-21 09:21:13.738 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
2024-09-21 09:21:13.798 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
2024-09-21 09:21:13.957 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
[rank: 2] Seed set to 3407
2024-09-21 09:21:14.090 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/rand
om
2024-09-21 09:21:14.090 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/co
rpus.jsonl
[rank: 3] Seed set to 3407
2024-09-21 09:21:14.115 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/rand
om
2024-09-21 09:21:14.115 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/co
rpus.jsonl
[rank: 1] Seed set to 3407
2024-09-21 09:21:14.198 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/rand
om
2024-09-21 09:21:14.198 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/co
rpus.jsonl
2024-09-21 09:21:14.606 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 09:21:14.645 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/test.json
2024-09-21 09:21:14.646 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/corpus.jsonl
  0%|                                                                                                  | 0/1477 [00:00<?, ?it/s]
2024-09-21 09:21:14.648 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████████████| 1477/1477 [00:00<00:00, 49163.83it/s]
2024-09-21 09:21:14.676 | INFO     | __main__:main:1988 - R@1 = 27.545180303618956 %, R@10 = 66.72930855466825 %, MRR = 0.573768
2553198041
2024-09-21 09:21:14.678 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
2024-09-21 09:21:14.729 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-21 09:21:14.895 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/rand
om
2024-09-21 09:21:14.895 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/co
rpus.jsonl
2024-09-21 09:21:15.473 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-21 09:21:25.797 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_train/cached_data.pkl
Training dataset size: 154567
2024-09-21 09:21:25.826 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_pred/cached_data.pkl
Testing dataset size: 2168
2024-09-21 09:21:27.279 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_train/cached_data.pkl
Training dataset size: 154567
2024-09-21 09:21:27.295 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_pred/cached_data.pkl
Testing dataset size: 2168
2024-09-21 09:21:29.082 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_train/cached_data.pkl
Training dataset size: 154567
2024-09-21 09:21:31.425 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_pred/cached_data.pkl
Testing dataset size: 2168
2024-09-21 09:21:33.748 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_train/cached_data.pkl
Training dataset size: 154567
2024-09-21 09:21:33.768 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450
612e6/random/cache_pred/cached_data.pkl
Testing dataset size: 2168
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 09:21:36.957 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:21:36.959 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/2029 [00:00<?, ?it/s]
2024-09-21 09:21:37.035 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:21:37.035 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/2029 [00:00<02:20, 14.39it/s]
2024-09-21 09:21:37.236 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:21:37.237 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 09:21:38.111 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:21:38.112 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 2029/2029 [09:20<00:00,  3.62it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 2029/2029 [09:22<00:00,  3.61it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 2029/2029 [09:25<00:00,  3.59it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 2029/2029 [09:25<00:00,  3.59it/s]
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:26<00:00,  0.35it/s]
2024-09-21 09:31:30.021 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:31:30.021 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:31:30.021 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:31:30.021 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:31:30.153 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 09:31:30.153 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:31:30.156 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 09:31:30.156 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:31:30.167 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 09:31:30.168 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:31:30.186 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 09:31:30.186 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:31:30.187 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:26<00:00,  0.34it/s]
2024-09-21 09:31:31.077 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
2024-09-21 09:31:31.105 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
2024-09-21 09:31:31.195 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
[rank: 1] Seed set to 3407
2024-09-21 09:31:31.341 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-09-21 09:31:31.341 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-21 09:31:31.386 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-09-21 09:31:31.386 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-21 09:31:31.456 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-09-21 09:31:31.456 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-09-21 09:31:31.842 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-09-21 09:31:31.849 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 09:31:31.884 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7ddf1d26beeea628c45450612e6/random/test.json
  0%|                                                                                                  | 0/1437 [00:00<?, ?it/s]
2024-09-21 09:31:31.890 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████████████| 1437/1437 [00:00<00:00, 57692.16it/s]
2024-09-21 09:31:31.910 | INFO     | __main__:main:1988 - R@1 = 29.523727134799067 %, R@10 = 71.48972716673704 %, MRR = 0.599091
015336897
2024-09-21 09:31:31.911 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
[rank: 0] Seed set to 3407
2024-09-21 09:31:32.109 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-09-21 09:31:32.109 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-09-21 09:31:32.124 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-09-21 09:31:32.666 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-21 09:31:46.020 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_train/cached_data.pkl
Training dataset size: 153572
2024-09-21 09:31:46.035 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-21 09:31:46.410 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_train/cached_data.pkl
Training dataset size: 153572
2024-09-21 09:31:46.423 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-21 09:31:53.172 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_train/cached_data.pkl
Training dataset size: 153572
2024-09-21 09:31:53.200 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_pred/cached_data.pkl
Testing dataset size: 2298
2024-09-21 09:32:03.339 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_train/cached_data.pkl
Training dataset size: 153572
2024-09-21 09:32:03.360 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
/cache_pred/cached_data.pkl
Testing dataset size: 2298
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 09:32:06.192 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:32:06.193 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/1758 [00:00<?, ?it/s]
2024-09-21 09:32:06.239 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:32:06.240 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/1758 [00:00<02:00, 14.55it/s]
2024-09-21 09:32:06.491 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:32:06.491 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 09:32:07.226 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:32:07.227 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:21<00:00,  3.13it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:22<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:26<00:00,  3.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 1758/1758 [09:26<00:00,  3.10it/s]
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:23<00:00,  0.38it/s]
2024-09-21 09:41:56.882 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:41:56.883 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:41:56.883 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:41:56.883 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 09:41:56.973 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 09:41:56.973 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:41:56.976 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 09:41:56.976 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:41:57.018 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 09:41:57.018 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:41:57.028 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 09:41:57.028 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 09:41:57.028 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████| 9/9 [00:23<00:00,  0.38it/s]
2024-09-21 09:41:58.052 | INFO     | retrieval.main:run_cli:60 - PID: 2378693
2024-09-21 09:41:58.060 | INFO     | retrieval.main:run_cli:60 - PID: 2378694
2024-09-21 09:41:58.078 | INFO     | retrieval.main:run_cli:60 - PID: 2378695
[rank: 2] Seed set to 3407
2024-09-21 09:41:58.316 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random
2024-09-21 09:41:58.316 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.j
sonl
[rank: 1] Seed set to 3407
2024-09-21 09:41:58.322 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random
2024-09-21 09:41:58.323 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.j
sonl
[rank: 3] Seed set to 3407
2024-09-21 09:41:58.354 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random
2024-09-21 09:41:58.354 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.j
sonl
2024-09-21 09:41:58.745 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 09:41:58.779 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████| 1493/1493 [00:00<00:00, 51227.04it/s]
2024-09-21 09:41:58.809 | INFO     | __main__:main:1988 - R@1 = 27.03540354222948 %, R@10 = 68.762049668193 %, MRR = 0.574560435
4596043
2024-09-21 09:41:58.811 | INFO     | retrieval.main:run_cli:60 - PID: 2376208
2024-09-21 09:41:58.835 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.jsonl
2024-09-21 09:41:58.878 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.jsonl
2024-09-21 09:41:58.880 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-21 09:41:59.010 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/data
sets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random
2024-09-21 09:41:59.010 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/da
tasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.j
sonl
2024-09-21 09:41:59.580 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-21 09:42:30.826 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-21 09:42:30.891 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-21 09:42:37.410 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-21 09:42:37.440 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-21 09:42:41.577 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-21 09:42:41.606 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_pred/cached_data.pkl
Testing dataset size: 5139
2024-09-21 09:42:42.456 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_train/cached_data.pkl
Training dataset size: 357252
2024-09-21 09:42:42.495 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/
random/cache_pred/cached_data.pkl
Testing dataset size: 5139
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merg
ed_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merge
d_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-21 09:42:45.727 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:42:45.728 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                                  | 0/2756 [00:00<?, ?it/s]
2024-09-21 09:42:45.779 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:42:45.780 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
  0%|                                                                                          | 2/2756 [00:00<03:47, 12.13it/s]
2024-09-21 09:42:46.067 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:42:46.068 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
Predicting: |                                                                                             | 0/? [00:00<?, ?it/s]
2024-09-21 09:42:46.749 | INFO     | retrieval.model:on_predict_start:400 - Embeddings staled on predict start: True
2024-09-21 09:42:46.749 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 2756/2756 [15:59<00:00,  2.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 2756/2756 [16:02<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 2756/2756 [16:08<00:00,  2.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████| 2756/2756 [16:07<00:00,  2.85it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████| 21/21 [01:08<00:00,  0.31it/s]
2024-09-21 10:00:02.864 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 10:00:02.864 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 10:00:02.864 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 10:00:02.864 | INFO     | retrieval.model:on_predict_epoch_end:503 - About to construct predictions map
2024-09-21 10:00:03.105 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-21 10:00:03.105 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 10:00:03.113 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-21 10:00:03.113 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 10:00:03.338 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-21 10:00:03.338 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 10:00:03.365 | INFO     | retrieval.model:on_predict_epoch_end:523 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-21 10:00:03.365 | INFO     | retrieval.model:on_predict_epoch_end:562 - About to call barrier
2024-09-21 10:00:03.366 | INFO     | retrieval.model:on_predict_epoch_end:566 - All GPUs have completed their predictions and sa
ved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████| 21/21 [01:08<00:00,  0.31it/s]
2024-09-21 10:00:04.471 | INFO     | __main__:main:2083 - Finished processing the repository
2024-09-21 10:00:04.471 | INFO     | __main__:main:2085 - current epoch: 7
2024-09-21 10:00:04.471 | INFO     | __main__:main:1772 - length of lean_git_repos: 2
2024-09-21 10:00:04.472 | INFO     | __main__:main:1773 - i: 1
2024-09-21 10:00:04.472 | INFO     | __main__:main:1801 - All GPUs
2024-09-21 10:00:04.474 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 10:00:04.474 | INFO     | __main__:main:1808 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 10:00:04.474 | INFO     | __main__:main:1814 - Inside train_test_fisher
2024-09-21 10:00:04.474 | INFO     | __main__:main:1815 - Starting training at epoch 7
[rank: 3] Seed set to 3407
2024-09-21 10:00:04.493 | INFO     | __main__:main:2083 - Finished processing the repository
2024-09-21 10:00:04.494 | INFO     | __main__:main:2085 - current epoch: 7
2024-09-21 10:00:04.494 | INFO     | __main__:main:1772 - length of lean_git_repos: 2
2024-09-21 10:00:04.495 | INFO     | __main__:main:1773 - i: 1
2024-09-21 10:00:04.495 | INFO     | __main__:main:1801 - All GPUs
2024-09-21 10:00:04.496 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 10:00:04.496 | INFO     | __main__:main:1808 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 10:00:04.496 | INFO     | __main__:main:1814 - Inside train_test_fisher
2024-09-21 10:00:04.496 | INFO     | __main__:main:1815 - Starting training at epoch 7
[rank: 1] Seed set to 3407
2024-09-21 10:00:04.590 | INFO     | __main__:main:2083 - Finished processing the repository
2024-09-21 10:00:04.591 | INFO     | __main__:main:2085 - current epoch: 7
2024-09-21 10:00:04.591 | INFO     | __main__:main:1772 - length of lean_git_repos: 2
2024-09-21 10:00:04.591 | INFO     | __main__:main:1773 - i: 1
2024-09-21 10:00:04.591 | INFO     | __main__:main:1801 - All GPUs
2024-09-21 10:00:04.593 | INFO     | __main__:find_latest_checkpoint:911 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 10:00:04.593 | INFO     | __main__:main:1808 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 10:00:04.593 | INFO     | __main__:main:1814 - Inside train_test_fisher
2024-09-21 10:00:04.593 | INFO     | __main__:main:1815 - Starting training at epoch 7
[rank: 2] Seed set to 3407
2024-09-21 10:00:05.804 | INFO     | __main__:main:1983 - Loaded the predictions pickle files
2024-09-21 10:00:05.880 | INFO     | __main__:main:1986 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc
_curriculum_sorries/merged_with_new_zeta_3_irrational_914712200e463cfc97fe37e929d518dd58806a38/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████| 2403/2403 [00:00<00:00, 35078.07it/s]
2024-09-21 10:00:05.950 | INFO     | __main__:main:1988 - R@1 = 23.014447475956505 %, R@10 = 61.452791890228845 %, MRR = 0.51518
40089036672
2024-09-21 10:00:05.951 | INFO     | __main__:main:2005 - Average R@1 = 26.878764832691367 %, R@10 = 67.40281248732525 %, MRR =
0.5705228502524913
2024-09-21 10:00:05.952 | INFO     | __main__:main:2020 - Starting the prover
2024-09-21 10:00:05.952 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-21 10:00:05.952 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-21 10:00:05.953 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-21 10:00:05.953 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_
ma/lean_project/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a
97_lambda_0.1_epoch=6-Recall@10_val=69.23.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, r
un `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-21 10:00:06.773 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=
6-Recall@10_val=69.23.ckpt
2024-09-21 10:00:06.773 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/chec
kpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=
6-Recall@10_val=69.23.ckpt
2024-09-21 10:00:12.613 | INFO     | __main__:main:1839 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_P
T_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@
10_val=69.23.ckpt
2024-09-21 10:00:12.615 | INFO     | __main__:find_latest_fisher:921 - Using the latest Fisher Information Matrix: /data/yingzi_
ma/lean_project/fisher_PT_single_repo_ewc_curriculum_sorries/fisher_info_merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7d
df1d26beeea628c45450612e6_distributed.pkl
2024-09-21 10:00:12.622 | INFO     | __main__:main:1839 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_P
T_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@
10_val=69.23.ckpt
2024-09-21 10:00:12.640 | INFO     | __main__:main:1839 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_P
T_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@
10_val=69.23.ckpt
2024-09-21 10:00:12.666 | INFO     | __main__:find_latest_fisher:921 - Using the latest Fisher Information Matrix: /data/yingzi_
ma/lean_project/fisher_PT_single_repo_ewc_curriculum_sorries/fisher_info_merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7d
df1d26beeea628c45450612e6_distributed.pkl
2024-09-21 10:00:12.666 | INFO     | __main__:find_latest_fisher:921 - Using the latest Fisher Information Matrix: /data/yingzi_
ma/lean_project/fisher_PT_single_repo_ewc_curriculum_sorries/fisher_info_merged_with_new_hairy-ball-theorem-lean_a778826d19c8a7d
df1d26beeea628c45450612e6_distributed.pkl
2024-09-21 10:00:13.699 | INFO     | __main__:load_fisher_information:897 - Fisher Information successfully loaded.
2024-09-21 10:00:13.700 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-21 10:00:13.700 | INFO     | __main__:main:1846 - Fisher Information Matrix loaded.
2024-09-21 10:00:13.713 | INFO     | __main__:load_fisher_information:897 - Fisher Information successfully loaded.
2024-09-21 10:00:13.713 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-21 10:00:13.713 | INFO     | __main__:main:1846 - Fisher Information Matrix loaded.
2024-09-21 10:00:13.713 | INFO     | __main__:load_fisher_information:897 - Fisher Information successfully loaded.
2024-09-21 10:00:13.714 | INFO     | retrieval.model:set_fisher_info:60 - Fisher Information has been updated in the model.
2024-09-21 10:00:13.714 | INFO     | __main__:main:1846 - Fisher Information Matrix loaded.
2024-09-21 10:00:13.925 | INFO     | __main__:main:1897 - right before barrier for data module
2024-09-21 10:00:13.926 | INFO     | __main__:main:1897 - right before barrier for data module
2024-09-21 10:00:13.926 | INFO     | __main__:main:1897 - right before barrier for data module
2024-09-21 10:00:14.275 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are
in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.embed_tokens.w
eight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAtten
tion.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.S
elfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.enc
oder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.we
ight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q
.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0
.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.
layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.en
coder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder
.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retrie
ver.encoder.encoder.block.2.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.
weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_
norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.enc
oder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retri
ever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight'
, 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.
weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.Dens
eReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder
.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.
encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retr
iever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'r
etriever.encoder.encoder.block.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.wei
ght', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.
weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.Dens
eReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.
6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.blo
ck.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.enc
oder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.
encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.Dens
eReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.bloc
k.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight', 'retriever.encoder.encoder
.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder
.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever
.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.w
o.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttent
ion.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.
SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1
0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encode
r.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retrieve
r.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'ret
riever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.wei
ght', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_nor
m.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.
DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.b
lock.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are
not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict', 'callback
s', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-21 10:00:15.191 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lig
htning.ckpt
2024-09-21 10:00:15.192 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-21 10:00:15.193 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project
/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 10:00:15.193 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 10:00:23.599 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-21 10:00:23.600 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/
datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 10:00:23.600 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████| 3988/3988 [05:29<00:00, 12.11it/s]
2024-09-21 10:05:53.014 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-09-21 10:05:53.015 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
2024-09-21 10:05:59,411 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=2494930) [2024-09-21 10:06:46,050] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto de
tect)
(ProverActor pid=2494930) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarn
ing: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impl
icitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://githu
b.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weig
hts_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will
no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_
safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the load
ed file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2494930)   return torch.load(io.BytesIO(b))
(pid=2495454) [2024-09-21 10:06:57,709] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto de
tect)
(ProverActor pid=2495454) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarn
ing: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impl
icitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://githu
b.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weig
hts_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will
no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_
safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the load
ed file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2495454)   return torch.load(io.BytesIO(b))
(pid=2495655) [2024-09-21 10:07:11,739] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto de
tect)
2024-09-21 10:07:13.210 | INFO     | __main__:prove_sorry_theorems:1216 - Found 15 sorry theorems to prove
Processing theorems from NUS-Math-Formalization/coxeter:   0%|                                      | 0/15 [00:00<?, ?theorem/s]
2024-09-21 10:07:13.211 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterGroup.Bruhat.fin_list_c
omplement_loop_bound
2024-09-21 10:07:13.212 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (199, 1)
2024-09-21 10:07:13.212 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.strong_exchange
2024-09-21 10:07:13.212 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (182, 1)
2024-09-21 10:07:13.212 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.Presentation.len
gth_eq
2024-09-21 10:07:13.212 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (179, 1)
2024-09-21 10:07:13.212 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterGroup.Bruhat.le_iff_exi
sts_reduced_subword
2024-09-21 10:07:13.213 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (242, 1)
2024-09-21 10:07:13.213 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterGroup.Bruhat.exists_int
ermediate_reduced_subword
2024-09-21 10:07:13.213 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (222, 1)
2024-09-21 10:07:13.213 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.monoidLift.mapLi
ft.of
2024-09-21 10:07:13.214 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (76, 1)
2024-09-21 10:07:13.214 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.Presentation.red
uced_iff
2024-09-21 10:07:13.214 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (177, 1)
2024-09-21 10:07:13.214 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.Presentation.inv
map_surjective
2024-09-21 10:07:13.214 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (141, 1)
2024-09-21 10:07:13.214 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.Presentation.inv
map_injective
2024-09-21 10:07:13.215 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (138, 1)
2024-09-21 10:07:13.215 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.Presentation.gpr
od_eq
2024-09-21 10:07:13.215 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (170, 1)
2024-09-21 10:07:13.215 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.Presentation.inv
map.of_eq
2024-09-21 10:07:13.215 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (117, 1)
2024-09-21 10:07:13.215 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterSystem.monoidLift.aux_s
ymm_of_power
2024-09-21 10:07:13.216 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (68, 1)
2024-09-21 10:07:13.216 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=2494930) 2024-09-21 10:07:13.237 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.le_iff_exists_reduced_subword')
(ProverActor pid=2495454) 2024-09-21 10:07:17.086 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.length_eq')
(ProverActor pid=2495655) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarn
ing: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impl
icitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://githu
b.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weig
hts_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will
no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_
safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the load
ed file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2495655)   return torch.load(io.BytesIO(b))
(pid=2495835) [2024-09-21 10:07:23,935] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto de
tect)
(ProverActor pid=2495655) 2024-09-21 10:07:28.752 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.strong_exchange')
(ProverActor pid=2495835) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarn
ing: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module impl
icitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://githu
b.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weig
hts_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will
no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_
safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the load
ed file. Please open an issue on GitHub for any issues related to this experimental feature.
(ProverActor pid=2495835)   return torch.load(io.BytesIO(b))
(ProverActor pid=2495835) 2024-09-21 10:07:42.515 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.fin_list_complement_loop_bound')
(ProverActor pid=2494930) 2024-09-21 10:08:25.494 | WARNING  | prover.proof_search:search:132 - EOF
(ProverActor pid=2494930) 2024-09-21 10:08:25.502 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.exists_intermediate_reduced_subword')
(ProverActor pid=2495454) 2024-09-21 10:18:15.568 | INFO     | prover.proof_search:_best_first_search:149 - 3575864.734945465
(ProverActor pid=2495454) 2024-09-21 10:18:15.569 | INFO     | prover.proof_search:_best_first_search:150 - 3575264.736566384
(ProverActor pid=2495454) 2024-09-21 10:18:15.569 | INFO     | prover.proof_search:_best_first_search:151 - 599.9988373410888
(ProverActor pid=2495454) 2024-09-21 10:18:15.569 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2495454) 2024-09-21 10:18:15.571 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495454) 2024-09-21 10:18:26.566 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.length_eq'), status=<Status.OPEN: 'Open'>,
proof=None, actor_time=524.8222365793772, environment_time=59.08183537470177, total_time=601.0006547211669, num_total_nodes=424,
 num_searched_nodes=15)
(ProverActor pid=2495454) 2024-09-21 10:18:26.573 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.monoidLift.mapLift.of')
(ProverActor pid=2495655) 2024-09-21 10:18:20.523 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x acr
oss cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en
/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ProverActor pid=2495655) 2024-09-21 10:18:20.525 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495655) 2024-09-21 10:18:30.450 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.strong_exchange'), status=<Status.OPEN: 'Open'>, proof=N
one, actor_time=466.02321535674855, environment_time=112.83515203651041, total_time=600.9996465179138, num_total_nodes=818, num_
searched_nodes=19)
(ProverActor pid=2495655) 2024-09-21 10:18:30.457 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.reduced_iff')
(ProverActor pid=2495835) 2024-09-21 10:18:40.383 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495835) 2024-09-21 10:18:40.381 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x acr
oss cluster]
(ProverActor pid=2495835) 2024-09-21 10:18:50.454 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.fin_list_complement_loop_bound'), status=<Status.OPEN
: 'Open'>, proof=None, actor_time=510.74694161722437, environment_time=73.06707162968814, total_time=601.0010449718684, num_tota
l_nodes=545, num_searched_nodes=16)
(ProverActor pid=2495835) 2024-09-21 10:18:50.463 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.invmap_surjective')
(ProverActor pid=2494930) 2024-09-21 10:19:26.236 | INFO     | prover.proof_search:_best_first_search:149 - 3575935.403033732
(ProverActor pid=2494930) 2024-09-21 10:19:26.237 | INFO     | prover.proof_search:_best_first_search:150 - 3575335.406141921
(ProverActor pid=2494930) 2024-09-21 10:19:26.237 | INFO     | prover.proof_search:_best_first_search:151 - 599.9976692972705
(ProverActor pid=2494930) 2024-09-21 10:19:26.237 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2494930) 2024-09-21 10:19:26.237 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2494930) 2024-09-21 10:19:40.393 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.exists_intermediate_reduced_subword'), status=<Status
.OPEN: 'Open'>, proof=None, actor_time=143.40358762815595, environment_time=447.59176884265617, total_time=600.9979206132703, nu
m_total_nodes=1752, num_searched_nodes=51)
(ProverActor pid=2494930) 2024-09-21 10:19:40.400 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.invmap_injective')
(ProverActor pid=2495655) 2024-09-21 10:29:27.099 | INFO     | prover.proof_search:_best_first_search:149 - 3576536.265286672
(ProverActor pid=2495655) 2024-09-21 10:29:27.099 | INFO     | prover.proof_search:_best_first_search:150 - 3575936.269229577
(ProverActor pid=2495655) 2024-09-21 10:29:27.099 | INFO     | prover.proof_search:_best_first_search:151 - 599.996725960169
(ProverActor pid=2495655) 2024-09-21 10:29:27.099 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2495655) 2024-09-21 10:29:27.100 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495655) 2024-09-21 10:29:37.225 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.reduced_iff'), status=<Status.OPEN: 'Open'>
, proof=None, actor_time=397.83649909263477, environment_time=155.70708920573816, total_time=600.9973287419416, num_total_nodes=
365, num_searched_nodes=11)
(ProverActor pid=2495655) 2024-09-21 10:29:37.232 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.gprod_eq')
(ProverActor pid=2495454) 2024-09-21 10:29:50.408 | INFO     | prover.proof_search:_best_first_search:149 - 3576559.575129148
(ProverActor pid=2495454) 2024-09-21 10:29:50.409 | INFO     | prover.proof_search:_best_first_search:150 - 3575959.575319779
(ProverActor pid=2495454) 2024-09-21 10:29:50.409 | INFO     | prover.proof_search:_best_first_search:151 - 600.0004058727063
(ProverActor pid=2495454) 2024-09-21 10:29:50.409 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2495454) 2024-09-21 10:29:50.412 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495454) 2024-09-21 10:30:03.786 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.monoidLift.mapLift.of'), status=<Status.OPEN: 'Open'>, p
roof=None, actor_time=446.61997175076976, environment_time=122.7010350478813, total_time=601.0034992396832, num_total_nodes=300,
 num_searched_nodes=12)
(ProverActor pid=2495454) 2024-09-21 10:30:03.793 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.invmap.of_eq')
(ProverActor pid=2495835) 2024-09-21 10:29:51.449 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x acr
oss cluster]
(ProverActor pid=2495835) 2024-09-21 10:29:51.449 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495835) 2024-09-21 10:30:04.623 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.invmap_surjective'), status=<Status.OPEN: '
Open'>, proof=None, actor_time=224.51594716869295, environment_time=6.926279661711305, total_time=600.9981152019463, num_total_n
odes=381, num_searched_nodes=8)
(ProverActor pid=2495835) 2024-09-21 10:30:04.630 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.monoidLift.aux_symm_of_power')
(ProverActor pid=2494930) 2024-09-21 10:30:35.803 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2494930) 2024-09-21 10:30:35.803 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 4x acr
oss cluster]
(ProverActor pid=2494930) 2024-09-21 10:30:50.155 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.invmap_injective'), status=<Status.OPEN: 'O
pen'>, proof=None, actor_time=193.6457851594314, environment_time=397.98069278150797, total_time=600.9970693751238, num_total_no
des=1825, num_searched_nodes=57)
(ProverActor pid=2495835) 2024-09-21 10:40:58.297 | INFO     | prover.proof_search:_best_first_search:149 - 3577227.463770824
(ProverActor pid=2495835) 2024-09-21 10:40:58.297 | INFO     | prover.proof_search:_best_first_search:150 - 3576627.466353593
(ProverActor pid=2495835) 2024-09-21 10:40:58.298 | INFO     | prover.proof_search:_best_first_search:151 - 599.9979827529751
(ProverActor pid=2495835) 2024-09-21 10:40:58.298 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2495835) 2024-09-21 10:40:58.299 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495835) 2024-09-21 10:41:08.263 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.monoidLift.aux_symm_of_power'), status=<Status.OPEN: 'Op
en'>, proof=None, actor_time=554.9023046889342, environment_time=26.015766597352922, total_time=600.9994207751006, num_total_nod
es=614, num_searched_nodes=18)
(ProverActor pid=2495655) 2024-09-21 10:41:02.909 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 8x acr
oss cluster]
(ProverActor pid=2495655) 2024-09-21 10:41:02.910 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions). [repeated 2x across cluster]
(ProverActor pid=2495655) 2024-09-21 10:41:14.557 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.gprod_eq'), status=<Status.OPEN: 'Open'>, p
roof=None, actor_time=539.7119962405413, environment_time=54.71133083710447, total_time=600.9993433072232, num_total_nodes=414,
num_searched_nodes=15)
2024-09-21 10:41:21.233 | WARNING  | __main__:process_theorem_batch:1166 - Unexpected result type
2024-09-21 10:41:21.233 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.Presentation.length_
eq
2024-09-21 10:41:21.233 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.strong_exchange
2024-09-21 10:41:21.233 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterGroup.Bruhat.fin_list_compl
ement_loop_bound
2024-09-21 10:41:21.233 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterGroup.Bruhat.exists_interme
diate_reduced_subword
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.Presentation.reduced
_iff
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.monoidLift.mapLift.o
f
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.Presentation.invmap_
surjective
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.Presentation.invmap_
injective
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.monoidLift.aux_symm_
of_power
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.Presentation.gprod_e
q
2024-09-21 10:41:21.234 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterSystem.Presentation.invmap.
of_eq
(ProverActor pid=2495454) 2024-09-21 10:41:21.231 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/StrongExchange.lean'), full_name='CoxeterSystem.Presentation.invmap.of_eq'), status=<Status.OPEN: 'Open'
>, proof=None, actor_time=554.8610601252876, environment_time=21.08099259948358, total_time=601.0011762678623, num_total_nodes=2
86, num_searched_nodes=13)
2024-09-21 10:43:06.355 | INFO     | __main__:save_progress:1171 - Saving encountered theorems...
Processing theorems from NUS-Math-Formalization/coxeter:  80%|██████████████████████▍     | 12/15 [35:53<08:58, 179.43s/theorem]
2024-09-21 10:43:06.357 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterGroup.Bruhat.fin_list_c
omplement_incr
2024-09-21 10:43:06.357 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (203, 1)
2024-09-21 10:43:06.357 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterGroup.Bruhat.le_aux
2024-09-21 10:43:06.358 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (238, 1)
2024-09-21 10:43:06.358 | INFO     | __main__:prove_sorry_theorems:1239 - Searching for proof for CoxeterGroup.Bruhat.fin_list_c
omplement_complement
2024-09-21 10:43:06.358 | INFO     | __main__:prove_sorry_theorems:1240 - Position: (215, 1)
Processing theorems from NUS-Math-Formalization/coxeter: 100%|████████████████████████████| 15/15 [35:53<00:00, 143.54s/theorem]
2024-09-21 10:43:06.358 | INFO     | prover.proof_search:search_unordered:513 - Distributed
(ProverActor pid=2495454) 2024-09-21 10:43:06.362 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.fin_list_complement_incr')
(ProverActor pid=2495655) 2024-09-21 10:43:06.364 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.le_aux')
(ProverActor pid=2495835) 2024-09-21 10:43:06.365 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(
url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_path=PosixPath
('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.fin_list_complement_complement')
(ProverActor pid=2495454) 2024-09-21 10:53:57.285 | INFO     | prover.proof_search:_best_first_search:149 - 3578006.451514829
(ProverActor pid=2495454) 2024-09-21 10:53:57.285 | INFO     | prover.proof_search:_best_first_search:150 - 3577406.455619934
(ProverActor pid=2495454) 2024-09-21 10:53:57.285 | INFO     | prover.proof_search:_best_first_search:151 - 599.9962916839868
(ProverActor pid=2495454) 2024-09-21 10:53:57.285 | INFO     | prover.proof_search:_best_first_search:152 - 600
(ProverActor pid=2495454) 2024-09-21 10:53:57.286 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions).
(ProverActor pid=2495454) 2024-09-21 10:54:06.542 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.fin_list_complement_incr'), status=<Status.OPEN: 'Ope
n'>, proof=None, actor_time=559.4243523771875, environment_time=36.626277482602745, total_time=600.9969701077789, num_total_node
s=412, num_searched_nodes=17)
(ProverActor pid=2495835) 2024-09-21 10:53:59.354 | INFO     | prover.proof_search:_best_first_search:152 - 600 [repeated 8x acr
oss cluster]
(ProverActor pid=2495835) 2024-09-21 10:53:59.356 | INFO     | prover.proof_search:_best_first_search:163 - Hit the resource lim
it (timeout or max_expansions). [repeated 2x across cluster]
(ProverActor pid=2495655) 2024-09-21 10:54:07.912 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.le_aux'), status=<Status.OPEN: 'Open'>, proof=None, a
ctor_time=265.29210575763136, environment_time=314.61956429248676, total_time=600.9974054899067, num_total_nodes=337, num_search
ed_nodes=8)
2024-09-21 10:54:09.154 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterGroup.Bruhat.fin_list_compl
ement_incr
2024-09-21 10:54:09.155 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterGroup.Bruhat.le_aux
2024-09-21 10:54:09.155 | INFO     | __main__:process_theorem_batch:1162 - No proof found for CoxeterGroup.Bruhat.fin_list_compl
ement_complement
(ProverActor pid=2495835) 2024-09-21 10:54:09.152 | INFO     | prover.proof_search:search:128 - SearchResult(theorem=Theorem(rep
o=LeanGitRepo(url='https://github.com/NUS-Math-Formalization/coxeter', commit='96af8aee7943ca8685ed1b00cc83a559ea389a97'), file_
path=PosixPath('Coxeter/BruhatOrder.lean'), full_name='CoxeterGroup.Bruhat.fin_list_complement_complement'), status=<Status.OPEN
: 'Open'>, proof=None, actor_time=532.6159156239592, environment_time=57.24092328455299, total_time=600.9986379710026, num_total
_nodes=545, num_searched_nodes=17)
2024-09-21 10:55:44.529 | INFO     | __main__:save_progress:1171 - Saving encountered theorems...
2024-09-21 10:55:44.531 | INFO     | __main__:prove_sorry_theorems:1267 - Finished attempting to prove sorry theorems
2024-09-21 10:57:25.582 | INFO     | __main__:main:2059 - Finished searching for proofs of sorry theorems
2024-09-21 10:57:25.582 | INFO     | __main__:main:2062 - Shutting down Ray after proving
[rank0]:[W921 10:57:33.629211250 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we des
truct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCC
L operations have finished in this process. In rare cases this process can exit before this point and block the progress of anot
her member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.
4 (function operator())
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ bash run_code_compute_fisher8_more_sorries
bash: run_code_compute_fisher8_more_sorries: No such file or directory
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ bash run_code_compute_fisher8_more_sorries.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
^CTraceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/bin/ray", line 5, in <module>
    from ray.scripts.scripts import main
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/scripts/scripts.py", line 2607, in <module>
    from ray.serve.scripts import serve_cli
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/serve/__init__.py", line 4, in <module>
    from ray.serve.api import (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/serve/api.py", line 8, in <module>
    from fastapi import APIRouter, FastAPI
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/fastapi/__init__.py", line 7, in <module>
    from .applications import FastAPI as FastAPI
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/fastapi/applications.py", line 16, in <module>
    from fastapi import routing
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/fastapi/routing.py", line 24, in <module>
    from fastapi import params
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/fastapi/params.py", line 5, in <module>
    from fastapi.openapi.models import Example
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/fastapi/openapi/models.py", line 273, in <module>
    class Header(ParameterBase):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 2
05, in __new__
    complete_model_class(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 5
44, in complete_model_class
    schema = gen_schema.clean_schema(schema)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_generate_schema.py", line 448,
 in clean_schema
    schema = simplify_schema_references(schema)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 463, in s
implify_schema_references
    schema = walk_core_schema(schema, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 414, in w
alk_core_schema
    return f(schema.copy(), _dispatch)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 459, in c
ount_refs
    recurse(definitions[ref], count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 447, in c
ount_refs
    return recurse(s, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 209, in _
handle_other_schemas
    schema['schema'] = self.walk(sub_schema, f)  # type: ignore
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 447, in c
ount_refs
    return recurse(s, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 337, in h
andle_model_fields_schema
    replaced_field['schema'] = self.walk(v['schema'], f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 447, in c
ount_refs
    return recurse(s, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 209, in _
handle_other_schemas
    schema['schema'] = self.walk(sub_schema, f)  # type: ignore
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 447, in c
ount_refs
    return recurse(s, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 209, in _
handle_other_schemas
    schema['schema'] = self.walk(sub_schema, f)  # type: ignore
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 447, in c
ount_refs
    return recurse(s, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 298, in h
andle_union_schema
    new_choices.append(self.walk(v, f))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 459, in c
ount_refs
    recurse(definitions[ref], count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 209, in _
handle_other_schemas
    schema['schema'] = self.walk(sub_schema, f)  # type: ignore
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 197, in w
alk
    return f(schema, self._walk)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 447, in c
ount_refs
    return recurse(s, count_refs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 200, in _
walk
    schema = self._schema_type_to_method[schema['type']](schema.copy(), f)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pydantic/_internal/_core_utils.py", line 336, in h
andle_model_fields_schema
    replaced_field = v.copy()
KeyboardInterrupt

(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ nvidia-smi
Sat Sep 21 13:16:28 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   38C    P0             83W /  400W |   15256MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   36C    P0             90W /  400W |    4305MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   37C    P0             93W /  400W |    4305MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   38C    P0             87W /  400W |    4161MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A   2378693      C   ...miniconda3/envs/ReProver/bin/python       5224MiB |
|    0   N/A  N/A   2378694      C   ...miniconda3/envs/ReProver/bin/python       4936MiB |
|    0   N/A  N/A   2378695      C   ...miniconda3/envs/ReProver/bin/python       5080MiB |
|    1   N/A  N/A   2378693      C   ...miniconda3/envs/ReProver/bin/python       4298MiB |
|    2   N/A  N/A   2378694      C   ...miniconda3/envs/ReProver/bin/python       4298MiB |
|    3   N/A  N/A   2378695      C   ...miniconda3/envs/ReProver/bin/python       4154MiB |
+-----------------------------------------------------------------------------------------+
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ ps aux | grep "python" | awk '{print $2}' | xargs -r kill -
9
kill: (6951): Operation not permitted
kill: (7260): Operation not permitted
kill: (667449): Operation not permitted
kill: (667466): Operation not permitted
kill: (667467): Operation not permitted
kill: (667468): Operation not permitted
kill: (667475): Operation not permitted
kill: (668342): Operation not permitted
kill: (668360): Operation not permitted
kill: (668361): Operation not permitted
kill: (668362): Operation not permitted
kill: (668369): Operation not permitted
kill: (669121): Operation not permitted
kill: (669214): Operation not permitted
kill: (669215): Operation not permitted
kill: (669216): Operation not permitted
kill: (669223): Operation not permitted
kill: (1936820): Operation not permitted
kill: (1936821): Operation not permitted
kill: (2170705): Operation not permitted
kill: (2170709): Operation not permitted
kill: (2330447): Operation not permitted
kill: (2509131): Operation not permitted
kill: (2539694): Operation not permitted
kill: (2539695): Operation not permitted
kill: (2539696): Operation not permitted
kill: (2603575): No such process
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ nvidia-smi
Sat Sep 21 13:16:36 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   38C    P0             86W /  400W |       1MiB /  81920MiB |     67%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   36C    P0             86W /  400W |       1MiB /  81920MiB |     58%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   37C    P0             91W /  400W |       1MiB /  81920MiB |      1%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   37C    P0             83W /  400W |       1MiB /  81920MiB |      4%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ nvidia-smi
Sat Sep 21 13:16:37 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   38C    P0             83W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   36C    P0             86W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:50:00.0 Off |                    0 |
| N/A   36C    P0             88W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   37C    P0             82W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
(base) yingzi_ma@compute-permanent-node-491:~/lean_project/ReProver$ bash run_code_compute_fisher8_more_sorries.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
Removing old cache files
Stopping ray
Did not find any active Ray processes.
Running compute_fisher8_more_sorries.py
[2024-09-21 13:16:52,008] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-21 13:16:58.226 | INFO     | __main__:main:1179 - Calculating Fisher Information Matrix for EWC
2024-09-21 13:16:58.227 | INFO     | __main__:find_latest_checkpoint:518 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 13:16:58.227 | INFO     | __main__:main:1199 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `
torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possib
le to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorc
h/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be fl
ipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed
 to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We re
commend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open
 an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `s
run` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your pyt
hon command with `srun` like so: srun python compute_fisher8_more_sorries.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-21 13:17:02.032 | INFO     | __main__:main:1227 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc_cu
rriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarnin
g: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transform
ers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transfo
rmers/issues/31884
  warnings.warn(
2024-09-21 13:17:02.135 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 13:17:11.411 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:11.425 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:11.437 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:11.437 | INFO     | __main__:main:1242 - right before barrier fisher
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/configuration_validator.py:72: Y
ou passed in a `val_dataloader` but have no `validation_step`. Skipping val loop.
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-21 13:17:17,977] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-21 13:17:17,977] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-21 13:17:17,977] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-21 13:17:22.750 | INFO     | __main__:main:1179 - Calculating Fisher Information Matrix for EWC
2024-09-21 13:17:22.750 | INFO     | __main__:main:1179 - Calculating Fisher Information Matrix for EWC
2024-09-21 13:17:22.750 | INFO     | __main__:main:1179 - Calculating Fisher Information Matrix for EWC
2024-09-21 13:17:22.751 | INFO     | __main__:find_latest_checkpoint:518 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 13:17:22.751 | INFO     | __main__:find_latest_checkpoint:518 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 13:17:22.751 | INFO     | __main__:find_latest_checkpoint:518 - Using the latest checkpoint: /data/yingzi_ma/lean_pro
ject/checkpoints_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0
.1_epoch=6-Recall@10_val=69.23.ckpt
2024-09-21 13:17:22.751 | INFO     | __main__:main:1199 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 13:17:22.751 | INFO     | __main__:main:1199 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
2024-09-21 13:17:22.751 | INFO     | __main__:main:1199 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_s
ingle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97_lambda_0.1_epoch=6-Recall@10_
val=69.23.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `
torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possib
le to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorc
h/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be fl
ipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed
 to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We re
commend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open
 an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `
torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possib
le to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorc
h/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be fl
ipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed
 to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We re
commend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open
 an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `
torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possib
le to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorc
h/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be fl
ipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed
 to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We re
commend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open
 an issue on GitHub for any issues related to this experimental feature.
2024-09-21 13:17:25.748 | INFO     | __main__:main:1227 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc_cu
rriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-09-21 13:17:25.748 | INFO     | __main__:main:1227 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc_cu
rriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-09-21 13:17:25.753 | INFO     | __main__:main:1227 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_ewc_cu
rriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarnin
g: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transform
ers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transfo
rmers/issues/31884
  warnings.warn(
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarnin
g: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transform
ers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transfo
rmers/issues/31884
  warnings.warn(
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarnin
g: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transform
ers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transfo
rmers/issues/31884
  warnings.warn(
2024-09-21 13:17:25.844 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 13:17:25.845 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 13:17:25.850 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_sin
gle_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-09-21 13:17:35.089 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:35.101 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:35.111 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:35.111 | INFO     | __main__:main:1242 - right before barrier fisher
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-21 13:17:35.637 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:35.649 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:35.652 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:35.659 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:35.659 | INFO     | __main__:main:1242 - right before barrier fisher
2024-09-21 13:17:35.665 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:35.681 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:35.682 | INFO     | __main__:main:1242 - right before barrier fisher
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-21 13:17:39.209 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
2024-09-21 13:17:39.244 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:39.292 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
Training dataset size: 150902
2024-09-21 13:17:39.327 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:39.934 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:40.045 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:40.682 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:40.727 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:41.852 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
2024-09-21 13:17:41.893 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_train/cached_data.pkl
Training dataset size: 150902
2024-09-21 13:17:41.989 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_val/cached_data.pkl
Validation dataset size: 2196
2024-09-21 13:17:42.008 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_pr
oject/datasets_PT_single_repo_ewc_curriculum_sorries/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cac
he_pred/cached_data.pkl
Testing dataset size: 2087
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name  | Type             | Params
-------------------------------------------
0 | model | PremiseRetriever | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Epoch 0:   2%|█▏                                                              | 183/9431 [01:15<1:03:14,  2.44it/s, v_num=27695]
