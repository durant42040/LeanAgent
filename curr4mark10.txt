2024-09-12 08:52:26.934 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 80.57491289198606
2024-09-12 08:52:26.935 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 80.57491289198606
2024-09-12 08:52:26.935 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 80.57491289198606
2024-09-12 08:52:26.935 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 80.57491289198606
2024-09-12 08:52:26.936 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 81.38792102206736
2024-09-12 08:52:26.936 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 81.38792102206736
2024-09-12 08:52:26.936 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 81.38792102206736
2024-09-12 08:52:26.937 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 82.0073557878436
2024-09-12 08:52:26.937 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 82.0073557878436
2024-09-12 08:52:26.937 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 82.0073557878436
2024-09-12 08:52:26.938 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 82.0073557878436
2024-09-12 08:52:26.938 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 82.0073557878436
2024-09-12 08:52:26.938 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 82.35578784359271
2024-09-12 08:52:26.939 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 82.35578784359271
2024-09-12 08:52:26.939 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 83.16879597367401
2024-09-12 08:52:26.939 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 83.16879597367401
2024-09-12 08:52:26.940 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 83.16879597367401
2024-09-12 08:52:26.940 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 83.16879597367401
2024-09-12 08:52:26.940 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 83.16879597367401
2024-09-12 08:52:26.941 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 83.16879597367401
2024-09-12 08:52:26.941 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 83.16879597367401
2024-09-12 08:52:26.941 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 83.16879597367401
2024-09-12 08:52:26.942 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 83.51722802942315
2024-09-12 08:52:26.942 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 83.51722802942315
2024-09-12 08:52:26.943 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 83.51722802942315
2024-09-12 08:52:26.943 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 83.51722802942315
2024-09-12 08:52:26.943 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 84.12698412698413
2024-09-12 08:52:26.943 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 84.12698412698413
2024-09-12 08:52:26.944 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 84.12698412698413
2024-09-12 08:52:26.944 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 84.12698412698413
2024-09-12 08:52:26.944 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 84.12698412698413
2024-09-12 08:52:26.945 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 84.12698412698413
2024-09-12 08:52:26.945 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 84.12698412698413
2024-09-12 08:52:26.945 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 84.39798683701122
2024-09-12 08:52:26.946 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 86.83701122725512
2024-09-12 08:52:26.946 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 86.83701122725512
2024-09-12 08:52:26.946 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 86.83701122725512
2024-09-12 08:52:26.947 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 86.83701122725512
2024-09-12 08:52:26.947 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 86.83701122725512
2024-09-12 08:52:26.947 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 86.83701122725512
2024-09-12 08:52:26.948 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 86.83701122725512
2024-09-12 08:52:26.948 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 86.83701122725512
2024-09-12 08:52:26.948 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 86.83701122725512
2024-09-12 08:52:26.949 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 86.83701122725512
2024-09-12 08:52:26.949 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 86.83701122725512
2024-09-12 08:52:26.949 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 86.83701122725512
2024-09-12 08:52:26.950 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 86.83701122725512
2024-09-12 08:52:26.950 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 86.83701122725512
2024-09-12 08:52:26.950 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 86.83701122725512
2024-09-12 08:52:26.951 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 86.83701122725512
2024-09-12 08:52:26.951 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 86.83701122725512
2024-09-12 08:52:26.951 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 86.83701122725512
2024-09-12 08:52:26.952 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 86.83701122725512
2024-09-12 08:52:26.952 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 86.83701122725512
2024-09-12 08:52:26.952 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 86.83701122725512
2024-09-12 08:52:26.953 | INFO     | retrieval.model:validation_step:382 - MRR: 0.4740877477478889
2024-09-12 08:52:26.953 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                        2
024-09-12 08:52:28.810 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 20.343137254901958███████████████████████████████████████████████████████████████████████████████| 21/21 [01:37<00:00,  0.21it/s]
2024-09-12 08:52:28.811 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 32.59803921568627
2024-09-12 08:52:28.811 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 35.78431372549019
2024-09-12 08:52:28.811 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 38.725490196078425
2024-09-12 08:52:28.812 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 38.725490196078425
2024-09-12 08:52:28.812 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 44.85294117647059
2024-09-12 08:52:28.812 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 46.56862745098039
2024-09-12 08:52:28.813 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 46.56862745098039
2024-09-12 08:52:28.813 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 52.45098039215685
2024-09-12 08:52:28.813 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 52.45098039215685
2024-09-12 08:52:28.814 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 53.18627450980392
2024-09-12 08:52:28.814 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 55.39215686274509
2024-09-12 08:52:28.814 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 55.39215686274509
2024-09-12 08:52:28.815 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 58.333333333333336
2024-09-12 08:52:28.815 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 58.333333333333336
2024-09-12 08:52:28.815 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 60.78431372549019
2024-09-12 08:52:28.816 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 60.78431372549019
2024-09-12 08:52:28.816 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 60.78431372549019
2024-09-12 08:52:28.816 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 60.78431372549019
2024-09-12 08:52:28.817 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 64.70588235294117
2024-09-12 08:52:28.817 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 64.95098039215686
2024-09-12 08:52:28.817 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 70.83333333333334
2024-09-12 08:52:28.818 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 70.83333333333334
2024-09-12 08:52:28.818 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 70.83333333333334
2024-09-12 08:52:28.818 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 71.5686274509804
2024-09-12 08:52:28.818 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 71.5686274509804
2024-09-12 08:52:28.819 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 71.5686274509804
2024-09-12 08:52:28.819 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 71.5686274509804
2024-09-12 08:52:28.819 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 73.03921568627452
2024-09-12 08:52:28.820 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 73.77450980392157
2024-09-12 08:52:28.820 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 73.77450980392157
2024-09-12 08:52:28.820 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 73.77450980392157
2024-09-12 08:52:28.821 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 74.01960784313725
2024-09-12 08:52:28.821 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 74.01960784313725
2024-09-12 08:52:28.821 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 74.01960784313725
2024-09-12 08:52:28.822 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 74.01960784313725
2024-09-12 08:52:28.822 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 74.01960784313725
2024-09-12 08:52:28.822 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 74.01960784313725
2024-09-12 08:52:28.823 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 74.01960784313725
2024-09-12 08:52:28.823 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 74.01960784313725
2024-09-12 08:52:28.823 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 74.01960784313725
2024-09-12 08:52:28.824 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 74.01960784313725
2024-09-12 08:52:28.824 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 74.01960784313725
2024-09-12 08:52:28.824 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 74.01960784313725
2024-09-12 08:52:28.824 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 74.01960784313725
2024-09-12 08:52:28.825 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 74.26470588235294
2024-09-12 08:52:28.825 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 75.73529411764706
2024-09-12 08:52:28.825 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 75.73529411764706
2024-09-12 08:52:28.826 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 75.73529411764706
2024-09-12 08:52:28.826 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 75.73529411764706
2024-09-12 08:52:28.826 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 75.73529411764706
2024-09-12 08:52:28.827 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 75.73529411764706
2024-09-12 08:52:28.827 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 75.73529411764706
2024-09-12 08:52:28.827 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 75.73529411764706
2024-09-12 08:52:28.828 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 75.73529411764706
2024-09-12 08:52:28.828 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 75.73529411764706
2024-09-12 08:52:28.828 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 75.73529411764706
2024-09-12 08:52:28.829 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 75.73529411764706
2024-09-12 08:52:28.829 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 75.73529411764706
2024-09-12 08:52:28.829 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 75.73529411764706
2024-09-12 08:52:28.830 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 75.73529411764706
2024-09-12 08:52:28.830 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 75.73529411764706
2024-09-12 08:52:28.830 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 75.73529411764706
2024-09-12 08:52:28.830 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 75.73529411764706
2024-09-12 08:52:28.831 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 75.73529411764706
2024-09-12 08:52:28.831 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 75.73529411764706
2024-09-12 08:52:28.831 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 75.73529411764706
2024-09-12 08:52:28.832 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 75.73529411764706
2024-09-12 08:52:28.832 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 75.73529411764706
2024-09-12 08:52:28.832 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 75.73529411764706
2024-09-12 08:52:28.833 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 75.73529411764706
2024-09-12 08:52:28.833 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 75.73529411764706
2024-09-12 08:52:28.833 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 75.73529411764706
2024-09-12 08:52:28.834 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 75.73529411764706
2024-09-12 08:52:28.834 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 75.73529411764706
2024-09-12 08:52:28.834 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 75.73529411764706
2024-09-12 08:52:28.835 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 75.73529411764706
2024-09-12 08:52:28.835 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 75.73529411764706
2024-09-12 08:52:28.835 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 75.73529411764706
2024-09-12 08:52:28.836 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 75.73529411764706
2024-09-12 08:52:28.836 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 75.73529411764706
2024-09-12 08:52:28.836 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 75.73529411764706
2024-09-12 08:52:28.836 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 77.20588235294117
2024-09-12 08:52:28.837 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 77.20588235294117
2024-09-12 08:52:28.837 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 77.20588235294117
2024-09-12 08:52:28.837 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 77.20588235294117
2024-09-12 08:52:28.838 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 77.20588235294117
2024-09-12 08:52:28.838 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 77.20588235294117
2024-09-12 08:52:28.838 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 77.20588235294117
2024-09-12 08:52:28.839 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 80.14705882352942
2024-09-12 08:52:28.839 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 80.14705882352942
2024-09-12 08:52:28.839 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 80.14705882352942
2024-09-12 08:52:28.840 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 80.14705882352942
2024-09-12 08:52:28.840 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 80.14705882352942
2024-09-12 08:52:28.840 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 80.14705882352942
2024-09-12 08:52:28.841 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 80.14705882352942
2024-09-12 08:52:28.841 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 80.14705882352942
2024-09-12 08:52:28.841 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 80.14705882352942
2024-09-12 08:52:28.842 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 80.88235294117648
2024-09-12 08:52:28.842 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 80.88235294117648
2024-09-12 08:52:28.842 | INFO     | retrieval.model:validation_step:382 - MRR: 0.44591556319497494
2024-09-12 08:52:28.843 | INFO     | retrieval.model:validation_step:390 - End of validation_step
2024-09-12 08:52:28.858 | INFO     | retrieval.model:validation_step:319 - Inside validation_step
2024-09-12 08:52:28.877 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-12 08:52:29.389 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 21.452991452991455
2024-09-12 08:52:29.390 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 29.14529914529914
2024-09-12 08:52:29.391 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 35.55555555555555
2024-09-12 08:52:29.391 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 44.529914529914535
2024-09-12 08:52:29.392 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 49.017094017094024
2024-09-12 08:52:29.392 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 51.153846153846146
2024-09-12 08:52:29.393 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 53.717948717948715
2024-09-12 08:52:29.393 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 54.99999999999999
2024-09-12 08:52:29.393 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 58.71794871794872
2024-09-12 08:52:29.394 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 58.71794871794872
2024-09-12 08:52:29.394 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 62.77777777777778
2024-09-12 08:52:29.395 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 64.05982905982907
2024-09-12 08:52:29.395 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 67.47863247863248
2024-09-12 08:52:29.395 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 67.47863247863248
2024-09-12 08:52:29.396 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 67.47863247863248
2024-09-12 08:52:29.396 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 68.76068376068376
2024-09-12 08:52:29.396 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 70.04273504273503
2024-09-12 08:52:29.397 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 70.8974358974359
2024-09-12 08:52:29.397 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 72.17948717948718
2024-09-12 08:52:29.398 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 72.17948717948718
2024-09-12 08:52:29.398 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 75.59829059829059
2024-09-12 08:52:29.398 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 75.59829059829059
2024-09-12 08:52:29.399 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 76.88034188034189
2024-09-12 08:52:29.399 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 76.88034188034189
2024-09-12 08:52:29.399 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 78.16239316239316
2024-09-12 08:52:29.400 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 78.67521367521367
2024-09-12 08:52:29.400 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 79.52991452991454
2024-09-12 08:52:29.400 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 79.52991452991454
2024-09-12 08:52:29.401 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 79.52991452991454
2024-09-12 08:52:29.401 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 79.52991452991454
2024-09-12 08:52:29.401 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 79.52991452991454
2024-09-12 08:52:29.402 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 79.52991452991454
2024-09-12 08:52:29.402 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 79.52991452991454
2024-09-12 08:52:29.402 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 79.52991452991454
2024-09-12 08:52:29.403 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 79.52991452991454
2024-09-12 08:52:29.403 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 80.81196581196582
2024-09-12 08:52:29.403 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 80.81196581196582
2024-09-12 08:52:29.404 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 80.81196581196582
2024-09-12 08:52:29.404 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 81.45299145299147
2024-09-12 08:52:29.404 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 81.45299145299147
2024-09-12 08:52:29.405 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 81.45299145299147
2024-09-12 08:52:29.405 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 81.45299145299147
2024-09-12 08:52:29.405 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 81.45299145299147
2024-09-12 08:52:29.406 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 81.45299145299147
2024-09-12 08:52:29.406 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 81.45299145299147
2024-09-12 08:52:29.406 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 81.45299145299147
2024-09-12 08:52:29.407 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 82.30769230769232
2024-09-12 08:52:29.407 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 82.30769230769232
2024-09-12 08:52:29.407 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 83.16239316239317
2024-09-12 08:52:29.408 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 83.16239316239317
2024-09-12 08:52:29.408 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 83.16239316239317
2024-09-12 08:52:29.408 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 83.16239316239317
2024-09-12 08:52:29.409 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 83.16239316239317
2024-09-12 08:52:29.409 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 83.16239316239317
2024-09-12 08:52:29.409 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 83.16239316239317
2024-09-12 08:52:29.410 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 83.16239316239317
2024-09-12 08:52:29.410 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 83.16239316239317
2024-09-12 08:52:29.410 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 83.16239316239317
2024-09-12 08:52:29.411 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 83.16239316239317
2024-09-12 08:52:29.411 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 83.16239316239317
2024-09-12 08:52:29.412 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 84.52991452991454
2024-09-12 08:52:29.412 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 84.52991452991454
2024-09-12 08:52:29.412 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 84.52991452991454
2024-09-12 08:52:29.413 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 84.52991452991454
2024-09-12 08:52:29.413 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 85.17094017094018
2024-09-12 08:52:29.413 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 85.17094017094018
2024-09-12 08:52:29.414 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 85.17094017094018
2024-09-12 08:52:29.414 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 86.02564102564102
2024-09-12 08:52:29.414 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 86.02564102564102
2024-09-12 08:52:29.415 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 86.02564102564102
2024-09-12 08:52:29.415 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 86.02564102564102
2024-09-12 08:52:29.415 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 86.02564102564102
2024-09-12 08:52:29.416 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 86.02564102564102
2024-09-12 08:52:29.416 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 86.02564102564102
2024-09-12 08:52:29.416 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 86.02564102564102
2024-09-12 08:52:29.417 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 86.02564102564102
2024-09-12 08:52:29.417 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 86.02564102564102
2024-09-12 08:52:29.417 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 86.02564102564102
2024-09-12 08:52:29.418 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 86.02564102564102
2024-09-12 08:52:29.418 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 86.02564102564102
2024-09-12 08:52:29.418 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 86.02564102564102
2024-09-12 08:52:29.419 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 86.02564102564102
2024-09-12 08:52:29.419 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 86.02564102564102
2024-09-12 08:52:29.419 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 86.02564102564102
2024-09-12 08:52:29.420 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 86.02564102564102
2024-09-12 08:52:29.420 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 86.02564102564102
2024-09-12 08:52:29.420 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 86.02564102564102
2024-09-12 08:52:29.421 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 86.02564102564102
2024-09-12 08:52:29.421 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 86.02564102564102
2024-09-12 08:52:29.421 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 86.02564102564102
2024-09-12 08:52:29.422 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 86.02564102564102
2024-09-12 08:52:29.422 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 86.02564102564102
2024-09-12 08:52:29.423 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 86.02564102564102
2024-09-12 08:52:29.423 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 86.02564102564102
2024-09-12 08:52:29.423 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 86.02564102564102
2024-09-12 08:52:29.424 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 86.02564102564102
2024-09-12 08:52:29.424 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 86.02564102564102
2024-09-12 08:52:29.424 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 86.02564102564102
2024-09-12 08:52:29.425 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 86.02564102564102
2024-09-12 08:52:29.425 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 86.02564102564102
2024-09-12 08:52:29.425 | INFO     | retrieval.model:validation_step:382 - MRR: 0.5079263045717644
2024-09-12 08:52:29.426 | INFO     | retrieval.model:validation_step:390 - End of validation_step
2024-09-12 08:52:33.013 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 19.717261904761905
2024-09-12 08:52:33.014 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 28.757440476190478
2024-09-12 08:52:33.014 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 34.48660714285714
2024-09-12 08:52:33.014 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 35.26785714285714
2024-09-12 08:52:33.015 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 42.485119047619044
2024-09-12 08:52:33.015 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 46.65178571428571
2024-09-12 08:52:33.015 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 48.735119047619044
2024-09-12 08:52:33.016 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 53.422619047619044
2024-09-12 08:52:33.016 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 54.985119047619044
2024-09-12 08:52:33.016 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 59.672619047619044
2024-09-12 08:52:33.017 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 62.27678571428571
2024-09-12 08:52:33.017 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 62.27678571428571
2024-09-12 08:52:33.017 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 68.52678571428571
2024-09-12 08:52:33.018 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 70.08928571428571
2024-09-12 08:52:33.018 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 70.08928571428571
2024-09-12 08:52:33.018 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 70.53571428571428
2024-09-12 08:52:33.019 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 70.53571428571428
2024-09-12 08:52:33.019 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 72.09821428571428
2024-09-12 08:52:33.019 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 75.74404761904762
2024-09-12 08:52:33.020 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 75.74404761904762
2024-09-12 08:52:33.020 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 77.30654761904762
2024-09-12 08:52:33.020 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 80.43154761904762
2024-09-12 08:52:33.021 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 80.43154761904762
2024-09-12 08:52:33.021 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 80.43154761904762
2024-09-12 08:52:33.021 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 80.43154761904762
2024-09-12 08:52:33.021 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 80.43154761904762
2024-09-12 08:52:33.022 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 80.43154761904762
2024-09-12 08:52:33.022 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 80.43154761904762
2024-09-12 08:52:33.022 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 80.43154761904762
2024-09-12 08:52:33.023 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 80.43154761904762
2024-09-12 08:52:33.023 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 80.43154761904762
2024-09-12 08:52:33.023 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 81.21279761904762
2024-09-12 08:52:33.024 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 82.77529761904762
2024-09-12 08:52:33.024 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 82.77529761904762
2024-09-12 08:52:33.024 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 82.77529761904762
2024-09-12 08:52:33.025 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 82.77529761904762
2024-09-12 08:52:33.025 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 82.77529761904762
2024-09-12 08:52:33.025 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 84.33779761904762
2024-09-12 08:52:33.025 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 84.33779761904762
2024-09-12 08:52:33.026 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 84.33779761904762
2024-09-12 08:52:33.026 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 84.33779761904762
2024-09-12 08:52:33.026 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 84.33779761904762
2024-09-12 08:52:33.027 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 84.33779761904762
2024-09-12 08:52:33.027 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 84.33779761904762
2024-09-12 08:52:33.027 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 84.33779761904762
2024-09-12 08:52:33.028 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 84.33779761904762
2024-09-12 08:52:33.028 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 84.33779761904762
2024-09-12 08:52:33.028 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 87.98363095238095
2024-09-12 08:52:33.029 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 87.98363095238095
2024-09-12 08:52:33.029 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 87.98363095238095
2024-09-12 08:52:33.029 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 87.98363095238095
2024-09-12 08:52:33.030 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 87.98363095238095
2024-09-12 08:52:33.030 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 87.98363095238095
2024-09-12 08:52:33.030 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 87.98363095238095
2024-09-12 08:52:33.030 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 89.54613095238095
2024-09-12 08:52:33.031 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 89.54613095238095
2024-09-12 08:52:33.031 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 89.54613095238095
2024-09-12 08:52:33.031 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 89.54613095238095
2024-09-12 08:52:33.032 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 89.54613095238095
2024-09-12 08:52:33.032 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 89.54613095238095
2024-09-12 08:52:33.032 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 89.54613095238095
2024-09-12 08:52:33.033 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 89.54613095238095
2024-09-12 08:52:33.033 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 89.54613095238095
2024-09-12 08:52:33.033 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 89.54613095238095
2024-09-12 08:52:33.034 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 89.54613095238095
2024-09-12 08:52:33.034 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 89.54613095238095
2024-09-12 08:52:33.034 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 89.54613095238095
2024-09-12 08:52:33.035 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 89.54613095238095
2024-09-12 08:52:33.035 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 89.54613095238095
2024-09-12 08:52:33.035 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 89.54613095238095
2024-09-12 08:52:33.035 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 89.99255952380952
2024-09-12 08:52:33.036 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 89.99255952380952
2024-09-12 08:52:33.036 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 89.99255952380952
2024-09-12 08:52:33.036 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 89.99255952380952
2024-09-12 08:52:33.037 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 89.99255952380952
2024-09-12 08:52:33.037 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 89.99255952380952
2024-09-12 08:52:33.037 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 89.99255952380952
2024-09-12 08:52:33.038 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 89.99255952380952
2024-09-12 08:52:33.038 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 89.99255952380952
2024-09-12 08:52:33.038 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 89.99255952380952
2024-09-12 08:52:33.039 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 89.99255952380952
2024-09-12 08:52:33.039 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 89.99255952380952
2024-09-12 08:52:33.039 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 89.99255952380952
2024-09-12 08:52:33.039 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 89.99255952380952
2024-09-12 08:52:33.040 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 89.99255952380952
2024-09-12 08:52:33.040 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 89.99255952380952
2024-09-12 08:52:33.040 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 89.99255952380952
2024-09-12 08:52:33.041 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 89.99255952380952
2024-09-12 08:52:33.041 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 89.99255952380952
2024-09-12 08:52:33.041 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 89.99255952380952
2024-09-12 08:52:33.042 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 89.99255952380952
2024-09-12 08:52:33.042 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 89.99255952380952
2024-09-12 08:52:33.042 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 89.99255952380952
2024-09-12 08:52:33.043 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 89.99255952380952
2024-09-12 08:52:33.043 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 89.99255952380952
2024-09-12 08:52:33.043 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 89.99255952380952
2024-09-12 08:52:33.044 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 89.99255952380952
2024-09-12 08:52:33.044 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 89.99255952380952
2024-09-12 08:52:33.044 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 89.99255952380952
2024-09-12 08:52:33.044 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 89.99255952380952
2024-09-12 08:52:33.045 | INFO     | retrieval.model:validation_step:382 - MRR: 0.4883602348857283
2024-09-12 08:52:33.045 | INFO     | retrieval.model:validation_step:390 - End of validation_step
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23897/23897 [3:15:13<00:00,  2.04it/s, v_num=0]
Epoch 3, global step 24222: 'Recall@10_val' reached 59.20507 (best 61.22599), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6
c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt' as top 3
`Trainer.fit` stopped: `max_epochs=4` reached.
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23897/23897 [3:15:21<00:00,  2.04it/s, v_num=0]
2024-09-12 08:52:44.879 | INFO     | __main__:main:1462 - hit the barrier after training
2024-09-12 08:52:45.618 | INFO     | __main__:main:1462 - hit the barrier after training
2024-09-12 08:52:45.882 | INFO     | __main__:main:1462 - hit the barrier after training
2024-09-12 08:52:46.520 | INFO     | __main__:main:1462 - hit the barrier after training
2024-09-12 08:52:46.521 | INFO     | __main__:main:1468 - Finished progressive training at epoch 4
2024-09-12 08:52:46.521 | INFO     | __main__:main:1468 - Finished progressive training at epoch 4
2024-09-12 08:52:46.521 | INFO     | __main__:main:1468 - Finished progressive training at epoch 4
2024-09-12 08:52:46.521 | INFO     | __main__:main:1468 - Finished progressive training at epoch 4
2024-09-12 08:52:46.522 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.522 | INFO     | __main__:main:1475 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.522 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.522 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.522 | INFO     | __main__:main:1475 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.522 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.523 | INFO     | __main__:main:1475 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:46.523 | INFO     | __main__:main:1475 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 08:52:54.169 | INFO     | __main__:main:1485 - Testing...
2024-09-12 08:52:54.173 | INFO     | retrieval.main:run_cli:60 - PID: 2431132
2024-09-12 08:52:54.217 | INFO     | __main__:main:1485 - Testing...
2024-09-12 08:52:54.217 | INFO     | retrieval.main:run_cli:60 - PID: 2433819
2024-09-12 08:52:54.218 | INFO     | __main__:main:1485 - Testing...
2024-09-12 08:52:54.218 | INFO     | retrieval.main:run_cli:60 - PID: 2433820
2024-09-12 08:52:54.218 | INFO     | __main__:main:1485 - Testing...
2024-09-12 08:52:54.219 | INFO     | retrieval.main:run_cli:60 - PID: 2433818
[rank: 0] Seed set to 3407
2024-09-12 08:52:54.505 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5
fedd7bd67f9916ae24253d566/random
2024-09-12 08:52:54.505 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-12 08:52:54.517 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5
fedd7bd67f9916ae24253d566/random
[rank: 3] Seed set to 3407
2024-09-12 08:52:54.517 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/corpus.jsonl
2024-09-12 08:52:54.517 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5
fedd7bd67f9916ae24253d566/random
2024-09-12 08:52:54.518 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-12 08:52:54.524 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5
fedd7bd67f9916ae24253d566/random
2024-09-12 08:52:54.524 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660
b5fedd7bd67f9916ae24253d566/corpus.jsonl
2024-09-12 08:52:55.216 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9
916ae24253d566/corpus.jsonl
2024-09-12 08:52:55.238 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9
916ae24253d566/corpus.jsonl
2024-09-12 08:52:55.241 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9
916ae24253d566/corpus.jsonl
2024-09-12 08:52:55.280 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9
916ae24253d566/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to r
un Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-09-12 08:53:40.225 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 410758
2024-09-12 08:53:40.317 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 7509
2024-09-12 08:53:47.895 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 410758
2024-09-12 08:53:47.949 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 7509
2024-09-12 08:53:49.816 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 410758
2024-09-12 08:53:49.866 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 7509
2024-09-12 08:53:50.869 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_train/cached_data.pkl
Training dataset size: 410758
2024-09-12 08:53:50.920 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29bad
dd685660b5fedd7bd67f9916ae24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 7509
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recal
l@10_val=59.21.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall
@10_val=59.21.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-12 08:53:54.269 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 08:53:54.272 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2813 [00:00<?, ?it/s]
2024-09-12 08:53:54.402 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 08:53:54.403 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/2813 [00:00<03:45, 12.45it/s]
2024-09-12 08:53:54.567 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 08:53:54.567 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-12 08:53:55.109 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 08:53:55.110 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2813/2813 [16:29<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2813/2813 [16:34<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2813/2813 [16:34<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2813/2813 [16:35<00:00,  2.83it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:45<00:00,  0.29it/s]
2024-09-12 09:12:14.511 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:12:14.960 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-12 09:12:14.961 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:12:18.193 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:12:18.632 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-12 09:12:18.632 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:12:20.839 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:12:20.839 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:12:21.235 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-12 09:12:21.235 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:12:21.307 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-12 09:12:21.308 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:12:21.308 | INFO     | retrieval.model:on_predict_epoch_end:567 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:51<00:00,  0.27it/s]
2024-09-12 09:12:22.667 | INFO     | retrieval.main:run_cli:60 - PID: 2433819
2024-09-12 09:12:23.008 | INFO     | retrieval.main:run_cli:60 - PID: 2433818
2024-09-12 09:12:23.028 | INFO     | retrieval.main:run_cli:60 - PID: 2433820
[rank: 2] Seed set to 3407
2024-09-12 09:12:23.069 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c10
32798a6046c1baf261445d/random
2024-09-12 09:12:23.069 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c
1032798a6046c1baf261445d/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-12 09:12:23.287 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c10
32798a6046c1baf261445d/random
2024-09-12 09:12:23.287 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c
1032798a6046c1baf261445d/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-12 09:12:23.308 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c10
32798a6046c1baf261445d/random
2024-09-12 09:12:23.309 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c
1032798a6046c1baf261445d/corpus.jsonl
2024-09-12 09:12:23.647 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/corpus.jsonl
2024-09-12 09:12:23.837 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/corpus.jsonl
2024-09-12 09:12:23.896 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/corpus.jsonl
2024-09-12 09:12:24.184 | INFO     | __main__:main:1507 - Loaded the predictions pickle files
2024-09-12 09:12:24.349 | INFO     | __main__:main:1510 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [00:00<00:00, 19171.13it/s]
2024-09-12 09:12:24.513 | INFO     | __main__:main:1512 - R@1 = 20.412930307051813 %, R@10 = 55.49679205065039 %, MRR = 0.45791892702307335
2024-09-12 09:12:24.515 | INFO     | retrieval.main:run_cli:60 - PID: 2431132
[rank: 0] Seed set to 3407
2024-09-12 09:12:24.790 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c10
32798a6046c1baf261445d/random
2024-09-12 09:12:24.791 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c
1032798a6046c1baf261445d/corpus.jsonl
2024-09-12 09:12:25.413 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/corpus.jsonl
[rank: 1] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-09-12 09:13:19.054 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 382360
2024-09-12 09:13:28.542 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 382360
2024-09-12 09:13:28.595 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 6681
2024-09-12 09:13:28.894 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 6681
2024-09-12 09:13:30.957 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 382360
2024-09-12 09:13:31.001 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 6681
2024-09-12 09:13:40.022 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_train/cached_data.pkl
Training dataset size: 382360
2024-09-12 09:13:40.080 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b93
3d47fd6c1032798a6046c1baf261445d/random/cache_pred/cached_data.pkl
Testing dataset size: 6681
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recal
l@10_val=59.21.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall
@10_val=59.21.ckpt
2024-09-12 09:13:43.534 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:13:43.535 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2804 [00:00<?, ?it/s]
2024-09-12 09:13:43.619 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:13:43.619 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                  | 2/2804 [00:00<03:44, 12.47it/s]
2024-09-12 09:13:43.791 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:13:43.792 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-12 09:13:44.504 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:13:44.504 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2804/2804 [16:27<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2804/2804 [16:32<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2804/2804 [16:32<00:00,  2.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2804/2804 [16:32<00:00,  2.83it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 27/27 [01:20<00:00,  0.33it/s]
2024-09-12 09:31:37.888 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:31:38.185 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-12 09:31:38.186 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:31:48.028 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:31:48.028 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:31:48.280 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-12 09:31:48.280 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:31:48.302 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-12 09:31:48.302 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:31:50.069 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:31:50.290 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-12 09:31:50.290 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:31:50.291 | INFO     | retrieval.model:on_predict_epoch_end:567 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 27/27 [01:33<00:00,  0.29it/s]
2024-09-12 09:31:51.537 | INFO     | retrieval.main:run_cli:60 - PID: 2433820
2024-09-12 09:31:51.621 | INFO     | retrieval.main:run_cli:60 - PID: 2433819
2024-09-12 09:31:51.657 | INFO     | retrieval.main:run_cli:60 - PID: 2433818
[rank: 3] Seed set to 3407
2024-09-12 09:31:51.944 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb05
1367c48c0a084411853a576389ecf5/random
2024-09-12 09:31:51.944 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-12 09:31:51.947 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb05
1367c48c0a084411853a576389ecf5/random
2024-09-12 09:31:51.947 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-12 09:31:52.035 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb05
1367c48c0a084411853a576389ecf5/random
2024-09-12 09:31:52.035 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-12 09:31:52.498 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/corpus.jsonl
2024-09-12 09:31:52.522 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/corpus.jsonl
2024-09-12 09:31:52.650 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/corpus.jsonl
2024-09-12 09:31:53.439 | INFO     | __main__:main:1507 - Loaded the predictions pickle files
2024-09-12 09:31:53.646 | INFO     | __main__:main:1510 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2668/2668 [00:00<00:00, 13504.25it/s]
2024-09-12 09:31:53.848 | INFO     | __main__:main:1512 - R@1 = 20.399087734565306 %, R@10 = 55.09533711521228 %, MRR = 0.458372214696906
2024-09-12 09:31:53.850 | INFO     | retrieval.main:run_cli:60 - PID: 2431132
[rank: 0] Seed set to 3407
2024-09-12 09:31:54.244 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb05
1367c48c0a084411853a576389ecf5/random
2024-09-12 09:31:54.244 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb
051367c48c0a084411853a576389ecf5/corpus.jsonl
2024-09-12 09:31:54.884 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a0
84411853a576389ecf5/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-12 09:32:35.944 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 394886
2024-09-12 09:32:36.005 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 6381
2024-09-12 09:32:55.476 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 394886
2024-09-12 09:32:55.530 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 6381
2024-09-12 09:32:58.824 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 394886
2024-09-12 09:32:58.876 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 6381
2024-09-12 09:32:58.983 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 394886
2024-09-12 09:32:59.038 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_
5297e0fb051367c48c0a084411853a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 6381
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recal
l@10_val=59.21.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall
@10_val=59.21.ckpt
2024-09-12 09:33:02.509 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:33:02.539 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2801 [00:00<?, ?it/s]
2024-09-12 09:33:02.594 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:33:02.601 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 1/2801 [00:00<04:59,  9.34it/s]
2024-09-12 09:33:02.756 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:33:02.757 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-12 09:33:03.327 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:33:03.328 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2801/2801 [16:25<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2801/2801 [16:29<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2801/2801 [16:31<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2801/2801 [16:31<00:00,  2.83it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [01:25<00:00,  0.29it/s]
2024-09-12 09:50:59.721 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:50:59.998 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-12 09:50:59.998 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:51:02.925 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:51:03.174 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-12 09:51:03.174 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:51:05.071 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:51:05.311 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-12 09:51:05.312 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:51:09.185 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 09:51:09.431 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-12 09:51:09.432 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 09:51:09.432 | INFO     | retrieval.model:on_predict_epoch_end:567 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [01:35<00:00,  0.26it/s]
2024-09-12 09:51:10.558 | INFO     | retrieval.main:run_cli:60 - PID: 2433820
2024-09-12 09:51:10.560 | INFO     | retrieval.main:run_cli:60 - PID: 2433819
2024-09-12 09:51:10.976 | INFO     | retrieval.main:run_cli:60 - PID: 2433818
[rank: 2] Seed set to 3407
2024-09-12 09:51:11.117 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3
a723c2665f091/random
2024-09-12 09:51:11.117 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414
b3a723c2665f091/corpus.jsonl
[rank: 3] Seed set to 3407
2024-09-12 09:51:11.126 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3
a723c2665f091/random
2024-09-12 09:51:11.126 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414
b3a723c2665f091/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-12 09:51:11.301 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3
a723c2665f091/random
2024-09-12 09:51:11.301 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414
b3a723c2665f091/corpus.jsonl
2024-09-12 09:51:11.748 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f0
91/corpus.jsonl
2024-09-12 09:51:11.809 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f0
91/corpus.jsonl
2024-09-12 09:51:11.892 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f0
91/corpus.jsonl
2024-09-12 09:51:39.782 | INFO     | __main__:main:1507 - Loaded the predictions pickle files
2024-09-12 09:51:39.922 | INFO     | __main__:main:1510 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/test.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2988/2988 [00:00<00:00, 25397.92it/s]
2024-09-12 09:51:40.042 | INFO     | __main__:main:1512 - R@1 = 21.785110457673795 %, R@10 = 57.71218888302529 %, MRR = 0.4910938646590658
2024-09-12 09:51:40.043 | INFO     | retrieval.main:run_cli:60 - PID: 2431132
[rank: 3] Seed set to 3407
[rank: 0] Seed set to 3407
2024-09-12 09:51:40.313 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3
a723c2665f091/random
2024-09-12 09:51:40.313 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414
b3a723c2665f091/corpus.jsonl
2024-09-12 09:51:40.935 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f0
91/corpus.jsonl
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-12 09:52:33.073 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-12 09:52:33.126 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-12 09:52:51.249 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-12 09:52:51.287 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-12 09:52:56.609 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-12 09:52:56.651 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
2024-09-12 09:52:58.082 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_train/cached_data.pkl
Training dataset size: 362149
2024-09-12 09:52:58.117 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1
a445b414b3a723c2665f091/random/cache_pred/cached_data.pkl
Testing dataset size: 5133
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recal
l@10_val=59.21.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall
@10_val=59.21.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-12 09:53:01.312 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:53:01.314 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                           | 0/2783 [00:00<?, ?it/s]
2024-09-12 09:53:01.341 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:53:01.342 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                   | 1/2783 [00:00<07:18,  6.34it/s]
2024-09-12 09:53:01.570 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:53:01.571 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                      | 0/? [00:00<?, ?it/s]
2024-09-12 09:53:02.482 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-12 09:53:02.483 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:19<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:24<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:24<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2783/2783 [16:25<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [01:14<00:00,  0.28it/s]
2024-09-12 10:10:41.840 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 10:10:41.841 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 10:10:41.841 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 10:10:41.841 | INFO     | retrieval.model:on_predict_epoch_end:504 - About to construct predictions map
2024-09-12 10:10:42.046 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-12 10:10:42.047 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 10:10:42.085 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-12 10:10:42.085 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 10:10:42.095 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-12 10:10:42.095 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 10:10:42.096 | INFO     | retrieval.model:on_predict_epoch_end:524 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-12 10:10:42.096 | INFO     | retrieval.model:on_predict_epoch_end:563 - About to call barrier
2024-09-12 10:10:42.096 | INFO     | retrieval.model:on_predict_epoch_end:567 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [01:14<00:00,  0.28it/s]
2024-09-12 10:10:43.481 | INFO     | __main__:main:1616 - Finished processing the repository
2024-09-12 10:10:43.482 | INFO     | __main__:main:1618 - current epoch: 4
2024-09-12 10:10:43.482 | INFO     | __main__:main:1296 - length of lean_git_repos: 13
2024-09-12 10:10:43.482 | INFO     | __main__:main:1297 - i: 2
2024-09-12 10:10:43.482 | INFO     | __main__:main:1327 - All GPUs
2024-09-12 10:10:43.489 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:43.489 | INFO     | __main__:main:1334 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:43.490 | INFO     | __main__:main:1340 - Inside train_test_fisher
2024-09-12 10:10:43.490 | INFO     | __main__:main:1341 - Starting training at epoch 4
[rank: 2] Seed set to 3407
2024-09-12 10:10:44.135 | INFO     | __main__:main:1616 - Finished processing the repository
2024-09-12 10:10:44.136 | INFO     | __main__:main:1618 - current epoch: 4
2024-09-12 10:10:44.136 | INFO     | __main__:main:1296 - length of lean_git_repos: 13
2024-09-12 10:10:44.136 | INFO     | __main__:main:1297 - i: 2
2024-09-12 10:10:44.136 | INFO     | __main__:main:1327 - All GPUs
2024-09-12 10:10:44.140 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:44.140 | INFO     | __main__:main:1334 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:44.140 | INFO     | __main__:main:1340 - Inside train_test_fisher
2024-09-12 10:10:44.140 | INFO     | __main__:main:1341 - Starting training at epoch 4
[rank: 1] Seed set to 3407
2024-09-12 10:10:44.222 | INFO     | __main__:main:1616 - Finished processing the repository
2024-09-12 10:10:44.223 | INFO     | __main__:main:1618 - current epoch: 4
2024-09-12 10:10:44.223 | INFO     | __main__:main:1296 - length of lean_git_repos: 13
2024-09-12 10:10:44.224 | INFO     | __main__:main:1297 - i: 2
2024-09-12 10:10:44.224 | INFO     | __main__:main:1327 - All GPUs
2024-09-12 10:10:44.227 | INFO     | __main__:find_latest_checkpoint:524 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b
933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:44.227 | INFO     | __main__:main:1334 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a604
6c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:44.227 | INFO     | __main__:main:1340 - Inside train_test_fisher
2024-09-12 10:10:44.227 | INFO     | __main__:main:1341 - Starting training at epoch 4
[rank: 3] Seed set to 3407
2024-09-12 10:10:45.839 | INFO     | __main__:main:1507 - Loaded the predictions pickle files
2024-09-12 10:10:45.981 | INFO     | __main__:main:1510 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/te
st.json
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2427/2427 [00:00<00:00, 21563.88it/s]
2024-09-12 10:10:46.098 | INFO     | __main__:main:1512 - R@1 = 24.139303473555827 %, R@10 = 62.164709408238814 %, MRR = 0.5334997620403018
2024-09-12 10:10:46.100 | INFO     | __main__:main:1527 - Average R@1 = 21.684107993211686 %, R@10 = 57.6172568642817 %, MRR = 0.4852211921048367
2024-09-12 10:10:46.101 | INFO     | __main__:main:1563 - Starting the prover
2024-09-12 10:10:46.102 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-12 10:10:46.102 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-12 10:10:46.102 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-09-12 10:10:46.102 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-work
shop_5acd4b933d47fd6c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:46.841 | INFO     | __main__:main:1365 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a
6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:46.985 | INFO     | __main__:main:1423 - right before barrier for data module
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-09-12 10:10:46.989 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6
c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:46.989 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6
c1032798a6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:47.139 | INFO     | __main__:main:1365 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a
6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:47.198 | INFO     | __main__:main:1423 - right before barrier for data module
2024-09-12 10:10:47.335 | INFO     | __main__:main:1365 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a
6046c1baf261445d_lambda_0.1_epoch=3-Recall@10_val=59.21.ckpt
2024-09-12 10:10:47.386 | INFO     | __main__:main:1423 - right before barrier for data module
2024-09-12 10:10:50.022 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'r
etriever.encoder.encoder.embed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0
.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encode
r.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.
layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtte
ntion.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', '
retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wo.weight', 'ret
riever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.weight', 'retriever.encoder.enc
oder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer
.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.
layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.we
ight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retrie
ver.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.
encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block
.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.Den
seReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.q
.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.o.weight', 're
triever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.en
coder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.bl
ock.6.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0
.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseRelu
Dense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight',
'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.en
coder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.8.laye
r.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense
.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.weight
', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever
.encoder.encoder.block.9.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encod
er.block.9.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.
layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.Se
lfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDens
e.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight
', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.o.weight', 'retrie
ver.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_1.weight', 'retriever.enc
oder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_
step', 'epoch', 'state_dict', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-12 10:10:50.932 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-09-12 10:10:50.934 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-12 10:10:50.934 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47f
d6c1032798a6046c1baf261445d/corpus.jsonl
2024-09-12 10:10:50.934 | INFO     | common:__init__:212 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c
1baf261445d/corpus.jsonl
2024-09-12 10:11:13.876 | INFO     | retrieval.model:load_corpus:160 - Embeddings staled load corpus jsonl: True
2024-09-12 10:11:13.876 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_curriculum/merged_with_new_lean-math-workshop_5acd4b933d47fd
6c1032798a6046c1baf261445d/corpus.jsonl
2024-09-12 10:11:13.876 | INFO     | retrieval.model:reindex_corpus:287 - Re-indexing the retrieval corpus
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5608/5608 [09:08<00:00, 10.22it/s]
2024-09-12 10:20:22.359 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-09-12 10:20:22.360 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
(autoscaler +6h47m15s) Tip: use `ray status` to view detailed cluster status. To disable these messages, set RAY_SCHEDULER_EVENTS=0.
(autoscaler +6h47m15s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h47m15s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h48m20s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h48m20s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h49m57s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h50m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h50m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h52m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h52m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h52m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h52m59s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h54m27s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h55m57s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h58m0s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +6h58m0s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +6h58m0s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +6h58m0s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +6h58m29s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h59m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h59m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h59m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h59m56s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +6h59m56s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h2m4s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h2m4s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h3m39s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h4m37s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h5m8s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h5m8s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h5m8s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h5m8s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h5m8s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors
 or adding more nodes to this Ray cluster.
(autoscaler +7h6m39s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h7m11s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h7m11s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h8m11s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h9m10s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actor
s or adding more nodes to this Ray cluster.
(autoscaler +7h10m11s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h10m42s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h12m12s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h13m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h14m44s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h16m17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h16m17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h16m46s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h18m18s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h18m18s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h18m18s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h18m48s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h19m45s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h20m46s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.
(autoscaler +7h20m46s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer acto
rs or adding more nodes to this Ray cluster.

