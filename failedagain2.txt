2024-09-03 05:34:34.512 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 81.62499999999999
2024-09-03 05:34:34.512 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 81.62499999999999
2024-09-03 05:34:34.512 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 81.62499999999999
2024-09-03 05:34:34.513 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 81.62499999999999
2024-09-03 05:34:34.513 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 83.01388888888889
2024-09-03 05:34:34.513 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 83.01388888888889
2024-09-03 05:34:34.513 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 83.63888888888889
2024-09-03 05:34:34.514 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 83.63888888888889
2024-09-03 05:34:34.514 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 83.63888888888889
2024-09-03 05:34:34.514 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 83.63888888888889
2024-09-03 05:34:34.514 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 83.63888888888889
2024-09-03 05:34:34.515 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 84.47222222222223
2024-09-03 05:34:34.515 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 87.13888888888889
2024-09-03 05:34:34.515 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 87.30555555555554
2024-09-03 05:34:34.515 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 87.68055555555556
2024-09-03 05:34:34.516 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 87.68055555555556
2024-09-03 05:34:34.516 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 87.68055555555556
2024-09-03 05:34:34.516 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 87.68055555555556
2024-09-03 05:34:34.516 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 87.68055555555556
2024-09-03 05:34:34.517 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 87.68055555555556
2024-09-03 05:34:34.517 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 87.68055555555556
2024-09-03 05:34:34.517 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 87.68055555555556
2024-09-03 05:34:34.517 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 87.68055555555556
2024-09-03 05:34:34.518 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 87.68055555555556
2024-09-03 05:34:34.518 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 87.81944444444446
2024-09-03 05:34:34.518 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 87.81944444444446
2024-09-03 05:34:34.518 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 88.31944444444444
2024-09-03 05:34:34.519 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 88.31944444444444
2024-09-03 05:34:34.519 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 88.31944444444444
2024-09-03 05:34:34.519 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 88.31944444444444
2024-09-03 05:34:34.519 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 88.31944444444444
2024-09-03 05:34:34.520 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 88.31944444444444
2024-09-03 05:34:34.520 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 88.31944444444444
2024-09-03 05:34:34.520 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 89.15277777777779
2024-09-03 05:34:34.520 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 89.15277777777779
2024-09-03 05:34:34.521 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 89.15277777777779
2024-09-03 05:34:34.521 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 89.15277777777779
2024-09-03 05:34:34.521 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 89.15277777777779
2024-09-03 05:34:34.521 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 89.15277777777779
2024-09-03 05:34:34.522 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 89.15277777777779
2024-09-03 05:34:34.522 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 89.15277777777779
2024-09-03 05:34:34.522 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 89.29166666666667
2024-09-03 05:34:34.522 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 90.54166666666667
2024-09-03 05:34:34.523 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 90.54166666666667
2024-09-03 05:34:34.523 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 90.54166666666667
2024-09-03 05:34:34.523 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 90.54166666666667
2024-09-03 05:34:34.523 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 90.54166666666667
2024-09-03 05:34:34.524 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 90.54166666666667
2024-09-03 05:34:34.524 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 90.54166666666667
2024-09-03 05:34:34.524 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 90.54166666666667
2024-09-03 05:34:34.524 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 90.54166666666667
2024-09-03 05:34:34.525 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 90.54166666666667
2024-09-03 05:34:34.525 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 90.54166666666667
2024-09-03 05:34:34.525 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 91.16666666666667
2024-09-03 05:34:34.525 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 91.16666666666667
2024-09-03 05:34:34.526 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 91.16666666666667
2024-09-03 05:34:34.526 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 91.375
2024-09-03 05:34:34.526 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 91.375
2024-09-03 05:34:34.526 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 91.375
2024-09-03 05:34:34.527 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 91.375
2024-09-03 05:34:34.527 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 92.20833333333334
2024-09-03 05:34:34.527 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 92.20833333333334
2024-09-03 05:34:34.527 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 92.20833333333334
2024-09-03 05:34:34.528 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 92.20833333333334
2024-09-03 05:34:34.528 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 92.20833333333334
2024-09-03 05:34:34.528 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 92.20833333333334
2024-09-03 05:34:34.528 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 92.20833333333334
2024-09-03 05:34:34.529 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 93.04166666666667
2024-09-03 05:34:34.529 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 93.04166666666667
2024-09-03 05:34:34.529 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 93.04166666666667
2024-09-03 05:34:34.529 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 94.43055555555556
2024-09-03 05:34:34.530 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 94.43055555555556
2024-09-03 05:34:34.530 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 94.43055555555556
2024-09-03 05:34:34.530 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 94.43055555555556
2024-09-03 05:34:34.530 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 94.43055555555556
2024-09-03 05:34:34.531 | INFO     | retrieval.model:validation_step:382 - MRR: 0.6048978908518382
2024-09-03 05:34:34.531 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                 2
024-09-03 05:34:34.541 | INFO     | retrieval.model:validation_step:318 - Inside validation_step███████████████████████████████████████████████████████                           | 27/33 [00:49<00:11,  0.54it/s]
2024-09-03 05:34:34.541 | INFO     | retrieval.model:validation_step:319 - All training loss for epoch
2024-09-03 05:34:34.556 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-03 05:34:36.443 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 18.666666666666664
2024-09-03 05:34:36.444 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 31.047619047619047
2024-09-03 05:34:36.444 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 35.57142857142857
2024-09-03 05:34:36.444 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 39.71428571428571
2024-09-03 05:34:36.445 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 43.52380952380951
2024-09-03 05:34:36.445 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 46.69841269841269
2024-09-03 05:34:36.445 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 57.49206349206348
2024-09-03 05:34:36.446 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 57.49206349206348
2024-09-03 05:34:36.446 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 61.23809523809523
2024-09-03 05:34:36.446 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 61.55555555555554
2024-09-03 05:34:36.446 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 62.50793650793649
2024-09-03 05:34:36.447 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 63.77777777777778
2024-09-03 05:34:36.447 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 66.71428571428571
2024-09-03 05:34:36.447 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 67.98412698412697
2024-09-03 05:34:36.447 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 67.98412698412697
2024-09-03 05:34:36.448 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 70.36507936507938
2024-09-03 05:34:36.448 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 70.36507936507938
2024-09-03 05:34:36.448 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 70.36507936507938
2024-09-03 05:34:36.448 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 70.36507936507938
2024-09-03 05:34:36.449 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 70.36507936507938
2024-09-03 05:34:36.449 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 70.36507936507938
2024-09-03 05:34:36.449 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 71.7936507936508
2024-09-03 05:34:36.449 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 72.36507936507937
2024-09-03 05:34:36.450 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 73.7936507936508
2024-09-03 05:34:36.450 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 73.7936507936508
2024-09-03 05:34:36.450 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 73.7936507936508
2024-09-03 05:34:36.450 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 73.7936507936508
2024-09-03 05:34:36.451 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 73.7936507936508
2024-09-03 05:34:36.451 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 73.7936507936508
2024-09-03 05:34:36.451 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 74.5079365079365
2024-09-03 05:34:36.451 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 74.5079365079365
2024-09-03 05:34:36.452 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 75.07936507936508
2024-09-03 05:34:36.452 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 75.07936507936508
2024-09-03 05:34:36.452 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 75.79365079365078
2024-09-03 05:34:36.452 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 75.79365079365078
2024-09-03 05:34:36.453 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 75.79365079365078
2024-09-03 05:34:36.453 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 75.79365079365078
2024-09-03 05:34:36.453 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 75.79365079365078
2024-09-03 05:34:36.453 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 75.79365079365078
2024-09-03 05:34:36.454 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 75.79365079365078
2024-09-03 05:34:36.454 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 75.79365079365078
2024-09-03 05:34:36.454 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 75.79365079365078
2024-09-03 05:34:36.454 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 76.74603174603175
2024-09-03 05:34:36.455 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 76.74603174603175
2024-09-03 05:34:36.455 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 76.74603174603175
2024-09-03 05:34:36.455 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 76.74603174603175
2024-09-03 05:34:36.455 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 77.31746031746032
2024-09-03 05:34:36.456 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 77.31746031746032
2024-09-03 05:34:36.456 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 77.31746031746032
2024-09-03 05:34:36.456 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 77.31746031746032
2024-09-03 05:34:36.456 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 77.31746031746032
2024-09-03 05:34:36.457 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 77.31746031746032
2024-09-03 05:34:36.457 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 77.31746031746032
2024-09-03 05:34:36.457 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 77.31746031746032
2024-09-03 05:34:36.457 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 77.31746031746032
2024-09-03 05:34:36.458 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 77.31746031746032
2024-09-03 05:34:36.458 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 77.31746031746032
2024-09-03 05:34:36.458 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 77.31746031746032
2024-09-03 05:34:36.458 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 77.31746031746032
2024-09-03 05:34:36.459 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 78.26984126984128
2024-09-03 05:34:36.459 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 78.26984126984128
2024-09-03 05:34:36.459 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 78.26984126984128
2024-09-03 05:34:36.459 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 78.26984126984128
2024-09-03 05:34:36.460 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 78.26984126984128
2024-09-03 05:34:36.460 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 78.26984126984128
2024-09-03 05:34:36.460 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 78.26984126984128
2024-09-03 05:34:36.460 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 78.26984126984128
2024-09-03 05:34:36.461 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 78.26984126984128
2024-09-03 05:34:36.461 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 78.26984126984128
2024-09-03 05:34:36.461 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 78.26984126984128
2024-09-03 05:34:36.461 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 78.5873015873016
2024-09-03 05:34:36.462 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 79.15873015873017
2024-09-03 05:34:36.462 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 79.15873015873017
2024-09-03 05:34:36.462 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 79.15873015873017
2024-09-03 05:34:36.462 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 79.15873015873017
2024-09-03 05:34:36.463 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 79.15873015873017
2024-09-03 05:34:36.463 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 79.15873015873017
2024-09-03 05:34:36.463 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 79.15873015873017
2024-09-03 05:34:36.463 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 80.58730158730158
2024-09-03 05:34:36.464 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 80.58730158730158
2024-09-03 05:34:36.464 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 82.01587301587303
2024-09-03 05:34:36.464 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 82.01587301587303
2024-09-03 05:34:36.464 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 82.01587301587303
2024-09-03 05:34:36.465 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 82.01587301587303
2024-09-03 05:34:36.465 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 82.01587301587303
2024-09-03 05:34:36.465 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 82.01587301587303
2024-09-03 05:34:36.465 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 82.01587301587303
2024-09-03 05:34:36.466 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 82.01587301587303
2024-09-03 05:34:36.466 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 82.01587301587303
2024-09-03 05:34:36.466 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 82.01587301587303
2024-09-03 05:34:36.466 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 82.01587301587303
2024-09-03 05:34:36.467 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 82.01587301587303
2024-09-03 05:34:36.467 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 82.01587301587303
2024-09-03 05:34:36.467 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 82.01587301587303
2024-09-03 05:34:36.467 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 82.01587301587303
2024-09-03 05:34:36.468 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 82.01587301587303
2024-09-03 05:34:36.468 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 82.01587301587303
2024-09-03 05:34:36.468 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 82.01587301587303
2024-09-03 05:34:36.468 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 82.01587301587303
2024-09-03 05:34:36.469 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 82.01587301587303
2024-09-03 05:34:36.469 | INFO     | retrieval.model:validation_step:382 - MRR: 0.49758462359302696
2024-09-03 05:34:36.469 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                 2
024-09-03 05:34:36.479 | INFO     | retrieval.model:validation_step:318 - Inside validation_step███████████████████████████████████████████████████████████▌                      | 28/33 [00:51<00:09,  0.54it/s]
2024-09-03 05:34:36.479 | INFO     | retrieval.model:validation_step:319 - All training loss for epoch
2024-09-03 05:34:36.494 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-03 05:34:38.197 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 25.476190476190474
2024-09-03 05:34:38.198 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 36.52380952380952
2024-09-03 05:34:38.198 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 45.09523809523809
2024-09-03 05:34:38.198 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 48.42857142857142
2024-09-03 05:34:38.199 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 52.95238095238095
2024-09-03 05:34:38.199 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 60.57142857142856
2024-09-03 05:34:38.199 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 61.285714285714285
2024-09-03 05:34:38.199 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 65.0952380952381
2024-09-03 05:34:38.200 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 67.0
2024-09-03 05:34:38.200 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 67.0
2024-09-03 05:34:38.200 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 67.0
2024-09-03 05:34:38.200 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 68.42857142857143
2024-09-03 05:34:38.201 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 69.38095238095238
2024-09-03 05:34:38.201 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 70.33333333333334
2024-09-03 05:34:38.201 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 72.47619047619048
2024-09-03 05:34:38.202 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 72.47619047619048
2024-09-03 05:34:38.202 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 75.33333333333333
2024-09-03 05:34:38.202 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 75.90476190476191
2024-09-03 05:34:38.202 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 75.90476190476191
2024-09-03 05:34:38.203 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 79.33333333333333
2024-09-03 05:34:38.203 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 79.33333333333333
2024-09-03 05:34:38.203 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 79.33333333333333
2024-09-03 05:34:38.203 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 79.33333333333333
2024-09-03 05:34:38.204 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 79.33333333333333
2024-09-03 05:34:38.204 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 83.14285714285714
2024-09-03 05:34:38.204 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 86.0
2024-09-03 05:34:38.204 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 86.0
2024-09-03 05:34:38.205 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 86.0
2024-09-03 05:34:38.205 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 86.0
2024-09-03 05:34:38.205 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 86.0
2024-09-03 05:34:38.205 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 86.0
2024-09-03 05:34:38.206 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 86.0
2024-09-03 05:34:38.206 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 86.0
2024-09-03 05:34:38.206 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 86.0
2024-09-03 05:34:38.206 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 86.71428571428571
2024-09-03 05:34:38.207 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 87.42857142857142
2024-09-03 05:34:38.207 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 87.42857142857142
2024-09-03 05:34:38.207 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 87.42857142857142
2024-09-03 05:34:38.207 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 87.42857142857142
2024-09-03 05:34:38.208 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 87.42857142857142
2024-09-03 05:34:38.208 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 87.42857142857142
2024-09-03 05:34:38.208 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 87.42857142857142
2024-09-03 05:34:38.208 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 88.0
2024-09-03 05:34:38.209 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 88.95238095238095
2024-09-03 05:34:38.209 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 88.95238095238095
2024-09-03 05:34:38.209 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 88.95238095238095
2024-09-03 05:34:38.210 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 88.95238095238095
2024-09-03 05:34:38.210 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 88.95238095238095
2024-09-03 05:34:38.210 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 88.95238095238095
2024-09-03 05:34:38.210 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 88.95238095238095
2024-09-03 05:34:38.211 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 88.95238095238095
2024-09-03 05:34:38.211 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 88.95238095238095
2024-09-03 05:34:38.211 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 88.95238095238095
2024-09-03 05:34:38.211 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 88.95238095238095
2024-09-03 05:34:38.212 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 88.95238095238095
2024-09-03 05:34:38.212 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 88.95238095238095
2024-09-03 05:34:38.212 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 88.95238095238095
2024-09-03 05:34:38.212 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 88.95238095238095
2024-09-03 05:34:38.213 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 88.95238095238095
2024-09-03 05:34:38.213 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 88.95238095238095
2024-09-03 05:34:38.213 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 88.95238095238095
2024-09-03 05:34:38.213 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 88.95238095238095
2024-09-03 05:34:38.214 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 88.95238095238095
2024-09-03 05:34:38.214 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 88.95238095238095
2024-09-03 05:34:38.214 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 88.95238095238095
2024-09-03 05:34:38.214 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 88.95238095238095
2024-09-03 05:34:38.215 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 88.95238095238095
2024-09-03 05:34:38.215 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 88.95238095238095
2024-09-03 05:34:38.215 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 88.95238095238095
2024-09-03 05:34:38.215 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 88.95238095238095
2024-09-03 05:34:38.216 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 88.95238095238095
2024-09-03 05:34:38.216 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 90.38095238095238
2024-09-03 05:34:38.216 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 90.38095238095238
2024-09-03 05:34:38.216 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 91.33333333333334
2024-09-03 05:34:38.217 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 91.33333333333334
2024-09-03 05:34:38.217 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 91.33333333333334
2024-09-03 05:34:38.217 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 91.33333333333334
2024-09-03 05:34:38.217 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 91.33333333333334
2024-09-03 05:34:38.218 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 91.33333333333334
2024-09-03 05:34:38.218 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 91.33333333333334
2024-09-03 05:34:38.218 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 91.33333333333334
2024-09-03 05:34:38.218 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 91.33333333333334
2024-09-03 05:34:38.219 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 91.33333333333334
2024-09-03 05:34:38.219 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 91.33333333333334
2024-09-03 05:34:38.219 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 91.33333333333334
2024-09-03 05:34:38.219 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 91.33333333333334
2024-09-03 05:34:38.220 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 91.33333333333334
2024-09-03 05:34:38.220 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 91.33333333333334
2024-09-03 05:34:38.220 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 91.9047619047619
2024-09-03 05:34:38.220 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 91.9047619047619
2024-09-03 05:34:38.221 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 91.9047619047619
2024-09-03 05:34:38.221 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 91.9047619047619
2024-09-03 05:34:38.221 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 91.9047619047619
2024-09-03 05:34:38.221 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 91.9047619047619
2024-09-03 05:34:38.222 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 91.9047619047619
2024-09-03 05:34:38.222 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 91.9047619047619
2024-09-03 05:34:38.222 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 91.9047619047619
2024-09-03 05:34:38.222 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 91.9047619047619
2024-09-03 05:34:38.223 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 91.9047619047619
2024-09-03 05:34:38.223 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 91.9047619047619
2024-09-03 05:34:38.223 | INFO     | retrieval.model:validation_step:382 - MRR: 0.5465414781297134
2024-09-03 05:34:38.223 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                 2
024-09-03 05:34:38.233 | INFO     | retrieval.model:validation_step:318 - Inside validation_step████████████████████████████████████████████████████████████████                  | 29/33 [00:53<00:07,  0.54it/s]
2024-09-03 05:34:38.233 | INFO     | retrieval.model:validation_step:319 - All training loss for epoch
2024-09-03 05:34:38.247 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-03 05:34:40.127 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 24.14529914529914
2024-09-03 05:34:40.128 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 31.41025641025641
2024-09-03 05:34:40.128 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 39.31623931623932
2024-09-03 05:34:40.128 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 45.08547008547008
2024-09-03 05:34:40.129 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 50.85470085470085
2024-09-03 05:34:40.129 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 54.059829059829056
2024-09-03 05:34:40.129 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 59.18803418803419
2024-09-03 05:34:40.129 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 63.67521367521367
2024-09-03 05:34:40.130 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 65.5982905982906
2024-09-03 05:34:40.130 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 65.5982905982906
2024-09-03 05:34:40.130 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 67.52136752136751
2024-09-03 05:34:40.130 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 68.80341880341881
2024-09-03 05:34:40.131 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 69.65811965811966
2024-09-03 05:34:40.131 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 72.22222222222221
2024-09-03 05:34:40.131 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 75.42735042735043
2024-09-03 05:34:40.132 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 76.28205128205127
2024-09-03 05:34:40.132 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 78.84615384615384
2024-09-03 05:34:40.132 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 78.84615384615384
2024-09-03 05:34:40.132 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 79.48717948717949
2024-09-03 05:34:40.133 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 79.91452991452992
2024-09-03 05:34:40.133 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 83.76068376068378
2024-09-03 05:34:40.133 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 83.76068376068378
2024-09-03 05:34:40.133 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 84.18803418803418
2024-09-03 05:34:40.134 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 84.18803418803418
2024-09-03 05:34:40.134 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 84.18803418803418
2024-09-03 05:34:40.134 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 84.18803418803418
2024-09-03 05:34:40.134 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 84.18803418803418
2024-09-03 05:34:40.135 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 89.3162393162393
2024-09-03 05:34:40.135 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 89.3162393162393
2024-09-03 05:34:40.135 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 89.3162393162393
2024-09-03 05:34:40.135 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 89.3162393162393
2024-09-03 05:34:40.136 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 89.3162393162393
2024-09-03 05:34:40.136 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 89.3162393162393
2024-09-03 05:34:40.136 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 89.3162393162393
2024-09-03 05:34:40.136 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 89.3162393162393
2024-09-03 05:34:40.137 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 89.3162393162393
2024-09-03 05:34:40.137 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 89.3162393162393
2024-09-03 05:34:40.137 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 90.17094017094016
2024-09-03 05:34:40.137 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 90.17094017094016
2024-09-03 05:34:40.138 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 90.17094017094016
2024-09-03 05:34:40.138 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 90.17094017094016
2024-09-03 05:34:40.138 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 90.17094017094016
2024-09-03 05:34:40.138 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 90.17094017094016
2024-09-03 05:34:40.139 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 90.17094017094016
2024-09-03 05:34:40.139 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 90.17094017094016
2024-09-03 05:34:40.139 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 90.17094017094016
2024-09-03 05:34:40.139 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 90.17094017094016
2024-09-03 05:34:40.140 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 90.17094017094016
2024-09-03 05:34:40.140 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 90.17094017094016
2024-09-03 05:34:40.140 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 90.17094017094016
2024-09-03 05:34:40.140 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 90.17094017094016
2024-09-03 05:34:40.141 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 90.17094017094016
2024-09-03 05:34:40.141 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 90.17094017094016
2024-09-03 05:34:40.141 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 90.17094017094016
2024-09-03 05:34:40.141 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 90.17094017094016
2024-09-03 05:34:40.142 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 90.17094017094016
2024-09-03 05:34:40.142 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 90.17094017094016
2024-09-03 05:34:40.142 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 90.17094017094016
2024-09-03 05:34:40.142 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 92.73504273504273
2024-09-03 05:34:40.143 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 92.73504273504273
2024-09-03 05:34:40.143 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 92.73504273504273
2024-09-03 05:34:40.143 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 92.73504273504273
2024-09-03 05:34:40.143 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 92.73504273504273
2024-09-03 05:34:40.144 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 92.73504273504273
2024-09-03 05:34:40.144 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 92.73504273504273
2024-09-03 05:34:40.144 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 92.73504273504273
2024-09-03 05:34:40.144 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 92.73504273504273
2024-09-03 05:34:40.145 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 92.73504273504273
2024-09-03 05:34:40.145 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 92.73504273504273
2024-09-03 05:34:40.145 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 92.73504273504273
2024-09-03 05:34:40.145 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 92.73504273504273
2024-09-03 05:34:40.146 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 92.73504273504273
2024-09-03 05:34:40.146 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 93.16239316239316
2024-09-03 05:34:40.146 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 93.16239316239316
2024-09-03 05:34:40.146 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 93.16239316239316
2024-09-03 05:34:40.147 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 93.16239316239316
2024-09-03 05:34:40.147 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 93.16239316239316
2024-09-03 05:34:40.147 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 93.16239316239316
2024-09-03 05:34:40.147 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 93.16239316239316
2024-09-03 05:34:40.148 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 93.16239316239316
2024-09-03 05:34:40.148 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 93.16239316239316
2024-09-03 05:34:40.148 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 93.16239316239316
2024-09-03 05:34:40.148 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 93.16239316239316
2024-09-03 05:34:40.149 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 93.16239316239316
2024-09-03 05:34:40.149 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 93.16239316239316
2024-09-03 05:34:40.149 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 95.72649572649571
2024-09-03 05:34:40.149 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 95.72649572649571
2024-09-03 05:34:40.150 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 95.72649572649571
2024-09-03 05:34:40.150 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 95.72649572649571
2024-09-03 05:34:40.150 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 97.008547008547
2024-09-03 05:34:40.150 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 97.008547008547
2024-09-03 05:34:40.151 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 97.008547008547
2024-09-03 05:34:40.151 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 97.008547008547
2024-09-03 05:34:40.151 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 97.008547008547
2024-09-03 05:34:40.151 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 97.008547008547
2024-09-03 05:34:40.152 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 97.008547008547
2024-09-03 05:34:40.152 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 97.008547008547
2024-09-03 05:34:40.152 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 97.008547008547
2024-09-03 05:34:40.152 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 97.008547008547
2024-09-03 05:34:40.153 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 97.008547008547
2024-09-03 05:34:40.153 | INFO     | retrieval.model:validation_step:382 - MRR: 0.4692587452595221
2024-09-03 05:34:40.153 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                 2
024-09-03 05:34:40.163 | INFO     | retrieval.model:validation_step:318 - Inside validation_step████████████████████████████████████████████████████████████████████▌             | 30/33 [00:55<00:05,  0.54it/s]
2024-09-03 05:34:40.163 | INFO     | retrieval.model:validation_step:319 - All training loss for epoch
2024-09-03 05:34:40.178 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-03 05:34:42.131 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 22.725225225225227
2024-09-03 05:34:42.132 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 30.698198198198195
2024-09-03 05:34:42.132 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 32.04954954954955
2024-09-03 05:34:42.132 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 35.2027027027027
2024-09-03 05:34:42.132 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 37.9054054054054
2024-09-03 05:34:42.133 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 43.1981981981982
2024-09-03 05:34:42.133 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 44.54954954954955
2024-09-03 05:34:42.133 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 49.14414414414415
2024-09-03 05:34:42.133 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 53.64864864864865
2024-09-03 05:34:42.134 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 53.64864864864865
2024-09-03 05:34:42.134 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 55.90090090090089
2024-09-03 05:34:42.134 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 56.8018018018018
2024-09-03 05:34:42.134 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 60.38288288288288
2024-09-03 05:34:42.135 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 62.74774774774774
2024-09-03 05:34:42.135 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 64.77477477477477
2024-09-03 05:34:42.135 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 69.50450450450451
2024-09-03 05:34:42.136 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 69.50450450450451
2024-09-03 05:34:42.136 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 72.2072072072072
2024-09-03 05:34:42.136 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 72.2072072072072
2024-09-03 05:34:42.136 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 72.2072072072072
2024-09-03 05:34:42.137 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 72.2072072072072
2024-09-03 05:34:42.137 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 72.2072072072072
2024-09-03 05:34:42.137 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 72.2072072072072
2024-09-03 05:34:42.137 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 72.88288288288288
2024-09-03 05:34:42.138 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 76.12612612612611
2024-09-03 05:34:42.138 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 76.12612612612611
2024-09-03 05:34:42.138 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 76.12612612612611
2024-09-03 05:34:42.138 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 79.16666666666666
2024-09-03 05:34:42.139 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 80.51801801801801
2024-09-03 05:34:42.139 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 81.19369369369369
2024-09-03 05:34:42.139 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 81.19369369369369
2024-09-03 05:34:42.139 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 81.19369369369369
2024-09-03 05:34:42.140 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 81.19369369369369
2024-09-03 05:34:42.140 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 82.77027027027027
2024-09-03 05:34:42.140 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 82.77027027027027
2024-09-03 05:34:42.140 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 83.1081081081081
2024-09-03 05:34:42.141 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 83.1081081081081
2024-09-03 05:34:42.141 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 83.1081081081081
2024-09-03 05:34:42.141 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 84.45945945945947
2024-09-03 05:34:42.141 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 84.45945945945947
2024-09-03 05:34:42.142 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 84.45945945945947
2024-09-03 05:34:42.142 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 84.45945945945947
2024-09-03 05:34:42.142 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 84.45945945945947
2024-09-03 05:34:42.142 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 84.45945945945947
2024-09-03 05:34:42.143 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 84.45945945945947
2024-09-03 05:34:42.143 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 84.45945945945947
2024-09-03 05:34:42.143 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 84.45945945945947
2024-09-03 05:34:42.143 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 84.45945945945947
2024-09-03 05:34:42.144 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 84.45945945945947
2024-09-03 05:34:42.144 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 84.45945945945947
2024-09-03 05:34:42.144 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 84.45945945945947
2024-09-03 05:34:42.144 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 84.45945945945947
2024-09-03 05:34:42.145 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 84.45945945945947
2024-09-03 05:34:42.145 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 85.8108108108108
2024-09-03 05:34:42.145 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 85.8108108108108
2024-09-03 05:34:42.145 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 86.48648648648648
2024-09-03 05:34:42.146 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 86.48648648648648
2024-09-03 05:34:42.146 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 86.48648648648648
2024-09-03 05:34:42.146 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 86.48648648648648
2024-09-03 05:34:42.146 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 87.83783783783784
2024-09-03 05:34:42.147 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 87.83783783783784
2024-09-03 05:34:42.147 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 87.83783783783784
2024-09-03 05:34:42.147 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 87.83783783783784
2024-09-03 05:34:42.147 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 87.83783783783784
2024-09-03 05:34:42.148 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 87.83783783783784
2024-09-03 05:34:42.148 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 87.83783783783784
2024-09-03 05:34:42.148 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 87.83783783783784
2024-09-03 05:34:42.148 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 87.83783783783784
2024-09-03 05:34:42.149 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 87.83783783783784
2024-09-03 05:34:42.149 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 87.83783783783784
2024-09-03 05:34:42.149 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 87.83783783783784
2024-09-03 05:34:42.149 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 87.83783783783784
2024-09-03 05:34:42.150 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 87.83783783783784
2024-09-03 05:34:42.150 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 87.83783783783784
2024-09-03 05:34:42.150 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 87.83783783783784
2024-09-03 05:34:42.150 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 87.83783783783784
2024-09-03 05:34:42.151 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 87.83783783783784
2024-09-03 05:34:42.151 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 87.83783783783784
2024-09-03 05:34:42.151 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 87.83783783783784
2024-09-03 05:34:42.151 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 87.83783783783784
2024-09-03 05:34:42.152 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 87.83783783783784
2024-09-03 05:34:42.152 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 87.83783783783784
2024-09-03 05:34:42.152 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 87.83783783783784
2024-09-03 05:34:42.152 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 87.83783783783784
2024-09-03 05:34:42.153 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 87.83783783783784
2024-09-03 05:34:42.153 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 87.83783783783784
2024-09-03 05:34:42.153 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 87.83783783783784
2024-09-03 05:34:42.153 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 87.83783783783784
2024-09-03 05:34:42.154 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 87.83783783783784
2024-09-03 05:34:42.154 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 87.83783783783784
2024-09-03 05:34:42.154 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 87.83783783783784
2024-09-03 05:34:42.154 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 87.83783783783784
2024-09-03 05:34:42.155 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 87.83783783783784
2024-09-03 05:34:42.155 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 87.83783783783784
2024-09-03 05:34:42.155 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 87.83783783783784
2024-09-03 05:34:42.155 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 87.83783783783784
2024-09-03 05:34:42.156 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 87.83783783783784
2024-09-03 05:34:42.156 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 87.83783783783784
2024-09-03 05:34:42.156 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 87.83783783783784
2024-09-03 05:34:42.156 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 87.83783783783784
2024-09-03 05:34:42.157 | INFO     | retrieval.model:validation_step:382 - MRR: 0.4678276383448797
2024-09-03 05:34:42.157 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                 2
024-09-03 05:34:42.166 | INFO     | retrieval.model:validation_step:318 - Inside validation_step█████████████████████████████████████████████████████████████████████████         | 31/33 [00:57<00:03,  0.54it/s]
2024-09-03 05:34:42.166 | INFO     | retrieval.model:validation_step:319 - All training loss for epoch
2024-09-03 05:34:42.181 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-03 05:34:44.056 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 21.62162162162162
2024-09-03 05:34:44.056 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 32.88288288288289
2024-09-03 05:34:44.057 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 38.288288288288285
2024-09-03 05:34:44.057 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 54.05405405405405
2024-09-03 05:34:44.057 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 60.36036036036035
2024-09-03 05:34:44.058 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 68.46846846846847
2024-09-03 05:34:44.058 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 71.17117117117117
2024-09-03 05:34:44.058 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 72.52252252252251
2024-09-03 05:34:44.058 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 77.47747747747749
2024-09-03 05:34:44.059 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 77.47747747747749
2024-09-03 05:34:44.059 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 78.82882882882883
2024-09-03 05:34:44.059 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 78.82882882882883
2024-09-03 05:34:44.059 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 79.2792792792793
2024-09-03 05:34:44.060 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 80.18018018018019
2024-09-03 05:34:44.060 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 82.8828828828829
2024-09-03 05:34:44.060 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 84.23423423423424
2024-09-03 05:34:44.060 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 84.23423423423424
2024-09-03 05:34:44.061 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 84.23423423423424
2024-09-03 05:34:44.061 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 84.23423423423424
2024-09-03 05:34:44.061 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 84.23423423423424
2024-09-03 05:34:44.062 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 84.23423423423424
2024-09-03 05:34:44.062 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 84.23423423423424
2024-09-03 05:34:44.062 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 84.23423423423424
2024-09-03 05:34:44.062 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 84.23423423423424
2024-09-03 05:34:44.063 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 85.13513513513513
2024-09-03 05:34:44.063 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 87.83783783783784
2024-09-03 05:34:44.063 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 87.83783783783784
2024-09-03 05:34:44.063 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 87.83783783783784
2024-09-03 05:34:44.064 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 87.83783783783784
2024-09-03 05:34:44.064 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 87.83783783783784
2024-09-03 05:34:44.064 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 87.83783783783784
2024-09-03 05:34:44.064 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 88.73873873873872
2024-09-03 05:34:44.065 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 88.73873873873872
2024-09-03 05:34:44.065 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 88.73873873873872
2024-09-03 05:34:44.065 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 88.73873873873872
2024-09-03 05:34:44.065 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 88.73873873873872
2024-09-03 05:34:44.066 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 90.09009009009009
2024-09-03 05:34:44.066 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 90.09009009009009
2024-09-03 05:34:44.066 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 90.09009009009009
2024-09-03 05:34:44.066 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 90.09009009009009
2024-09-03 05:34:44.067 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 90.09009009009009
2024-09-03 05:34:44.067 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 90.09009009009009
2024-09-03 05:34:44.067 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 90.09009009009009
2024-09-03 05:34:44.067 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 90.09009009009009
2024-09-03 05:34:44.068 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 90.09009009009009
2024-09-03 05:34:44.068 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 91.44144144144143
2024-09-03 05:34:44.068 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 91.44144144144143
2024-09-03 05:34:44.068 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 92.79279279279278
2024-09-03 05:34:44.069 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 92.79279279279278
2024-09-03 05:34:44.069 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 92.79279279279278
2024-09-03 05:34:44.069 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 94.14414414414412
2024-09-03 05:34:44.069 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 94.14414414414412
2024-09-03 05:34:44.070 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 94.14414414414412
2024-09-03 05:34:44.070 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 95.49549549549549
2024-09-03 05:34:44.070 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 95.49549549549549
2024-09-03 05:34:44.070 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 95.49549549549549
2024-09-03 05:34:44.071 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 95.49549549549549
2024-09-03 05:34:44.071 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 95.49549549549549
2024-09-03 05:34:44.071 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 95.49549549549549
2024-09-03 05:34:44.071 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 95.49549549549549
2024-09-03 05:34:44.072 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 95.49549549549549
2024-09-03 05:34:44.072 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 95.49549549549549
2024-09-03 05:34:44.072 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 95.49549549549549
2024-09-03 05:34:44.072 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 95.49549549549549
2024-09-03 05:34:44.073 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 95.49549549549549
2024-09-03 05:34:44.073 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 95.49549549549549
2024-09-03 05:34:44.073 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 95.49549549549549
2024-09-03 05:34:44.073 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 95.49549549549549
2024-09-03 05:34:44.074 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 95.49549549549549
2024-09-03 05:34:44.074 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 95.49549549549549
2024-09-03 05:34:44.074 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 95.49549549549549
2024-09-03 05:34:44.074 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 95.49549549549549
2024-09-03 05:34:44.075 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 95.49549549549549
2024-09-03 05:34:44.075 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 95.49549549549549
2024-09-03 05:34:44.075 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 95.49549549549549
2024-09-03 05:34:44.075 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 96.84684684684683
2024-09-03 05:34:44.076 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 96.84684684684683
2024-09-03 05:34:44.076 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 96.84684684684683
2024-09-03 05:34:44.076 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 96.84684684684683
2024-09-03 05:34:44.076 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 96.84684684684683
2024-09-03 05:34:44.077 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 96.84684684684683
2024-09-03 05:34:44.077 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 96.84684684684683
2024-09-03 05:34:44.077 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 96.84684684684683
2024-09-03 05:34:44.077 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 96.84684684684683
2024-09-03 05:34:44.078 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 96.84684684684683
2024-09-03 05:34:44.078 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 96.84684684684683
2024-09-03 05:34:44.078 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 96.84684684684683
2024-09-03 05:34:44.078 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 96.84684684684683
2024-09-03 05:34:44.079 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 96.84684684684683
2024-09-03 05:34:44.079 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 96.84684684684683
2024-09-03 05:34:44.079 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 96.84684684684683
2024-09-03 05:34:44.079 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 96.84684684684683
2024-09-03 05:34:44.080 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 96.84684684684683
2024-09-03 05:34:44.080 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 96.84684684684683
2024-09-03 05:34:44.080 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 96.84684684684683
2024-09-03 05:34:44.080 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 98.19819819819818
2024-09-03 05:34:44.081 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 98.19819819819818
2024-09-03 05:34:44.081 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 98.19819819819818
2024-09-03 05:34:44.081 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 98.19819819819818
2024-09-03 05:34:44.081 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 98.19819819819818
2024-09-03 05:34:44.082 | INFO     | retrieval.model:validation_step:382 - MRR: 0.48897662647662643
2024-09-03 05:34:44.082 | INFO     | retrieval.model:validation_step:390 - End of validation_step
                                                                                                                                                                                                                 2
024-09-03 05:34:44.089 | INFO     | retrieval.model:validation_step:318 - Inside validation_step█████████████████████████████████████████████████████████████████████████████▌    | 32/33 [00:59<00:01,  0.54it/s]
2024-09-03 05:34:44.089 | INFO     | retrieval.model:validation_step:319 - All training loss for epoch
2024-09-03 05:34:44.104 | INFO     | retrieval.model:validation_step:323 - Embeddings staled validation step: False
2024-09-03 05:34:45.017 | INFO     | retrieval.model:validation_step:373 - Recall@1_val: 37.5
2024-09-03 05:34:45.018 | INFO     | retrieval.model:validation_step:373 - Recall@2_val: 56.25
2024-09-03 05:34:45.018 | INFO     | retrieval.model:validation_step:373 - Recall@3_val: 63.888888888888886
2024-09-03 05:34:45.019 | INFO     | retrieval.model:validation_step:373 - Recall@4_val: 65.27777777777779
2024-09-03 05:34:45.019 | INFO     | retrieval.model:validation_step:373 - Recall@5_val: 65.97222222222221
2024-09-03 05:34:45.019 | INFO     | retrieval.model:validation_step:373 - Recall@6_val: 66.66666666666666
2024-09-03 05:34:45.020 | INFO     | retrieval.model:validation_step:373 - Recall@7_val: 71.52777777777777
2024-09-03 05:34:45.020 | INFO     | retrieval.model:validation_step:373 - Recall@8_val: 76.38888888888889
2024-09-03 05:34:45.020 | INFO     | retrieval.model:validation_step:373 - Recall@9_val: 78.47222222222221
2024-09-03 05:34:45.020 | INFO     | retrieval.model:validation_step:373 - Recall@10_val: 78.47222222222221
2024-09-03 05:34:45.021 | INFO     | retrieval.model:validation_step:373 - Recall@11_val: 78.47222222222221
2024-09-03 05:34:45.021 | INFO     | retrieval.model:validation_step:373 - Recall@12_val: 79.8611111111111
2024-09-03 05:34:45.021 | INFO     | retrieval.model:validation_step:373 - Recall@13_val: 79.8611111111111
2024-09-03 05:34:45.021 | INFO     | retrieval.model:validation_step:373 - Recall@14_val: 81.94444444444443
2024-09-03 05:34:45.022 | INFO     | retrieval.model:validation_step:373 - Recall@15_val: 83.33333333333334
2024-09-03 05:34:45.022 | INFO     | retrieval.model:validation_step:373 - Recall@16_val: 83.33333333333334
2024-09-03 05:34:45.022 | INFO     | retrieval.model:validation_step:373 - Recall@17_val: 84.02777777777777
2024-09-03 05:34:45.022 | INFO     | retrieval.model:validation_step:373 - Recall@18_val: 84.02777777777777
2024-09-03 05:34:45.023 | INFO     | retrieval.model:validation_step:373 - Recall@19_val: 85.41666666666666
2024-09-03 05:34:45.023 | INFO     | retrieval.model:validation_step:373 - Recall@20_val: 86.1111111111111
2024-09-03 05:34:45.023 | INFO     | retrieval.model:validation_step:373 - Recall@21_val: 86.1111111111111
2024-09-03 05:34:45.023 | INFO     | retrieval.model:validation_step:373 - Recall@22_val: 86.1111111111111
2024-09-03 05:34:45.024 | INFO     | retrieval.model:validation_step:373 - Recall@23_val: 88.19444444444443
2024-09-03 05:34:45.024 | INFO     | retrieval.model:validation_step:373 - Recall@24_val: 88.19444444444443
2024-09-03 05:34:45.024 | INFO     | retrieval.model:validation_step:373 - Recall@25_val: 88.19444444444443
2024-09-03 05:34:45.024 | INFO     | retrieval.model:validation_step:373 - Recall@26_val: 88.19444444444443
2024-09-03 05:34:45.025 | INFO     | retrieval.model:validation_step:373 - Recall@27_val: 92.3611111111111
2024-09-03 05:34:45.025 | INFO     | retrieval.model:validation_step:373 - Recall@28_val: 92.3611111111111
2024-09-03 05:34:45.025 | INFO     | retrieval.model:validation_step:373 - Recall@29_val: 92.3611111111111
2024-09-03 05:34:45.025 | INFO     | retrieval.model:validation_step:373 - Recall@30_val: 92.3611111111111
2024-09-03 05:34:45.026 | INFO     | retrieval.model:validation_step:373 - Recall@31_val: 92.3611111111111
2024-09-03 05:34:45.026 | INFO     | retrieval.model:validation_step:373 - Recall@32_val: 93.05555555555557
2024-09-03 05:34:45.026 | INFO     | retrieval.model:validation_step:373 - Recall@33_val: 93.05555555555557
2024-09-03 05:34:45.026 | INFO     | retrieval.model:validation_step:373 - Recall@34_val: 93.05555555555557
2024-09-03 05:34:45.027 | INFO     | retrieval.model:validation_step:373 - Recall@35_val: 93.05555555555557
2024-09-03 05:34:45.027 | INFO     | retrieval.model:validation_step:373 - Recall@36_val: 93.05555555555557
2024-09-03 05:34:45.027 | INFO     | retrieval.model:validation_step:373 - Recall@37_val: 93.05555555555557
2024-09-03 05:34:45.027 | INFO     | retrieval.model:validation_step:373 - Recall@38_val: 93.05555555555557
2024-09-03 05:34:45.028 | INFO     | retrieval.model:validation_step:373 - Recall@39_val: 93.05555555555557
2024-09-03 05:34:45.028 | INFO     | retrieval.model:validation_step:373 - Recall@40_val: 93.05555555555557
2024-09-03 05:34:45.028 | INFO     | retrieval.model:validation_step:373 - Recall@41_val: 93.05555555555557
2024-09-03 05:34:45.028 | INFO     | retrieval.model:validation_step:373 - Recall@42_val: 93.05555555555557
2024-09-03 05:34:45.029 | INFO     | retrieval.model:validation_step:373 - Recall@43_val: 93.05555555555557
2024-09-03 05:34:45.029 | INFO     | retrieval.model:validation_step:373 - Recall@44_val: 93.05555555555557
2024-09-03 05:34:45.029 | INFO     | retrieval.model:validation_step:373 - Recall@45_val: 93.05555555555557
2024-09-03 05:34:45.029 | INFO     | retrieval.model:validation_step:373 - Recall@46_val: 93.05555555555557
2024-09-03 05:34:45.030 | INFO     | retrieval.model:validation_step:373 - Recall@47_val: 93.05555555555557
2024-09-03 05:34:45.030 | INFO     | retrieval.model:validation_step:373 - Recall@48_val: 93.05555555555557
2024-09-03 05:34:45.030 | INFO     | retrieval.model:validation_step:373 - Recall@49_val: 93.05555555555557
2024-09-03 05:34:45.030 | INFO     | retrieval.model:validation_step:373 - Recall@50_val: 93.05555555555557
2024-09-03 05:34:45.031 | INFO     | retrieval.model:validation_step:373 - Recall@51_val: 93.05555555555557
2024-09-03 05:34:45.031 | INFO     | retrieval.model:validation_step:373 - Recall@52_val: 93.05555555555557
2024-09-03 05:34:45.031 | INFO     | retrieval.model:validation_step:373 - Recall@53_val: 93.05555555555557
2024-09-03 05:34:45.031 | INFO     | retrieval.model:validation_step:373 - Recall@54_val: 93.05555555555557
2024-09-03 05:34:45.032 | INFO     | retrieval.model:validation_step:373 - Recall@55_val: 93.05555555555557
2024-09-03 05:34:45.032 | INFO     | retrieval.model:validation_step:373 - Recall@56_val: 93.05555555555557
2024-09-03 05:34:45.032 | INFO     | retrieval.model:validation_step:373 - Recall@57_val: 93.05555555555557
2024-09-03 05:34:45.032 | INFO     | retrieval.model:validation_step:373 - Recall@58_val: 93.05555555555557
2024-09-03 05:34:45.033 | INFO     | retrieval.model:validation_step:373 - Recall@59_val: 93.05555555555557
2024-09-03 05:34:45.033 | INFO     | retrieval.model:validation_step:373 - Recall@60_val: 97.22222222222223
2024-09-03 05:34:45.033 | INFO     | retrieval.model:validation_step:373 - Recall@61_val: 97.22222222222223
2024-09-03 05:34:45.033 | INFO     | retrieval.model:validation_step:373 - Recall@62_val: 97.22222222222223
2024-09-03 05:34:45.034 | INFO     | retrieval.model:validation_step:373 - Recall@63_val: 97.22222222222223
2024-09-03 05:34:45.034 | INFO     | retrieval.model:validation_step:373 - Recall@64_val: 97.22222222222223
2024-09-03 05:34:45.034 | INFO     | retrieval.model:validation_step:373 - Recall@65_val: 97.91666666666666
2024-09-03 05:34:45.034 | INFO     | retrieval.model:validation_step:373 - Recall@66_val: 97.91666666666666
2024-09-03 05:34:45.035 | INFO     | retrieval.model:validation_step:373 - Recall@67_val: 97.91666666666666
2024-09-03 05:34:45.035 | INFO     | retrieval.model:validation_step:373 - Recall@68_val: 97.91666666666666
2024-09-03 05:34:45.035 | INFO     | retrieval.model:validation_step:373 - Recall@69_val: 97.91666666666666
2024-09-03 05:34:45.035 | INFO     | retrieval.model:validation_step:373 - Recall@70_val: 97.91666666666666
2024-09-03 05:34:45.036 | INFO     | retrieval.model:validation_step:373 - Recall@71_val: 97.91666666666666
2024-09-03 05:34:45.036 | INFO     | retrieval.model:validation_step:373 - Recall@72_val: 97.91666666666666
2024-09-03 05:34:45.036 | INFO     | retrieval.model:validation_step:373 - Recall@73_val: 97.91666666666666
2024-09-03 05:34:45.036 | INFO     | retrieval.model:validation_step:373 - Recall@74_val: 98.6111111111111
2024-09-03 05:34:45.037 | INFO     | retrieval.model:validation_step:373 - Recall@75_val: 98.6111111111111
2024-09-03 05:34:45.037 | INFO     | retrieval.model:validation_step:373 - Recall@76_val: 98.6111111111111
2024-09-03 05:34:45.037 | INFO     | retrieval.model:validation_step:373 - Recall@77_val: 98.6111111111111
2024-09-03 05:34:45.037 | INFO     | retrieval.model:validation_step:373 - Recall@78_val: 98.6111111111111
2024-09-03 05:34:45.038 | INFO     | retrieval.model:validation_step:373 - Recall@79_val: 98.6111111111111
2024-09-03 05:34:45.038 | INFO     | retrieval.model:validation_step:373 - Recall@80_val: 98.6111111111111
2024-09-03 05:34:45.038 | INFO     | retrieval.model:validation_step:373 - Recall@81_val: 98.6111111111111
2024-09-03 05:34:45.038 | INFO     | retrieval.model:validation_step:373 - Recall@82_val: 98.6111111111111
2024-09-03 05:34:45.039 | INFO     | retrieval.model:validation_step:373 - Recall@83_val: 98.6111111111111
2024-09-03 05:34:45.039 | INFO     | retrieval.model:validation_step:373 - Recall@84_val: 98.6111111111111
2024-09-03 05:34:45.039 | INFO     | retrieval.model:validation_step:373 - Recall@85_val: 98.6111111111111
2024-09-03 05:34:45.039 | INFO     | retrieval.model:validation_step:373 - Recall@86_val: 98.6111111111111
2024-09-03 05:34:45.040 | INFO     | retrieval.model:validation_step:373 - Recall@87_val: 98.6111111111111
2024-09-03 05:34:45.040 | INFO     | retrieval.model:validation_step:373 - Recall@88_val: 98.6111111111111
2024-09-03 05:34:45.040 | INFO     | retrieval.model:validation_step:373 - Recall@89_val: 98.6111111111111
2024-09-03 05:34:45.040 | INFO     | retrieval.model:validation_step:373 - Recall@90_val: 98.6111111111111
2024-09-03 05:34:45.041 | INFO     | retrieval.model:validation_step:373 - Recall@91_val: 98.6111111111111
2024-09-03 05:34:45.041 | INFO     | retrieval.model:validation_step:373 - Recall@92_val: 98.6111111111111
2024-09-03 05:34:45.041 | INFO     | retrieval.model:validation_step:373 - Recall@93_val: 100.0
2024-09-03 05:34:45.041 | INFO     | retrieval.model:validation_step:373 - Recall@94_val: 100.0
2024-09-03 05:34:45.042 | INFO     | retrieval.model:validation_step:373 - Recall@95_val: 100.0
2024-09-03 05:34:45.042 | INFO     | retrieval.model:validation_step:373 - Recall@96_val: 100.0
2024-09-03 05:34:45.042 | INFO     | retrieval.model:validation_step:373 - Recall@97_val: 100.0
2024-09-03 05:34:45.042 | INFO     | retrieval.model:validation_step:373 - Recall@98_val: 100.0
2024-09-03 05:34:45.043 | INFO     | retrieval.model:validation_step:373 - Recall@99_val: 100.0
2024-09-03 05:34:45.043 | INFO     | retrieval.model:validation_step:373 - Recall@100_val: 100.0
2024-09-03 05:34:45.043 | INFO     | retrieval.model:validation_step:382 - MRR: 0.7558752204585537
2024-09-03 05:34:45.043 | INFO     | retrieval.model:validation_step:390 - End of validation_step
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37307/37307 [2:52:21<00:00,  3.61it/s, v_num=17084]
Metric Recall@10_val improved by 10.604 >= min_delta = 0.0. New best score: 70.071
Epoch 1, global step 31743: 'Recall@10_val' reached 70.07054 (best 70.07054), saving model to '/data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c
916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt' as top 1
`Trainer.fit` stopped: `max_epochs=2` reached.
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37307/37307 [2:52:24<00:00,  3.61it/s, v_num=17084]
2024-09-03 05:34:51.412 | INFO     | __main__:train_test_fisher:722 - Finished progressive training at epoch 2
2024-09-03 05:34:53.830 | INFO     | __main__:train_test_fisher:741 - Testing...
2024-09-03 05:34:53.833 | INFO     | retrieval.main:run_cli:55 - PID: 3881482
[rank: 0] Seed set to 3407
2024-09-03 05:34:54.037 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/random
2024-09-03 05:34:54.037 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c9
16e62655744/corpus.jsonl
2024-09-03 05:34:54.650 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/c
orpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-03 05:35:02.628 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71
da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-03 05:35:02.644 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71
da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1230, in main
[rank0]:     proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo
)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1115, in retrieve_proof
[rank0]:     train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 753, in train_test_fisher
[rank0]:     run_cli(best_model_path, data_path)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
[rank0]:     cli = CLI(PremiseRetriever, RetrievalDataModule)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
[rank0]:     self._run_subcommand(self.subcommand)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
[rank0]:     fn(**fn_kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
[rank0]:     return call._call_and_handle_interrupt(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
[rank0]:     return trainer_fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
[rank0]:     results = self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
[rank0]:     call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 93, in _call_setup_hook
[rank0]:     _call_callback_hooks(trainer, "setup", stage=fn)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 208, in _call_callback_hooks
[rank0]:     fn(trainer, trainer.lightning_module, *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 257, in setup
[rank0]:     raise RuntimeError(
[rank0]: RuntimeError: SaveConfigCallback expected /data/yingzi_ma/lean_project/ReProver/lightning_logs/version_17084/config.yaml to NOT exist. Aborting to avoid overwriting results of a previous run. You can d
elete the previous config file, set `LightningCLI(save_config_callback=None)` to disable config saving, or set `LightningCLI(save_config_kwargs={"overwrite": True})` to overwrite the config file.

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1254, in <module>
[rank0]:     main()
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1250, in main
[rank0]:     logger.info(f"An error occurred: {e}", file=sys.stderr)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2044, in info
[rank0]:     __self._log("INFO", False, __self._options, __message, args, kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2021, in _log
[rank0]:     log_record["message"] = message.format(*args, **kwargs)
[rank0]: KeyError: '"overwrite"'
[rank0]:[W903 05:39:39.481588051 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destro
y_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. Thi
s constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
(base) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-03 06:34:05,775] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-03 06:34:09.398 | INFO     | __main__:main:1204 - Running progressive training
2024-09-03 06:34:09.398 | INFO     | __main__:main:1210 - Configuring LeanDojo...
2024-09-03 06:34:09.401 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-03 06:34:09.401 | INFO     | __main__:main:1212 - LeanDojo configured
2024-09-03 06:34:11.055 | INFO     | __main__:search_github_repositories:392 - Processing leanprover/lean4
2024-09-03 06:34:11.055 | INFO     | __main__:search_github_repositories:410 - Skipping leanprover/lean4 since it is a known repository
2024-09-03 06:34:11.055 | INFO     | __main__:search_github_repositories:392 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-03 06:34:11.940 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Ret
rying...
2024-09-03 06:34:12.990 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Ret
rying...
2024-09-03 06:34:15.019 | INFO     | __main__:search_github_repositories:408 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-03 06:34:15.020 | INFO     | __main__:search_github_repositories:392 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-03 06:34:15.934 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0-rc1
2024-09-03 06:34:31.584 | INFO     | __main__:search_github_repositories:392 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-03 06:34:32.440 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-03 06:34:33.469 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-03 06:34:35.499 | INFO     | __main__:search_github_repositories:408 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-03 06:34:35.500 | INFO     | __main__:search_github_repositories:392 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-03 06:34:36.435 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-03 06:34:37.464 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-03 06:34:39.493 | INFO     | __main__:search_github_repositories:408 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-03 06:34:39.494 | INFO     | __main__:search_github_repositories:392 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-03 06:34:40.274 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-03 06:34:41.303 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-03 06:34:43.334 | INFO     | __main__:search_github_repositories:408 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-03 06:34:43.335 | INFO     | __main__:search_github_repositories:392 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-03 06:34:44.074 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-03 06:34:45.105 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-03 06:34:47.134 | INFO     | __main__:search_github_repositories:408 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-03 06:34:47.135 | INFO     | __main__:search_github_repositories:392 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-03 06:34:47.979 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolc
hain failed. Retrying...
2024-09-03 06:34:49.010 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolc
hain failed. Retrying...
2024-09-03 06:34:51.041 | INFO     | __main__:search_github_repositories:408 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-03 06:34:51.041 | INFO     | __main__:search_github_repositories:392 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-03 06:34:51.718 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-03 06:35:07.205 | INFO     | __main__:retrieve_proof:1016 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-03 06:35:07.205 | INFO     | __main__:retrieve_proof:1032 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-03 06:35:07.205 | INFO     | __main__:retrieve_proof:1033 - Lean version: v4.8.0
2024-09-03 06:35:07.438 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-03 06:35:22.810 | INFO     | __main__:retrieve_proof:1038 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb13
10
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 06:35:22.810 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 06:35:22.811 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 06:35:22.811 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 06:35:22.812 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 06:35:22.884 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-03 06:35:22.884 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-03 06:35:22.884 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-03 06:35:22.890 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-03 06:35:22.890 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-03 06:35:22.890 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-03 06:35:22.892 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-03 06:35:22.893 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7
c0fe19306beb1310/mathlib4
2024-09-03 06:35:25.114 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b
29e73438e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [10:49<00:00,  8.49it/s]
2024-09-03 06:46:14.578 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240
a427bcecc7c0fe19306beb1310')
2024-09-03 06:46:15.984 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-03 06:46:32.315 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-03 06:46:48.699 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-03 06:47:04.131 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-03 06:47:05.235 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-03 06:47:07.796 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-03 06:47:08.425 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0
2024-09-03 06:47:24.014 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-03 06:47:33.712 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-03 06:47:35.069 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-03 06:47:35.464 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-03 06:47:36.096 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-03 06:47:36.720 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-03 06:47:52.644 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-03 06:47:53.364 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='e490631b72a43a6a82b4ddd3
a2d020b2029491d0')
2024-09-03 06:47:53.994 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-09-03 06:48:10.006 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-03 06:48:26.731 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-03 06:48:28.244 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an uns
upported Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-03 06:48:28.245 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='8feac540abb78
1cb1349688c816dc02fae66b49c')
2024-09-03 06:48:28.434 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='2c8ae451ce9ffc83
554322b14437159c1a9703f9')
2024-09-03 06:48:28.701 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='ad85095b6112bb3a7
ad6c068fd0844d1e35706f2')
2024-09-03 06:48:29.153 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c6
1280c77ade6bbf0bc3c66a44fe2e0c5')
2024-09-03 06:48:29.644 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a0
9350b675ef3e347d0')
2024-09-03 06:48:29.969 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='3e96ea03ed
d48b932566ca9b201285ae2d57130d')
2024-09-03 06:48:59.349 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='
2b29e73438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='e9e858a4484905a0bfe97c4f05c3924ead02eed8'), 'batteries': LeanGitRepo(url='https:
//github.com/leanprover-community/batteries', commit='fa571ea02a804b52a59e58012b1e21fe4f0514f2'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b
961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community
/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRe
po(url='https://github.com/leanprover/doc-gen4', commit='e490631b72a43a6a82b4ddd3a2d020b2029491d0'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56f
b005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='929690af200efb291babee737b087d244a70c3c3'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQu
ery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='3e96ea03edd48b932566ca9b201285ae2d57130d')}, root_dir=Pos
ixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-03 06:49:18.474 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-03 06:49:18.475 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it in
stead.
2024-09-03 06:49:18.475 | INFO     | __main__:retrieve_proof:1046 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-03 06:49:32.077 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 06:49:32.078 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 06:49:33.773 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-03 06:49:33.773 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 54525.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 52717.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:02<00:00, 50801.18it/s]
2024-09-03 06:52:38.366 | INFO     | __main__:retrieve_proof:1084 - Before adding new repo:
2024-09-03 06:52:38.366 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-03 06:52:38.366 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 06:52:38.366 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-03 06:52:38.366 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 06:52:38.366 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in
the database.
2024-09-03 06:52:38.366 | INFO     | __main__:retrieve_proof:1087 - After adding new repo:
2024-09-03 06:52:38.366 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-03 06:52:38.367 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 06:52:38.367 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-03 06:52:58.352 | INFO     | __main__:retrieve_proof:1097 - Adding repo to repos_for_merged_dataset
2024-09-03 06:52:58.355 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-03 06:52:58.355 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 06:55:26.285 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
already exists. Removing it now.
2024-09-03 06:55:49.161 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcec
c7c0fe19306beb1310
2024-09-03 06:55:49.749 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e
240a427bcecc7c0fe19306beb1310
2024-09-03 06:55:49.763 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310
2024-09-03 06:55:49.766 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310
2024-09-03 06:55:49.789 | INFO     | __main__:find_latest_checkpoint:475 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e
71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-03 06:55:49.789 | INFO     | __main__:retrieve_proof:1109 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c91
6e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-03 06:55:49.789 | INFO     | __main__:train_test_fisher:615 - Inside train_test_fisher
2024-09-03 06:55:49.789 | INFO     | __main__:train_test_fisher:616 - Starting training at epoch 0
Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the
default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-mo
dels for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer
be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you
 don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-03 06:55:53.802 | INFO     | __main__:train_test_fisher:640 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6e
b9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default
. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-03 06:55:53.906 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/
corpus.jsonl
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:16<00:00, 7140.68it/s]
2024-09-03 06:56:32.228 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 7007.78it/s]
2024-09-03 06:56:32.670 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4904
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 6666.55it/s]
2024-09-03 06:56:33.128 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
Training dataset size after load: 358647
Validation dataset size after load: 4904
Testing dataset size after load: 5431
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data/yingzi_ma/lean_project/ReProver/main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-03 06:56:33.213 | INFO     | __main__:train_test_fisher:714 - Starting progressive training from epoch 0 to 1
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-03 06:56:34.561 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
2024-09-03 06:56:34.757 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4904
2024-09-03 06:56:34.793 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc exi
sts and is not empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.0
7.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the
default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-mo
dels for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer
be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you
 don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
2024-09-03 06:56:35.788 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.
ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-03 06:56:39.402 | INFO     | __main__:train_test_fisher:722 - Finished progressive training at epoch 2
2024-09-03 06:56:41.217 | INFO     | __main__:train_test_fisher:741 - Testing...
2024-09-03 06:56:41.220 | INFO     | retrieval.main:run_cli:55 - PID: 4056235
[rank: 0] Seed set to 3407
2024-09-03 06:56:41.441 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/random
2024-09-03 06:56:41.441 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c9
16e62655744/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default
. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-03 06:56:42.109 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/c
orpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-03 06:56:49.522 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71
da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-03 06:56:49.539 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71
da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.0
7.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07
.ckpt
Predicting: |                                                                                                                                                                               | 0/? [00:00<?, ?it/s]
2024-09-03 06:56:53.104 | INFO     | retrieval.model:on_predict_start:401 - Embeddings staled on predict start: True
2024-09-03 06:56:53.105 | INFO     | retrieval.model:reindex_corpus:281 - Inside reindex_corpus
2024-09-03 06:56:53.105 | INFO     | retrieval.model:reindex_corpus:286 - Re-indexing the retrieval corpus
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1692/1692 [08:50<00:00,  3.19it/s]
2024-09-03 07:05:43.588 | INFO     | retrieval.model:reindex_corpus:308 - End of reindex_corpus███████████████████████████████████████████████████████████████████████████████| 1692/1692 [08:50<00:00,  2.08it/s]
2024-09-03 07:05:43.588 | INFO     | retrieval.model:reindex_corpus:309 - Embeddings staled end of reindex corpus: False
Predicting DataLoader 0:   0%|                                                                                                                                                             | 0/36 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [01:08<00:00,  0.53it/s]
2024-09-03 07:06:52.050 | INFO     | retrieval.model:on_predict_epoch_end:511 - About to construct predictions map
2024-09-03 07:06:52.207 | INFO     | retrieval.model:on_predict_epoch_end:531 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-03 07:06:52.207 | INFO     | retrieval.model:on_predict_epoch_end:573 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [01:08<00:00,  0.52it/s]
2024-09-03 07:06:53.485 | INFO     | retrieval.main:run_cli:59 - Configuration:

2024-09-03 07:06:53.617 | INFO     | __main__:train_test_fisher:761 - Loaded the predictions pickle files
2024-09-03 07:06:53.649 | INFO     | __main__:train_test_fisher:764 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/r
andom/test.json
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1444/1444 [00:00<00:00, 61875.03it/s]
2024-09-03 07:06:53.674 | INFO     | __main__:train_test_fisher:766 - R@1 = 26.065137583053975 %, R@10 = 68.26946112944785 %, MRR = 0.5730865533349457
2024-09-03 07:06:53.676 | INFO     | retrieval.main:run_cli:55 - PID: 4056235
[rank: 0] Seed set to 3407
2024-09-03 07:06:53.904 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19
306beb1310/random
2024-09-03 07:06:53.904 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe
19306beb1310/corpus.jsonl
2024-09-03 07:06:54.469 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-03 07:07:14.396 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
2024-09-03 07:07:14.428 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1230, in main
[rank0]:     proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo
)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1115, in retrieve_proof
[rank0]:     train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 753, in train_test_fisher
[rank0]:     run_cli(best_model_path, data_path)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
[rank0]:     cli = CLI(PremiseRetriever, RetrievalDataModule)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
[rank0]:     self._run_subcommand(self.subcommand)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
[rank0]:     fn(**fn_kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
[rank0]:     return call._call_and_handle_interrupt(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
[rank0]:     return trainer_fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
[rank0]:     results = self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
[rank0]:     call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 93, in _call_setup_hook
[rank0]:     _call_callback_hooks(trainer, "setup", stage=fn)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 208, in _call_callback_hooks
[rank0]:     fn(trainer, trainer.lightning_module, *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 257, in setup
[rank0]:     raise RuntimeError(
[rank0]: RuntimeError: SaveConfigCallback expected /data/yingzi_ma/lean_project/ReProver/lightning_logs/version_17084/config.yaml to NOT exist. Aborting to avoid overwriting results of a previous run. You can d
elete the previous config file, set `LightningCLI(save_config_callback=None)` to disable config saving, or set `LightningCLI(save_config_kwargs={"overwrite": True})` to overwrite the config file.

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1254, in <module>
[rank0]:     main()
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1250, in main
[rank0]:     logger.info(f"An error occurred: {e}", file=sys.stderr)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2044, in info
[rank0]:     __self._log("INFO", False, __self._options, __message, args, kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2021, in _log
[rank0]:     log_record["message"] = message.format(*args, **kwargs)
[rank0]: KeyError: '"overwrite"'
[rank0]:[W903 07:12:37.352875012 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destro
y_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. Thi
s constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
(base) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ python test_logs.py
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/test_logs.py", line 4, in <module>
    import pytorch_lightning as pl
ModuleNotFoundError: No module named 'pytorch_lightning'
(base) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ conda activate ReProver
\(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ python test_logs.py


/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python test_logs.py ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python test_logs.py ...
You are using a CUDA device ('NVIDIA A100-SXM4-80GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for p
erformance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
EE
======================================================================

ERROR: test_custom_logging_directory (__main__.TestPyTorchLightningLogging)
----------------------------------------------------------------------
======================================================================
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/test_logs.py", line 28, in setUp
    shutil.rmtree(self.test_dir)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
FileNotFoundError: [Errno 2] No such file or directory: 'test_lightning_logs'
ERROR: test_custom_logging_directory (__main__.TestPyTorchLightningLogging)

----------------------------------------------------------------------
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/test_logs.py", line 28, in setUp
    shutil.rmtree(self.test_dir)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
FileNotFoundError: [Errno 2] No such file or directory: 'test_lightning_logs'
Ran 1 test in 0.004s


----------------------------------------------------------------------
FAILED (errors=1)
Ran 1 test in 0.004s

FAILED (errors=1)
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
[rank: 2] Child process with PID 160950 terminated with code 1. Forcefully terminating all other processes to avoid zombies 🧟
Killed
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ python test_logs.py
test_custom_logging_directory (__main__.TestPyTorchLightningLogging) ... Test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Removing existing test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Creating test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Starting test_custom_logging_directory
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python test_logs.py ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Trainer initialized with default_root_dir: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python test_logs.py ...
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
test_custom_logging_directory (__main__.TestPyTorchLightningLogging) ... test_custom_logging_directory (__main__.TestPyTorchLightningLogging) ... test_custom_logging_directory (__main__.TestPyTorchLightningLogg
ing) ... Test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Removing existing test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Removing existing test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Removing existing test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Creating test directory: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
ERROR
ERROR

======================================================================
ERROR: test_custom_logging_directory (__main__.TestPyTorchLightningLogging)

----------------------------------------------------------------------
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/test_logs.py", line 30, in setUp
    shutil.rmtree(self.test_dir)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/ReProver/test_lightning_logs'
======================================================================

----------------------------------------------------------------------
ERROR: test_custom_logging_directory (__main__.TestPyTorchLightningLogging)
----------------------------------------------------------------------
Ran 1 test in 0.003s
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/test_logs.py", line 30, in setUp
    shutil.rmtree(self.test_dir)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/data/yingzi_ma/lean_project/ReProver/test_lightning_logs'


----------------------------------------------------------------------
FAILED (errors=1)
Ran 1 test in 0.003s

FAILED (errors=1)
Starting test_custom_logging_directory
Trainer initialized with default_root_dir: /data/yingzi_ma/lean_project/ReProver/test_lightning_logs
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
[rank: 1] Child process with PID 164005 terminated with code 1. Forcefully terminating all other processes to avoid zombies 🧟
Killed
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srun python test_logs.py
^Csrun: Cancelled pending job step with signal 2
srun: error: Unable to create step for job 17084: Job/step already completing or completed
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srun python test_logs.py -u
^Csrun: Cancelled pending job step with signal 2
srun: error: Unable to create step for job 17084: Job/step already completing or completed
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srun python test_pytorch_lightning_logging.py > output.log 2> error.log ^C
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srun --pty python test_pytorch_lightning_logging.py
^Csrun: Cancelled pending job step with signal 2
srun: error: Unable to create step for job 17084: Job/step already completing or completed
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srun python test_pytorch_lightning_logging.py > output.log 2> error.log
^C(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srn python test_logs.py >> test_logs.log 2>&1
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ srun python test_logs.py >> test_logs.log 2>&1
^C(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ python
Python 3.10.14 (main, May  6 2024, 19:42:50) [GCC 11.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> import shutil
orch_lightning as pl
import torch
from torch impor>>> import unittest
t nn
from torch.utils.data import DataLoader, TensorDataset>>> import pytorch_lightning as pl

>>> import torch
>>> from torch import nn
>>> from torch.utils.data import DataLoader, TensorDataset
>>> test_dir = os.path.abspath('test_lightning_logs')
>>> os.path.exists(test_dir)
True
>>> exit()
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-03 15:19:15,081] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-03 15:19:18.304 | INFO     | __main__:main:1204 - Running progressive training
2024-09-03 15:19:18.304 | INFO     | __main__:main:1210 - Configuring LeanDojo...
2024-09-03 15:19:18.307 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-03 15:19:18.307 | INFO     | __main__:main:1212 - LeanDojo configured
2024-09-03 15:19:20.303 | INFO     | __main__:search_github_repositories:392 - Processing leanprover/lean4
2024-09-03 15:19:20.304 | INFO     | __main__:search_github_repositories:410 - Skipping leanprover/lean4 since it is a known repository
2024-09-03 15:19:20.304 | INFO     | __main__:search_github_repositories:392 - Processing leanprover-community/mathlib3
Cloning https://github.com/leanprover-community/mathlib3.git
Repo name: leanprover-community/mathlib3
2024-09-03 15:19:21.231 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Ret
rying...
2024-09-03 15:19:22.261 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/leanprover-community/mathlib3/65a1391a0106c9204fe45bc73a039f056558cb83/lean-toolchain failed. Ret
rying...
2024-09-03 15:19:24.293 | INFO     | __main__:search_github_repositories:408 - Failed to clone leanprover-community/mathlib3 because of HTTP Error 404: Not Found
2024-09-03 15:19:24.293 | INFO     | __main__:search_github_repositories:392 - Processing leanprover-community/mathlib4
Cloning https://github.com/leanprover-community/mathlib4.git
Repo name: leanprover-community/mathlib4
2024-09-03 15:19:25.058 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.12.0-rc1
2024-09-03 15:19:40.738 | INFO     | __main__:search_github_repositories:392 - Processing uwdb/Cosette
Cloning https://github.com/uwdb/Cosette.git
Repo name: uwdb/Cosette
2024-09-03 15:19:41.506 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-03 15:19:42.535 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/uwdb/Cosette/c16b48ec7d278c717a9f1da3684f69621b3863f2/lean-toolchain failed. Retrying...
2024-09-03 15:19:44.565 | INFO     | __main__:search_github_repositories:408 - Failed to clone uwdb/Cosette because of HTTP Error 404: Not Found
2024-09-03 15:19:44.565 | INFO     | __main__:search_github_repositories:392 - Processing AndrasKovacs/smalltt
Cloning https://github.com/AndrasKovacs/smalltt.git
Repo name: AndrasKovacs/smalltt
2024-09-03 15:19:45.311 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-03 15:19:46.340 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/AndrasKovacs/smalltt/b5fc9b3747dcbf8c71ca9f976afb7b574b630996/lean-toolchain failed. Retrying...
2024-09-03 15:19:48.370 | INFO     | __main__:search_github_repositories:408 - Failed to clone AndrasKovacs/smalltt because of HTTP Error 404: Not Found
2024-09-03 15:19:48.370 | INFO     | __main__:search_github_repositories:392 - Processing dselsam/certigrad
Cloning https://github.com/dselsam/certigrad.git
Repo name: dselsam/certigrad
2024-09-03 15:19:49.176 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-03 15:19:50.205 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/dselsam/certigrad/c9a06e93f1ec58196d6d3b8563b29868d916727f/lean-toolchain failed. Retrying...
2024-09-03 15:19:52.234 | INFO     | __main__:search_github_repositories:408 - Failed to clone dselsam/certigrad because of HTTP Error 404: Not Found
2024-09-03 15:19:52.235 | INFO     | __main__:search_github_repositories:392 - Processing Kha/electrolysis
Cloning https://github.com/Kha/electrolysis.git
Repo name: Kha/electrolysis
2024-09-03 15:19:52.952 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-03 15:19:53.981 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/Kha/electrolysis/bd4655d91ca65856fb8373637ce3e7b17ee3a190/lean-toolchain failed. Retrying...
2024-09-03 15:19:56.010 | INFO     | __main__:search_github_repositories:408 - Failed to clone Kha/electrolysis because of HTTP Error 404: Not Found
2024-09-03 15:19:56.010 | INFO     | __main__:search_github_repositories:392 - Processing ImperialCollegeLondon/formalising-mathematics
Cloning https://github.com/ImperialCollegeLondon/formalising-mathematics.git
Repo name: ImperialCollegeLondon/formalising-mathematics
2024-09-03 15:19:56.818 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolc
hain failed. Retrying...
2024-09-03 15:19:57.848 | DEBUG    | lean_dojo.utils:read_url:178 - Request to https://raw.githubusercontent.com/ImperialCollegeLondon/formalising-mathematics/d81ad67e36774eb68f242bcc1b88d33dacfd87bf/lean-toolc
hain failed. Retrying...
2024-09-03 15:19:59.877 | INFO     | __main__:search_github_repositories:408 - Failed to clone ImperialCollegeLondon/formalising-mathematics because of HTTP Error 404: Not Found
2024-09-03 15:19:59.877 | INFO     | __main__:search_github_repositories:392 - Processing lecopivo/SciLean
Cloning https://github.com/lecopivo/SciLean.git
Repo name: lecopivo/SciLean
2024-09-03 15:20:00.687 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc2
Found 2 repositories
Using lambda = 0.1
Processing /data/yingzi_ma/lean_project/repos_new/leanprover-community/mathlib4
2024-09-03 15:20:16.336 | INFO     | __main__:retrieve_proof:1016 - Processing https://github.com/leanprover-community/mathlib4.git
2024-09-03 15:20:16.336 | INFO     | __main__:retrieve_proof:1032 - Found compatible commit 2b29e73438e240a427bcecc7c0fe19306beb1310 for https://github.com/leanprover-community/mathlib4.git
2024-09-03 15:20:16.336 | INFO     | __main__:retrieve_proof:1033 - Lean version: v4.8.0
2024-09-03 15:20:16.671 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0
2024-09-03 15:20:32.628 | INFO     | __main__:retrieve_proof:1038 - Generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:324 - Generating dataset to go into /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb13
10
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:331 - lean toolchain version: {'content': 'leanprover/lean4:v4.8.0\n'}
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:333 - lean version v: v4.8.0
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:334 - is supported: True
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:344 - lean path1 /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:345 - lean path2 /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 15:20:32.628 | INFO     | generate_benchmark_lean4:main:346 - lean path3 ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 15:20:32.629 | INFO     | generate_benchmark_lean4:main:350 - Lean toolchain path 2 does not exist: /.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 15:20:32.630 | INFO     | generate_benchmark_lean4:main:352 - Lean toolchain path 3 does not exist: ~/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 15:20:32.630 | INFO     | generate_benchmark_lean4:main:355 - Switched to Lean toolchain at: /data/yingzi_ma/.elan/toolchains/leanprover--lean4---4.8.0
2024-09-03 15:20:32.700 | INFO     | generate_benchmark_lean4:main:357 - lean --version: Lean (version 4.8.0, x86_64-unknown-linux-gnu, commit df668f00e6c0, Release)

2024-09-03 15:20:32.700 | INFO     | generate_benchmark_lean4:main:358 - repo: LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240a427bcecc7c0fe19306beb1310')
2024-09-03 15:20:32.700 | INFO     | generate_benchmark_lean4:main:360 - Configuring LeanDojo again...
2024-09-03 15:20:32.706 | INFO     | generate_benchmark_lean4:configure_leandojo:317 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-03 15:20:32.706 | INFO     | generate_benchmark_lean4:main:362 - LeanDojo configured
2024-09-03 15:20:32.706 | INFO     | generate_benchmark_lean4:main:365 - Tracing the repo...
2024-09-03 15:20:32.708 | DEBUG    | lean_dojo.data_extraction.trace:get_traced_repo_path:87 - The traced repo is available in the cache.
2024-09-03 15:20:32.708 | INFO     | lean_dojo.data_extraction.trace:trace:116 - Loading the traced repo from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7
c0fe19306beb1310/mathlib4
2024-09-03 15:20:34.388 | DEBUG    | lean_dojo.data_extraction.traced_data:load_from_disk:1123 - Loading 5514 traced XML files from /data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b
29e73438e240a427bcecc7c0fe19306beb1310/mathlib4 with 31 workers
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5514/5514 [11:33<00:00,  7.95it/s]
2024-09-03 15:32:08.049 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='2b29e73438e240
a427bcecc7c0fe19306beb1310')
2024-09-03 15:32:09.634 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.6.0-rc1
2024-09-03 15:32:25.949 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-03 15:32:41.914 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.7.0
2024-09-03 15:32:57.530 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-03 15:32:58.646 | DEBUG    | lean_dojo.data_extraction.lean:url_to_repo:70 - url_to_repo("https://github.com/leanprover-community/import-graph.git") failed. Retrying...
2024-09-03 15:33:01.264 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for doc-gen4 main
2024-09-03 15:33:02.428 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0
2024-09-03 15:33:18.040 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for batteries main
2024-09-03 15:33:27.853 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for quote4 master
2024-09-03 15:33:28.322 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for aesop master
2024-09-03 15:33:28.725 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for ProofWidgets4 v0.0.36
2024-09-03 15:33:29.402 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-cli main
2024-09-03 15:33:30.060 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0
2024-09-03 15:33:45.863 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for import-graph main
2024-09-03 15:33:46.536 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/doc-gen4', commit='e490631b72a43a6a82b4ddd3
a2d020b2029491d0')
2024-09-03 15:33:47.135 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.9.0-rc1
2024-09-03 15:34:03.115 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.11.0-rc3
Following Github server redirection from /repos/mhuisi/lean4-cli to /repositories/341363356
2024-09-03 15:34:19.750 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4-nightly nightly-2024-06-05
2024-09-03 15:34:21.242 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:446 - LeanGitRepo(url='https://github.com/mhuisi/lean4-cli', commit='bf066c328bcff19aa93adf4d24c4e896c0d4eaca') relies on an uns
upported Lean version: fbb3055f82ff9a4bc82f6722f6e73225617342fd
2024-09-03 15:34:21.243 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/batteries', commit='8feac540abb78
1cb1349688c816dc02fae66b49c')
2024-09-03 15:34:21.512 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='2c8ae451ce9ffc83
554322b14437159c1a9703f9')
2024-09-03 15:34:21.767 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='e291aa4de57079b3d
2199b9eb7b4b00922b85a7c')
2024-09-03 15:34:22.325 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/ProofWidgets4', commit='e6b6247c6
1280c77ade6bbf0bc3c66a44fe2e0c5')
2024-09-03 15:34:22.879 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a0
9350b675ef3e347d0')
2024-09-03 15:34:23.141 | DEBUG    | lean_dojo.data_extraction.lean:get_dependencies:499 - Querying the dependencies of LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='3e96ea03ed
d48b932566ca9b201285ae2d57130d')
2024-09-03 15:34:45.575 | DEBUG    | lean_dojo.data_extraction.traced_data:check_sanity:1009 - Checking the sanity of TracedRepo(repo=LeanGitRepo(url='https://github.com/leanprover-community/mathlib4', commit='
2b29e73438e240a427bcecc7c0fe19306beb1310'), dependencies={'lean4': LeanGitRepo(url='https://github.com/leanprover/lean4', commit='e9e858a4484905a0bfe97c4f05c3924ead02eed8'), 'batteries': LeanGitRepo(url='https:
//github.com/leanprover-community/batteries', commit='fa571ea02a804b52a59e58012b1e21fe4f0514f2'), 'Qq': LeanGitRepo(url='https://github.com/leanprover-community/quote4', commit='53156671405fbbd5402ed17a79bd129b
961bd8d6'), 'aesop': LeanGitRepo(url='https://github.com/leanprover-community/aesop', commit='53ba96ad7666d4a2515292974631629b5ea5dfee'), 'proofwidgets': LeanGitRepo(url='https://github.com/leanprover-community
/ProofWidgets4', commit='e6b6247c61280c77ade6bbf0bc3c66a44fe2e0c5'), 'Cli': LeanGitRepo(url='https://github.com/leanprover/lean4-cli', commit='2cf1030dc2ae6b3632c84a09350b675ef3e347d0'), '«doc-gen4»': LeanGitRe
po(url='https://github.com/leanprover/doc-gen4', commit='e490631b72a43a6a82b4ddd3a2d020b2029491d0'), 'MD4Lean': LeanGitRepo(url='https://github.com/acmepjz/md4lean', commit='5e95f4776be5e048364f325c7e9d619bb56f
b005'), 'UnicodeBasic': LeanGitRepo(url='https://github.com/fgdorais/lean4-unicode-basic', commit='929690af200efb291babee737b087d244a70c3c3'), 'BibtexQuery': LeanGitRepo(url='https://github.com/dupuisf/BibtexQu
ery', commit='c138ab5c566c4268798b24bfcbea2f4c42413cdd'), 'importGraph': LeanGitRepo(url='https://github.com/leanprover-community/import-graph', commit='3e96ea03edd48b932566ca9b201285ae2d57130d')}, root_dir=Pos
ixPath('/data/yingzi_ma/lean_project/.cache/lean_dojo/leanprover-community-mathlib4-2b29e73438e240a427bcecc7c0fe19306beb1310/mathlib4'))
2024-09-03 15:35:02.742 | INFO     | generate_benchmark_lean4:main:367 - Successfully traced the repo
2024-09-03 15:35:02.743 | WARNING  | generate_benchmark_lean4:main:372 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310 already exists. Using it in
stead.
2024-09-03 15:35:02.743 | INFO     | __main__:retrieve_proof:1046 - Finished generating benchmark at /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
2024-09-03 15:35:15.983 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 15:35:15.983 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 15:35:17.683 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-03 15:35:17.683 | INFO     | dynamic_database:add_repository:586 - Added new repository: https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 54879.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 54416.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:02<00:00, 51489.20it/s]
2024-09-03 15:37:08.458 | INFO     | __main__:retrieve_proof:1084 - Before adding new repo:
2024-09-03 15:37:08.458 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-03 15:37:08.458 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 15:37:08.458 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-03 15:37:08.458 | INFO     | dynamic_database:add_repository:583 - Attempting to add repository: https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 15:37:08.458 | INFO     | dynamic_database:add_repository:588 - Repository 'https://github.com/leanprover-community/mathlib4' with commit '2b29e73438e240a427bcecc7c0fe19306beb1310' already exists in
the database.
2024-09-03 15:37:08.458 | INFO     | __main__:retrieve_proof:1087 - After adding new repo:
2024-09-03 15:37:08.458 | INFO     | dynamic_database:print_database_contents:607 - Current database contents:
2024-09-03 15:37:08.458 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 15:37:08.459 | INFO     | dynamic_database:print_database_contents:609 -   - https://github.com/lecopivo/SciLean (commit: 22d53b2f4e3db2a172e71da6eb9c916e62655744)
2024-09-03 15:37:27.943 | INFO     | __main__:retrieve_proof:1097 - Adding repo to repos_for_merged_dataset
2024-09-03 15:37:27.945 | INFO     | dynamic_database:generate_merged_dataset:399 - Merging selected repositories in the database:
2024-09-03 15:37:27.945 | INFO     | dynamic_database:generate_merged_dataset:401 -   - https://github.com/leanprover-community/mathlib4 (commit: 2b29e73438e240a427bcecc7c0fe19306beb1310)
2024-09-03 15:40:02.783 | WARNING  | dynamic_database:generate_merged_dataset:418 - /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310
already exists. Removing it now.
2024-09-03 15:40:24.814 | INFO     | dynamic_database:generate_merged_dataset:422 - Exported proofs to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcec
c7c0fe19306beb1310
2024-09-03 15:40:25.395 | INFO     | dynamic_database:generate_merged_dataset:425 - Merged and exported corpus to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e
240a427bcecc7c0fe19306beb1310
2024-09-03 15:40:25.409 | INFO     | dynamic_database:generate_merged_dataset:428 - Exported traced files to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310
2024-09-03 15:40:25.412 | INFO     | dynamic_database:generate_merged_dataset:431 - Exported metadata to /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310
2024-09-03 15:40:25.433 | INFO     | __main__:find_latest_checkpoint:475 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e
71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-03 15:40:25.434 | INFO     | __main__:retrieve_proof:1109 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c91
6e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt
2024-09-03 15:40:25.434 | INFO     | __main__:train_test_fisher:615 - Inside train_test_fisher
2024-09-03 15:40:25.434 | INFO     | __main__:train_test_fisher:616 - Starting training at epoch 0
Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the
default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-mo
dels for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer
be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you
 don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-03 15:40:29.443 | INFO     | __main__:train_test_fisher:640 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6e
b9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.ckpt and reset epoch count
Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default
. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-03 15:40:29.550 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bcecc7c0fe19306beb1310/
corpus.jsonl
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116251/116251 [00:16<00:00, 7016.06it/s]
2024-09-03 15:41:08.088 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 7038.73it/s]
2024-09-03 15:41:08.517 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4904
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2421/2421 [00:00<00:00, 6616.65it/s]
2024-09-03 15:41:08.977 | INFO     | retrieval.datamodule:load_or_cache_data:61 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a4
27bcecc7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
Training dataset size after load: 358647
Validation dataset size after load: 4904
Testing dataset size after load: 5431
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data/yingzi_ma/lean_project/ReProver/main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-03 15:41:09.059 | INFO     | __main__:train_test_fisher:714 - Starting progressive training from epoch 0 to 1
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-03 15:41:10.419 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_train/cached_data.pkl
Training dataset size: 358647
2024-09-03 15:41:10.617 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_val/cached_data.pkl
Validation dataset size: 4904
2024-09-03 15:41:10.654 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_mathlib4_2b29e73438e240a427bc
ecc7c0fe19306beb1310/random/cache_pred/cached_data.pkl
Testing dataset size: 5431
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc exi
sts and is not empty.
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.0
7.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the
default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-mo
dels for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer
be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you
 don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
2024-09-03 15:41:11.666 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744_lambda_0.1_epoch=1-Recall@10_val=70.07.
ckpt
`Trainer.fit` stopped: `max_epochs=1` reached.
2024-09-03 15:41:15.423 | INFO     | __main__:train_test_fisher:722 - Finished progressive training at epoch 2
2024-09-03 15:41:17.716 | INFO     | __main__:train_test_fisher:741 - Testing...
2024-09-03 15:41:17.719 | INFO     | retrieval.main:run_cli:55 - PID: 173542
[rank: 0] Seed set to 3407
2024-09-03 15:41:17.934 | INFO     | retrieval.main:before_instantiate_classes:28 - Data path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916
e62655744/random
2024-09-03 15:41:17.934 | INFO     | retrieval.main:before_instantiate_classes:29 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c9
16e62655744/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default
. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-03 15:41:18.566 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/c
orpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention
is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-09-03 15:41:26.012 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71
da6eb9c916e62655744/random/cache_train/cached_data.pkl
Training dataset size: 149228
2024-09-03 15:41:26.029 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_single_repo_no_ewc/merged_with_new_SciLean_22d53b2f4e3db2a172e71
da6eb9c916e62655744/random/cache_pred/cached_data.pkl
Testing dataset size: 2298
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1230, in main
[rank0]:     proofs = retrieve_proof(run_progressive_training, use_fisher, single_repo, dynamic_database_json_path, lean_git_repo, repo_no_dir, lean_git_repo.commit, lambda_value, current_epoch, epochs_per_repo
)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1115, in retrieve_proof
[rank0]:     train_test_fisher(model_checkpoint_path, dst_dir, lambda_value, current_epoch, use_fisher, epochs_per_repo)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 753, in train_test_fisher
[rank0]:     run_cli(best_model_path, data_path)
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/retrieval/main.py", line 58, in run_cli
[rank0]:     cli = CLI(PremiseRetriever, RetrievalDataModule)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 388, in __init__
[rank0]:     self._run_subcommand(self.subcommand)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 679, in _run_subcommand
[rank0]:     fn(**fn_kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in predict
[rank0]:     return call._call_and_handle_interrupt(
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
[rank0]:     return trainer_fn(*args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 903, in _predict_impl
[rank0]:     results = self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
[rank0]:     call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 93, in _call_setup_hook
[rank0]:     _call_callback_hooks(trainer, "setup", stage=fn)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 208, in _call_callback_hooks
[rank0]:     fn(trainer, trainer.lightning_module, *args, **kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/cli.py", line 257, in setup
[rank0]:     raise RuntimeError(
[rank0]: RuntimeError: SaveConfigCallback expected /data/yingzi_ma/lean_project/ReProver/lightning_logs/version_17084/config.yaml to NOT exist. Aborting to avoid overwriting results of a previous run. You can d
elete the previous config file, set `LightningCLI(save_config_callback=None)` to disable config saving, or set `LightningCLI(save_config_kwargs={"overwrite": True})` to overwrite the config file.

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1254, in <module>
[rank0]:     main()
[rank0]:   File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1250, in main
[rank0]:     logger.info(f"An error occurred: {e}", file=sys.stderr)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2044, in info
[rank0]:     __self._log("INFO", False, __self._options, __message, args, kwargs)
[rank0]:   File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/loguru/_logger.py", line 2021, in _log
[rank0]:     log_record["message"] = message.format(*args, **kwargs)
[rank0]: KeyError: '"overwrite"'
[rank0]:[W903 15:46:06.845219164 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destro
y_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. Thi
s constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
(ReProver) yingzi_ma@compute-permanent-node-794:~/
(ReProver) yingzi_ma@compute-permanent
(ReProver) yingzi_ma@compute-permanent-node-794:~/lean_project/ReProver$
