2024-11-03 05:26:10.535 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_pred/cached_data.pkl
Testing dataset size: 9478
2024-11-03 05:26:11.212 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_train/cached_data.pkl
Training dataset size: 598689
2024-11-03 05:26:11.270 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/cac
he_pred/cached_data.pkl
Testing dataset size: 9478
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 05:26:15.101 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:26:15.102 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3230 [00:00<?, ?it/s]
2024-11-03 05:26:15.162 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:26:15.162 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/3230 [00:00<05:09, 10.43it/s]
2024-11-03 05:26:15.575 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:26:15.577 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 05:26:16.821 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:26:16.822 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [18:55<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [18:56<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [19:04<00:00,  2.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3230/3230 [19:04<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:01<00:00,  0.31it/s]
2024-11-03 05:47:23.128 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 05:47:23.647 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 05:47:23.648 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 05:47:26.419 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 05:47:26.964 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 05:47:26.964 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 05:47:27.016 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 05:47:27.541 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 05:47:27.541 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 05:47:36.919 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 05:47:37.428 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 05:47:37.428 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 05:47:37.428 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:15<00:00,  0.28it/s]
2024-11-03 05:47:39.764 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 05:47:39.877 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 05:47:39.882 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-03 05:47:40.154 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-03 05:47:40.154 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
[rank: 1] Seed set to 3407
2024-11-03 05:47:40.241 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-03 05:47:40.241 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-11-03 05:47:40.256 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-03 05:47:40.256 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
2024-11-03 05:47:41.335 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 05:47:41.517 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanAPAP_951c660a8d7ba8e39f906fdf657674a984effa8b/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5015/5015 [00:00<00:00, 28663.59it/s]
2024-11-03 05:47:41.694 | INFO     | __main__:main:1812 - R@1 = 21.109397533805748 %, R@10 = 57.145590286510085 %, MRR = 0.46658561432733353
2024-11-03 05:47:41.696 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 05:47:42.085 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random
2024-11-03 05:47:42.086 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/corpus
.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 05:48:45.291 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 493919
2024-11-03 05:48:57.063 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 8768
2024-11-03 05:49:00.417 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 493919
2024-11-03 05:49:00.503 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 8768
2024-11-03 05:49:03.875 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 493919
2024-11-03 05:49:03.940 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 8768
2024-11-03 05:49:06.133 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_train/cached_data.pkl
Training dataset size: 493919
2024-11-03 05:49:06.211 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669
f/random/cache_pred/cached_data.pkl
Testing dataset size: 8768
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 05:49:10.057 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:49:10.058 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3021 [00:00<03:15, 15.48it/s]
2024-11-03 05:49:10.351 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:49:10.352 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/3021 [00:00<04:47, 10.50it/s]
2024-11-03 05:49:10.425 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:49:10.427 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 05:49:11.686 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 05:49:11.687 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [17:36<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [17:36<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [17:43<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3021/3021 [18:09<00:00,  2.77it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:58<00:00,  0.29it/s]
2024-11-03 06:09:19.810 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:09:19.810 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:09:19.810 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:09:19.810 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:09:20.267 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 06:09:20.268 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:09:20.283 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 06:09:20.283 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 06:09:20.283 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:09:20.283 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:09:20.285 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 06:09:20.286 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:09:20.286 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:59<00:00,  0.29it/s]
2024-11-03 06:09:21.898 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 06:09:22.079 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-03 06:09:22.430 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 06:09:22.471 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-03 06:09:22.472 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-11-03 06:09:22.558 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-03 06:09:22.558 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-03 06:09:22.840 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-03 06:09:22.841 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
2024-11-03 06:09:24.521 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 06:09:24.730 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-matrix-cookbook_f15a149d321ac99ff9b9c024b58e7882f564669f/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4088/4088 [00:00<00:00, 22329.39it/s]
2024-11-03 06:09:24.920 | INFO     | __main__:main:1812 - R@1 = 21.994546039444103 %, R@10 = 59.18395355580254 %, MRR = 0.48456580992123277
2024-11-03 06:09:24.922 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 06:09:25.399 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random
2024-11-03 06:09:25.400 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 06:09:47.937 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_train/cached_data.pkl
Training dataset size: 149237
2024-11-03 06:09:47.969 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
2024-11-03 06:09:48.222 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_train/cached_data.pkl
Training dataset size: 149237
2024-11-03 06:09:48.243 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
2024-11-03 06:09:56.066 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_train/cached_data.pkl
Training dataset size: 149237
2024-11-03 06:09:56.088 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
2024-11-03 06:10:00.908 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_train/cached_data.pkl
Training dataset size: 149237
2024-11-03 06:10:00.927 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/cach
e_pred/cached_data.pkl
Testing dataset size: 2062
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 06:10:04.692 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:10:04.693 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2027 [00:00<?, ?it/s]
2024-11-03 06:10:04.843 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:10:04.843 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2027 [00:00<?, ?it/s]
2024-11-03 06:10:04.877 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:10:04.878 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 06:10:06.274 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:10:06.275 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:21<00:00,  3.61it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:21<00:00,  3.61it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:25<00:00,  3.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2027/2027 [09:25<00:00,  3.58it/s]
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:24<00:00,  0.36it/s]
2024-11-03 06:19:56.855 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:19:56.855 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:19:56.855 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:19:56.855 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:19:57.045 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 06:19:57.045 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:19:57.053 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 06:19:57.053 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:19:57.059 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 06:19:57.059 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:19:57.060 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 06:19:57.060 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:19:57.061 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:25<00:00,  0.36it/s]
2024-11-03 06:19:58.919 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 06:19:58.990 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 06:19:59.113 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-03 06:19:59.383 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-03 06:19:59.383 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-03 06:19:59.480 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-03 06:19:59.480 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-11-03 06:19:59.547 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-03 06:19:59.547 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
2024-11-03 06:20:00.453 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 06:20:00.523 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_SciLean_22d53b2f4e3db2a172e71da6eb9c916e62655744/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1444/1444 [00:00<00:00, 40803.70it/s]
2024-11-03 06:20:00.560 | INFO     | __main__:main:1812 - R@1 = 28.393841890525756 %, R@10 = 67.72320489372422 %, MRR = 0.6041686329570671
2024-11-03 06:20:00.562 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 06:20:00.968 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/ra
ndom
2024-11-03 06:20:00.968 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/
corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [00:51<00:00, 3775.91it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                             | 103034/195879 [00:36<00:21, 4409.01it/s]
2024-11-03 06:21:54.614 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 493772
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4080/4080 [00:01<00:00, 3095.89it/s]
 56%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 109828/195879 [00:40<00:25, 3415.95it/s]
2024-11-03 06:21:56.215 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 8803
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [00:59<00:00, 3267.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [00:59<00:00, 3267.22it/s]
 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 165222/195879 [00:50<00:07, 4082.56it/s]
2024-11-03 06:22:18.350 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 493772
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 165631/195879 [00:50<00:07, 3917.73it/s]
2024-11-03 06:22:18.426 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 8803
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                   | 176331/195879 [00:52<00:04, 4474.30it/s]
2024-11-03 06:22:20.923 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 493772
2024-11-03 06:22:20.996 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 8803
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 195879/195879 [00:56<00:00, 3450.79it/s]
2024-11-03 06:22:28.222 | INFO     | retrieval.datamodule:load_or_cache_data:65 - Saved loaded data to cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853
a576389ecf5/random/cache_train/cached_data.pkl
Training dataset size: 493772
2024-11-03 06:22:28.293 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576
389ecf5/random/cache_pred/cached_data.pkl
Testing dataset size: 8803
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 06:22:32.329 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:22:32.330 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3015 [00:00<?, ?it/s]
2024-11-03 06:22:32.430 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:22:32.430 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3015 [00:00<03:19, 15.09it/s]
2024-11-03 06:22:32.661 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:22:32.665 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 06:22:34.317 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:22:34.318 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:34<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:34<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:41<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3015/3015 [17:43<00:00,  2.83it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:43<00:00,  0.21it/s]
2024-11-03 06:43:01.354 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:43:01.355 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:43:01.355 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:43:01.355 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 06:43:01.798 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 06:43:01.799 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:43:01.802 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 06:43:01.802 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:43:01.803 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 06:43:01.804 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:43:01.815 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 06:43:01.816 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 06:43:01.816 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [02:43<00:00,  0.21it/s]
2024-11-03 06:43:03.991 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 06:43:04.101 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 06:43:04.191 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-03 06:43:04.454 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-03 06:43:04.454 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-03 06:43:04.508 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-03 06:43:04.508 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-03 06:43:04.568 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-03 06:43:04.568 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
2024-11-03 06:43:06.149 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 06:43:06.332 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_mathematics_in_lean_source_5297e0fb051367c48c0a084411853a576389ecf5/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4080/4080 [00:00<00:00, 22472.17it/s]
2024-11-03 06:43:06.517 | INFO     | __main__:main:1812 - R@1 = 22.703642480140005 %, R@10 = 59.67848282090969 %, MRR = 0.48796125514176514
2024-11-03 06:43:06.520 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 06:43:06.995 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random
2024-11-03 06:43:06.995 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 06:43:56.141 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 487873
2024-11-03 06:43:56.270 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
2024-11-03 06:44:10.914 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 487873
2024-11-03 06:44:10.985 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
2024-11-03 06:44:14.823 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 487873
2024-11-03 06:44:14.897 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
2024-11-03 06:44:22.494 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_train/cached_data.pkl
Training dataset size: 487873
2024-11-03 06:44:22.561 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/cache
_pred/cached_data.pkl
Testing dataset size: 8622
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 06:44:26.393 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:44:26.394 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3010 [00:00<?, ?it/s]
2024-11-03 06:44:26.492 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:44:26.493 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3010 [00:00<?, ?it/s]
2024-11-03 06:44:26.551 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:44:26.552 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 06:44:27.842 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 06:44:27.843 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:33<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:33<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:40<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3010/3010 [17:41<00:00,  2.84it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [01:57<00:00,  0.29it/s]
2024-11-03 07:04:07.075 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:04:07.556 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 07:04:07.556 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:04:14.691 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:04:14.691 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:04:14.691 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:04:15.115 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 07:04:15.115 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:04:15.131 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 07:04:15.131 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:04:15.133 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 07:04:15.133 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:04:15.134 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:05<00:00,  0.27it/s]
2024-11-03 07:04:17.203 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 07:04:17.237 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 07:04:17.310 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-03 07:04:17.634 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-03 07:04:17.635 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-11-03 07:04:17.636 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-03 07:04:17.636 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-11-03 07:04:17.696 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-03 07:04:17.697 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
2024-11-03 07:04:19.129 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 07:04:19.336 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_debate_de3a6e500ae1a65dfeea2f91ef519ebad9704be0/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4025/4025 [00:00<00:00, 22996.22it/s]
2024-11-03 07:04:19.515 | INFO     | __main__:main:1812 - R@1 = 22.5032768199352 %, R@10 = 59.58650874280812 %, MRR = 0.48672454978974256
2024-11-03 07:04:19.517 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 07:04:19.979 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random
2024-11-03 07:04:19.979 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 07:05:13.342 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 485344
2024-11-03 07:05:13.436 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 8627
2024-11-03 07:05:22.801 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 485344
2024-11-03 07:05:22.879 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 8627
2024-11-03 07:05:34.717 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 485344
2024-11-03 07:05:34.790 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 8627
2024-11-03 07:05:40.493 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_train/cached_data.pkl
Training dataset size: 485344
2024-11-03 07:05:40.555 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/ca
che_pred/cached_data.pkl
Testing dataset size: 8627
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 07:05:44.621 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:05:44.621 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3005 [00:00<03:36, 13.86it/s]
2024-11-03 07:05:44.948 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:05:44.951 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/3005 [00:00<04:47, 10.44it/s]
2024-11-03 07:05:45.100 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:05:45.101 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 07:05:46.155 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:05:46.156 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:30<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:30<00:00,  2.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:36<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3005/3005 [17:38<00:00,  2.84it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:36<00:00,  0.22it/s]
2024-11-03 07:26:01.422 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:26:01.423 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:26:01.423 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:26:01.423 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:26:01.871 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 07:26:01.872 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:26:01.878 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 07:26:01.879 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:26:01.879 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 07:26:01.879 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:26:01.882 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 07:26:01.883 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:26:01.883 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [02:36<00:00,  0.22it/s]
2024-11-03 07:26:04.127 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 07:26:04.382 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 07:26:04.391 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 2] Seed set to 3407
2024-11-03 07:26:04.534 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-03 07:26:04.534 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-03 07:26:04.739 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-03 07:26:04.739 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-11-03 07:26:04.753 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-03 07:26:04.753 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
2024-11-03 07:26:05.909 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 07:26:06.077 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_compfiles_f99bf6f2928d47dd1a445b414b3a723c2665f091/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4019/4019 [00:00<00:00, 24704.59it/s]
2024-11-03 07:26:06.258 | INFO     | __main__:main:1812 - R@1 = 22.289907451380376 %, R@10 = 59.106251367912634 %, MRR = 0.4827916432111696
2024-11-03 07:26:06.259 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 07:26:06.648 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random
2024-11-03 07:26:06.648 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 07:26:56.718 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 534976
2024-11-03 07:26:56.816 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
2024-11-03 07:27:09.487 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 534976
2024-11-03 07:27:20.943 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
2024-11-03 07:27:23.047 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 534976
2024-11-03 07:27:23.127 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
2024-11-03 07:27:35.606 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_train/cached_data.pkl
Training dataset size: 534976
2024-11-03 07:27:35.706 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/cache
_pred/cached_data.pkl
Testing dataset size: 9238
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 07:27:57.634 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:27:57.636 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3146 [00:00<03:57, 13.22it/s]
2024-11-03 07:27:57.919 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:27:57.920 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3146 [00:00<03:09, 16.57it/s]
2024-11-03 07:27:58.084 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:27:58.085 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 07:27:59.193 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:27:59.193 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:28<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:29<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:36<00:00,  2.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3146/3146 [18:37<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [02:05<00:00,  0.30it/s]
2024-11-03 07:48:42.112 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:48:42.113 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:48:42.113 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:48:42.598 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 07:48:42.599 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:48:42.616 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 07:48:42.616 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:48:42.635 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 07:48:42.636 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:48:46.806 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 07:48:47.246 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 07:48:47.247 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 07:48:47.247 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [02:10<00:00,  0.28it/s]
2024-11-03 07:48:48.661 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
[rank: 2] Seed set to 3407
2024-11-03 07:48:49.329 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 07:48:49.368 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-03 07:48:49.368 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-11-03 07:48:49.430 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 1] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-03 07:48:49.760 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-03 07:48:49.761 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-11-03 07:48:49.821 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-03 07:48:49.821 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
2024-11-03 07:48:51.541 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 07:48:51.776 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_con-nf_00bdc85ba7d486a9e544a0806a1018dd06fa3856/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4460/4460 [00:00<00:00, 20410.66it/s]
2024-11-03 07:48:52.005 | INFO     | __main__:main:1812 - R@1 = 21.615484659363222 %, R@10 = 58.62520917502741 %, MRR = 0.47470603111205756
2024-11-03 07:48:52.007 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 07:48:52.494 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random
2024-11-03 07:48:52.495 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 07:49:41.804 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 518001
2024-11-03 07:49:41.909 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9080
2024-11-03 07:50:03.825 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 518001
2024-11-03 07:50:03.908 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9080
2024-11-03 07:50:07.248 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 518001
2024-11-03 07:50:07.320 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9080
2024-11-03 07:50:11.036 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_train/cached_data.pkl
Training dataset size: 518001
2024-11-03 07:50:11.096 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9080
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 07:50:14.875 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:50:14.875 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3100 [00:00<?, ?it/s]
2024-11-03 07:50:14.948 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:50:14.949 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3100 [00:00<03:13, 16.03it/s]
2024-11-03 07:50:15.027 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:50:15.028 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 07:50:16.731 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 07:50:16.732 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:16<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:17<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:24<00:00,  2.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3100/3100 [18:25<00:00,  2.80it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:04<00:00,  0.29it/s]
2024-11-03 08:10:47.134 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:10:47.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:10:47.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:10:47.135 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:10:47.592 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 08:10:47.593 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:10:47.594 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 08:10:47.594 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:10:47.601 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 08:10:47.602 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:10:47.624 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 08:10:47.624 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:10:47.625 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:05<00:00,  0.29it/s]
2024-11-03 08:10:49.734 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 08:10:49.812 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 08:10:50.025 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-03 08:10:50.201 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-03 08:10:50.202 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-11-03 08:10:50.274 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-03 08:10:50.275 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-03 08:10:50.394 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-03 08:10:50.394 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
2024-11-03 08:10:51.827 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 08:10:51.991 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4lean_05b1f4a68c5facea96a5ee51c6a56fef21276e0f/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4386/4386 [00:00<00:00, 27371.45it/s]
2024-11-03 08:10:52.154 | INFO     | __main__:main:1812 - R@1 = 23.621390474144317 %, R@10 = 61.783972215079366 %, MRR = 0.5026956320461949
2024-11-03 08:10:52.156 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 08:10:52.535 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random
2024-11-03 08:10:52.535 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 08:11:20.418 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 212887
2024-11-03 08:11:20.460 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
2024-11-03 08:11:21.237 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 212887
2024-11-03 08:11:21.278 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
2024-11-03 08:11:27.246 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 212887
2024-11-03 08:11:27.274 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
2024-11-03 08:11:33.580 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_tr
ain/cached_data.pkl
Training dataset size: 212887
2024-11-03 08:11:33.606 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 3484
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-03 08:11:37.574 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:11:37.575 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/2077 [00:00<02:18, 15.02it/s]
2024-11-03 08:11:37.794 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:11:37.794 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2077 [00:00<?, ?it/s]
2024-11-03 08:11:37.800 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:11:37.801 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 08:11:39.048 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:11:39.049 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [10:57<00:00,  3.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [10:58<00:00,  3.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [11:02<00:00,  3.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2077/2077 [11:02<00:00,  3.13it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:38<00:00,  0.37it/s]
2024-11-03 08:23:20.169 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:23:20.169 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:23:20.437 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 08:23:20.437 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:23:20.445 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 08:23:20.445 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:23:21.867 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:23:21.867 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:23:22.090 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 08:23:22.090 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:23:22.111 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 08:23:22.112 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:23:22.112 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:40<00:00,  0.35it/s]
2024-11-03 08:23:24.074 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 08:23:24.115 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 08:23:24.328 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-03 08:23:24.502 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-03 08:23:24.503 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-11-03 08:23:24.532 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-03 08:23:24.532 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-03 08:23:24.686 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-03 08:23:24.686 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
2024-11-03 08:23:25.576 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 08:23:25.658 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_FLT_b208a302cdcbfadce33d8165f0b054bfa17e2147/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2339/2339 [00:00<00:00, 38244.34it/s]
2024-11-03 08:23:25.721 | INFO     | __main__:main:1812 - R@1 = 27.66237504129071 %, R@10 = 66.73485931738945 %, MRR = 0.5504282842177858
2024-11-03 08:23:25.723 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 08:23:26.138 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random
2024-11-03 08:23:26.139 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 08:24:39.794 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 535645
2024-11-03 08:24:39.908 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
2024-11-03 08:24:52.807 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 535645
2024-11-03 08:24:52.868 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
2024-11-03 08:25:03.549 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 535645
2024-11-03 08:25:03.615 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
2024-11-03 08:25:07.891 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_train/cached_data.pkl
Training dataset size: 535645
2024-11-03 08:25:07.954 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/cache
_pred/cached_data.pkl
Testing dataset size: 8251
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-11-03 08:25:11.985 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:25:11.986 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3149 [00:00<?, ?it/s]
2024-11-03 08:25:12.128 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:25:12.129 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/3149 [00:00<05:04, 10.34it/s]
2024-11-03 08:25:12.376 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:25:12.377 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 08:25:13.888 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:25:13.889 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:34<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:34<00:00,  2.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:42<00:00,  2.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3149/3149 [18:42<00:00,  2.80it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [01:59<00:00,  0.28it/s]
2024-11-03 08:45:55.903 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:45:55.904 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:45:55.904 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:45:55.904 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 08:45:56.359 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 08:45:56.360 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:45:56.366 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 08:45:56.366 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:45:56.373 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 08:45:56.373 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:45:56.380 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 08:45:56.380 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 08:45:56.380 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [01:59<00:00,  0.28it/s]
2024-11-03 08:45:58.153 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 3] Seed set to 3407
2024-11-03 08:45:58.687 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-11-03 08:45:58.687 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/corpus.jsonl
2024-11-03 08:45:58.835 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 08:45:58.840 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-03 08:45:59.190 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-11-03 08:45:59.191 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/corpus.jsonl
2024-11-03 08:45:59.193 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-11-03 08:45:59.193 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/corpus.jsonl
2024-11-03 08:46:00.039 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 08:46:00.228 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_Saturn_3811a9dd46cdfd5fa0c0c1896720c28d2ec4a42a/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4462/4462 [00:00<00:00, 26854.39it/s]
2024-11-03 08:46:00.397 | INFO     | __main__:main:1812 - R@1 = 22.463421731119734 %, R@10 = 61.011172150618286 %, MRR = 0.492342945670527
2024-11-03 08:46:00.399 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 08:46:00.821 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random
2024-11-03 08:46:00.821 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 08:46:52.963 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_train/cached_data.pkl
Training dataset size: 595416
2024-11-03 08:46:53.076 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9530
2024-11-03 08:47:15.409 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_train/cached_data.pkl
Training dataset size: 595416
2024-11-03 08:47:15.485 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9530
2024-11-03 08:47:22.376 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_train/cached_data.pkl
Training dataset size: 595416
2024-11-03 08:47:22.452 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9530
2024-11-03 08:47:24.036 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_train/cached_data.pkl
Training dataset size: 595416
2024-11-03 08:47:24.100 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/ca
che_pred/cached_data.pkl
Testing dataset size: 9530
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 08:47:28.157 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:47:28.163 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3242 [00:00<?, ?it/s]
2024-11-03 08:47:28.205 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:47:28.205 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3242 [00:00<04:51, 11.13it/s]
2024-11-03 08:47:28.451 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:47:28.452 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 08:47:29.812 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 08:47:29.812 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3242/3242 [19:01<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3242/3242 [19:02<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3242/3242 [19:09<00:00,  2.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3242/3242 [19:42<00:00,  2.74it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:06<00:00,  0.30it/s]
2024-11-03 09:09:18.335 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:09:18.335 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:09:18.335 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:09:18.335 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:09:18.815 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 09:09:18.815 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:09:18.825 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 09:09:18.825 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:09:18.827 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 09:09:18.828 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:09:18.898 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 09:09:18.899 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:09:18.899 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:06<00:00,  0.30it/s]
2024-11-03 09:09:20.370 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 1] Seed set to 3407
2024-11-03 09:09:20.922 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-03 09:09:20.922 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-11-03 09:09:20.941 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 09:09:21.126 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 2] Seed set to 3407
2024-11-03 09:09:21.353 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-03 09:09:21.353 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-03 09:09:21.529 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-03 09:09:21.529 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-11-03 09:09:23.296 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 09:09:23.523 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5051/5051 [00:00<00:00, 23642.10it/s]
2024-11-03 09:09:23.742 | INFO     | __main__:main:1812 - R@1 = 20.88871030886576 %, R@10 = 56.698231447889015 %, MRR = 0.4619248036060428
2024-11-03 09:09:23.744 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 09:09:24.153 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-11-03 09:09:24.153 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 09:09:50.784 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 260181
2024-11-03 09:09:50.846 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4144
2024-11-03 09:09:58.534 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 260181
2024-11-03 09:09:58.576 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4144
2024-11-03 09:10:06.444 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 260181
2024-11-03 09:10:06.485 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4144
2024-11-03 09:10:07.553 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_tr
ain/cached_data.pkl
Training dataset size: 260181
2024-11-03 09:10:07.584 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/cache_pr
ed/cached_data.pkl
Testing dataset size: 4144
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 09:10:11.732 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:10:11.738 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2145 [00:00<?, ?it/s]
2024-11-03 09:10:11.822 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:10:11.823 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/2145 [00:00<02:55, 12.23it/s]
2024-11-03 09:10:12.005 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:10:12.006 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 09:10:13.112 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:10:13.112 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:27<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:27<00:00,  3.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:32<00:00,  3.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2145/2145 [11:32<00:00,  3.10it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:47<00:00,  0.36it/s]
2024-11-03 09:22:33.221 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:22:33.221 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:22:33.221 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:22:33.495 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 09:22:33.495 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:22:33.505 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 09:22:33.505 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:22:33.507 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 09:22:33.507 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:22:36.630 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:22:36.904 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 09:22:36.905 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:22:36.905 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:51<00:00,  0.33it/s]
2024-11-03 09:22:38.994 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 09:22:39.176 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 09:22:39.207 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
[rank: 1] Seed set to 3407
2024-11-03 09:22:39.369 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-11-03 09:22:39.369 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
[rank: 3] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-03 09:22:39.528 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-11-03 09:22:39.528 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-11-03 09:22:39.563 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-11-03 09:22:39.563 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
2024-11-03 09:22:40.234 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 09:22:40.349 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2618/2618 [00:00<00:00, 34202.10it/s]
2024-11-03 09:22:40.429 | INFO     | __main__:main:1812 - R@1 = 26.88305505484782 %, R@10 = 66.35127155034183 %, MRR = 0.5447392369615295
2024-11-03 09:22:40.430 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 09:22:40.850 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random
2024-11-03 09:22:40.850 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 09:23:33.926 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_train/cached_data.pkl
Training dataset size: 574496
2024-11-03 09:23:34.045 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_pred/cached_data.pkl
Testing dataset size: 9613
2024-11-03 09:23:54.059 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_train/cached_data.pkl
Training dataset size: 574496
2024-11-03 09:23:54.135 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_pred/cached_data.pkl
Testing dataset size: 9613
2024-11-03 09:23:54.195 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_train/cached_data.pkl
Training dataset size: 574496
2024-11-03 09:23:54.266 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_pred/cached_data.pkl
Testing dataset size: 9613
2024-11-03 09:23:57.199 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_train/cached_data.pkl
Training dataset size: 574496
2024-11-03 09:23:57.267 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/cach
e_pred/cached_data.pkl
Testing dataset size: 9613
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 09:24:01.428 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:24:01.429 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3214 [00:00<?, ?it/s]
2024-11-03 09:24:01.468 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:24:01.469 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3214 [00:00<03:32, 15.13it/s]
2024-11-03 09:24:01.656 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:24:01.657 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 09:24:02.963 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:24:02.964 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3214/3214 [18:51<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3214/3214 [18:51<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3214/3214 [18:58<00:00,  2.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3214/3214 [18:59<00:00,  2.82it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:19<00:00,  0.27it/s]
2024-11-03 09:45:22.230 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:45:22.230 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:45:22.230 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:45:22.230 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 09:45:22.709 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 09:45:22.710 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:45:22.711 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 09:45:22.712 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:45:22.713 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 09:45:22.713 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:45:22.731 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 09:45:22.731 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 09:45:22.731 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [02:19<00:00,  0.27it/s]
2024-11-03 09:45:24.829 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 09:45:24.967 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 09:45:25.007 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
[rank: 3] Seed set to 3407
[rank: 1] Seed set to 3407
2024-11-03 09:45:25.237 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-03 09:45:25.238 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
[rank: 2] Seed set to 3407
2024-11-03 09:45:25.317 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-03 09:45:25.317 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-11-03 09:45:25.354 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-03 09:45:25.354 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
2024-11-03 09:45:26.371 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 09:46:01.181 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_coxeter_96af8aee7943ca8685ed1b00cc83a559ea389a97/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4964/4964 [00:00<00:00, 27938.65it/s]
2024-11-03 09:46:01.363 | INFO     | __main__:main:1812 - R@1 = 21.90648334597923 %, R@10 = 57.81961364152545 %, MRR = 0.47198627388829917
2024-11-03 09:46:01.365 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 09:46:01.817 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random
2024-11-03 09:46:01.818 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/corpus.j
sonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 09:46:41.435 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 522744
2024-11-03 09:46:41.576 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 8966
2024-11-03 09:47:02.825 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 522744
2024-11-03 09:47:02.909 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 8966
2024-11-03 09:47:05.508 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 522744
2024-11-03 09:47:05.577 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 8966
2024-11-03 09:47:09.176 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_train/cached_data.pkl
Training dataset size: 522744
2024-11-03 09:47:09.259 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/
random/cache_pred/cached_data.pkl
Testing dataset size: 8966
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 09:47:13.426 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:47:13.427 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3106 [00:00<03:17, 15.75it/s]
2024-11-03 09:47:13.666 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:47:13.667 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/3106 [00:00<04:54, 10.55it/s]
2024-11-03 09:47:13.802 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:47:13.803 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 09:47:14.898 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 09:47:14.899 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:18<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:18<00:00,  2.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:25<00:00,  2.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3106/3106 [18:27<00:00,  2.81it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:03<00:00,  0.29it/s]
2024-11-03 10:07:45.182 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:07:45.183 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:07:45.183 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:07:45.661 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 10:07:45.661 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:07:45.679 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 10:07:45.680 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:07:45.684 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 10:07:45.684 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:07:48.207 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:07:48.664 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 10:07:48.664 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:07:48.665 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:06<00:00,  0.28it/s]
2024-11-03 10:07:50.823 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 10:07:51.095 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
[rank: 1] Seed set to 3407
2024-11-03 10:07:51.251 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 10:07:51.297 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-03 10:07:51.298 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
[rank: 2] Seed set to 3407
2024-11-03 10:07:51.475 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-03 10:07:51.475 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-03 10:07:51.610 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-03 10:07:51.610 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
2024-11-03 10:07:52.918 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 10:07:53.096 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean-math-workshop_5acd4b933d47fd6c1032798a6046c1baf261445d/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4389/4389 [00:00<00:00, 27101.50it/s]
2024-11-03 10:07:53.262 | INFO     | __main__:main:1812 - R@1 = 21.55731287739297 %, R@10 = 58.592906251628676 %, MRR = 0.47816051752624117
2024-11-03 10:07:53.264 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 10:07:53.676 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random
2024-11-03 10:07:53.676 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 10:08:16.529 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-03 10:08:16.600 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-11-03 10:08:23.955 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-03 10:08:23.994 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-11-03 10:08:30.839 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-03 10:08:30.873 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
2024-11-03 10:08:31.258 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_train/cached_data.pkl
Training dataset size: 234802
2024-11-03 10:08:31.292 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/cac
he_pred/cached_data.pkl
Testing dataset size: 3974
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 10:08:35.522 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:08:35.523 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/2318 [00:00<?, ?it/s]
2024-11-03 10:08:35.564 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:08:35.565 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/2318 [00:00<04:01,  9.59it/s]
2024-11-03 10:08:35.971 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:08:36.003 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 10:08:37.526 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:08:37.527 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:08<00:00,  3.47it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:08<00:00,  3.47it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:12<00:00,  3.45it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2318/2318 [11:13<00:00,  3.44it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:48<00:00,  0.33it/s]
2024-11-03 10:20:39.464 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:20:39.464 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:20:39.464 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:20:39.464 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:20:39.713 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 10:20:39.713 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:20:39.728 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 10:20:39.728 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:20:39.731 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 10:20:39.731 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:20:39.735 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 10:20:39.735 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:20:39.736 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:48<00:00,  0.33it/s]
2024-11-03 10:20:41.824 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
2024-11-03 10:20:41.836 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 10:20:42.012 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
[rank: 1] Seed set to 3407
[rank: 2] Seed set to 3407
2024-11-03 10:20:42.258 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-03 10:20:42.259 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-11-03 10:20:42.266 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-03 10:20:42.266 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
[rank: 3] Seed set to 3407
2024-11-03 10:20:42.395 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-03 10:20:42.395 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
2024-11-03 10:20:43.392 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 10:20:43.485 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_carleson_bec7808b907190882fa1fa54ce749af297c6cf37/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2462/2462 [00:00<00:00, 30178.99it/s]
2024-11-03 10:20:43.568 | INFO     | __main__:main:1812 - R@1 = 23.4016716551395 %, R@10 = 57.61954044054778 %, MRR = 0.4813085938270707
2024-11-03 10:20:43.570 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 10:20:43.943 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random
2024-11-03 10:20:43.944 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 10:21:42.762 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 513766
2024-11-03 10:21:42.847 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 9181
2024-11-03 10:21:55.784 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 513766
2024-11-03 10:21:55.849 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 9181
2024-11-03 10:21:55.964 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 513766
2024-11-03 10:21:56.027 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 9181
2024-11-03 10:22:16.603 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_train/cached_data.pkl
Training dataset size: 513766
2024-11-03 10:22:16.683 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/c
ache_pred/cached_data.pkl
Testing dataset size: 9181
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 10:22:20.824 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:22:20.824 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3091 [00:00<03:54, 13.20it/s]
2024-11-03 10:22:21.054 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:22:21.055 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|                                                                                                                                                                                                                      | 0/3091 [00:00<?, ?it/s]
2024-11-03 10:22:21.131 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:22:21.132 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 10:22:22.462 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:22:22.463 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3091/3091 [18:07<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3091/3091 [18:07<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3091/3091 [18:15<00:00,  2.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3091/3091 [18:39<00:00,  2.76it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:11<00:00,  0.27it/s]
2024-11-03 10:43:12.901 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:43:12.902 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:43:12.902 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:43:12.902 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 10:43:13.207 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 10:43:13.208 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:43:13.227 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 10:43:13.227 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:43:13.232 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 10:43:13.232 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:43:13.259 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 10:43:13.259 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 10:43:13.260 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 36/36 [02:11<00:00,  0.27it/s]
2024-11-03 10:43:15.370 | INFO     | retrieval.main:run_cli:60 - PID: 3893917
2024-11-03 10:43:15.436 | INFO     | retrieval.main:run_cli:60 - PID: 3893918
2024-11-03 10:43:15.520 | INFO     | retrieval.main:run_cli:60 - PID: 3893916
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
2024-11-03 10:43:15.794 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-11-03 10:43:15.794 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
[rank: 1] Seed set to 3407
2024-11-03 10:43:15.856 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-11-03 10:43:15.857 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-11-03 10:43:15.912 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-11-03 10:43:15.913 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
2024-11-03 10:43:17.558 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 10:43:17.757 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_LeanEuclid_f1912c3090eb82820575758efc31e40b9db86bb8/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4351/4351 [00:00<00:00, 24300.54it/s]
2024-11-03 10:43:17.944 | INFO     | __main__:main:1812 - R@1 = 23.376329817286535 %, R@10 = 61.16176213157004 %, MRR = 0.49863090899790896
2024-11-03 10:43:17.946 | INFO     | retrieval.main:run_cli:60 - PID: 3878914
[rank: 0] Seed set to 3407
2024-11-03 10:43:18.395 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random
2024-11-03 10:43:18.395 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/corpus.jsonl
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2024-11-03 10:44:13.798 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_train/cached_data.pkl
Training dataset size: 540852
2024-11-03 10:44:13.914 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_pred/cached_data.pkl
Testing dataset size: 9342
2024-11-03 10:44:21.992 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_train/cached_data.pkl
Training dataset size: 540852
2024-11-03 10:44:22.066 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_pred/cached_data.pkl
Testing dataset size: 9342
2024-11-03 10:44:30.941 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_train/cached_data.pkl
Training dataset size: 540852
2024-11-03 10:44:31.021 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_pred/cached_data.pkl
Testing dataset size: 9342
2024-11-03 10:44:37.077 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_train/cached_data.pkl
Training dataset size: 540852
2024-11-03 10:44:37.158 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/
cache_pred/cached_data.pkl
Testing dataset size: 9342
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 10:44:41.065 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:44:41.066 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▏                                                                                                                                                                                                             | 2/3152 [00:00<03:39, 14.37it/s]
2024-11-03 10:44:41.264 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:44:41.265 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
  0%|▎                                                                                                                                                                                                             | 4/3152 [00:00<04:49, 10.88it/s]
2024-11-03 10:44:41.451 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:44:41.452 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-11-03 10:44:43.182 | INFO     | retrieval.model:on_predict_start:398 - Embeddings staled on predict start: True
2024-11-03 10:44:43.182 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3152/3152 [18:31<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3152/3152 [18:31<00:00,  2.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3152/3152 [18:39<00:00,  2.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3152/3152 [18:40<00:00,  2.81it/s]
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [02:02<00:00,  0.30it/s]
2024-11-03 11:05:26.327 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 11:05:26.636 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_0.pkl
2024-11-03 11:05:26.637 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 11:05:27.039 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 11:05:27.039 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 11:05:27.039 | INFO     | retrieval.model:on_predict_epoch_end:501 - About to construct predictions map
2024-11-03 11:05:27.362 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_1.pkl
2024-11-03 11:05:27.362 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 11:05:27.366 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_2.pkl
2024-11-03 11:05:27.367 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 11:05:27.372 | INFO     | retrieval.model:on_predict_epoch_end:521 - Retrieval predictions saved to test_pickle_3.pkl
2024-11-03 11:05:27.372 | INFO     | retrieval.model:on_predict_epoch_end:560 - About to call barrier
2024-11-03 11:05:27.373 | INFO     | retrieval.model:on_predict_epoch_end:564 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 37/37 [02:04<00:00,  0.30it/s]
2024-11-03 11:05:29.722 | INFO     | __main__:main:1916 - Finished processing the repository
2024-11-03 11:05:29.723 | INFO     | __main__:main:1918 - current epoch: 20
2024-11-03 11:05:29.724 | INFO     | __main__:main:1569 - length of lean_git_repos: 5
2024-11-03 11:05:29.724 | INFO     | __main__:main:1570 - i: 2
2024-11-03 11:05:29.724 | INFO     | __main__:main:1628 - All GPUs
2024-11-03 11:05:29.728 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_
0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 11:05:29.728 | INFO     | __main__:main:1635 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@1
0_val=54.98.ckpt
2024-11-03 11:05:29.728 | INFO     | __main__:main:1641 - Inside train_test_fisher
2024-11-03 11:05:29.728 | INFO     | __main__:main:1642 - Starting training at epoch 20
[rank: 1] Seed set to 3407
2024-11-03 11:05:29.821 | INFO     | __main__:main:1916 - Finished processing the repository
2024-11-03 11:05:29.822 | INFO     | __main__:main:1918 - current epoch: 20
2024-11-03 11:05:29.822 | INFO     | __main__:main:1569 - length of lean_git_repos: 5
2024-11-03 11:05:29.822 | INFO     | __main__:main:1570 - i: 2
2024-11-03 11:05:29.822 | INFO     | __main__:main:1628 - All GPUs
2024-11-03 11:05:29.826 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_
0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 11:05:29.827 | INFO     | __main__:main:1635 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@1
0_val=54.98.ckpt
2024-11-03 11:05:29.827 | INFO     | __main__:main:1641 - Inside train_test_fisher
2024-11-03 11:05:29.827 | INFO     | __main__:main:1642 - Starting training at epoch 20
[rank: 2] Seed set to 3407
2024-11-03 11:05:30.028 | INFO     | __main__:main:1916 - Finished processing the repository
2024-11-03 11:05:30.029 | INFO     | __main__:main:1918 - current epoch: 20
2024-11-03 11:05:30.029 | INFO     | __main__:main:1569 - length of lean_git_repos: 5
2024-11-03 11:05:30.029 | INFO     | __main__:main:1570 - i: 2
2024-11-03 11:05:30.029 | INFO     | __main__:main:1628 - All GPUs
2024-11-03 11:05:30.039 | INFO     | __main__:find_latest_checkpoint:579 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_
0.1_epoch=19-Recall@10_val=54.98.ckpt
2024-11-03 11:05:30.039 | INFO     | __main__:main:1635 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recall@1
0_val=54.98.ckpt
2024-11-03 11:05:30.039 | INFO     | __main__:main:1641 - Inside train_test_fisher
2024-11-03 11:05:30.039 | INFO     | __main__:main:1642 - Starting training at epoch 20
[rank: 3] Seed set to 3407
2024-11-03 11:05:32.326 | INFO     | __main__:main:1807 - Loaded the predictions pickle files
2024-11-03 11:05:32.482 | INFO     | __main__:main:1810 - Evaluating on /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_formal_book_6fbe8c2985008c0bfb30050750a71b90388ad3a3/random/test.json
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4535/4535 [00:00<00:00, 30447.41it/s]
2024-11-03 11:05:32.633 | INFO     | __main__:main:1812 - R@1 = 22.327627834293132 %, R@10 = 59.29547446971881 %, MRR = 0.48276352032821007
2024-11-03 11:05:32.635 | INFO     | __main__:main:1827 - Average R@1 = 23.172703377616696 %, R@10 = 60.46356750851281 %, MRR = 0.49615749660611164
2024-11-03 11:05:32.636 | INFO     | __main__:main:1863 - Starting the prover
2024-11-03 11:05:32.636 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-11-03 11:05:32.636 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-11-03 11:05:32.636 | INFO     | prover.proof_search:__init__:427 - Using RAG
2024-11-03 11:05:32.637 | INFO     | prover.proof_search:find_latest_checkpoint:380 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f61998
56e_lambda_0.1_epoch=19-Recall@10_val=54.98.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.4.0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../model_lightning.ckpt`
2024-11-03 11:05:35.171 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch
=19-Recall@10_val=54.98.ckpt
2024-11-03 11:05:35.171 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch
=19-Recall@10_val=54.98.ckpt
2024-11-03 11:05:39.877 | INFO     | __main__:main:1666 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recal
l@10_val=54.98.ckpt
2024-11-03 11:05:39.880 | INFO     | __main__:main:1666 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recal
l@10_val=54.98.ckpt
2024-11-03 11:05:39.884 | INFO     | __main__:main:1666 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e_lambda_0.1_epoch=19-Recal
l@10_val=54.98.ckpt
2024-11-03 11:05:40.001 | INFO     | __main__:main:1724 - right before barrier for data module
2024-11-03 11:05:40.001 | INFO     | __main__:main:1724 - right before barrier for data module
2024-11-03 11:05:40.001 | INFO     | __main__:main:1724 - right before barrier for data module
2024-11-03 11:05:41.250 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:191: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-11-03 11:05:42.266 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/model_lightning.ckpt
2024-11-03 11:05:42.268 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-11-03 11:05:42.268 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/corpus.jsonl
2024-11-03 11:06:16.224 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_PT_merge_all_no_ewc_full/merged_with_new_lean4-pdl_c7f649fe3c4891cf1a01c120e82ebc5f6199856e/corpus.jsonl
2024-11-03 11:06:16.224 | INFO     | retrieval.model:reindex_corpus:284 - Re-indexing the retrieval corpus
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6484/6484 [10:39<00:00, 10.14it/s]
2024-11-03 11:16:55.830 | INFO     | prover.proof_search:__init__:459 - Finished reindexing!
2024-11-03 11:16:55.830 | INFO     | prover.proof_search:__init__:470 - Launching 4 workers with 4 GPUs.
(autoscaler +19h24m1s) Tip: use `ray status` to view detailed cluster status. To disable these messages, set RAY_SCHEDULER_EVENTS=0.
(autoscaler +19h24m1s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h24m1s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h24m1s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h26m27s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h28m6s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h28m55s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h28m55s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h30m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h30m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h30m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h30m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h30m33s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h33m5s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h33m5s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h33m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h33m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h33m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h33m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h34m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h34m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h34m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h37m59s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h42m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h43m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h43m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h43m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h43m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h43m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h43m43s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h47m4s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h47m51s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h48m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h48m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h48m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h49m31s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h49m31s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h49m31s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h49m31s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h52m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h52m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +19h52m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h52m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h52m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h53m45s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h55m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h55m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h55m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h55m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h57m54s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h59m32s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +19h59m32s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +20h17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +20h17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +20h17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to th
is Ray cluster.
(autoscaler +20h1m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +20h1m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +20h1m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +20h1m58s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h2m48s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h4m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h4m26s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h6m4s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to t
his Ray cluster.
(autoscaler +20h7m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h7m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h7m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h7m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h7m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h7m40s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h9m17s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h10m7s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h10m56s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h10m56s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h11m41s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h14m10s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h17m31s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h19m10s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h20m2s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h23m21s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h23m21s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h23m21s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
 this Ray cluster.
(autoscaler +20h24m9s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h24m9s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
(autoscaler +20h24m9s) Warning: The following resource request cannot be scheduled right now: {'CPU': 1.0, 'GPU': 1.0}. This is likely due to all cluster resources being claimed by actors. Consider creating fewer actors or adding more nodes to
this Ray cluster.
2024-11-03 18:34:33.280 | INFO     | __main__:prove_sorry_theorems:884 - Found 30 sorry theorems to prove
Processing theorems from m4lvin/lean4-pdl:   0%|                                                                                                                                                                        | 0/30 [00:00<?, ?theorem/s]
2024-11-03 18:34:56.158 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for localBoxTruth'
2024-11-03 18:35:16.367 | INFO     | __main__:prove_sorry_theorems:908 - Position: (959, 1)
Processing theorems from m4lvin/lean4-pdl:   3%|█████▎                                                                                                                                                          | 1/30 [00:20<09:46, 20.21s/theorem]
2024-11-03 18:35:36.162 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for tableauThenNotSat
2024-11-03 18:35:59.606 | INFO     | __main__:prove_sorry_theorems:908 - Position: (752, 1)
Processing theorems from m4lvin/lean4-pdl:   7%|██████████▋                                                                                                                                                     | 2/30 [01:03<15:45, 33.76s/theorem]
2024-11-03 18:36:22.793 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for mord_acc_mOrd_acc
2024-11-03 18:36:22.794 | INFO     | __main__:prove_sorry_theorems:908 - Position: (208, 1)
Processing theorems from m4lvin/lean4-pdl:  10%|████████████████                                                                                                                                                | 3/30 [01:46<17:07, 38.05s/theorem]
2024-11-03 18:36:42.776 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for boxHelperTP
2024-11-03 18:37:02.652 | INFO     | __main__:prove_sorry_theorems:908 - Position: (900, 1)
Processing theorems from m4lvin/lean4-pdl:  13%|█████████████████████▎                                                                                                                                          | 4/30 [02:06<13:22, 30.88s/theorem]
2024-11-03 18:37:02.652 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for nonsense
2024-11-03 18:37:02.653 | INFO     | __main__:prove_sorry_theorems:908 - Position: (163, 1)
2024-11-03 18:37:02.653 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for loadRuleTruth
2024-11-03 18:37:23.160 | INFO     | __main__:prove_sorry_theorems:908 - Position: (117, 1)
Processing theorems from m4lvin/lean4-pdl:  20%|████████████████████████████████                                                                                                                                | 6/30 [02:27<07:58, 19.95s/theorem]
2024-11-03 18:37:23.160 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for localRuleApp.decreases_DM
2024-11-03 18:37:42.930 | INFO     | __main__:prove_sorry_theorems:908 - Position: (658, 1)
Processing theorems from m4lvin/lean4-pdl:  23%|█████████████████████████████████████▎                                                                                                                          | 7/30 [02:46<07:37, 19.90s/theorem]
2024-11-03 18:38:02.853 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for equiv_iff_TPequiv
2024-11-03 18:38:02.853 | INFO     | __main__:prove_sorry_theorems:908 - Position: (749, 1)
Processing theorems from m4lvin/lean4-pdl:  27%|██████████████████████████████████████████▋                                                                                                                     | 8/30 [03:26<07:17, 19.90s/theorem]
2024-11-03 18:38:22.653 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for loadedDiamondPaths
2024-11-03 18:38:42.571 | INFO     | __main__:prove_sorry_theorems:908 - Position: (715, 1)
Processing theorems from m4lvin/lean4-pdl:  30%|████████████████████████████████████████████████                                                                                                                | 9/30 [03:46<08:57, 25.59s/theorem]
2024-11-03 18:38:42.571 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for LocalRule.Decreases
2024-11-03 18:39:03.897 | INFO     | __main__:prove_sorry_theorems:908 - Position: (553, 1)
Processing theorems from m4lvin/lean4-pdl:  33%|█████████████████████████████████████████████████████                                                                                                          | 10/30 [04:07<08:07, 24.35s/theorem]
2024-11-03 18:39:03.898 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for WRONG_list_count_subset_le
2024-11-03 18:39:03.898 | INFO     | __main__:prove_sorry_theorems:908 - Position: (648, 1)
2024-11-03 18:39:03.898 | INFO     | __main__:prove_sorry_theorems:907 - Searching for proof for localBoxTruth
2024-11-03 18:39:03.898 | INFO     | __main__:prove_sorry_theorems:908 - Position: (974, 1)
2024-11-03 18:39:23.941 | INFO     | prover.proof_search:search_unordered:513 - Distributed
Processing theorems from m4lvin/lean4-pdl:  37%|████████████████████████████████████████████████████████▍                                                                                                 | 11/30 [2:23:04<4:07:07, 780.37s/theorem]
2024-11-03 20:58:00.273 | INFO     | __main__:main:1920 - An error occurred: ray::ProverActor.search() (pid=4100901, ip=10.0.6.22, actor_id=810bab8175bbef752ee2ae4b01000000, repr=<prover.proof_search.ProverActor object at 0x792e9f056560>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 1894, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_proving)
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 921, in prove_sorry_theorems
    process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
  File "/data/yingzi_ma/lean_project/ReProver/main2full.py", line 806, in process_theorem_batch
    results = prover.search_unordered(LeanGitRepo(repo.url, repo.commit), lean_dojo_theorems, positions_batch)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 514, in search_unordered
    results = list(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 170, in get_generator
    yield self.get_next_unordered()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 370, in get_next_unordered
    return ray.get(future)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 2691, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 871, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(CalledProcessError): ray::ProverActor.search() (pid=4100901, ip=10.0.6.22, actor_id=810bab8175bbef752ee2ae4b01000000, repr=<prover.proof_search.ProverActor object at 0x792e9f056560>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(base) yingzi_ma@compute-permanent-node-535:~/lean_project/ReProver$
